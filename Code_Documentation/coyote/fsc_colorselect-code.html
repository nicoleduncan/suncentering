<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:56:45 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>fsc_colorselect.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="fsc_colorselect.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;   FSC_COLORSELECT</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;</span>
<span class="comments">;   The purpose of this compound widget is to provide a means for selecting</span>
<span class="comments">;   a new color or color table in a widget program. The program consists of</span>
<span class="comments">;   a label, a non-editable text widget, and a button to make a color or</span>
<span class="comments">;   color table selection interactively. (See the example program.)</span>
<span class="comments">;</span>
<span class="comments">; AUTHOR:</span>
<span class="comments">;   FANNING SOFTWARE CONSULTING</span>
<span class="comments">;   David Fanning, Ph.D.</span>
<span class="comments">;   1645 Sheely Drive</span>
<span class="comments">;   Fort Collins, CO 80526 USA</span>
<span class="comments">;   Phone: 970-221-0438</span>
<span class="comments">;   E-mail: david@idlcoyote.com</span>
<span class="comments">;   Coyote's Guide to IDL Programming: http://www.idlcoyote.com/</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;</span>
<span class="comments">;   General programming.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;</span>
<span class="comments">;   objectRef = FSC_COLORSELECT(parent, Title='Annotate Color ", Color='red')</span>
<span class="comments">;</span>
<span class="comments">; INPUT PARAMETERS:</span>
<span class="comments">;</span>
<span class="comments">;   parent -- The parent widget ID of the compound widget. Required.</span>
<span class="comments">;</span>
<span class="comments">; INPUT KEYWORDS:</span>
<span class="comments">;</span>
<span class="comments">;   BREWER:        Set if you want Brewer color tables, rather than the normal IDL color tables.</span>
<span class="comments">;                  This requires the file fsc_brewer.tbl to be in your IDL path.</span>
<span class="comments">;                  </span>
<span class="comments">;   CFONT:         Set to the name of a font to display the color name in.</span>
<span class="comments">;   </span>
<span class="comments">;   COLOR:         The name of the color to be displayed in the widget. If color</span>
<span class="comments">;                  is not used, or if it is set to a null string, then the widget</span>
<span class="comments">;                  will allow selection of a color table, instead of a color name.</span>
<span class="comments">;                  </span>
<span class="comments">;   CT_INDEX:      The color table index number you wish to use. The actual name of the</span>
<span class="comments">;                  color table will be displayed in the widget.</span>
<span class="comments">;                    </span>
<span class="comments">;   EVENT_FUNC:   Set this keyword to the name of an Event Function. If this</span>
<span class="comments">;                 keyword is undefined and the Event_Pro keyword is undefined,</span>
<span class="comments">;                 all compound widget events are handled internally and not</span>
<span class="comments">;                 passed on to the parent widget.</span>
<span class="comments">;                 </span>
<span class="comments">;   EVENT_PRO:    Set this keyword to the name of an Event Procedure. If this</span>
<span class="comments">;                 keyword is undefined and the Event_Func keyword is undefined,</span>
<span class="comments">;                 all compound widget events are handled internally and not</span>
<span class="comments">;                 passed on to the parent widget.</span>
<span class="comments">;                 </span>
<span class="comments">;   FRAME:        Set this keyword to put a frame around the compound widget.</span>
<span class="comments">;   </span>
<span class="comments">;   LABELALIGN:  Set this keyword to align label text. [0-center (default), 1-left, 2-right].</span>
<span class="comments">;   </span>
<span class="comments">;   LABELFONT:   The font name for the text in the Label Widget.</span>
<span class="comments">;   </span>
<span class="comments">;   LABELSIZE:   The X screen size of the Label Widget.</span>
<span class="comments">;   </span>
<span class="comments">;   NAME:        A scalar string name of the object. (Default = ''.)</span>
<span class="comments">;   </span>
<span class="comments">;   SCR_XSIZE:   The X screen size of the compound widget.</span>
<span class="comments">;   </span>
<span class="comments">;   SCR_YSIZE:   The Y screen size of the compound widget.</span>
<span class="comments">;   </span>
<span class="comments">;   STYLE:       The "style" of the text in the Text Widget. A value of 0 (the default)</span>
<span class="comments">;                capitalizes the first letter in the name. A style of 1 uses all lowercase.</span>
<span class="comments">;                A style of 2 uses all uppercase.</span>
<span class="comments">;                </span>
<span class="comments">;   TITLE:       The text to go on the Label Widget.</span>
<span class="comments">;   </span>
<span class="comments">;   UVALUE:      A user value for any purpose.</span>
<span class="comments">;   </span>
<span class="comments">;   XSIZE:       The X size of the Text Widget.</span>
<span class="comments">;</span>
<span class="comments">;   In addition, any keyword defined for WIDGET_TEXT, but not defined here (e.g., SENSITIVE), is</span>
<span class="comments">;   passed along without inspection to the text widget. Use of "extra" keywords is discouraged.</span>
<span class="comments">;</span>
<span class="comments">; COMMON BLOCKS:</span>
<span class="comments">;</span>
<span class="comments">;   None.</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;</span>
<span class="comments">;   None.</span>
<span class="comments">;</span>
<span class="comments">; EVENT STRUCTURE:</span>
<span class="comments">;</span>
<span class="comments">;   All events are handled internally unless either the Event_Pro or Event_Func</span>
<span class="comments">;   keywords are used to assign an event handler to the compound widget. </span>
<span class="comments">;</span>
<span class="comments">;   event = { FSC_ColorSelect_Event, $; The name of the event structure.</span>
<span class="comments">;             ID: 0L, $              ; The ID of the compound widget's top-level base.</span>
<span class="comments">;             TOP: 0L, $             ; The widget ID of the top-level base of the hierarchy.</span>
<span class="comments">;             HANDLER: 0L, $         ; The event handler ID. Filled out by IDL.</span>
<span class="comments">;             Color: "", $           ; The name of the current color or color table.</span>
<span class="comments">;             Index: 0L, $           ; The color table index selected if color tables are used.</span>
<span class="comments">;             Brewer: 0L, $          ; A flag that indicated Brewer color tables are being used.</span>
<span class="comments">;             NColors: 0L, $         ; The number of colors used for the color table.</span>
<span class="comments">;             ObjRef:Obj_New()}      ; The "self" object.</span>
<span class="comments">;</span>
<span class="comments">; GETTING and SETTING VALUES:</span>
<span class="comments">;</span>
<span class="comments">;   Almost all the properties of the widget can be obtained or set via</span>
<span class="comments">;   the object's GetProperty and SetProperty methods (described below).</span>
<span class="comments">;   But since traditional compound widgets have the ability to get and</span>
<span class="comments">;   set the value of the compound widget, this capability is implemented</span>
<span class="comments">;   as special methods: Get_Color/Set_Color and Get_Color_Index/Set_Color_Index.</span>
<span class="comments">;</span>
<span class="comments">;   To get the color of the widget, do this: color = objectRef->Get_Color()</span>
<span class="comments">;   To set the color of the widget, do this: objectRef->Set_Color, 'blue'.</span>
<span class="comments">;   Valid colors are those returned by FSC_Color. Getting and setting the</span>
<span class="comments">;   color table index number works similarly.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;</span>
<span class="comments">;   An example program is provided at the end of the FSC_COLORSELECT code. To run it,</span>
<span class="comments">;   type these commands:</span>
<span class="comments">;</span>
<span class="comments">;      IDL> .Compile FSC_COLORSELECT</span>
<span class="comments">;      IDL> Example</span>
<span class="comments">;</span>
<span class="comments">; DEPENDENCIES:</span>
<span class="comments">;</span>
<span class="comments">;   Requires the Coyote Library:</span>
<span class="comments">;     http://www.idlcoyote.com/programs/coyoteprograms.zip</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;</span>
<span class="comments">;   Written by: David W. Fanning, 26 JULY 2010.</span>
<span class="comments">;-</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;  Copyright (c) 2010, by Fanning Software Consulting, Inc.                                ;</span>
<span class="comments">;  All rights reserved.                                                                    ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Redistribution and use in source and binary forms, with or without                      ;</span>
<span class="comments">;  modification, are permitted provided that the following conditions are met:             ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;      * Redistributions of source code must retain the above copyright                    ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer.                     ;</span>
<span class="comments">;      * Redistributions in binary form must reproduce the above copyright                 ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer in the               ;</span>
<span class="comments">;        documentation and/or other materials provided with the distribution.              ;</span>
<span class="comments">;      * Neither the name of Fanning Software Consulting, Inc. nor the names of its        ;</span>
<span class="comments">;        contributors may be used to endorse or promote products derived from this         ;</span>
<span class="comments">;        software without specific prior written permission.                               ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  THIS SOFTWARE IS PROVIDED BY FANNING SOFTWARE CONSULTING, INC. ''AS IS'' AND ANY        ;</span>
<span class="comments">;  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES    ;</span>
<span class="comments">;  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT     ;</span>
<span class="comments">;  SHALL FANNING SOFTWARE CONSULTING, INC. BE LIABLE FOR ANY DIRECT, INDIRECT,             ;</span>
<span class="comments">;  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED    ;</span>
<span class="comments">;  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;         ;</span>
<span class="comments">;  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND             ;</span>
<span class="comments">;  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT              ;</span>
<span class="comments">;  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS           ;</span>
<span class="comments">;  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                            ;</span>
<span class="comments">;******************************************************************************************;</span>
FUNCTION FSC_COLORSELECT_WidgetFont, DEFAULT=default

   <span class="comments">; Build a small widget to determine the current </span>
   <span class="comments">; and default widget fonts.</span>
   
   base = Widget_Base(MAP=0)
   button = Widget_Button(base, Value='TEST')
   
   <span class="comments">; Checking before realization gives default font.</span>
   defaultFont = Widget_Info(button, /FONTNAME)
   
   <span class="comments">; Checking after realization gives current font.</span>
   Widget_Control, base, /REALIZE
   currentFont = Widget_Info(button, /FONTNAME)
   
   <span class="comments">; Clean up.</span>
   Widget_Control, base, /DESTROY

   IF Keyword_Set(default) THEN $
        RETURN, defaultFont ELSE $
        RETURN, currentFont
    
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>




FUNCTION FSC_COLORSELECT::GetTextID

    <span class="comments">; This method returns the ID of the text widget of the compound widget.</span>
    
    RETURN, self.textID
    
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>


PRO FSC_COLORSELECT::Resize, newsize

    <span class="comments">; This method resizes the widget by making the text widget fit the new size.</span>
    
    l = Widget_Info(self.labelID, /Geometry)
    b = Widget_Info(self.cbuttonID, /Geometry)
    Widget_Control, self.textID, Scr_XSize = (newsize - (l.scr_xsize + b.scr_xsize))
    
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>


FUNCTION FSC_COLORSELECT::GetID

    <span class="comments">; This method returns the ID of the top-level base of the compound widget.</span>
    
    RETURN, self.tlb
    
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>


FUNCTION FSC_COLORSELECT::GetLabelSize

<span class="comments">; This method returns the X screen size of the label widget.</span>

geom = Widget_Info(self.labelID, /Geometry)
RETURN, geom.scr_xsize
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>



FUNCTION FSC_COLORSELECT::GetTextSize

    <span class="comments">; This method returns the X screen size of the text widget.</span>
    
    geom = Widget_Info(self.textID, /Geometry)
    RETURN, geom.scr_xsize
    
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>



FUNCTION FSC_ColorSelect::Geometry

    <span class="comments">; This method returns the geometry of the compound widget.</span>
    
    RETURN, Widget_Info(self.tlb,/Geometry)
    
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>


FUNCTION FSC_ColorSelect::Get_Color

    <span class="comments">; This method returns the text in the Text Widget of the compound widget</span>
    
    Widget_Control, self.textID, Get_Value=theValue
    theValue = theValue[0]
   
    RETURN, theValue
    
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>


FUNCTION FSC_ColorSelect::Get_Color_Index, BREWER=brewer

    <span class="comments">; This method returns the current color table index of the widget. </span>
    <span class="comments">; Optionally, you can determine if this index is to a brewer color</span>
    <span class="comments">; table or not.</span>
    
    brewer=self.brewer
   
    RETURN, self.ct_index
    
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>


PRO FSC_ColorSelect::Set_Color, color

<span class="comments">; This method sets the value of the compound widget.</span>

   <span class="comments">; Error Handling.</span>
   Catch, theError
   IF theError NE 0 THEN BEGIN
       void = Error_Message()
       RETURN
   ENDIF
   
   <span class="comments">; Must be a string.</span>
   IF Size(color, /TNAME) NE 'STRING' THEN Message, 'Input color must be a string.'
   
   <span class="comments">; Can you find this color in cgColor?</span>
   colors = cgColor(/NAMES)
   index = Where(colors EQ StrCompress(color, /REMOVE_ALL), count)
   IF count EQ 0 THEN Message, 'The color ' + StrUpCase(color) + ' is not a valid color name.'

   <span class="comments">; Load the color in the widget.</span>
   Widget_Control, self.textID, Set_Value=color
   self.color = color

END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>


PRO FSC_ColorSelect::Set_Color_Index, colorIndex, BREWER=brewer, TABLENAME=tableName

    <span class="comments">; This method sets the color table index number of the widget.</span>
    <span class="comments">; Optionally, can set the brewer color tables. The TABLENAME</span>
    <span class="comments">; keyword will return the color table name associated with the</span>
    <span class="comments">; colorIndex number.</span>

   <span class="comments">; Error Handling.</span>
   Catch, theError
   IF theError NE 0 THEN BEGIN
       void = Error_Message()
       RETURN
   ENDIF
   
   <span class="comments">; Check parameters.</span>
   IF N_Elements(colorIndex) EQ 0 THEN Message, 'Must pass a color table index number.'
   IF N_Elements(brewer) EQ 0 THEN brewer = self.brewer ELSE brewer = Keyword_Set(brewer)
   
   <span class="comments">; Get the color table names.</span>
   thisDevice = !D.NAME
   Set_Plot, 'Z'
   TVLCT, r, g, b, /GET
   cgLoadCT, colorIndex, GET_NAMES=ctNames, BREWER=brewer
   tableName = ctNames[colorIndex]
   TVLCT, r, g, b
   Set_Plot, thisDevice
    
    <span class="comments">; Set the appropriate values.</span>
    Widget_Control, self.textID, Set_Value=tableName
    Widget_Control, self.textID, Set_Text_Select=[StrLen(tableName)]
    self.ct_index = colorIndex
    self.brewer = brewer

END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>



PRO FSC_ColorSelect_Event__Define

<span class="comments">; The FSC_ColorSelect_Event Structure. Sent only if EVENT_PRO or EVENT_FUNC keywords</span>
<span class="comments">; have defined an event handler for the top-level base of the compound widget.</span>

   event = { FSC_ColorSelect_Event, $<span class="comments">; The name of the event structure.</span>
             ID: 0L, $              <span class="comments">; The ID of the compound widget's top-level base.</span>
             TOP: 0L, $             <span class="comments">; The widget ID of the top-level base of the hierarchy.</span>
             HANDLER: 0L, $         <span class="comments">; The event handler ID. Filled out by IDL.</span>
             Color: "", $           <span class="comments">; The name of the current color or color table.</span>
             Index: 0L, $           <span class="comments">; The color table index selected if color tables are used.</span>
             Brewer: 0L, $          <span class="comments">; A flag that indicated Brewer color tables are being used.</span>
             NColors: 0L, $         <span class="comments">; The number of colors used for the color table.</span>
             ObjRef:Obj_New()}      <span class="comments">; The "self" object.</span>


END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>


FUNCTION FSC_ColorSelect::PickColorEvents, event

    <span class="comments">; Error Handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
       Catch, /Cancel
       void = Error_Message()
       RETURN, 0
    ENDIF

    IF self.ct_ncolors GT 1 THEN BEGIN
        
        XCOLORS, /MODAL, CANCEL=cancelled, GROUP_LEADER=self.tlb, INDEX=self.ct_index, $
            NCOLORS=self.ct_ncolors, COLORINFO=cinfo, BREWER=self.brewer

        thisDevice = !D.NAME
        Set_Plot, 'Z'
        TVLCT, r, g, b, /GET
        cgLoadCT, cinfo.index, GET_NAMES=ctNames, BREWER=cinfo.brewer
        tableName = ctNames[cinfo.index]
        TVLCT, r, g, b
        Set_Plot, thisDevice
    
        Widget_Control, self.textID, Set_Value=tableName
        Widget_Control, self.textID, Set_Text_Select=[StrLen(tableName)]
        self.ct_index = cinfo.index
        self.brewer = cinfo.brewer

        event = { FSC_COLORSELECT_EVENT, $
            self.tlb, event.top, 0L, tableName, cinfo.index, $
            cinfo.brewer, self.ct_ncolors, self}        
    ENDIF ELSE BEGIN
        color = cgPickColorName(self.color, CANCEL=cancelled, GROUP_LEADER=self.tlb)
        IF cancelled THEN RETURN, 0
        
        <span class="comments">; Style the color name.</span>
        IF color NE "" THEN BEGIN
            CASE self.style OF
               0: thisColor = CapFirstLetter(StrLowCase(color))
               1: thisColor = StrLowCase(color)
               2: thisColor = StrUpCase(color)
            ENDCASE
        ENDIF ELSE thisColor = ""
    
        self.color = color
        Widget_Control, self.textID, Set_Value=thisColor
        Widget_Control, self.textID, Set_Text_Select=[StrLen(thisColor)]
        event = { FSC_COLORSELECT_EVENT, $
            self.tlb, event.top, 0L, StrUpCase(color), self.ct_index, $
            self.brewer, self.ct_ncolors, self}
    ENDELSE
    
    IF self.event_pro EQ "" AND self.event_func EQ "" THEN event = 0
    
   RETURN, event
END

FUNCTION FSC_ColorSelect_Event_Handler, event

    <span class="comments">; The main event handler for the compound widget. It reacts</span>
    <span class="comments">; to "messages" in the UValue of the text widget.</span>
    <span class="comments">; The message indicates which object method to call. A message</span>
    <span class="comments">; consists of an object method and the self object reference.</span>
    
    Widget_Control, event.ID, Get_UValue=theMessage
    
    event = Call_Method(theMessage.method, theMessage.object, event)
    
    RETURN, event
    
END <span class="comments">;-----------------------------------------------------------------------------------------------------------------------------</span>



PRO FSC_ColorSelect::GetProperty, $
<span class="comments">;</span>
<span class="comments">; This method allows you to obtain various properties of the compound widget via output keywords.</span>
<span class="comments">;</span>
   BREWER=brewer, $                 <span class="comments">; A flag that indicates a brewer color table.</span>
   COLOR=color, $                   <span class="comments">; Get the "value" of the compound widget.</span>
   CT_INDEX=ct_index, $             <span class="comments">; The color table index number.</span>
   EVENT_FUNC=event_func, $         <span class="comments">; Get the name of an Event Function.</span>
   EVENT_PRO=event_pro, $           <span class="comments">; Get the name of an Event Procedure.</span>
   ID=id, $                         <span class="comments">; The widget identifier of the compound widget.</span>
   NAME=name, $                     <span class="comments">; Get the name of the object.</span>
   TEXTID=textid, $                 <span class="comments">; The ID of the text widget.</span>
   UVALUE=uvalue                    <span class="comments">; Get the user value of this object.</span>

   <span class="comments">; Error Handling.</span>
   Catch, theError
   IF theError NE 0 THEN BEGIN
       void = Error_Message()
       RETURN
   ENDIF

    <span class="comments">; Get the properties.</span>
    brewer = self.brewer
    color = self.color
    ct_index = self.ct_index
    event_func = self.event_func
    event_pro = self.event_pro
    id = self -> GetID()
    uvalue = *self.uvalue
    name = self.name
    textid = self -> GetTextID()
    
END <span class="comments">;--------------------------------------------------------------------------------------------------------------</span>



PRO FSC_ColorSelect::SetProperty, $

   <span class="comments">; This method allows you to set various properties of the compound widget.</span>

   BREWER=brewer, $
   COLOR=color, $                   <span class="comments">; The name of a color for the compound widget.</span>
   CT_INDEX=ct_index, $             <span class="comments">; The color table index number.</span>
   EVENT_FUNC=event_func, $         <span class="comments">; Set this keyword to the name of an Event Function.</span>
   EVENT_PRO=event_pro, $           <span class="comments">; Set this keyword to the name of an Event Procedure.</span>
   LABELSIZE=labelsize, $           <span class="comments">; The X screen size of the Label Widget.</span>
   NAME=name, $                     <span class="comments">; A scalar string name for the object.</span>
   SCR_XSIZE=scr_xsize, $           <span class="comments">; The X screen size of the text widget.</span>
   SCR_YSIZE=scr_ysize, $           <span class="comments">; The Y screen size of the text widget.</span>
   SENSITIVE=sensitive, $           <span class="comments">; Set to 1 to make the widget sensitive, and to 0 to make it insensitive.</span>
   STYLE=style, $                   <span class="comments">; The formating style for the text widget.</span>
   TITLE=title, $                   <span class="comments">; The text to go on the Label Widget.</span>
   UVALUE=uvalue, $                 <span class="comments">; A user value for any purpose.</span>
   XSIZE=xsize                      <span class="comments">; The X size of the Text Widget.</span>

   <span class="comments">; Error Handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
       void = Error_Message()
       RETURN
    ENDIF
    
    <span class="comments">; Set the properties, if needed.</span>
    IF N_Elements(brewer) NE 0 THEN self.brewer = Keyword_Set(brewer)
    IF N_Elements(color) NE 0 THEN self.color = color
    IF N_Elements(ct_index) NE 0 THEN self.ct_index = ct_index
    IF N_Elements(event_func) NE 0 THEN self.event_func = event_func
    IF N_Elements(event_pro) NE 0 THEN self.event_pro = event_pro
    IF N_Elements(labelsize) NE 0 THEN BEGIN
       Widget_Control, self.labelID, XSize=labelsize
    ENDIF
    IF N_Elements(scr_xsize) NE 0 THEN BEGIN
       self.scr_xsize = scr_xsize
       Widget_Control, self.textID, Scr_XSize=scr_xsize
    ENDIF
    IF N_Elements(scr_ysize) NE 0 THEN BEGIN
       self.scr_ysize = scr_ysize
       Widget_Control, self.textID, Scr_YSize=scr_ysize
    ENDIF
    IF N_Elements(sensitive) NE 0 THEN Widget_Control, self.textID, Sensitive=sensitive
    IF N_Elements(style) NE 0 THEN self.style = 0 > style &lt<span class="comments">; 2</span>
    IF N_Elements(title) NE 0 THEN Widget_Control, self.labelID, Set_Value=title
    IF N_Elements(uvalue) NE 0 THEN *self.uvalue = uvalue
    IF N_elements(name) NE 0 THEN self.name = String(name[0])
    IF N_Elements(xsize) NE 0 THEN Widget_Control, self.textID, XSize=xsize

END <span class="comments">;--------------------------------------------------------------------------------------------------------------</span>



FUNCTION FSC_ColorSelect::INIT, $   <span class="comments">; The compound widget FSC_ColorSelect INIT method..</span>
   parent, $                        <span class="comments">; The parent widget. Required for all compound widgets.</span>
   Brewer=brewer, $                 <span class="comments">; A brewer color table, if set.</span>
   Button_Text=button_text, $       <span class="comments">; The value of the selection button.</span>
   CFont=cfont, $                   <span class="comments">; The font name for the text in the Text Widget.</span>
   Color=color, $                   <span class="comments">; The color name.</span>
   CT_Index=ct_index, $             <span class="comments">; The index of the current color table.</span>
   CT_NColors=ct_ncolors, $         <span class="comments">; The number of colors in the color table. $               </span>
   Event_Func=event_func, $         <span class="comments">; Set this keyword to the name of an Event Function.</span>
   Event_Pro=event_pro, $           <span class="comments">; Set this keyword to the name of an Event Procedure.</span>
   _Extra=extra, $                  <span class="comments">; Passes along extra keywords to the text widget.</span>
   Frame=frame, $                   <span class="comments">; Set this keyword to put a frame around the compound widget.</span>
   LabelAlign=labelalign, $         <span class="comments">; Set this keyword to align label text.</span>
   LabelFont=labelfont, $           <span class="comments">; The font name for the text in the Label Widget.</span>
   LabelSize=labelsize, $           <span class="comments">; The X screen size of the Label Widget.</span>
   Name=name, $                     <span class="comments">; A scalar string name for the object.</span>
   Scr_XSize=scr_xsize, $           <span class="comments">; The X screen size of the text widget.</span>
   Scr_YSize=scr_ysize, $           <span class="comments">; The Y screen size of the text widget.</span>
   Style=style, $                   <span class="comments">; The style of the color name: 0 (cap first letter), 1 (lowcase) 2 (uppercase)</span>
   Title=title, $                   <span class="comments">; The text to go on the Label Widget.</span>
   UValue=uvalue, $                 <span class="comments">; A user value for any purpose.</span>
   XSize=xsize                      <span class="comments">; The X size of the Text Widget.</span>

   <span class="comments">; Error Handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
       void = Error_Message()
       RETURN, 0
    ENDIF
    
    <span class="comments">; A parent is required.</span>
    IF N_Elements(parent) EQ 0 THEN BEGIN
       Message, 'A PARENT argument is required. Returning...', /Informational
       RETURN, -1L
    ENDIF
    
    <span class="comments">; Set up PostScript device for working with colors.</span>
    IF !D.Name EQ 'PS' THEN Device, COLOR=1, BITS_PER_PIXEL=8
    
    <span class="comments">; Check keyword values. Properties of the widget are determined by</span>
    <span class="comments">; whether the COLOR parameter is a null string or not.</span>
    IF N_Elements(color) EQ 0 THEN color = ""
    IF N_Elements(ct_index) EQ 0 THEN ct_index = 0
    brewer = Keyword_Set(brewer)
    IF N_Elements(ct_ncolors) EQ 0 THEN ct_ncolors = (color EQ "") ? 256 : 1
    IF N_Elements(event_func) EQ 0 THEN event_func = ""
    IF N_Elements(event_pro) EQ 0 THEN event_pro = ""
    IF N_Elements(cfont) EQ 0 THEN cfont = FSC_ColorSelect_WidgetFont()
    IF N_Elements(frame) EQ 0 THEN frame = 0
    IF N_Elements(labelalign) EQ 0 THEN labelalign = 0
    IF N_Elements(labelfont) EQ 0 THEN labelfont = FSC_ColorSelect_WidgetFont()
    IF N_Elements(labelsize) EQ 0 THEN labelsize = 0
    IF N_Elements(style) EQ 0 THEN style = 0
    IF N_Elements(title) EQ 0 THEN title = "Input Value: "
    IF N_Elements(uvalue) EQ 0 THEN uvalue = ""
    IF N_Elements(color) EQ 0 THEN color = "Red"
    IF N_Elements(xsize) EQ 0 THEN xsize = 0
    
    <span class="comments">; Populate the object.</span>
    self.color = color
    self.ct_index = ct_index
    self.brewer = brewer
    self.ct_ncolors = 0 > ct_ncolors &lt<span class="comments">; 256</span>
    self.parent = parent
    self.event_pro = event_pro
    self.event_func = event_func
    self.style = style
    self.uvalue = Ptr_New(uvalue)
    If N_Elements(name) NE 0 Then self.name = String(name[0])
    
    <span class="comments">; Create the widgets.</span>
    self.tlb = Widget_Base( parent, $  <span class="comments">; The top-level base of the compound widget.</span>
       Frame=frame, $
       Row=row, $
       Row=1, $
       Base_Align_Center=1, $
       UValue=uvalue, $
       Event_Pro=event_pro, $
       Event_Func=event_func )
    
    self.labelID = Widget_Label( self.tlb, Value=title, Font=labelfont, $ <span class="comments">; The Label Widget.</span>
      Scr_XSize=labelsize, Scr_YSize=scr_ysize, /Dynamic_Resize, $
      Align_Center=(labelalign eq 0)?1:0, $
      Align_Left=(labelalign EQ 1)?1:0, $
      Align_Right=(labelalign EQ 2)?1:0)
      
   
      
    <span class="comments">; Style the color name.</span>
    IF color NE "" THEN BEGIN
        CASE style OF
           0: thisColor = CapFirstLetter(StrLowCase(color))
           1: thisColor = StrLowCase(color)
           2: thisColor = StrUpCase(color)
        ENDCASE
    ENDIF ELSE BEGIN
        thisDevice = !D.NAME
        Set_Plot, 'Z'
        TVLCT, r, g, b, /GET
        cgLoadCT, ct_index, GET_NAMES=ctNames, BREWER=brewer
        thisColor = ctNames[ct_index]
        TVLCT, r, g, b
        Set_Plot, thisDevice
    ENDELSE
    
    self.textID = Widget_Text( self.tlb, $  <span class="comments">; The Text Widget.</span>
       Value=thisColor, $
       XSize=xsize, $
       YSize=1, $
       Font=colorfont, $
       All_Events=0, $
       _Extra=extra, $
       Scr_YSize=scr_ysize, $
       Event_Func='FSC_ColorSelect_Event_Handler', $
       UValue={Method:"TextEvents", Object:self}, $
       Kill_Notify='FSC_ColorSelect_Kill_Notify', $
       Editable=0 )
       
    <span class="comments">; Get the name of the selection button.</span>
    IF N_Elements(button_text) EQ 0 THEN BEGIN
        IF color EQ "" THEN BEGIN
            button_text = 'Select Color Table' 
        ENDIF ELSE BEGIN
            button_text = 'Select Color'
        ENDELSE
    ENDIF
    
    <span class="comments">; Selection button.</span>
    self.cbuttonID = Widget_Button( self.tlb, $
       Value=button_text, Font=labelfont, $
       Event_Func='FSC_ColorSelect_Event_Handler', $
       UValue={Method:"PickColorEvents", Object:self}, $
       Kill_Notify='FSC_ColorSelect_Kill_Notify')
    
   <span class="comments">; If screen sizes are set, adjust the text widget size.</span>
   IF N_Elements(scr_xsize) NE 0 THEN BEGIN
      tlbg = Widget_Info(self.tlb, /Geometry)
      textg = Widget_Info(self.textID, /Geometry)
      labelg = Widget_info(self.labelID, /Geometry)
      plussize = textg.scr_xsize + labelg.scr_xsize
      stuff = (tlbg.xpad*2) + tlbg.space
      IF plussize GT scr_xsize THEN $
         Widget_Control, self.textID, Scr_XSize=textg.scr_xsize-(plussize-scr_xsize)-stuff ELSE $
         Widget_Control, self.textID, Scr_XSize=textg.scr_xsize+(scr_xsize - plussize)-stuff
   ENDIF
        
   RETURN, 1
   
END <span class="comments">;--------------------------------------------------------------------------------------------------------------</span>



PRO FSC_ColorSelect_Kill_Notify, textID

    <span class="comments">; This widget call-back procedure makes sure the self object is</span>
    <span class="comments">; destroyed when the widget is destroyed.</span>
    
    Widget_Control, textID, Get_UValue=message
    Obj_Destroy, message.object
    
END <span class="comments">;--------------------------------------------------------------------------------------------------------------</span>



PRO FSC_ColorSelect::CLEANUP

    <span class="comments">; This method makes sure there are not pointers left on the heap.</span>
    
    Ptr_Free, self.uvalue
    
END <span class="comments">;--------------------------------------------------------------------------------------------------------------</span>



PRO FSC_ColorSelect__Define

   objectClass = { FSC_ColorSelect, $       <span class="comments">; The object class name.</span>
                   parent: 0L, $            <span class="comments">; The parent widget ID.</span>
                   tlb: 0L, $               <span class="comments">; The top-level base of the compound widget.</span>
                   cbuttonID: 0L, $         <span class="comments">; The identifier of the Select Color button.</span>
                   color: "", $             <span class="comments">; The name of the color.</span>
                   ct_index: 0L, $          <span class="comments">; The color table index number.</span>
                   ct_ncolors: 0L, $        <span class="comments">; The number of colors in XCOLORS.</span>
                   labelID: 0L, $           <span class="comments">; The label widget ID.</span>
                   textID: 0L, $            <span class="comments">; The text widget ID.</span>
                   brewer: 0L, $            <span class="comments">; Use Brewer color tables.</span>
                   event_func: "", $        <span class="comments">; The name of the specified event handler function.</span>
                   event_pro: "", $         <span class="comments">; The name of the specified event handler procedrue</span>
                   style: 0L, $             <span class="comments">; The style of the color name.</span>
                   uvalue: Ptr_New(), $     <span class="comments">; The user value of the compound widget.</span>
                   name: "" $               <span class="comments">; A scalar string name for the object</span>
                  }

  END <span class="comments">;--------------------------------------------------------------------------------------------------------------</span>


FUNCTION FSC_ColorSelect, $          <span class="comments">; The compound widget FSC_ColorSelect.</span>
   parent, $                        <span class="comments">; The parent widget. Required for all compound widgets.</span>
   Brewer=brewer, $                 <span class="comments">; A brewer color table, if set.</span>
   Button_Text=button_text, $       <span class="comments">; The value of the selection button.</span>
   CFont=cfont, $                   <span class="comments">; The font name for the text in the Text Widget.</span>
   Color=color, $                   <span class="comments">; The color name.</span>
   CT_Index=ct_index, $             <span class="comments">; The index of the current color table.</span>
   CT_NColors=ct_ncolors, $         <span class="comments">; The number of colors in the color table. $               </span>
   Event_Func=event_func, $         <span class="comments">; Set this keyword to the name of an Event Function.</span>
   Event_Pro=event_pro, $           <span class="comments">; Set this keyword to the name of an Event Procedure.</span>
   _Extra=extra, $                  <span class="comments">; Passes along extra keywords to the text widget.</span>
   Frame=frame, $                   <span class="comments">; Set this keyword to put a frame around the compound widget.</span>
   LabelAlign=labelalign, $         <span class="comments">; Set this keyword to align label text.</span>
   LabelFont=labelfont, $           <span class="comments">; The font name for the text in the Label Widget.</span>
   LabelSize=labelsize, $           <span class="comments">; The X screen size of the Label Widget.</span>
   Name=name, $                     <span class="comments">; A scalar string name for the object.</span>
   Scr_XSize=scr_xsize, $           <span class="comments">; The X screen size of the text widget.</span>
   Scr_YSize=scr_ysize, $           <span class="comments">; The Y screen size of the text widget.</span>
   Style=style, $                   <span class="comments">; The style of the color name: 0 (cap first letter), 1 (lowcase) 2 (uppercase)</span>
   Title=title, $                   <span class="comments">; The text to go on the Label Widget.</span>
   UValue=uvalue, $                 <span class="comments">; A user value for any purpose.</span>
   XSize=xsize                      <span class="comments">; The X size of the Text Widget.</span>

RETURN, Obj_New("FSC_ColorSelect", $
   parent, $                        <span class="comments">; The parent widget. Required for all compound widgets.</span>
   Brewer=brewer, $                 <span class="comments">; A brewer color table, if set.</span>
   Button_Text=button_text, $       <span class="comments">; The value of the selection button.</span>
   CFont=cfont, $                   <span class="comments">; The font name for the text in the Text Widget.</span>
   Color=color, $                   <span class="comments">; The color name.</span>
   CT_Index=ct_index, $             <span class="comments">; The index of the current color table.</span>
   CT_NColors=ct_ncolors, $         <span class="comments">; The number of colors in the color table. $               </span>
   Event_Func=event_func, $         <span class="comments">; Set this keyword to the name of an Event Function.</span>
   Event_Pro=event_pro, $           <span class="comments">; Set this keyword to the name of an Event Procedure.</span>
   _Extra=extra, $                  <span class="comments">; Passes along extra keywords to the text widget.</span>
   Frame=frame, $                   <span class="comments">; Set this keyword to put a frame around the compound widget.</span>
   LabelAlign=labelalign, $         <span class="comments">; Set this keyword to align label text.</span>
   LabelFont=labelfont, $           <span class="comments">; The font name for the text in the Label Widget.</span>
   LabelSize=labelsize, $           <span class="comments">; The X screen size of the Label Widget.</span>
   Name=name, $                     <span class="comments">; A scalar string name for the object.</span>
   Scr_XSize=scr_xsize, $           <span class="comments">; The X screen size of the text widget.</span>
   Scr_YSize=scr_ysize, $           <span class="comments">; The Y screen size of the text widget.</span>
   Style=style, $                   <span class="comments">; The style of the color name: 0 (cap first letter), 1 (lowcase) 2 (uppercase)</span>
   Title=title, $                   <span class="comments">; The text to go on the Label Widget.</span>
   UValue=uvalue, $                 <span class="comments">; A user value for any purpose.</span>
   XSize=xsize)                     <span class="comments">; The X size of the Text Widget.</span>
END <span class="comments">;----------------------------------------------------------------------------</span>


PRO Example_Event, event
    Help,  event, /Structure
END <span class="comments">;----------------------------------------------------------------------------</span>


PRO Example
    <span class="comments">; An example program to exercise some of the features of FSC_ColorSelect.</span>
    tlb = Widget_Base(Column=1)
    field1 = FSC_COLORSELECT(tlb, Title='Color:', LabelSize=75, Color='Red', $
        LabelAlign=1, Event_Pro='Example_Event')
    field2 = FSC_COLORSELECT(tlb, Title='ColorTable:', LabelSize=75, $
        LabelAlign=1, CT_INDEX=4, /BREWER, Event_Pro='Example_Event')
    Widget_Control, tlb, /Realize
    XManager, 'example', tlb, /NO_BLOCK
END <span class="comments">;----------------------------------------------------------------------------</span>
</code>
    </div>
  </body>
</html>