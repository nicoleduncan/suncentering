<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:55:53 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>adjustposition.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="adjustposition.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       AdjustPosition</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;</span>
<span class="comments">;       This is a program for interactively adjusting the plot position</span>
<span class="comments">;       coordinates. The result of the function is a four-element floating</span>
<span class="comments">;       point array of normalized coordinates, suitable for passing to the</span>
<span class="comments">;       POSITION keyword of most IDL graphics commands.</span>
<span class="comments">;</span>
<span class="comments">; AUTHOR:</span>
<span class="comments">;</span>
<span class="comments">;       FANNING SOFTWARE CONSULTING</span>
<span class="comments">;       David Fanning, Ph.D.</span>
<span class="comments">;       1645 Sheely Drive</span>
<span class="comments">;       Fort Collins, CO 80526 USA</span>
<span class="comments">;       Phone: 970-221-0438</span>
<span class="comments">;       E-mail: david@idlcoyote.com</span>
<span class="comments">;       Coyote's Guide to IDL Programming: http://www.idlcoyote.com</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;</span>
<span class="comments">;       Graphics</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;</span>
<span class="comments">;       position = AdjustPosition(startingPosition)</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;</span>
<span class="comments">;       startingPosition - A four-element array of normalized coordinates</span>
<span class="comments">;            of the form [x0, y0, x1, y1].</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;</span>
<span class="comments">;       position - The adjusted plot position. A four-element array of normalized coordinates.</span>
<span class="comments">;</span>
<span class="comments">; INPUT KEYWORDS:</span>
<span class="comments">;</span>
<span class="comments">;       GROUP_LEADER - The group leader of this program. This keyword</span>
<span class="comments">;            is required to ensure modal operation when calling from</span>
<span class="comments">;            another widget program.</span>
<span class="comments">;</span>
<span class="comments">;       TITLE - The title of the window. "Adjust Plot Position in Window..." by default.</span>
<span class="comments">;</span>
<span class="comments">;       XOFFSET - The X offset of the program on the display. Calculated from the</span>
<span class="comments">;            upper left-hand corner of the display.</span>
<span class="comments">;</span>
<span class="comments">;       YOFFSET - The Y offset of the program on the display. Calculated from the</span>
<span class="comments">;            upper left-hand corner of the display.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT KEYWORDS:</span>
<span class="comments">;</span>
<span class="comments">;       CANCEL - Returns a 1 if the user selects the Cancel button. Returns 0 otherwise.</span>
<span class="comments">;            Note that if the use cancels, the "position" parameter is set to the value of</span>
<span class="comments">;            the "startingPosition" parameter.</span>
<span class="comments">;</span>
<span class="comments">; DEPENDENCIES:</span>
<span class="comments">;</span>
<span class="comments">;       Reqires FSC_FIELD and FSC_PLOTWINDOW from the Coyote Library:</span>
<span class="comments">;</span>
<span class="comments">;                     http://www.idlcoyote.com/programs/fsc_field.pro</span>
<span class="comments">;                     http://www.idlcoyote.com/programs/fsc_plotwindow.pro</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;</span>
<span class="comments">;       Written by David Fanning, March 2001.</span>
<span class="comments">;-</span>
<span class="comments">;</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;  Copyright (c) 2008, by Fanning Software Consulting, Inc.                                ;</span>
<span class="comments">;  All rights reserved.                                                                    ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Redistribution and use in source and binary forms, with or without                      ;</span>
<span class="comments">;  modification, are permitted provided that the following conditions are met:             ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;      * Redistributions of source code must retain the above copyright                    ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer.                     ;</span>
<span class="comments">;      * Redistributions in binary form must reproduce the above copyright                 ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer in the               ;</span>
<span class="comments">;        documentation and/or other materials provided with the distribution.              ;</span>
<span class="comments">;      * Neither the name of Fanning Software Consulting, Inc. nor the names of its        ;</span>
<span class="comments">;        contributors may be used to endorse or promote products derived from this         ;</span>
<span class="comments">;        software without specific prior written permission.                               ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  THIS SOFTWARE IS PROVIDED BY FANNING SOFTWARE CONSULTING, INC. ''AS IS'' AND ANY        ;</span>
<span class="comments">;  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES    ;</span>
<span class="comments">;  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT     ;</span>
<span class="comments">;  SHALL FANNING SOFTWARE CONSULTING, INC. BE LIABLE FOR ANY DIRECT, INDIRECT,             ;</span>
<span class="comments">;  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED    ;</span>
<span class="comments">;  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;         ;</span>
<span class="comments">;  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND             ;</span>
<span class="comments">;  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT              ;</span>
<span class="comments">;  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS           ;</span>
<span class="comments">;  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                            ;</span>
<span class="comments">;******************************************************************************************;</span>
PRO AdjustPosition_PlotEvents, event

<span class="comments">; This event handler responds to events generated by manipulating</span>
<span class="comments">; the plot position interactively with the mouse.</span>

Widget_Control, event.top, Get_UValue=info, /No_Copy

   <span class="comments">; Get the current position from the window.</span>

position = info.plotWindow->GetPosition()

   <span class="comments">; Update the text widgets.</span>

info.p0->Set_Value, position[0]
info.p1->Set_Value, position[1]
info.p2->Set_Value, position[2]
info.p3->Set_Value, position[3]

Widget_Control, event.top, Set_UValue=info, /No_Copy
END <span class="comments">;------------------------------------------------------------------------------------------</span>



PRO AdjustPosition_FieldEvents, event

<span class="comments">; The event handler responds to events from the text widgets.</span>

Widget_Control, event.top, Get_UValue=info, /No_Copy

   <span class="comments">; Get the values from the text widgets.</span>

x0 = info.p0->Get_Value()
y0 = info.p1->Get_Value()
x1 = info.p2->Get_Value()
y1 = info.p3->Get_Value()

   <span class="comments">; Make sure the values are ordered properly. There must</span>
   <span class="comments">; be at least 0.05 unit between values.</span>

IF x0 GT x1 THEN BEGIN
   temp = x0
   x0 = x1
   x1 = temp
ENDIF
IF x1-x0 LT 0.05 THEN x0 = 0 > (x1 - 0.05)
info.p0->Set_Value, x0
info.p2->Set_Value, x1

IF y0 GT y1 THEN BEGIN
   temp = y0
   y0 = y1
   y1 = temp
ENDIF
IF y1-y0 LT 0.05 THEN y0 = 0 > (y1 - 0.05)
info.p1->Set_Value, y0
info.p3->Set_Value, y1

   <span class="comments">; Set the position in the display.</span>

position = [x0, y0, x1, y1]
info.plotWindow->SetWindowSize, position

   <span class="comments">; Update the form info pointer.</span>

*(info.ptr) = {cancel:0, position:position}

Widget_Control, event.top, Set_UValue=info, /No_Copy
END <span class="comments">;------------------------------------------------------------------------------------------</span>



PRO AdjustPosition_ButtonEvents, event

<span class="comments">; This event handler responds to Cancel and Accept buttons.</span>

Widget_Control, event.top, Get_UValue=info, /No_Copy

   <span class="comments">; Get the latest plot position.</span>

position = info.plotWindow->GetPosition()

   <span class="comments">; Which button is it? Load the pointer with the correct</span>
   <span class="comments">; information.</span>

Widget_Control, event.id, Get_Value=buttonValue
CASE buttonValue OF
   'Cancel': *(info.ptr) = {cancel:1, position:position}
   'Accept': *(info.ptr) = {cancel:0, position:position}
ENDCASE

Widget_Control, event.top, /Destroy
END <span class="comments">;------------------------------------------------------------------------------------------</span>



FUNCTION AdjustPosition, currentPosition, Group_Leader=group_leader, $
   Title=title, Cancel=cancelled, XOffset=xoffset, YOffset=yoffset

   <span class="comments">; Check keywords.</span>

IF N_Elements(currentPosition) EQ 0 THEN currentPosition = [0.15, 0.15, 0.9, 0.9]
IF N_Elements(title) EQ 0 THEN title = "Adjust Plot Position in Window..."

   <span class="comments">; Create TLB as modal, if possible. Otherwise, will have to</span>
   <span class="comments">; rely on command line blocking.</span>

IF N_Elements(group_leader) NE 0 THEN BEGIN
   tlb = Widget_Base(Title=title, Modal=1, Group_Leader=group_leader, $
      Column=1, Base_Align_Center=1)
ENDIF ELSE BEGIN
   tlb = Widget_Base(Title=title, Column=1, Base_Align_Center=1)
ENDELSE

   <span class="comments">; Create the plot window widget.</span>

plotwindow = FSC_PlotWindow(tlb, PageSize='DISPLAY', WindowSize=currentPosition, $
   Event_Pro='AdjustPosition_PlotEvents', /Color)

   <span class="comments">; Other widgets.</span>

label = Widget_Label(tlb, Value='Adjust plot position with MOUSE. Use middle button to CENTER.')
rowbaseID = Widget_Base(tlb, Row=2)
f = FSC_Field(rowbaseID, Title='x0: ', Value=currentPosition[0], Decimal=3, Object=p0, $
   /CR_Only, Event_Pro='AdjustPosition_FieldEvents')
f = FSC_Field(rowbaseID, Title='y0: ', Value=currentPosition[1], Decimal=3, Object=p1, $
   /CR_Only, Event_Pro='AdjustPosition_FieldEvents')
f = FSC_Field(rowbaseID, Title='x1: ', Value=currentPosition[2], Decimal=3, Object=p2, $
   /CR_Only, Event_Pro='AdjustPosition_FieldEvents')
f = FSC_Field(rowbaseID, Title='y1: ', Value=currentPosition[3], Decimal=3, Object=p3, $
   /CR_Only, Event_Pro='AdjustPosition_FieldEvents')

buttonBaseID = Widget_Base(tlb, Row=1, Event_Pro='AdjustPosition_ButtonEvents')
b = Widget_Button(buttonBaseID, Value='Cancel')
b = Widget_Button(buttonBaseID, Value='Accept')

   <span class="comments">; Create a pointer to collect position information. Set for CANCEL.</span>

ptr = Ptr_New({Cancel:1})

   <span class="comments">; Position the widget on the display.</span>

IF (N_Elements(xoffset) EQ 0) AND (N_Elements(yoffset) EQ 0) THEN cgCenterTLB, tlb ELSE BEGIN
   IF N_Elements(xoffset) EQ 0 THEN xoffset = 100
   IF N_Elements(yoffset) EQ 0 THEN yoffset = 100
   Widget_Control, tlb, XOffset=xoffset, YOffset=yoffset
ENDELSE

Widget_Control, tlb, /Realize

   <span class="comments">; Create and store info structure.</span>

info = {p1:p1, p2:p2, p3:p3, p0:p0, ptr:ptr, plotWindow:plotWindow}
Widget_Control, tlb, Set_UValue=info, /No_Copy

   <span class="comments">; Block here until the widget is destroyed.</span>

XManager, 'adjustposition', tlb

   <span class="comments">; Set the cancel flag. Return starting position.</span>

cancelled = (*ptr).cancel
IF cancelled THEN BEGIN
   Ptr_Free, ptr
   RETURN, currentPosition
ENDIF

   <span class="comments">; Free pointer and return the new position.</span>

thisPosition = (*ptr).position
Ptr_Free, ptr

RETURN, thisPosition
END
</code>
    </div>
  </body>
</html>