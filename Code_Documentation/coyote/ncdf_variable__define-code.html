<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:08 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ncdf_variable__define.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ncdf_variable__define.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       NCDF_VARIABLE</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;</span>
<span class="comments">;       The pupose of this NCDF_Variable object is to store information about</span>
<span class="comments">;       a netCDF variable. The object is principally used as a utility routine </span>
<span class="comments">;       for the NCDF_FILE object. Given the variable name, the object will acquire </span>
<span class="comments">;       additional information about the variable from the netCDF file containing </span>
<span class="comments">;       the variable.</span>
<span class="comments">;</span>
<span class="comments">; AUTHOR:</span>
<span class="comments">;</span>
<span class="comments">;       FANNING SOFTWARE CONSULTING</span>
<span class="comments">;       David Fanning, Ph.D.</span>
<span class="comments">;       1645 Sheely Drive</span>
<span class="comments">;       Fort Collins, CO 80526 USA</span>
<span class="comments">;       Phone: 970-221-0438</span>
<span class="comments">;       E-mail: david@idlcoyote.com</span>
<span class="comments">;       Coyote's Guide to IDL Programming: http://www.idlcoyote.com</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;</span>
<span class="comments">;       File I/O</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;</span>
<span class="comments">;       IDL> varObj = Obj_New('NCDF_VARIABLE', varName, parent)</span>
<span class="comments">;</span>
<span class="comments">; ARGUMENTS:</span>
<span class="comments">;</span>
<span class="comments">;       varName:   The case sensitive name of a netCDF variable that is stored in the </span>
<span class="comments">;                  netCDF file. (Input and required.)</span>
<span class="comments">;</span>
<span class="comments">;       parent:    The object reference (NCDF_FILE object) of the netCDF file. In other words, the</span>
<span class="comments">;                  object reference of the file that contains this attribute. (Input and required.)</span>
<span class="comments">;</span>
<span class="comments">; KEYWORD PARAMETERS:</span>
<span class="comments">;       </span>
<span class="comments">;       None.</span>
<span class="comments">;</span>
<span class="comments">; METHODS:</span>
<span class="comments">;</span>
<span class="comments">;     The following methods are available. Each is documented in front of the method.</span>
<span class="comments">;</span>
<span class="comments">;     varObject -> AddAttr</span>
<span class="comments">;     varAttrNames = varObject -> GetAttrNames()</span>
<span class="comments">;     dimIDs = varObject -> GetDimIDs()</span>
<span class="comments">;     dimNames = varObject -> GetDimNames()</span>
<span class="comments">;     varAttrValue = varObject -> GetAttrValue()</span>
<span class="comments">;     varID = varObject -> GetID()</span>
<span class="comments">;     varName = varObject -> GetName()</span>
<span class="comments">;     propertyValue = varObject -> GetProperty(attrProperty)</span>
<span class="comments">;     varValue = varObject -> GetValue()</span>
<span class="comments">;     varObject -> ParseVariable</span>
<span class="comments">;     </span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       Written by:  David W. Fanning, 3 Feb 2010.</span>
<span class="comments">;       Changes to the way dimensions of length 0 are handled. 11 Feb 2010. DWF.</span>
<span class="comments">;       Added GetInfo method. 20 Mar 2010. DWF.</span>
<span class="comments">;       Added MISSINGINDICES and FILLVALUE keywords to GetValue method to return the indices </span>
<span class="comments">;           and the value of missing data. 20 Mar 2010. DWF.</span>
<span class="comments">;       Modified the GetValue method so that if the data returned is scaled and/or offset</span>
<span class="comments">;           then the "missing" data value is preserved, although its data type may change.</span>
<span class="comments">;           In other words, the "missing" data is not scaled or offset. 20 Mar 2010. DWF.</span>
<span class="comments">;       Added output keywords SCALE_FACTOR, ADD_OFFSET, and DATATYPE to the GetValue method</span>
<span class="comments">;           so that these values can be returned to the caller at run-time. 29 April 2010. DWF.</span>
<span class="comments">;       Modified AddAttr method to allow for additional data types in attributes, specifically</span>
<span class="comments">;           INT data type. 3 June 2013. DWF.</span>
<span class="comments">;       Had to modify AddAttr method again to allow compatibility with IDL versions below 8.1. 26 July 2013. DWF.</span>
<span class="comments">;-</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;  Copyright (c) 2010, by Fanning Software Consulting, Inc.                                ;</span>
<span class="comments">;  All rights reserved.                                                                    ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Redistribution and use in source and binary forms, with or without                      ;</span>
<span class="comments">;  modification, are permitted provided that the following conditions are met:             ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;      * Redistributions of source code must retain the above copyright                    ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer.                     ;</span>
<span class="comments">;      * Redistributions in binary form must reproduce the above copyright                 ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer in the               ;</span>
<span class="comments">;        documentation and/or other materials provided with the distribution.              ;</span>
<span class="comments">;      * Neither the name of Fanning Software Consulting, Inc. nor the names of its        ;</span>
<span class="comments">;        contributors may be used to endorse or promote products derived from this         ;</span>
<span class="comments">;        software without specific prior written permission.                               ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  THIS SOFTWARE IS PROVIDED BY FANNING SOFTWARE CONSULTING, INC. ''AS IS'' AND ANY        ;</span>
<span class="comments">;  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES    ;</span>
<span class="comments">;  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT     ;</span>
<span class="comments">;  SHALL FANNING SOFTWARE CONSULTING, INC. BE LIABLE FOR ANY DIRECT, INDIRECT,             ;</span>
<span class="comments">;  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED    ;</span>
<span class="comments">;  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;         ;</span>
<span class="comments">;  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND             ;</span>
<span class="comments">;  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT              ;</span>
<span class="comments">;  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS           ;</span>
<span class="comments">;  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                            ;</span>
<span class="comments">;******************************************************************************************;</span>

<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::AddAttr                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Adds a variable attribute to the object.                                  </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    varObject -> AddAttr, attrName, attrValue, DATATYPE=datatype              </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    attrName:     A case sensitive name of a variable attribute.              </span>
<span class="comments">;    attrValue:    The value of the variable attribute.                        </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    DATATYPE:    An input keyword that contains the netCDF data type of       </span>
<span class="comments">;                 the variable attribute. If not provided the data type is     </span>
<span class="comments">;                 determined from the attribute value.                           </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
PRO NCDF_Variable::AddAttr, attrName, attrValue, DATATYPE=datatype

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        errorlogger = self.parent -> GetProperty('ErrorLogger')
        errorLogger -> AddError
        RETURN
    ENDIF
    
    <span class="comments">; Check parameters.</span>
    IF N_Elements(attrName) EQ 0 THEN Message, 'The attribute name is required.'
    IF N_Elements(attrValue) EQ 0 THEN Message, 'The attribute value is required.'
   
    <span class="comments">; Set the appropriate netCDF data type keyword.</span>
    IF N_Elements(datatype) EQ 0 THEN datatype = NCDF_CastDataType(attrValue)
    CASE StrUpCase(datatype) OF
        'BYTE': tbyte = 1
        'CHAR': tchar = 1
        'INT': tshort = 1
        'DOUBLE': tdouble = 1
        'FLOAT': tfloat = 1
        'LONG': tlong = 1
        'SHORT': tshort = 1
        'STRING': tstring = 1
        'UBYTE': tubyte = 1
        'UINT64': tuint64 = 1
        'ULONG': tulong = 1
        'UINT':  tushort = 1
        ELSE: Message, 'Unknown DATATYPE for netCDF files: ' + datatype
    ENDCASE
    
    <span class="comments">; The file has to be writable to add an attribute.</span>
    IF ~self.parent -> GetProperty('WRITABLE') THEN $
        Message, 'Cannot add a attribute to a READ-ONLY file.'
    
    <span class="comments">; Put the file into define mode</span>
    self.parent -> SetMode, /DEFINE
    
    <span class="comments">; Check to see if this attribute in _FillValue. If it is,</span>
    <span class="comments">; make sure the data type of the attribute matches the </span>
    <span class="comments">; data type of the variable, or there can be lots of trouble</span>
    <span class="comments">; later on.</span>
    IF (attrName EQ '_FillValue') THEN BEGIN
        IF self.datatype NE datatype THEN BEGIN
            Message, "The _FillValue attribute's datatype (" + $
                datatype + ") does not match the datatype (" + $
                self.datatype + ") of the variable."
        ENDIF
    ENDIF
    
    <span class="comments">; Add the attribute to the file. Some attributes added only after IDL 7.2.</span>
    fileID = self.parent -> GetFileID()
    IF (Float(!Version.Release) GE 8.1) THEN BEGIN
        NCDF_AttPut, fileID, self.ID, attrName, attrValue, $
            BYTE=tbyte, $
            CHAR=tchar, $
            DOUBLE=tdouble, $
            FLOAT=tfloat, $
            LENGTH=length, $
            LONG=tlong, $
            SHORT=tshort, $
            STRING=tstring, $
            UBYTE=tubyte, $
            UINT64=tuint64, $
            ULONG=tulong, $
            USHORT=tushort
    ENDIF ELSE BEGIN
        NCDF_AttPut, fileID, self.ID, attrName, attrValue, $
            BYTE=tbyte, $
            CHAR=tchar, $
            DOUBLE=tdouble, $
            FLOAT=tfloat, $
            LENGTH=length, $
            LONG=tlong, $
            SHORT=tshort
    ENDELSE
        
    <span class="comments">; Add the attribute to this object's attribute list. Use "self" rather</span>
    <span class="comments">; then the variable name to avoid excess trips through ParseFile from the</span>
    <span class="comments">; HASVAR method.</span>
    attrObj = Obj_New('NCDF_Attribute', attrName, self.parent, VARNAME=self)
    self.attrs -> Add, attrObj

END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::GetAttrNames                                                              </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Returns a string array with the names of all the variable's attributes.   </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    attrNames = GetAttrNames(COUNT=attrCount)                                 </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    COUNT:      An output keyword containing the number of attribute names found.           </span>
<span class="comments">;                                                                              </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    attrNames:  A string array with the names of all the variable's attributes.           </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetAttrNames, COUNT=attrCount

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        errorLogger = self.parent -> GetProperty('ErrorLogger')
        errorLogger -> AddError
        RETURN, ""
    ENDIF

    <span class="comments">; Count the number of attribute objects.</span>
    attrCount = self.attrs -> Count()
    
    <span class="comments">; If there are no attributes, return null string.</span>
    IF attrCount EQ 0 THEN RETURN, ""
    
    attrNames = StrArr(attrCount)
    FOR j=0,attrCount-1 DO BEGIN
        thisObj = self.attrs -> Get(POSITION=j)
        attrNames[j] = thisObj -> GetName()
    ENDFOR
    
    <span class="comments">; Return a scalar if necessary.</span>
    IF N_Elements(attrNames) EQ 1 THEN attrNames = attrNames[0]
    
    RETURN, attrNames

END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::GetAttrValue                                                              </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Returns the value of a variable attribute.                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    attrValue = GetAttrValue(attrName, DATATYPE=datatype)                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    attrName:     A case sensitive name of a variable attribute.              </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    DATATYPE:    An ouput keyword that contains the netCDF data type of       </span>
<span class="comments">;                 the variable attribute.                                        </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    attrValue:  The value of the variable's attribute.                        </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetAttrValue, attrName, DATATYPE=datatype

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        errorLogger = self.parent -> GetProperty('ErrorLogger')
        errorLogger -> AddError
        RETURN, ""
    ENDIF
    
    IF N_Elements(attrName) EQ 0 THEN Message, 'An attribute name or object reference is required.'

    <span class="comments">; Were you passed the name of a attribute or an attribute object?</span>
    CASE Size(attrName, /TNAME) OF
    
        'STRING': BEGIN
            attrObj = self.attrs -> FindByName(attrName, COUNT=attrcount, /CASE_SENSITIVE)
            IF attrcount EQ 0 THEN Message, 'Cannot find an attribute object with name ' + attrName + '.'
            IF ~Obj_Valid(attrObj) THEN Message, 'Invalid object with name "' + attrName + '" has been found.'
            END
            
         'OBJREF': BEGIN
            attrObj = attrName
            END
    
        ELSE: Message, 'Input attribute name or object is the wrong data type.'
    ENDCASE

    <span class="comments">; Get the data.</span>
    attrData = attrObj -> GetValue()
    datatype = attrObj -> GetProperty('DATATYPE')
    
    RETURN, attrData
    
END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::GetDimIDs                                                                 </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Returns the dimension IDs of the dimensions associated with this image.   </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    dimIDs = GetDimIDs(COUNT=dimCount)                                        </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    COUNT:     An ouput keyword that contains number of dimension IDs returned.           ;  </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    dimIDs:    A long arry of dimension identifiers.                          </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetDimIDs, COUNT=dimCount

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        errorLogger = self.parent -> GetProperty('ErrorLogger')
        errorLogger -> AddError
        RETURN, ""
    ENDIF
    
    <span class="comments">; Get the dimension IDs.</span>
    IF Ptr_Valid(self.dims) THEN BEGIN
        dimIDs = *self.dims 
        dimCount = self.ndims
    ENDIF ELSE BEGIN
        dimIDs = -1
        dimCount = 0
    ENDELSE
    
    RETURN, dimIDs

END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::GetDimNames                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Returns the dimension names of the dimensions associated with this image. </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    dimNames = GetDimNames(COUNT=dimCount)                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    COUNT:     An ouput keyword that contains number of dimension names returned.          </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    dimNames:    A string array containing the dimension names.               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetDimNames, COUNT=dimCount

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        errorLogger = self.parent -> GetProperty('ErrorLogger')
        errorLogger -> AddError
        RETURN, ""
    ENDIF
    
    <span class="comments">; Get the dimension names.</span>
    IF Ptr_Valid(self.dimNames) THEN BEGIN
        dimNames = *self.dimNames
        dimCount = self.ndims
     ENDIF ELSE BEGIN
        dimNames = ""
        dimCount = 0
    ENDELSE
    
    RETURN, dimNames

END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::GetDimSizes                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Returns the dimension sizes of the dimensions associated with this image. </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    dimSizes = GetDimSizes(COUNT=dimCount)                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    COUNT:     An ouput keyword that contains number of dimension sizes returned.           </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    dimSizes:    A long array of dimension sizes.                             </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetDimSizes, COUNT=dimCount

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        errorLogger = self.parent -> GetProperty('ErrorLogger')
        errorLogger -> AddError
        RETURN, ""
    ENDIF
    
    <span class="comments">; Get the dimension sizes.</span>
    IF Ptr_Valid(self.dimensions) THEN BEGIN
        dimSizes = *self.dimensions
        dimCount = N_Elements(dimSizes)
    ENDIF ELSE BEGIN
        dimSizes = 0
        dimCount = 0
    ENDELSE
    
    RETURN, dimSizes

END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::GetID                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Returns the netCDF variable ID.                                           </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    varID = GetID()                                                           </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                       </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    varID:    A long integer containing the netCDF variable ID.               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetID
    RETURN, self.ID
END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                           </span>
<span class="comments">; NAME:                                                                     </span>
<span class="comments">;    NCDF_Variable::GetInfo                                                                </span>
<span class="comments">;                                                                           </span>
<span class="comments">; Purpose:                                                                  </span>
<span class="comments">;                                                                           </span>
<span class="comments">;    Returns information about the variable from the file.                               </span>
<span class="comments">;                                                                           </span>
<span class="comments">; Method Syntax:                                                            </span>
<span class="comments">;                                                                           </span>
<span class="comments">;    info = obj -> GetInfo()       </span>
<span class="comments">;                                                                           </span>
<span class="comments">; Auguments:                                                                </span>
<span class="comments">;                                                                           </span>
<span class="comments">;    None.   </span>
<span class="comments">;                                                                           </span>
<span class="comments">; Keywords:                                                                 </span>
<span class="comments">;                                                                           </span>
<span class="comments">;    None.</span>
<span class="comments">;         </span>
<span class="comments">; Return Value:                                                             </span>
<span class="comments">;                                                                           </span>
<span class="comments">;    info:       A structure contains the following fields.</span>
<span class="comments">;    </span>
<span class="comments">;                    info = { dims: varObj -> GetDimSizes(), $</span>
<span class="comments">;                             dimNames: varObj -> GetDimNames(), $</span>
<span class="comments">;                             attrNames: varObj -> GetAttrNames(), $</span>
<span class="comments">;                             dataType: varObj -> GetProperty('datatype'), $</span>
<span class="comments">;                             nattrs: varObj -> GetProperty('nattrs'), $</span>
<span class="comments">;                             ndims: varObj -> GetProperty('ndims') }</span>
<span class="comments">;                            </span>
<span class="comments">;                In addition, the structure will contain the fields "scale_factor," "add_offset,"</span>
<span class="comments">;                and "_FillValue" if these attributes are available for the variable.</span>
<span class="comments">;                                                                           </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetInfo

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        errorLogger = self.parent -> GetProperty('ErrorLogger')
        errorLogger -> AddError
        RETURN, ""
    ENDIF
    

    <span class="comments">; Collect and return information about the variable.</span>
    info = { dims: self -> GetDimSizes(), $
             dimNames: self -> GetDimNames(), $
             attrNames: self -> GetAttrNames(), $
             dataType: self -> GetProperty('datatype'), $
             nattrs: self -> GetProperty('nattrs'), $
             ndims: self -> GetProperty('ndims') }
             
    <span class="comments">; Add additional information to the info structure, if it is available.</span>
    <span class="comments">; This will include scale_factor, add_offset, and _FillValue attribute values.</span>
    attrNames = self -> GetAttrNames()
    attrIndex = Where(attrNames EQ 'scale_factor', count)
    IF count GT 0 THEN info = Create_Struct(info, 'scale_factor', $
        self -> GetAttrValue('scale_factor'))
    attrIndex = Where(attrNames EQ 'add_offset', count)
    IF count GT 0 THEN info = Create_Struct(info, 'add_offset', $
        self -> GetAttrValue('add_offset'))
    attrIndex = Where(attrNames EQ 'missing_value', count)
    IF count GT 0 THEN info = Create_Struct(info, '_FillValue', $
        self -> GetAttrValue('missing_value'))
    attrIndex = Where(attrNames EQ '_FillValue', count)
    IF count GT 0 THEN info = Create_Struct(info, '_FillValue', $
        self -> GetAttrValue('_FillValue'))
    
    RETURN, info
    
END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::GetName                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Returns the variable name.                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    varName = GetName()                                                       </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                       </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    varName:    A string variable containing the variable name.               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetName
    RETURN, self.name
END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::GetProperty                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Returns various properties of the object one at a time. This is a shorthand and       </span>
<span class="comments">;    generic way to get the value of an object's "properties", which are defined as        </span>
<span class="comments">;    the IDL variables in the object's class structure.                        </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    propertyValue = obj -> GetProperty(thisProperty)                          </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    thisProperty:   A string variable that is equivalent to a field in the object's       </span>
<span class="comments">;                    class structure. See the *__DEFINE procedure for which properties     </span>
<span class="comments">;                    can be returned. The property is case insensitive.        </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    propertyValue:  The value of a particular object property. Note that pointer          </span>
<span class="comments">;                    properties will return the variable the pointer points to.</span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetProperty, thisProperty

    Catch, theError
    IF theError NE 0 THEN BEGIN
       Catch, /CANCEL

        <span class="comments">; Log the error.</span>
        (self.parent -> GetProperty('ERRORLOGGER')) -> AddError

        <span class="comments">; No success finding the property requested.</span>
        RETURN, 0
    ENDIF
    
    <span class="comments">; Get the self structure as a structure, rather than as an object.</span>
    Call_Procedure, StrLowCase(Obj_Class(self)) + '__define', classStruct

    <span class="comments">; Find the property in this class structure.</span>
    index = Where(StrPos(Tag_Names(classStruct), StrUpCase(thisProperty)) EQ 0, count)
    index = index[0]
    
    <span class="comments">; What happened?</span>
    CASE count OF
        0: Message, 'Property ' + StrUpCase(thisProperty) + ' could not be found.'
        1: propertyValue = self.(index)
        ELSE: Message, 'Ambiguous property. Use more characters to specify it.'
    ENDCASE

    <span class="comments">; If this is a pointer, you want the thing pointed to.</span>
    IF Size(propertyValue, /TNAME) EQ 'POINTER' THEN propertyValue = *propertyValue
    RETURN, propertyValue
    
END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::GetValue                                                                  </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Returns the the value of the variable. That is, the variable's data.      </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    varValue = GetValue(COUNT=count, OFFSET=offset, STRIDE=stride, MISSING=missing)            </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Input Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    COUNT:      An optional vector containing the counts to be used in reading the        </span>
<span class="comments">;                variable. Count is a 1-based vector with an element for each dimension.    </span>
<span class="comments">;                The default matches the size of the variable so that all data is          </span>
<span class="comments">;                written out.                                                    </span>
<span class="comments">;    OFFSET:     An optional vector containing the starting position for the read.         </span>
<span class="comments">;                The default start position is [0, 0, ...].      </span>
<span class="comments">;    STRIDE:     An optional vector containing the strides, or sampling intervals,         </span>
<span class="comments">;                between accessed values of the netCDF variable. The default stride        </span>
<span class="comments">;                vector is that for a contiguous read, [1, 1, ...].              </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Output Keywords:   </span>
<span class="comments">;</span>
<span class="comments">;    ADD_OFFSET:  The add_offset value for the variable, if there is one.</span>
<span class="comments">;</span>
<span class="comments">;    DATATYPE:    The data type of the variable, before the scale and offset are applied.</span>
<span class="comments">;                 The same as what comes back from datatype = Size(rawVariable, /TNAME).</span>
<span class="comments">;</span>
<span class="comments">;    FILLVALUE:   The value that is being used for the "missing" value in this variable.</span>
<span class="comments">;                                                                              </span>
<span class="comments">;    MISSINGINDICES: A vector containing the missing indices in the returned data. Missing</span>
<span class="comments">;                 data is identified by either the depreciated "missing_value" attribute</span>
<span class="comments">;                 or the approved "_FillValue" attribute.  </span>
<span class="comments">;       </span>
<span class="comments">;    SCALE_FACTOR: The scale factor for the variable, if there is one.</span>
<span class="comments">; </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    varValue:    The actual data of the variable. If scale_factor and add_offset          </span>
<span class="comments">;                 attributes are present, the data is scaled and offset before it          </span>
<span class="comments">;                 is returned to the caller. The "missing" data (see the MISSING </span>
<span class="comments">;                 keyword) value is not changed, although its data type might change</span>
<span class="comments">;                 in the scaling and offset process.                                  </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::GetValue, $
    ADD_OFFSET=add_offset, $
    COUNT=count, $
    DATATYPE=datatype, $
    FILLVALUE=missingvalue, $
    OFFSET=offset, $
    SCALE_FACTOR=scale_factor, $
    STRIDE=stride, $
    MISSINGINDICES=missingIndices

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        errorLogger = self.parent -> GetProperty('ErrorLogger')
        errorLogger -> AddError
        RETURN, ""
    ENDIF

    <span class="comments">; Read the data for this variable.</span>
    NCDF_VarGet, self.parent->GetFileID(), self.id, data, COUNT=count, OFFSET=offset, STRIDE=stride
    dataType = Size(data, /TNAME)
    
    <span class="comments">; Does this variable contain "missing" values. If so, identify and return</span>
    <span class="comments">; the missing data indices so they can be identified after scaling.</span>
    missingCount = 0
    IF self -> HasAttr('missing_value') THEN BEGIN
        missingValue = self -> GetAttrValue('missing_value')
        missingIndices = Where(data EQ missingValue, missingCount)
    ENDIF
    IF self -> HasAttr('_FillValue') THEN BEGIN
        missingValue = self -> GetAttrValue('_FillValue')
        missingIndices = Where(data EQ missingValue, missingCount)
    ENDIF
    
    <span class="comments">; If there are scale_factor and add_offset attributes defined for this variable, the</span>
    <span class="comments">; data will be scaled and offset before it is returned. Take care to preserve missing</span>
    <span class="comments">; values in the data. (Data type may change!) </span>
    IF (self -> HasAttr('scale_factor') OR self -> HasAttr('add_offset')) THEN BEGIN
        IF self -> HasAttr('scale_factor') THEN scale_factor = self -> GetAttrValue('scale_factor') ELSE scale_factor = 1B
        IF self -> HasAttr('add_offset') THEN add_offset = self -> GetAttrValue('add_offset') ELSE add_offset = 0B
        data = (data * scale_factor) + add_offset
        IF missingCount GT 0 THEN data[missingIndices] = missingValue
    ENDIF
    
    <span class="comments">; Is this CHAR data? If so, convert it back to a string.</span>
    IF self.datatype EQ 'CHAR' THEN data = String(Temporary(data))
    
    <span class="comments">; Return the data.</span>
    RETURN, data
    
END 


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::HasAttr                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Indicates, by returning a 1, that this particular variable attribute is found in the  ;</span>
<span class="comments">;    file. If not found, this function returns a 0.                                                                      </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    isFound = obj -> HasAttr(attrName, OBJECT=object)                         </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    attrName:     The case sensitive name of a variable attribute.            </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    OBJECT:        If the attribute exists, this keyword returns the attribute's          </span>
<span class="comments">;                   object reference.                                          </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Return Value:                                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    isFound:       If a variable attribute with this name is found, this variable         </span>
<span class="comments">;                   is set to 1. It is set to 0 otherwise.                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION NCDF_Variable::HasAttr, attrName, OBJECT=object

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        errorLogger = self.parent -> GetProperty('ErrorLogger')
        self.errorLogger -> AddError
        RETURN, ""
    ENDIF

    <span class="comments">; Can you find an attribute object with this name?</span>
    object = self.attrs -> FindByName(attrName, COUNT=count)
    
    IF count GT 0 THEN RETURN, 1 ELSE RETURN, 0
    
END


<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">;                                                                              </span>
<span class="comments">; NAME:                                                                         </span>
<span class="comments">;    NCDF_Variable::ParseVariable                                                             </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Purpose:                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    Gathers information about the variable from the netCDF file.              </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Method Syntax:                                                               </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    dimObject -> ParseVariable                                                </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Auguments:                                                                   </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                     </span>
<span class="comments">;                                                                              </span>
<span class="comments">; Keywords:                                                                    </span>
<span class="comments">;                                                                              </span>
<span class="comments">;    None.                                                                       </span>
<span class="comments">;                                                                              </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
PRO NCDF_Variable::ParseVariable

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    On_Error, 2

    <span class="comments">; Gather information about the variable.</span>
    fileID = self.parent -> GetFileID()
    self.id = NCDF_VarID(fileID, self.name)
    varinfo = NCDF_VarInq(fileID, self.id)
    self.datatype = StrUpCase(varinfo.datatype)
    self.ndims = varinfo.ndims
    self.nattrs = varinfo.natts
    self.dims = Ptr_New(varinfo.dim)
    
    <span class="comments">; Get the actual dimensions of the variable.</span>
    IF self.ndims GT 0 THEN BEGIN
        dimensions = LonArr(self.ndims)
        dimNames = StrArr(self.ndims)
        FOR j=0,self.ndims-1 DO BEGIN
            NCDF_DIMINQ, fileID, (*self.dims)[j], dimName, dimSize
            dimensions[j] = dimSize
            dimNames[j] = dimName
        ENDFOR
    ENDIF ELSE BEGIN
        dimensions = 0
        dimNames = ""
    ENDELSE
    self.dimensions = Ptr_New(dimensions)
    self.dimNames = Ptr_New(dimNames)
        
    <span class="comments">; If you have variable attributes, parse these, too.</span>
    self.attrs -> Remove, /ALL
    FOR j=0,self.nattrs-1 DO BEGIN
        attrName = NCDF_AttName(fileID, self.id, j)
        attrObj = Obj_New('NCDF_Attribute', attrName, self.parent, VARNAME=self)
        self.attrs -> Add, attrObj
    ENDFOR
    
    
END    


PRO NCDF_Variable::CLEANUP

    Obj_Destroy, self.attrs
    Ptr_Free, self.dims
    Ptr_Free, self.dimensions
    Ptr_Free, self.dimNames

END



FUNCTION NCDF_Variable::INIT, varName, parent

    <span class="comments">; Compiler options.</span>
    Compile_Opt DEFINT32
    Compile_Opt STRICTARR
    Compile_Opt STRICTARRSUBS
    Compile_Opt LOGICAL_PREDICATE

    <span class="comments">; Error handling. Return 0 if can't finish.</span>
    CATCH, theError
    IF theError NE 0 THEN BEGIN
       CATCH, /CANCEL
       errorLogger = parent -> GetProperty('ERRORLOGGER')
       errorLogger -> AddError
       RETURN, 0
    ENDIF

    <span class="comments">; Check parameters.</span>
    IF N_Elements(varName) EQ 0 THEN Message, 'A variable name is required'
    IF Size(varName, /TNAME) NE 'STRING' THEN Message, 'The variable name must be a string.'
    self.name = varName
    IF N_Elements(parent) EQ 0 THEN Message, 'A parent object is required.'
    IF Size(parent, /TNAME) NE 'OBJREF' THEN Message, 'The parent parameter must be an object reference.'
    self.parent = parent
    self.attrs = Obj_New('NCDF_Container')
    
    <span class="comments">; Obtain information about the variable and fill out the variable object.</span>
    self -> ParseVariable
    
    RETURN, 1
    
END

PRO NCDF_Variable__DEFINE, class
    
    class = { NCDF_VARIABLE, $
              name: "", $                 <span class="comments">; The variable name.</span>
              ID: 0L, $                   <span class="comments">; The variable ID.</span>
              dimensions: Ptr_New(), $    <span class="comments">; The actual dimensions of the variable.</span>
              dimNames: Ptr_New(), $      <span class="comments">; A vector of dimension names.</span>
              dims: Ptr_New(), $          <span class="comments">; The dimension IDs of the dimensions</span>
              nattrs: 0L, $               <span class="comments">; The number of attributes the variable has.</span>
              ndims: 0L, $                <span class="comments">; The number of dimensions the variable has.</span>
              datatype: "",  $            <span class="comments">; The netCDF data byte of this variable.</span>
              parent: Obj_New(), $        <span class="comments">; The NCDF_FILE object where this variable resides.</span>
              attrs: Obj_New() $          <span class="comments">; The variable attributes (objects).</span>
            }
            
END
</code>
    </div>
  </body>
</html>