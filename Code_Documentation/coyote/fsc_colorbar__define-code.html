<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:56:44 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>fsc_colorbar__define.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="fsc_colorbar__define.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       FSC_COLORBAR__DEFINE</span>
<span class="comments">;       Note: The name of the routine has been changed from COLORBAR__DEFINE</span>
<span class="comments">;       on 25 Sept 2010 to avoid conflicts with an IDL 8.0 routine of the</span>
<span class="comments">;       same name. See the article "IDL 8 Name Conflicts" here:</span>
<span class="comments">;       </span>
<span class="comments">;           http://www.idlcoyote.com/ng_tips/idl8_name_conflicts.html</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       The purpose of this routine is to implement a FSC_COLORBAR object</span>
<span class="comments">;       class. The ColorBar is rendered in the direct graphics system.</span>
<span class="comments">;</span>
<span class="comments">; AUTHOR:</span>
<span class="comments">;       FANNING SOFTWARE CONSULTING</span>
<span class="comments">;       David Fanning, Ph.D.</span>
<span class="comments">;       1645 Sheely Drive</span>
<span class="comments">;       Fort Collins, CO 80526 USA</span>
<span class="comments">;       Phone: 970-221-0438</span>
<span class="comments">;       E-mail: david@idlcoyote.com</span>
<span class="comments">;       Coyote's Guide to IDL Programming: http://www.idlcoyote.com</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;       Graphics.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       colorbar = Obj_New("FSC_COLORBAR")</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       All inputs to the program are via keyword parameters.</span>
<span class="comments">;</span>
<span class="comments">; KEYWORD PARAMETERS:</span>
<span class="comments">;</span>
<span class="comments">;   Background: Background color. This is the color with which the colorbar is</span>
<span class="comments">;               erased. The default color is !P.Background.</span>
<span class="comments">;   Bottom: Bottom color index of colors allocated to colorbar.</span>
<span class="comments">;   Charsize: Character size of annotation. Default is 1.0.</span>
<span class="comments">;   Color: Color of annotation and outline. Default is !P.Color.</span>
<span class="comments">;   Font: Font to use for annotation. Default is -1, Hershey fonts.</span>
<span class="comments">;   Format: Format of annotation. Default is "(F8.2)".</span>
<span class="comments">;   Major: The number of major tick intervals. Default is 5.</span>
<span class="comments">;   Minor: The number of minor tick intervals. Default is 2.</span>
<span class="comments">;   MinusOne: Set this keyword to choose MinusOne keyword on the Congrid command</span>
<span class="comments">;               that resizes the colorbar into the window.</span>
<span class="comments">;   NColors: The number of colors allocated to colorbar. Default is (256 &lt;</span>
<span class="comments">;            !D.N_Colors).</span>
<span class="comments">;   Neighbor: Set to indicate Nearest Neighbor sampling for Congrid. Default is</span>
<span class="comments">;             0 (Bilinear).</span>
<span class="comments">;   Position: The position of colorbar in normalized coordinates. Default for a</span>
<span class="comments">;             horizontal colorbar is [0.15, 0.88, 0.85, 0.95]. Default for a</span>
<span class="comments">;             vertical colorbar is [0.88, 0.15, 0.95, 0.85]. These defaults are</span>
<span class="comments">;             designed for a 400 by 400 window.</span>
<span class="comments">;   Range: The data range on colorbar. Default is [0, 255].</span>
<span class="comments">;   TickLen: The length of tick marks. Default is -0.1</span>
<span class="comments">;   TickV:   Locations for the tick marks in data units. This is the same as</span>
<span class="comments">;            the [XY]TickV keyword. Default is to do what IDL would do</span>
<span class="comments">;            normally.</span>
<span class="comments">;   Vertical: Set this keyword if you want a vertical colorbar. Default is</span>
<span class="comments">;             horizontal.</span>
<span class="comments">;   XEraseBox: A five-element vector of X points (normalized) for erasing the</span>
<span class="comments">;              colorbar plot. Normally this keyword will not have to be used.</span>
<span class="comments">;              The program uses the plot REGION for erasing. But larger</span>
<span class="comments">;              character sizes can result in annotation going outside the</span>
<span class="comments">;              region enclosed by the plot. If that is the case, then use this</span>
<span class="comments">;              keyword along with YEraseBox to specify a larger-than-normal</span>
<span class="comments">;              erasure area. The points are sent to the POLYFILL command for</span>
<span class="comments">;              erasing.</span>
<span class="comments">;</span>
<span class="comments">;                 POLYFILL, xEraseBox, yEraseBox, /Normal, Color=background</span>
<span class="comments">;</span>
<span class="comments">;   YEraseBox: A five-element vector of Y points (normalized) for erasing the</span>
<span class="comments">;              colorbar plot.</span>
<span class="comments">;</span>
<span class="comments">; OBJECT METHODS:</span>
<span class="comments">;</span>
<span class="comments">;   Clamp: This procedure method allows the color bar range to be "clamped"</span>
<span class="comments">;          to a particular data range.</span>
<span class="comments">;</span>
<span class="comments">;   Draw: This procedure method draws the colorbar in the display window. The</span>
<span class="comments">;         ERASE keyword to this method will erase the current colorbar (by</span>
<span class="comments">;         calling the ERASE method) before drawing the colorbar in the display</span>
<span class="comments">;         window.</span>
<span class="comments">;</span>
<span class="comments">;               colorbar->Draw</span>
<span class="comments">;</span>
<span class="comments">;   Erase: This procedure method erases the colorbar object in the window. It</span>
<span class="comments">;          accomplishes this by performing a POLYFILL in the background color.</span>
<span class="comments">;          This method is primarily useful for interactive graphics display</span>
<span class="comments">;          devices.</span>
<span class="comments">;               colorbar->Erase</span>
<span class="comments">;</span>
<span class="comments">;   GetProperty: This procedure method allows one to obtain the current state</span>
<span class="comments">;                of the object via the keyword parameters listed above.</span>
<span class="comments">;</span>
<span class="comments">;               colorbar->GetProperty, Range=currentRange, Title=currentTitle</span>
<span class="comments">;               Print, currentRange, currentTitle</span>
<span class="comments">;</span>
<span class="comments">;   SetProperty: This procedure method allows one to set the properties of the</span>
<span class="comments">;                colorbar object via the keywords described above. In addition,</span>
<span class="comments">;                a DRAW and ERASE keyword are provided so that the colorbar can</span>
<span class="comments">;                be immediately drawn when the new property is set.</span>
<span class="comments">;</span>
<span class="comments">;               colorbar->SetProperty, Range=[500, 15000], /Erase, /Draw</span>
<span class="comments">;</span>
<span class="comments">; COMMON BLOCKS:</span>
<span class="comments">;       None.</span>
<span class="comments">;</span>
<span class="comments">; SIDE EFFECTS:</span>
<span class="comments">;       The display window is not erased first.</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;       None.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       To create a colorbar, use it, then destroy it, type:</span>
<span class="comments">;</span>
<span class="comments">;       colorbar = Obj_New("FSC_COLORBAR", Title='Colorbar Values', Range=[0,1000],$</span>
<span class="comments">;                  Format='(I4)')</span>
<span class="comments">;       Window</span>
<span class="comments">;       LoadCT, 5</span>
<span class="comments">;       colorbar->Draw</span>
<span class="comments">;       colorbar->SetProperty, Range=[0,500], /Erase, /Draw</span>
<span class="comments">;       Obj_Destroy, colorbar</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       Written by: David Fanning, Fanning Software Consulting,</span>
<span class="comments">;                   26 November 1998.</span>
<span class="comments">;       Added Horizontal keyword to SetProperty method and fixed problem in</span>
<span class="comments">;       going from Vertical to Horizontal color bars. 29 Nov 1998. DWF.</span>
<span class="comments">;       Added LoadCT method and current color table index to object.</span>
<span class="comments">;             6 December 1998.</span>
<span class="comments">;       Fixed a bug dealing with nearest neighbor resampling. 30 Mar 1999. DWF.</span>
<span class="comments">;       Fixed a bug with how NCOLORS and BOTTOM keywords interacted.</span>
<span class="comments">;             29 Aug 1999. DWF.</span>
<span class="comments">;       10 Oct 99. Modified the program so that current plot and map coordinates</span>
<span class="comments">;                are saved and restored after the colorbar is drawn. DWF.</span>
<span class="comments">;       26 May 2000 Added {XY}TICKV capability to the draw method. This</span>
<span class="comments">;                required adding TickV to the object data structure, and to the</span>
<span class="comments">;                INIT, GetProperty and SetProperty methods.</span>
<span class="comments">;                Changed default tick length to -0.1. DWF (and Jack Saba)</span>
<span class="comments">;       18 Nov 2001. Added Clamp method. DWF.</span>
<span class="comments">;       25 September 2010. Renamed to FSC_Colorbar__Define to avoid conflict with a</span>
<span class="comments">;                Colorbar__Define program introduced with IDL 8.0. DWF.</span>
<span class="comments">;-</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;  Copyright (c) 2008, by Fanning Software Consulting, Inc.                                ;</span>
<span class="comments">;  All rights reserved.                                                                    ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Redistribution and use in source and binary forms, with or without                      ;</span>
<span class="comments">;  modification, are permitted provided that the following conditions are met:             ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;      * Redistributions of source code must retain the above copyright                    ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer.                     ;</span>
<span class="comments">;      * Redistributions in binary form must reproduce the above copyright                 ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer in the               ;</span>
<span class="comments">;        documentation and/or other materials provided with the distribution.              ;</span>
<span class="comments">;      * Neither the name of Fanning Software Consulting, Inc. nor the names of its        ;</span>
<span class="comments">;        contributors may be used to endorse or promote products derived from this         ;</span>
<span class="comments">;        software without specific prior written permission.                               ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  THIS SOFTWARE IS PROVIDED BY FANNING SOFTWARE CONSULTING, INC. ''AS IS'' AND ANY        ;</span>
<span class="comments">;  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES    ;</span>
<span class="comments">;  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT     ;</span>
<span class="comments">;  SHALL FANNING SOFTWARE CONSULTING, INC. BE LIABLE FOR ANY DIRECT, INDIRECT,             ;</span>
<span class="comments">;  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED    ;</span>
<span class="comments">;  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;         ;</span>
<span class="comments">;  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND             ;</span>
<span class="comments">;  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT              ;</span>
<span class="comments">;  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS           ;</span>
<span class="comments">;  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                            ;</span>
<span class="comments">;******************************************************************************************;</span>
PRO FSC_Colorbar::Clamp, datarange, Draw=draw

<span class="comments">; This method clamps the data to a particular data range.</span>

self->GetProperty, Range=currentRange

thisclamp = Bytscl(datarange, Max=currentRange[1], Min=currentRange[0])
lowval = thisclamp[0]
highval = thisclamp[1]
IF self.vertical THEN bar = BytScl(REPLICATE(1B,10) # BINDGEN(self.ncolors), Min=lowval, Max=highval) ELSE $
   bar = BytScl(BIndgen(self.ncolors) # Replicate(1B, 20), Min=lowval, Max=highval)
*self.bar = bar
IF Keyword_Set(draw) THEN self->Draw, /Erase
END
<span class="comments">;-------------------------------------------------------------------------</span>


PRO FSC_Colorbar::GetProperty, $

<span class="comments">; The GetProperty method of the FSC_COLORBAR object class. All properties are</span>
<span class="comments">; obtained via the following keywords:</span>

   Background=background, $ <span class="comments">; Background color. Default is !P.Background.</span>
   Bottom=bottom, $         <span class="comments">; Bottom color index of colors allocated to</span>
                            <span class="comments">; colorbar.</span>
   Charsize=charsize, $     <span class="comments">; Character size of annotation. Default is 1.0.</span>
   Color=color, $           <span class="comments">; Color of annotation and outline. Default is</span>
                            <span class="comments">; !P.Color</span>
   Font=font, $             <span class="comments">; Font to use for annotation. Default is -1,</span>
                            <span class="comments">; Hershey fonts.</span>
   Format=format, $         <span class="comments">; Format of annotation. Default is F8.2.</span>
   Index=index, $           <span class="comments">; The color table index. Default is to use none.</span>
   Major=major, $           <span class="comments">; The number of major tick intervals. Default is 5.</span>
   Minor=minor, $           <span class="comments">; The number of minor tick intervals. Default is 2.</span>
   MinusOne=minusone, $     <span class="comments">; Set this keyword to choose MinusOne keyword on</span>
                            <span class="comments">; Congrid command.</span>
   NColors=ncolors, $       <span class="comments">; The number of colors allocated to colorbar.</span>
                            <span class="comments">; Default is (256 &lt; !D.N_Colors).</span>
   Neighbor=neighbor, $     <span class="comments">; Set to indicate Nearest Neighbor sampling for</span>
                            <span class="comments">; Congrid. Default is 0 (Bilinear).</span>
   Position=position, $     <span class="comments">; The position of colorbar in normalized</span>
                            <span class="comments">; coordinates.</span>
   Range=range, $           <span class="comments">; The data range on colorbar. Default is [0, 255].</span>
   TickLen=ticklen, $       <span class="comments">; The length of tick marks. Default is -0.1.</span>
   TickV=tickv, $           <span class="comments">; Locations for tick marks in color index units.</span>
   Title=title, $           <span class="comments">; The title of the color bar. Default is a null</span>
                            <span class="comments">; string.</span>
   Vertical=vertical, $     <span class="comments">; Set this keyword if you want a vertical colorbar.</span>
                            <span class="comments">; Default is horizontal.</span>
   XEraseBox=xerasebox, $   <span class="comments">; A five-element vector of X points (normalized)</span>
                            <span class="comments">; for erasing the colorbar plot.</span>
   YEraseBox=yerasebox      <span class="comments">; A five-element vector of Y points (normalized)</span>
                            <span class="comments">; for erasing the colorbar plot.</span>

   <span class="comments">; Error handling.</span>

Catch, error
IF error NE 0 THEN BEGIN
   Catch, Cancel=1
   ok = Dialog_Message('Error in GETPROPERTY method. Returning...')
   Print, ''
   Print, 'FSC_Colorbar::GetProperty Method: ' + !Error_State.Msg
   RETURN
ENDIF

   <span class="comments">; Return value of self object.</span>

bottom = self.bottom
charsize = self.charsize
color = self.color
background = self.background
font = self.font
format = self.format
index = self.index
range = self.range
major = self.major
minor = self.minor
minusone = self.minusone
ncolors = self.ncolors
IF self.neighbor EQ 0 THEN neighbor = 1 ELSE neighbor = 0
position = self.position
title = self.title
ticklen = self.ticklen
tickv   = *(self.tickv)
vertical = self.vertical
xerasebox = self.xerasebox
yerasebox = self.yerasebox

END
<span class="comments">;-----------------------------------------------------------------</span>



PRO FSC_Colorbar::SetProperty, $

<span class="comments">; The SetProperty method of the FSC_COLORBAR object class. All properties are</span>
<span class="comments">; set via the following keywords:</span>

   Background=background, $ <span class="comments">; Background color. Default is !P.Background.</span>
   Bottom=bottom, $         <span class="comments">; Bottom color index of colors allocated to</span>
                            <span class="comments">; colorbar.</span>
   Charsize=charsize, $     <span class="comments">; Character size of annotation. Default is 1.0.</span>
   Color=color, $           <span class="comments">; Color of annotation and outline. Default is</span>
                            <span class="comments">; !P.Color</span>
   Draw=draw, $             <span class="comments">; Set this keyword to call DRAW method after</span>
                            <span class="comments">; setting property.</span>
   Erase=erase, $           <span class="comments">; Set this keyword to set ERASE keyword on DRAW</span>
                            <span class="comments">; method call.</span>
   Font=font, $             <span class="comments">; Font to use for annotation. Default is -1,</span>
                            <span class="comments">; Hershey fonts.</span>
   Format=format, $         <span class="comments">; Format of annotation. Default is F8.2.</span>
   Horizontal=horizontal, $ <span class="comments">; Set this keyword to go from a vertical colorbar</span>
                            <span class="comments">; to horizontal.</span>
   Index=index, $           <span class="comments">; The color table index. Default is 0.</span>
   Major=major, $           <span class="comments">; The number of major tick intervals. Default is 5.</span>
   Minor=minor, $           <span class="comments">; The number of minor tick intervals. Default is 2.</span>
   MinusOne=minusone, $     <span class="comments">; Set this keyword to choose MinusOne keyword on</span>
                            <span class="comments">; Congrid command.</span>
   NColors=ncolors, $       <span class="comments">; The number of colors allocated to colorbar.</span>
                            <span class="comments">; Default is (256 &lt; !D.N_Colors).</span>
   Neighbor=neighbor, $     <span class="comments">; Set to indicate Nearest Neighbor sampling for</span>
                            <span class="comments">; Congrid. Default is 0 (Bilinear).</span>
   Position=position, $     <span class="comments">; The position of colorbar in normalized</span>
                            <span class="comments">; coordinates.</span>
   Range=range, $           <span class="comments">; The data range on colorbar. Default is [0, 255].</span>
   TickLen=ticklen, $       <span class="comments">; The length of tick marks. Default is -0.1.</span>
   TickV=tickv, $           <span class="comments">; Locations for tick marks in color index units.</span>
   Title=title, $           <span class="comments">; The title of the color bar. Default is a null</span>
                            <span class="comments">; string.</span>
   Vertical=vertical, $     <span class="comments">; Set this keyword if you want a vertical colorbar.</span>
                            <span class="comments">; Default is horizontal.</span>
   XEraseBox=xerasebox, $   <span class="comments">; A five-element vector of X points (normalized)</span>
                            <span class="comments">; for erasing the colorbar plot.</span>
   YEraseBox=yerasebox      <span class="comments">; A five-element vector of Y points (normalized)</span>
                            <span class="comments">; for erasing the colorbar plot.</span>

   <span class="comments">; Error handling.</span>

Catch, error
IF error NE 0 THEN BEGIN
   Catch, Cancel=1
   ok = Dialog_Message('Error in SETPROPERTY method. Returning...')
   Print, ''
   Print, 'FSC_Colorbar::SetProperty Method: ' + !Error_State.Msg
   RETURN
ENDIF

   <span class="comments">; Set property if requested.</span>

IF N_Elements(bottom) NE 0 THEN  self.bottom = bottom
IF N_Elements(charsize) NE 0 THEN  self.charsize = charsize
IF N_Elements(color) NE 0 THEN  self.color = color
IF N_Elements(background) NE 0 THEN  self.background = background
IF N_Elements(font) NE 0 THEN  self.font = font
IF N_Elements(format) NE 0 THEN  self.format = format
IF N_Elements(range) NE 0 THEN  self.range = range
IF N_Elements(major) NE 0 THEN  self.major = major
IF N_Elements(minor) NE 0 THEN  self.minor = minor
IF N_Elements(minusone) NE 0 THEN  self.minusone = minusone
IF N_Elements(ncolors) NE 0 THEN  self.ncolors = ncolors
IF N_Elements(index) NE 0 THEN  BEGIN
   self.index = index
   LoadCT, index, NColors=self.ncolors, Bottom=self.bottom
ENDIF
IF N_Elements(neighbor) NE 0 THEN  BEGIN
   self.neighbor = neighbor
   IF self.neighbor EQ 0 THEN self.neighbor = 1 ELSE self.neighbor = 0
ENDIF
IF N_Elements(position) NE 0 THEN  self.position = position
IF N_Elements(ticklen) NE 0 THEN  self.ticklen = ticklen
IF N_Elements(tickv) NE 0 THEN  *(self.tickv) = tickv
IF N_Elements(title) NE 0 THEN  self.title = title
IF N_Elements(xerasebox) NE 0 THEN  self.xerasebox = xerasebox
IF N_Elements(yerasebox) NE 0 THEN  self.yerasebox = yerasebox
IF Keyword_Set(vertical) THEN BEGIN
   *self.bar = Replicate(1B, 20) # BIndgen(self.ncolors)
   IF N_Elements(position) EQ 0 THEN self.position = [0.88, 0.15, 0.95, 0.85]
  self.vertical = 1
ENDIF
IF Keyword_Set(horizontal) THEN BEGIN
   *self.bar =  BIndgen(self.ncolors) # Replicate(1B, 20)
   IF N_Elements(position) EQ 0 THEN self.position = [0.15, 0.88, 0.85, 0.95]
   self.vertical = 0
ENDIF

   <span class="comments">; Scale the color bar.</span>

*self.bar = BytScl(*self.bar, Top=self.ncolors-1) + self.bottom

   <span class="comments">; Draw the bar?</span>

IF Keyword_Set(draw) THEN self->Draw, Erase=Keyword_Set(erase)
END
<span class="comments">;-----------------------------------------------------------------</span>



PRO FSC_Colorbar::LoadCT, index, Draw=draw, Erase=erase

<span class="comments">; The LoadCT method of the FSC_COLORBAR object class.</span>

   <span class="comments">; Error handling.</span>

Catch, error
<span class="comments">;error=0</span>
IF error NE 0 THEN BEGIN
   Catch, Cancel=1
   ok = Dialog_Message('Error in LoadCT method. Returning...')
   Print, ''
   Print, 'FSC_Colorbar::LoadCT Method: ' + !Error_State.Msg
   RETURN
ENDIF

IF N_Elements(index) EQ 0 THEN index = 0

LoadCT, index, NColors=self.ncolors, Bottom=self.bottom, /Silent
self.index = index

IF Keyword_Set(draw) THEN self->Draw, Erase=Keyword_Set(erase)
END
<span class="comments">;-----------------------------------------------------------------</span>




PRO FSC_Colorbar::Erase

<span class="comments">; The Erase method of the FSC_COLORBAR object class.</span>

   <span class="comments">; Error handling.</span>

Catch, error
IF error NE 0 THEN BEGIN
   Catch, Cancel=1
   ok = Dialog_Message('Error in ERASE method. Returning...')
   Print, ''
   Print, 'FSC_Colorbar::Erase Method: ' + !Error_State.Msg
   RETURN
ENDIF

   <span class="comments">; Valid erase boxes?</span>

IF Total(self.xerasebox) EQ 0 OR Total(self.yerasebox) EQ 0 THEN BEGIN
   ok = Dialog_Message('No colorbar exists to erase. Returning...')
   RETURN
ENDIF

PolyFill, self.xerasebox, self.yerasebox, /Normal, Color=self.background

END
<span class="comments">;-----------------------------------------------------------------</span>




PRO FSC_Colorbar::Draw, Erase=erase

<span class="comments">; The Draw method of the FSC_COLORBAR object class.</span>

   <span class="comments">; Error handling.</span>

Catch, error
IF error NE 0 THEN BEGIN
   Catch, Cancel=1
   ok = Dialog_Message('Error in DRAW method. Returning...')
   Print, ''
   Print, 'FSC_Colorbar::Draw Method: ' + !Error_State.Msg
   RETURN
ENDIF

   <span class="comments">; Save the current plot state.</span>

bang_p = !P
bang_x = !X
bang_Y = !Y
bang_Z = !Z
bang_Map = !Map

   <span class="comments">; Must turn off decomposed color on devices that support it.</span>

CASE !D.Name OF
   'MAC': Device, Decomposed=0
   'WIN': Device, Decomposed=0
   'X':   Device, Decomposed=0
   ELSE:
ENDCASE

   <span class="comments">; Get starting locations.</span>

xstart = self.position(0)
ystart = self.position(1)

   <span class="comments">; Get the size of the bar.</span>

xsize = (self.position[2] - self.position[0])
ysize = (self.position[3] - self.position[1])

   <span class="comments">; Need to erase the display first?</span>

IF Keyword_Set(erase) THEN self->Erase

   <span class="comments">; Display the color bar in the window. Sizing is different for</span>
   <span class="comments">; devices with scalable pixels.</span>

scalablePixels = (!D.Flags AND 1) NE 0

IF scalablePixels THEN BEGIN

   TV, *self.bar, xstart, ystart, XSIZE=xsize, YSIZE=ysize, /Normal

ENDIF ELSE BEGIN

   bar = CONGRID(*self.bar, Ceil(xsize*!D.X_VSize), Ceil(ysize*!D.Y_VSize), $
       Interp=self.neighbor, Minus_One=self.minusone)
   TV, bar, xstart, ystart, /Normal

ENDELSE

   <span class="comments">; Annotate the color bar.</span>

IF self.vertical THEN BEGIN

   Plot, [self.range[0], self.range[1]], [self.range[0], self.range[1]], $
      /NoData, XTicks=1, YTitle=self.title, Font=self.font, YMinor=self.minor, $
      Position=self.position, YTicks=self.major, XStyle=1, YStyle=1, $
      Color=self.color, YCharsize=self.charsize, /NoErase, $
      YTickformat=self.format, XTickformat='(A1)', YTicklen=self.ticklen, $
      YRange=self.range, YTickV=*(self.tickv)

ENDIF ELSE BEGIN

   Plot, [self.range[0], self.range[1]], [self.range[0], self.range[1]], $
      /NoData, XTicks=self.major, Font=self.font, XMinor=self.minor, $
      Position=self.position, YTicks=1, XStyle=1, YStyle=1, XTitle=self.title, $
      Color=self.color, XCharsize=self.charsize, /NoErase, YTickformat='(A1)', $
      XTickformat=self.format, XTicklen=self.ticklen, XRange=self.range, $
      XTickV=*(self.tickv)

ENDELSE

   <span class="comments">; Update the erase boxes.</span>

self.xerasebox = [ !X.Region[0], !X.Region[0], !X.Region[1], !X.Region[1], $
                   !X.Region[0] ]
self.yerasebox = [ !Y.Region[0], !Y.Region[1], !Y.Region[1], !Y.Region[0], $
                   !Y.Region[0] ]

   <span class="comments">; Restore the previous plot and map system variables.</span>

!P = bang_p
!X = bang_x
!Y = bang_y
!Z = bang_z
!Map = bang_map

END
<span class="comments">;-----------------------------------------------------------------</span>



PRO FSC_Colorbar::CleanUp

<span class="comments">; The CleanUp method of the FSC_COLORBAR object class.</span>

Ptr_Free, self.bar
Ptr_Free, self.tickv
END
<span class="comments">;-----------------------------------------------------------------</span>



FUNCTION FSC_Colorbar::Init, $

<span class="comments">; The INIT method of the FSC_COLORBAR object class.</span>

   Background=background, $ <span class="comments">; Background color. Default is !P.Background.</span>
   Bottom=bottom, $         <span class="comments">; Bottom color index of colors allocated to</span>
                            <span class="comments">; colorbar.</span>
   Charsize=charsize, $     <span class="comments">; Character size of annotation. Default is 1.0.</span>
   Color=color, $           <span class="comments">; Color of annotation and outline. Default is</span>
                            <span class="comments">; !P.Color</span>
   Font=font, $             <span class="comments">; Font to use for annotation. Default is -1,</span>
                            <span class="comments">; Hershey fonts.</span>
   Format=format, $         <span class="comments">; Format of annotation. Default is F8.2.</span>
   Index=index, $           <span class="comments">; The color table index. Default is to use whatever</span>
                            <span class="comments">; is loaded.</span>
   Major=major, $           <span class="comments">; The number of major tick intervals. Default is 5.</span>
   Minor=minor, $           <span class="comments">; The number of minor tick intervals. Default is 2.</span>
   MinusOne=minusone, $     <span class="comments">; Set this keyword to choose MinusOne keyword on</span>
                            <span class="comments">; Congrid command.</span>
   NColors=ncolors, $       <span class="comments">; The number of colors allocated to colorbar.</span>
                            <span class="comments">; Default is (256 &lt; !D.N_Colors).</span>
   Neighbor=neighbor, $     <span class="comments">; Set to indicate Nearest Neighbor sampling for</span>
                            <span class="comments">; Congrid. Default is 0 (Bilinear).</span>
   Position=position, $     <span class="comments">; The position of colorbar in normalized</span>
                            <span class="comments">; coordinates.</span>
   Range=range, $           <span class="comments">; The data range on colorbar. Default is [0, 255].</span>
   TickLen=ticklen, $       <span class="comments">; The length of tick marks. Default is -0.1.</span>
   TickV=tickv, $           <span class="comments">; Locations for tick marks in color index units.</span>
   Title=title, $           <span class="comments">; The title of the color bar. Default is a null</span>
                            <span class="comments">; string.</span>
   Vertical=vertical, $     <span class="comments">; Set this keyword if you want a vertical colorbar.</span>
                            <span class="comments">; Default is horizontal.</span>
   XEraseBox=xerasebox, $   <span class="comments">; A five-element vector of X points (normalized)</span>
                            <span class="comments">; for erasing the colorbar plot.</span>
   YEraseBox=yerasebox      <span class="comments">; A five-element vector of Y points (normalized)</span>
                            <span class="comments">; for erasing the colorbar plot.</span>

   <span class="comments">; Error handling.</span>

Catch, error
IF error NE 0 THEN BEGIN
   Catch, Cancel=1
   ok = Dialog_Message('Error in INIT method. Returning...')
   Print, ''
   Print, 'FSC_Colorbar::INIT Method: ' + !Error_State.Msg
   RETURN, 0
ENDIF

   <span class="comments">; Check keywords. Define default values if unsupplied.</span>

IF N_Elements(bottom) EQ 0 THEN bottom = 0
IF N_Elements(ncolors) EQ 0 THEN ncolors = (256-bottom) &lt<span class="comments">; (!D.N_Colors - bottom)</span>
IF N_Elements(charsize) EQ 0 THEN charsize = 1.0
IF N_Elements(font) EQ 0 THEN font = -1
IF N_Elements(format) EQ 0 THEN format = '(F8.2)'
IF N_Elements(color) EQ 0 THEN color = !P.Color
IF N_Elements(index) EQ 0 THEN index = -1
IF index GE 0 THEN LoadCT, index, NColors=ncolors, Bottom=bottom, /Silent
IF N_Elements(background) EQ 0 THEN background = !P.Background
IF N_Elements(range) EQ 0 THEN range = [0, 255]
IF N_Elements(major) EQ 0 THEN major = 5
IF N_Elements(minor) EQ 0 THEN minor = 2
IF N_Elements(ticklen) EQ 0 THEN ticklen = -0.1
IF N_Elements(tickv) EQ 0 THEN tickv = 0
IF N_Elements(title) EQ 0 THEN title = ''
IF N_Elements(xerasebox) EQ 0 THEN xerasebox = FltArr(5)
IF N_Elements(yerasebox) EQ 0 THEN yerasebox = FltArr(5)
vertical = Keyword_Set(vertical)
neighbor = Keyword_Set(neighbor)
IF neighbor EQ 0 THEN neighbor = 1 ELSE neighbor = 0
minusone = Keyword_Set(minusone)

   <span class="comments">; Create the colorbar image and default positions.</span>

IF vertical THEN BEGIN
   bar = Replicate(1B, 20) # BIndgen(ncolors)
   IF N_Elements(position) EQ 0 THEN position = [0.88, 0.15, 0.95, 0.85]
ENDIF ELSE BEGIN
   bar = BIndgen(ncolors) # Replicate(1B, 20)
   IF N_Elements(position) EQ 0 THEN position = [0.15, 0.88, 0.85, 0.95]
ENDELSE

   <span class="comments">; Scale the color bar.</span>

bar = BytScl(bar, Top=ncolors-1) + bottom

   <span class="comments">; Fill out this particular instance of the FSC_COLORBAR object.</span>

self.bar = Ptr_New(bar)
self.position = Float(position)
self.vertical = vertical
self.bottom = bottom
self.ncolors = ncolors
self.font = font
self.format = format
self.index = index
self.range = range
self.title = title
self.ticklen = ticklen
self.tickv = Ptr_New(tickv)
self.neighbor = neighbor
self.major = major
self.minor = minor
self.minusone = minusone
self.charsize = charsize
self.color = color
self.background = background
self.xerasebox = xerasebox
self.yerasebox = yerasebox

RETURN, 1
END
<span class="comments">;-----------------------------------------------------------------</span>



PRO FSC_Colorbar__Define

<span class="comments">; Structure definition of the FSC_COLORBAR object class.</span>

struct = { FSC_COLORBAR, $ <span class="comments">; The FSC_COLORBAR object class definition.</span>
   bar:Ptr_New(), $        <span class="comments">; The colorbar image.</span>
   position:FltArr(4), $   <span class="comments">; Position in the window (normalized coords).</span>
   vertical:0, $           <span class="comments">; Flag for vertical colorbar. Default is 0.</span>
   bottom:0, $             <span class="comments">; The bottom color index. Default is 0.</span>
   ncolors:0, $            <span class="comments">; The number of colors in the colorbar. Default is</span>
                           <span class="comments">;  (256 &lt; !D.N_Colors).</span>
   major:0, $              <span class="comments">; The number of major tick intervals. (Same as</span>
                           <span class="comments">;  XTICKS.) Default is 5.</span>
   minor:0, $              <span class="comments">; The number of minor tick intervals. Default is 2.</span>
   font:0, $               <span class="comments">; The font to use. Default is -1, Hershey fonts.</span>
   format:'', $            <span class="comments">; The format of the annotations. Default is F8.2.</span>
   index:0, $              <span class="comments">; The current color table index.</span>
   range:FltArr(2), $      <span class="comments">; The colorbar data range. Default is [0,255].</span>
   title:'', $             <span class="comments">; The title of the colorbar. Default is null string.</span>
   ticklen:0.0, $          <span class="comments">; The length of tick marks. Default is -0.1.</span>
   tickv: Ptr_New(), $     <span class="comments">; Values for the tick marks.</span>
   neighbor:0, $           <span class="comments">; A flag to indicate nearest neighbor sampling.</span>
                           <span class="comments">;  Default is 0 (bilinear).</span>
   minusone:0, $           <span class="comments">; A flag to indicate MinusOne keyword set on</span>
                           <span class="comments">;  Congrid. Default is 0.</span>
   charsize:0.0, $         <span class="comments">; The character size of the annotation. Default is</span>
                           <span class="comments">;  1.0.</span>
   color:0, $              <span class="comments">; The color of annotation and colorbar outline.</span>
                           <span class="comments">;  Default is !P.Color.</span>
   background:0, $         <span class="comments">; The background or "erase" color. Default is</span>
                           <span class="comments">;  !P.Background.</span>
   xerasebox:FltArr(5), $  <span class="comments">; A vector of X points for erasing.</span>
   yerasebox:FltArr(5) $   <span class="comments">; A vector of Y points for erasing.</span>
   }

END
<span class="comments">;--------------------------------------------------------------------------</span>
</code>
    </div>
  </body>
</html>