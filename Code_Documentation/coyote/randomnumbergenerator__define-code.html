<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:10 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>randomnumbergenerator__define.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="randomnumbergenerator__define.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       RANDOMNUMBERGENERATOR</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;</span>
<span class="comments">;       Allows the user to obtain a sequence of pseudo-random numbers. The</span>
<span class="comments">;       object maintains the random number generator seed in such a way that</span>
<span class="comments">;       subsequent calls to GetRandomNumbers will guarentee that you don't </span>
<span class="comments">;       get the same random numbers each time you ask for random numbers.</span>
<span class="comments">;</span>
<span class="comments">; AUTHOR:</span>
<span class="comments">;</span>
<span class="comments">;       FANNING SOFTWARE CONSULTING</span>
<span class="comments">;       David Fanning, Ph.D.</span>
<span class="comments">;       1645 Sheely Drive</span>
<span class="comments">;       Fort Collins, CO 80526 USA</span>
<span class="comments">;       Phone: 970-221-0438</span>
<span class="comments">;       E-mail: david@idlcoyote.com</span>
<span class="comments">;       Coyote's Guide to IDL Programming: http://www.idlcoyote.com</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>

<span class="comments">;       Utilities</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">; </span>
<span class="comments">;       Generate three random numbers.</span>
<span class="comments">;</span>
<span class="comments">;       IDL> rng = Obj_New('RandomNumberGenerator', initialSeed)</span>
<span class="comments">;       IDL> numberOfNumbersNeeded = 3</span>
<span class="comments">;       IDL> randomNumbers = rng -> GetRandomNumbers(numberOfNumbersNeeded)</span>
<span class="comments">;       IDL> Print, randomNumbers</span>
<span class="comments">;             0.80952855      0.35878432      0.52150406</span>
<span class="comments">;             </span>
<span class="comments">;       Generate a sequence of 8 random digits.</span>
<span class="comments">;       IDL> Print, rng -> GetRandomDigits(8)</span>
<span class="comments">;             21855786</span>
<span class="comments">;</span>
<span class="comments">; INPUT PARAMETERS FOR INIT METHOD:</span>
<span class="comments">;</span>
<span class="comments">;       initialSeed:    The initial seed for the random number generator. If undefined</span>
<span class="comments">;                       or absent, the number of seconds after 1 January 1970 is used.</span>
<span class="comments">;                       </span>
<span class="comments">; METHODS:</span>
<span class="comments">;</span>
<span class="comments">;       randomNumbers -> GetRandomNumbers(d1, d2, d3, d4 d5, d6, d7, d8)</span>
<span class="comments">;       randomDigits = obj -> GetRandomDigits(numDigets)</span>
<span class="comments">;       obj -> SetSeed, seed</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;</span>
<span class="comments">;       Written by David W. Fanning, 13 November 2009.</span>
<span class="comments">;       Added GetRandomDigits method. 7 February 2010. DWF.</span>
<span class="comments">;       Incorrect cleanup of the seed pointer fixed in the CLEANUP procedure. </span>
<span class="comments">;           25 February 2010, DWF.</span>
<span class="comments">;-</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;  Copyright (c) 2009-2010, by Fanning Software Consulting, Inc.                           ;</span>
<span class="comments">;  All rights reserved.                                                                    ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Redistribution and use in source and binary forms, with or without                      ;</span>
<span class="comments">;  modification, are permitted provided that the following conditions are met:             ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;      * Redistributions of source code must retain the above copyright                    ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer.                     ;</span>
<span class="comments">;      * Redistributions in binary form must reproduce the above copyright                 ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer in the               ;</span>
<span class="comments">;        documentation and/or other materials provided with the distribution.              ;</span>
<span class="comments">;      * Neither the name of Fanning Software Consulting, Inc. nor the names of its        ;</span>
<span class="comments">;        contributors may be used to endorse or promote products derived from this         ;</span>
<span class="comments">;        software without specific prior written permission.                               ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  THIS SOFTWARE IS PROVIDED BY FANNING SOFTWARE CONSULTING, INC. ''AS IS'' AND ANY        ;</span>
<span class="comments">;  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES    ;</span>
<span class="comments">;  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT     ;</span>
<span class="comments">;  SHALL FANNING SOFTWARE CONSULTING, INC. BE LIABLE FOR ANY DIRECT, INDIRECT,             ;</span>
<span class="comments">;  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED    ;</span>
<span class="comments">;  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;         ;</span>
<span class="comments">;  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND             ;</span>
<span class="comments">;  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT              ;</span>
<span class="comments">;  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS           ;</span>
<span class="comments">;  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                            ;</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">; NAME:                                                                                </span>
<span class="comments">;    RandomNumberGenerator::GetRandomDigits                                                                   </span>
<span class="comments">;                                                                                      </span>
<span class="comments">; Purpose:                                                                             </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;    Allows the user to obtain a string variable of random digits.                                                               </span>
<span class="comments">;                                                                                      </span>
<span class="comments">; Method Syntax:                                                                       </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;    randomDigits = obj -> GetRandomDigits(numberOfDigits)                             </span>
<span class="comments">;                                                                                      </span>
<span class="comments">; Auguments:                                                                           </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;    numberOfDigits:   The number of digits desired. (Input, default is 8. )           </span>
<span class="comments">;                                                                                      </span>
<span class="comments">; Keywords:                                                                            </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;    BYTES:             If this keyword is set, the random digits are returned</span>
<span class="comments">;                       as a byte array, rather than as a string.                                                                             </span>
<span class="comments">;                                                                                      </span>
<span class="comments">; Return Value:                                                                        </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;    randomDigits:      A string variable containing the random digits.                </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION RandomNumberGenerator::GetRandomDigits, digits, BYTES=bytes

    COMPILE_OPT idl2

    On_Error, 2
    
    <span class="comments">; Default is 8 digits.</span>
    IF N_Elements(digits) EQ 0 THEN digits = 8
    
    <span class="comments">; How many random numbers are needed to construct this number of digits?</span>
    numbersNeeded = Long( digits/16 ) + 1
    
    <span class="comments">; Get the numbers and use only the digits after the "0.".</span>
    randomNumbers = self -> GetRandomNumbers(numbersNeeded, /DOUBLE)
    strNumbers = StrMid(String(randomNumbers, FORMAT='(F18.16)'), 2)
    
    <span class="comments">; Put the digits together to come up with the correct number.</span>
    digitNumbers = strNumbers[0]
    FOR j=1,N_Elements(randomNumbers)-1 DO digitNumbers = digitNumbers + strNumbers[j]
    
    <span class="comments">; Trim the result to the correct number of digits.</span>
    IF StrLen(digitNumbers) GT digits THEN digitNumbers = StrMid(digitNumbers,0,digits)
    
    <span class="comments">; Do you need bytes instead of a string?</span>
    IF Keyword_Set(bytes) THEN BEGIN
       numbers = BytArr(digits)
       FOR j=0,digits-1 DO BEGIN
            numbers[j] = Byte(Fix(StrMid(digitNumbers, j, 1)))
       ENDFOR
       digitNumbers = numbers
    ENDIF
    
    <span class="comments">;Return the digits you need.</span>
    RETURN, digitNumbers
    
END
    
    
<span class="comments">;------------------------------------------------------------------------------------------;</span>
<span class="comments">; NAME:                                                                                </span>
<span class="comments">;    RandomNumberGenerator::GetRandomNumbers                                                                  </span>
<span class="comments">;                                                                                      </span>
<span class="comments">; Purpose:                                                                             </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;    Allows the user to obtain a scalar or array of random numbers.                                                              </span>
<span class="comments">;                                                                                      </span>
<span class="comments">; Method Syntax:                                                                       </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;    randomNumbers = obj -> GetRandomNumbers(d1, d2, d3, d4, d5, d6, d7, d8)           </span>
<span class="comments">;                                                                                      </span>
<span class="comments">; Auguments:                                                                           </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;    d1...d8         Up to 8 dimension values can be specified, as in the IDL on-line  </span>
<span class="comments">;                    documentation for RANDOMU.                                        </span>
<span class="comments">; Keywords:                                                                            </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;        All the keywords that are defined for the IDL built-in routine RANDOMU are    </span>
<span class="comments">;        available for use here. The only difference is that non-integer numbers are   </span>
<span class="comments">;        *always* returned as double-precision values. That is to say DOUBLE is always </span>
<span class="comments">;        set to 1. See the IDL on-line documentation for RANDOMU to understand how to use </span>
<span class="comments">;        the following keywords:                                                       </span>
<span class="comments">;                BINOMIAL                                                              </span>
<span class="comments">;                DOUBLE                                                                </span>
<span class="comments">;                GAMMA                                                                 </span>
<span class="comments">;                NORMAL                                                                </span>
<span class="comments">;                POISSON                                                               </span>
<span class="comments">;                UNIFORM                                                               </span>
<span class="comments">;                LONG                                                                  </span>
<span class="comments">;                                                                                      </span>
<span class="comments">; Return Value:                                                                        </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;    randomNumbers:      The scalar or array of random numbers.                        </span>
<span class="comments">;                                                                                      </span>
<span class="comments">;------------------------------------------------------------------------------------------;</span>
FUNCTION RandomNumberGenerator::GetRandomNumbers, d1, d2, d3, d4, d5, d6, d7, d8, $
    BINOMIAL=binomial, $
    DOUBLE=double, $ 
    GAMMA=gamma, $
    NORMAL=normal, $
    POISSON=poisson, $
    UNIFORM=uniform, $
    LONG=long
    
    <span class="comments">; I just assume any floating value is *suppose* to be in double precision.</span>
    IF N_Elements(double) EQ 0 THEN double = 1
    
    <span class="comments">; Yuck! Have to do this according to the number of positional parameters.</span>
    CASE N_Params() OF
        0: results = RandomU(*self.seed, $
                BINOMIAL=binomial, $
                DOUBLE=double, $ 
                GAMMA=gamma, $
                NORMAL=normal, $
                POISSON=poisson, $
                UNIFORM=uniform, $
                LONG=long)
        1: results = RandomU(*self.seed, d1, $
                BINOMIAL=binomial, $
                DOUBLE=double, $ 
                GAMMA=gamma, $
                NORMAL=normal, $
                POISSON=poisson, $
                UNIFORM=uniform, $
                LONG=long)
        2: results = RandomU(*self.seed, d1, d2, $
                BINOMIAL=binomial, $
                DOUBLE=double, $ 
                GAMMA=gamma, $
                NORMAL=normal, $
                POISSON=poisson, $
                UNIFORM=uniform, $
                LONG=long)
        3: results = RandomU(*self.seed, d1, d2, d3, $
                BINOMIAL=binomial, $
                DOUBLE=double, $ 
                GAMMA=gamma, $
                NORMAL=normal, $
                POISSON=poisson, $
                UNIFORM=uniform, $
                LONG=long)
        4: results = RandomU(*self.seed, d1, d2, d3, d4, $
                BINOMIAL=binomial, $
                DOUBLE=double, $ 
                GAMMA=gamma, $
                NORMAL=normal, $
                POISSON=poisson, $
                UNIFORM=uniform, $
                LONG=long)
        5: results = RandomU(*self.seed, d1, d2, d3, d4, d5, $
                BINOMIAL=binomial, $
                DOUBLE=double, $ 
                GAMMA=gamma, $
                NORMAL=normal, $
                POISSON=poisson, $
                UNIFORM=uniform, $
                LONG=long)
        6: results = RandomU(*self.seed, d1, d2, d3, d4, d5, d6, $
                BINOMIAL=binomial, $
                DOUBLE=double, $ 
                GAMMA=gamma, $
                NORMAL=normal, $
                POISSON=poisson, $
                UNIFORM=uniform, $
                LONG=long)
        7: results = RandomU(*self.seed, d1, d2, d3, d4, d5, d6, d7, $
                BINOMIAL=binomial, $
                DOUBLE=double, $ 
                GAMMA=gamma, $
                NORMAL=normal, $
                POISSON=poisson, $
                UNIFORM=uniform, $
                LONG=long)
        8: results = RandomU(*self.seed, d1, d2, d3, d4, d5, d6, d7, d8, $
                BINOMIAL=binomial, $
                DOUBLE=double, $ 
                GAMMA=gamma, $
                NORMAL=normal, $
                POISSON=poisson, $
                UNIFORM=uniform, $
                LONG=long)
    ENDCASE
       
    <span class="comments">; Return the results.</span>
    RETURN, results
    
END <span class="comments">;----------------------------------------------------------------</span>



PRO RandomNumberGenerator::SetSeed, theSeed

    <span class="comments">; Sets the seed for the random number generator.</span>

    IF N_Elements(theSeed) NE 0 THEN *self.seed = theSeed
    
 END <span class="comments">;----------------------------------------------------------------</span>

   

PRO RandomNumberGenerator::CLEANUP

    Ptr_Free, self.seed

END <span class="comments">;----------------------------------------------------------------</span>


FUNCTION RandomNumberGenerator::INIT, initialSeed

    <span class="comments">; Initializes the random number generator. The initialSeed is the initial</span>
    <span class="comments">; seed for the generator. If absent, the number of seconds after 1 January 1970 </span>
    <span class="comments">; is used as the seed.</span>

    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        Help, /Last_Message
        Return, 0
    ENDIF
    
    <span class="comments">; Initialize the pointer.</span>
    self.seed = Ptr_New(/ALLOCATE_HEAP)

    <span class="comments">; Create the initial seed, if needed. Otherwise, just store it.</span>
    IF N_Elements(initialSeed) EQ 0 $
        THEN self -> SetSeed, Systime(1) $
        ELSE self -> SetSeed, initialSeed
        
    RETURN, 1
    
END <span class="comments">;----------------------------------------------------------------</span>


PRO RandomNumberGenerator__Define

    class = { RANDOMNUMBERGENERATOR, $
              seed: Ptr_New() }
END <span class="comments">;----------------------------------------------------------------</span>
</code>
    </div>
  </body>
</html>