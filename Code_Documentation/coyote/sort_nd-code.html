<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:12 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>sort_nd.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="sort_nd.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       SORT_ND</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;</span>
<span class="comments">;       Efficiently perform an N-dimensional sort along any dimension</span>
<span class="comments">;       of an array.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;</span>
<span class="comments">;       inds=sort_nd(array,dimension)</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;</span>
<span class="comments">;       array: An array of at least 2 dimensions to sort.</span>
<span class="comments">;</span>
<span class="comments">;       dimension: The dimension along which to sort, starting at 1</span>
<span class="comments">;          (1:rows, 2:columns, ...).</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;</span>
<span class="comments">;       inds: An index array with the same dimensions as the input</span>
<span class="comments">;          array, containing the (1D) sorted indices.  Can be used</span>
<span class="comments">;          directly to index the arary (ala SORT).</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;</span>
<span class="comments">;       a=randomu(sd,5,4,3,2)</span>
<span class="comments">;       sorted=a[sort_nd(a,2)]</span>
<span class="comments">;</span>
<span class="comments">; SEE ALSO:</span>
<span class="comments">;</span>
<span class="comments">;       HISTOGRAM</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;</span>
<span class="comments">;       Tue Aug 22 15:51:12 2006, J.D. Smith &lt;jdsmith@as.arizona.edu></span>
<span class="comments">;</span>
<span class="comments">;   Written, based on discussion on c.l.i-p, 08/2006.</span>
<span class="comments">;</span>
<span class="comments">;-</span>
<span class="comments">;##############################################################################</span>
<span class="comments">;</span>
<span class="comments">; LICENSE</span>
<span class="comments">;</span>
<span class="comments">;  Copyright (C) 2006 J.D. Smith</span>
<span class="comments">;</span>
<span class="comments">;  This file is free software; you can redistribute it and/or modify</span>
<span class="comments">;  it under the terms of the GNU General Public License as published</span>
<span class="comments">;  by the Free Software Foundation; either version 2, or (at your</span>
<span class="comments">;  option) any later version.</span>
<span class="comments">;</span>
<span class="comments">;  This file is distributed in the hope that it will be useful, but</span>
<span class="comments">;  WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="comments">;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="comments">;  General Public License for more details.</span>
<span class="comments">;</span>
<span class="comments">;  You should have received a copy of the GNU General Public License</span>
<span class="comments">;  along with this file; see the file COPYING.  If not, write to the</span>
<span class="comments">;  Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,</span>
<span class="comments">;  Boston, MA 02110-1301, USA.</span>
<span class="comments">;</span>
<span class="comments">;##############################################################################</span>

<a id="sort_nd:source"></a>function sort_nd, array, dimension
  sz=size(array,/DIMENSIONS)
  ndim=n_elements(sz)
  s=sort(array)

  if dimension eq 1 then begin  <span class="comments">; mark along dimension with index</span>
     inds=s/sz[0]
  endif else begin
     p=product(sz,/CUMULATIVE,/PRESERVE_TYPE)
     inds=s mod p[dimension-2]
     if dimension lt ndim then inds+=s/p[dimension-1]*p[dimension-2]
  endelse

  h=histogram(inds,REVERSE_INDICES=ri)
  ri=s[ri[n_elements(temporary(h))+1:*]]
  if dimension eq 1 then return,reform(ri,sz,/OVERWRITE) $
  else begin             <span class="comments">; target dimension is collected to front, rearrange it</span>
     t=[dimension-1,where(lindgen(ndim) ne dimension-1)]
     ri=reform(ri,sz[t],/OVERWRITE)
     return,transpose(ri,sort(t))
  endelse
end

</code>
    </div>
  </body>
</html>