<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:56:26 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>cgprogressbar__define.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="cgprogressbar__define.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">; docformat = 'rst'</span>
<span class="comments">;</span>
<span class="comments">; NAME:</span>
<span class="comments">;   cgProgressBar</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;   This program is used to draw a progress bar.</span>
<span class="comments">;</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Copyright (c) 2012, by Fanning Software Consulting, Inc. All rights reserved.           ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Redistribution and use in source and binary forms, with or without                      ;</span>
<span class="comments">;  modification, are permitted provided that the following conditions are met:             ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;      * Redistributions of source code must retain the above copyright                    ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer.                     ;</span>
<span class="comments">;      * Redistributions in binary form must reproduce the above copyright                 ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer in the               ;</span>
<span class="comments">;        documentation and/or other materials provided with the distribution.              ;</span>
<span class="comments">;      * Neither the name of Fanning Software Consulting, Inc. nor the names of its        ;</span>
<span class="comments">;        contributors may be used to endorse or promote products derived from this         ;</span>
<span class="comments">;        software without specific prior written permission.                               ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  THIS SOFTWARE IS PROVIDED BY FANNING SOFTWARE CONSULTING, INC. ''AS IS'' AND ANY        ;</span>
<span class="comments">;  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES    ;</span>
<span class="comments">;  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT     ;</span>
<span class="comments">;  SHALL FANNING SOFTWARE CONSULTING, INC. BE LIABLE FOR ANY DIRECT, INDIRECT,             ;</span>
<span class="comments">;  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED    ;</span>
<span class="comments">;  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;         ;</span>
<span class="comments">;  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND             ;</span>
<span class="comments">;  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT              ;</span>
<span class="comments">;  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS           ;</span>
<span class="comments">;  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                            ;</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;</span>
<span class="comments">;+</span>
<span class="comments">; This program is used to draw a progress bar on the display.</span>
<span class="comments">; </span>
<span class="comments">; .. image:: cgprogressbar.png</span>
<span class="comments">; </span>
<span class="comments">; The program requires the `Coyote Library &lt;http://www.idlcoyote.com/documents/programs.php>`</span>
<span class="comments">; to be installed on your machine.</span>
<span class="comments">;</span>
<span class="comments">; :Categories:</span>
<span class="comments">;    Graphics</span>
<span class="comments">;    </span>
<span class="comments">; :Examples:</span>
<span class="comments">;    To display a progress bar in a program with a FOR loop::</span>
<span class="comments">;       </span>
<span class="comments">;          cgProgressBar = Obj_New("CGPROGRESSBAR", /Cancel)</span>
<span class="comments">;          cgProgressBar -> Start</span>
<span class="comments">;          FOR j=0,9 DO BEGIN</span>
<span class="comments">;             IF cgProgressBar -> CheckCancel() THEN BEGIN</span>
<span class="comments">;                ok = Dialog_Message('The user cancelled operation.')</span>
<span class="comments">;                RETURN</span>
<span class="comments">;             ENDIF</span>
<span class="comments">;             Wait, 0.5  ; Would probably be doing something ELSE here!</span>
<span class="comments">;             cgProgressBar -> Update, (j+1)*10</span>
<span class="comments">;          ENDFOR</span>
<span class="comments">;          cgProgressBar -> Destroy</span>
<span class="comments">;    </span>
<span class="comments">;    An additional example can be found my compiling the program and typing</span>
<span class="comments">;    this command::</span>
<span class="comments">;    </span>
<span class="comments">;       IDL> ProgressBar_Example</span>
<span class="comments">;       </span>
<span class="comments">; :Author:</span>
<span class="comments">;    FANNING SOFTWARE CONSULTING::</span>
<span class="comments">;       David W. Fanning </span>
<span class="comments">;       1645 Sheely Drive</span>
<span class="comments">;       Fort Collins, CO 80526 USA</span>
<span class="comments">;       Phone: 970-221-0438</span>
<span class="comments">;       E-mail: david@idlcoyote.com</span>
<span class="comments">;       Coyote's Guide to IDL Programming: http://www.idlcoyote.com</span>
<span class="comments">;</span>
<span class="comments">; :History:</span>
<span class="comments">;    Change History::</span>
<span class="comments">;       Written by:  David W. Fanning, 27 September 2012. Inspired by Ronn Kling's program krProgressBar.</span>
<span class="comments">;         </span>
<span class="comments">; :Copyright:</span>
<span class="comments">;     Copyright (c) 2012, Fanning Software Consulting, Inc.</span>
<span class="comments">;-</span>
<span class="comments">;</span>
<span class="comments">;+</span>
<span class="comments">; Checks the cancel button to see if it has been selected.</span>
<span class="comments">; </span>
<span class="comments">; :Returns:</span>
<span class="comments">;    Returns a 1 if the user clicked the Cancel button and a 0 otherwise.</span>
<span class="comments">; </span>
<span class="comments">;+</span>
<span class="comments">; The initialization routine for the cgPROGRESSBAR object class.</span>
<span class="comments">;</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    cancelbutton: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword if you wish to have a CANCEL button on the </span>
<span class="comments">;       progress bar. If a CANCEL button is present, the user is reponsible</span>
<span class="comments">;       for checking if the user has canceled while the progress bar is running.</span>
<span class="comments">;    group_leader: in, optional, type=long</span>
<span class="comments">;       The identifier of a group leader widget for the progress bar. If the group</span>
<span class="comments">;       leader dies, the progress bar will be destroyed. </span>
<span class="comments">;    nocancel: in, optional, type=boolean, default=1</span>
<span class="comments">;        A depreciated keyword, added for compatibility with the old Progressbar code.</span>
<span class="comments">;        If set, sets the CancelButton keyword to 0.</span>
<span class="comments">;    percent: in, optional, type=float, default=0.0</span>
<span class="comments">;        The initial percentage completion of the progress bar when it first</span>
<span class="comments">;        appears on the display. Used only if the `Start` keyword is also set.</span>
<span class="comments">;    text: in, optional, type=string</span>
<span class="comments">;        The text that appears in a label widget above the progress bar. If not</span>
<span class="comments">;        supplied, no label widget is created.</span>
<span class="comments">;    title: in, optional, type=string</span>
<span class="comments">;        The text that appears as the window title of the progress bar. By default, </span>
<span class="comments">;        "Operation in Progress...".</span>
<span class="comments">;    xoffset: in, optional, type=int</span>
<span class="comments">;        The X offset, in pixels, from the top-left corner of the display. If</span>
<span class="comments">;        not provided, the progress bar is centered in the window.</span>
<span class="comments">;    xsize: in, optional, type=int, default=250</span>
<span class="comments">;        The X size, in pixels, of the progress bar.</span>
<span class="comments">;    yoffset: in, optional, type=int</span>
<span class="comments">;        The Y offset, in pixels, from the top-left corner of the display. If</span>
<span class="comments">;        not provided, the progress bar is centered in the window.</span>
<span class="comments">;    ysize: in, optional, type=int, default=25</span>
<span class="comments">;        The Y size, in pixels, of the progress bar.       </span>
<span class="comments">;-</span>
FUNCTION cgProgressBar::INIT, $
    CANCELBUTTON=cancelbutton, $ <span class="comments">; Set this keyword if you desire a CANCEL button on progress bar.</span>
    GROUP_LEADER=group_leader, $ <span class="comments">; The identifier of the group leader widget.</span>
    NOCANCEL=nocancel, $         <span class="comments">; Depreciated keyword.</span>
    PERCENT=percent, $           <span class="comments">; Initial percent of the progress bar. (Only recognized if START used.)</span>
    START=start, $               <span class="comments">; Set this keyword if you wish to call the START method from INIT.</span>
    TEXT=text, $                 <span class="comments">; The message text to be written over the progress bar.</span>
    TITLE=title, $               <span class="comments">; The title of the top-level base widget.</span>
    XOFFSET=xoffset, $           <span class="comments">; The X offset of the progress bar.</span>
    XSIZE=xsize, $               <span class="comments">; The X size of the progress bar.</span>
    YOFFSET=yoffset, $           <span class="comments">; The Y offset of the progress bar.</span>
    YSIZE=ysize                  <span class="comments">; The Y size of the progress bar.</span>

    Compile_Opt idl2
    
    <span class="comments">; Standard error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        void = Error_Message()
        RETURN, 0
    ENDIF
    
    <span class="comments">; Check keywords.</span>
    IF N_Elements(nocancel) NE 0 THEN cancelbutton = 1 - Keyword_Set(nocancel)
    SetDefaultValue, cancelbutton, 0, /Boolean
    SetDefaultValue, percent, 0.0
    SetDefaultValue, start, 0, /Boolean
    SetDefaultValue, text, ""
    SetDefaultValue, title, "Operation in Progress..."
    SetDefaultValue, xsize, 250
    SetDefaultValue, ysize, 25
    
    <span class="comments">; Progress bar should be centered unless told otherwise.</span>
    Device, Get_Screen_Size=screenSize
    IF screenSize[0] GT 2000 THEN screenSize[0] = screenSize[0]/2 <span class="comments">; Dual monitors.</span>
    IF N_Elements(xoffset) EQ 0 THEN xoffset = (screenSize[0]/2 - xsize/2)
    IF N_Elements(yoffset) EQ 0 THEN yoffset = (screenSize[1]/2 - ysize/2)

    <span class="comments">; The progress must be between 0.0 and 100.0.</span>
    percent = 0.0 > percent &lt<span class="comments">; 100.0</span>
    
    <span class="comments">; Create the widgets for the program.</span>
    self.tlb = Widget_Base(Column=1, Group_Leader=group_leader, $
        Floating=N_Elements(group_leader) GT 0, $
        XOffset=xoffset, YOffset=yoffset, Title=title, $
        Map=0, Base_Align_Center=1, TLB_Frame_Attr=11)
    IF text NE "" THEN BEGIN
       self.labelID = Widget_Label(self.tlb, Value=text, /Dynamic_Resize)
    ENDIF
    self.drawID = Widget_Draw(self.tlb, XSize=xsize, YSize=ysize, $
        Graphics_Level=2, Renderer=1, Retain=2)
    IF cancelbutton THEN BEGIN
       self.cancelID = Widget_Button(self.tlb, Value='Cancel')
    ENDIF
    
    <span class="comments">; Create needed objects.</span>
    self.view = Obj_New('IDLgrView', ViewPlane_Rect=[0,0,xsize,ysize], $
        Color=[255, 255, 255])
    self.model = Obj_New('IDLgrModel')
    self.view -> Add, self.model
    
    <span class="comments">; Store sizes.</span>
    self.xsize = xsize
    self.ysize = ysize
    
    <span class="comments">; Create the background image for the progress bar.</span>
    self.image = self -> CreateImage()
    self.model -> Add, self.image
    
    <span class="comments">; Create the initial mask for the image and update it with the percent.</span>
    mask = BytArr(4, xsize, ysize)
    mask[3,*,*] = 255B
    self.mask = Obj_New('IDLgrImage', mask, Blend_Function=[3,4], /No_Copy)
    self -> UpdateMask, percent
    self.model -> Add, self.mask
    
    <span class="comments">; Prepare to overlay percentage as text.</span>
    percentString = String(percent, Format='(I0)') + ' %'
    self.text = Obj_New('IDLgrText', percentString, Alignment=0.5, $
        Location=[xsize/2,ysize/2,0.1], Vertical_Alignment=0.5, $
        Color=[255,255,255])
    self.model -> Add, self.text
    
    <span class="comments">; Start it up?</span>
    IF start THEN self -> Start, percent

    RETURN, 1

END


<span class="comments">;+</span>
<span class="comments">; The clean-up routine for the object.</span>
<span class="comments">;-</span>
PRO cgProgressBar::CLEANUP

   IF Widget_Info(self.tlb, /VALID_ID) THEN Widget_Control, self.tlb, /Destroy
   Obj_Destroy, self.image
   Obj_Destroy, self.mask
   Obj_Destroy, self.text
   Obj_Destroy, self.view
   Obj_Destroy, self.model
   Obj_Destroy, self.window
END


<span class="comments">;+</span>
<span class="comments">; Checks to see if a Cancel button has been clicked during the on-going operation.</span>
<span class="comments">; An optional response can be issued, if so.</span>
<span class="comments">; </span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    message: in, optional, type=string</span>
<span class="comments">;       If the RESPOND keyword is set, this is the message set in the blocking</span>
<span class="comments">;       dialog widget. By default: "Current Operation Cancelled by User".</span>
<span class="comments">;    respond: in, optional, type=boolean, default=0</span>
<span class="comments">;       If this keyword is set, the program responds to a positive cancel flag</span>
<span class="comments">;       by destroying the progress bar and setting a blocking dialog widget</span>
<span class="comments">;       for the user. The keyword is ignored if the cancel flag is zero.</span>
<span class="comments">;-</span>
FUNCTION cgProgressBar::CheckCancel, $
    MESSAGE=message, $
    RESPOND=respond

    Compile_Opt idl2
    
    <span class="comments">; Standard error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        void = Error_Message()
        RETURN, 0
    ENDIF
    
    <span class="comments">; Assume no cancel operation.</span>
    cancelFlag = 0
  
   <span class="comments">; Check for a Cancel event, if there is one.</span>
   IF Widget_Info(self.cancelID, /Valid_ID) THEN BEGIN
      event = Widget_Event(self.cancelID, /NoWait)
      name = Tag_Names(event, /Structure_Name)
      IF name EQ 'WIDGET_BUTTON' THEN cancelFlag = 1
   ENDIF
   
   <span class="comments">; Need a response to the cancel flag?</span>
   IF cancelFlag && Keyword_Set(respond) THEN BEGIN
       self -> Destroy
       IF N_Elements(message) EQ 0 THEN message = "Current Operation Cancelled by User"
       void = Dialog_Message(message)
   ENDIF

   RETURN, cancelFlag
END


<span class="comments">;+</span>
<span class="comments">; Create the object image for the program. Taken from Ronn Kling's</span>
<span class="comments">; "really cool" background image in krProgressBar.</span>
<span class="comments">;-</span>
FUNCTION cgProgressBar::CreateImage

    Compile_Opt idl2
    
    <span class="comments">; Standard error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        void = Error_Message()
        RETURN, -1
    ENDIF

    <span class="comments">; RGB vectors set up by Ronn Kling.</span>
    red = Bytscl([Intarr(193), Indgen(63)])
    grn = Bytscl([Intarr(96) , Indgen(256-96)])
    blu = Bytscl([Intarr(188), Intarr(256-188)+188])
    
    data = [228,228,238,248,248,238,228,217,197,186,165,155,145,145,145, $
            145,155,166,176,186,186,186,176,166,124]
    IF self.ysize NE 25 THEN data = Congrid(data, self.ysize)
    
    <span class="comments">; Arrange the data in the form of an image.</span>
    data = Rebin(Reform(data, 1, self.ysize), self.xsize, self.ysize)
    img = BytArr(3, self.xsize, self.ysize)
    img[0,*,*] = red[data]
    img[1,*,*] = grn[data]
    img[2,*,*] = blu[data]
    
    <span class="comments">; Create an object image.</span>
    image = Obj_New('IDLgrImage', img, Interpolate=1, /No_Copy)
    
    RETURN, image

END

<span class="comments">;+</span>
<span class="comments">; Destroys the progress bar.</span>
<span class="comments">;-</span>
PRO cgProgressBar::Destroy

    Compile_Opt idl2
    
    <span class="comments">; Standard error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        void = Error_Message()
        RETURN
    ENDIF
    
   IF Widget_Info(self.tlb, /VALID_ID) THEN Widget_Control, self.tlb, /DESTROY
   Obj_Destroy, self

END


<span class="comments">;+</span>
<span class="comments">; Updates the progress bar.</span>
<span class="comments">; </span>
<span class="comments">; :Params:</span>
<span class="comments">;     percent: in, required, type=float</span>
<span class="comments">;         The percent the progress bar has been completed. A number between</span>
<span class="comments">;         0 and 100. Forced into this range.</span>
<span class="comments">;-</span>
PRO cgProgressBar::Update, percent

    Compile_Opt idl2
    
    <span class="comments">; Standard error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        void = Error_Message()
        RETURN
    ENDIF
    
    <span class="comments">; Nothing to do if percent equals zero.</span>
    IF (N_Elements(percent) EQ 0) || (percent EQ 0.0) THEN RETURN
    
    <span class="comments">; Percent must be between 0 and 100.</span>
    percent = 0.0 > percent &lt<span class="comments">; 100.0</span>
    
    <span class="comments">; Update the mask.</span>
    self -> UpdateMask, percent
    
    <span class="comments">; Update the text object.</span>
    newText = String(percent, Format='(I0)') + ' %'
    self.text -> SetProperty, String=newText
    
    <span class="comments">; Draw the progress bar.</span>
    self.window -> Draw, self.view
    
END


<span class="comments">;+</span>
<span class="comments">; Update the image mask to reflect the correct percentage.</span>
<span class="comments">; </span>
<span class="comments">; :Params:</span>
<span class="comments">;     percent: in, required, type=float</span>
<span class="comments">;         The percent the progress bar has been completed. A number between</span>
<span class="comments">;         0 and 100. Forced into this range.</span>
<span class="comments">;-</span>
PRO cgProgressBar::UpdateMask, percent

    Compile_Opt idl2
    
    <span class="comments">; Standard error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        void = Error_Message()
        RETURN
    ENDIF
    
    <span class="comments">; Nothing to do if percent equals zero.</span>
    IF (N_Elements(percent) EQ 0) || (percent EQ 0.0) THEN RETURN
    
    <span class="comments">; Percent must be between 0 and 100.</span>
    percent = 0.0 > percent &lt<span class="comments">; 100.0</span>

    <span class="comments">; Get the current maps</span>
    self.mask -> GetProperty, Data=data

    <span class="comments">; Modify the mask by the percent needed and update the alpha channel.</span>
    newMask = BytArr(self.xsize, self.ysize) + 255B
    x = Reverse(Bytscl(Findgen((self.xsize*(percent/100.))>1)))
    y = Bytarr(self.ysize) + 1B
    newMask[0,0] = x # y
    data[3, *, *] = newMask
    
    <span class="comments">; Set it back.</span>
    self.mask -> SetProperty, Data=data
     
END


<span class="comments">;+</span>
<span class="comments">; Starts the progress bar by realizing the progress bar on the display.</span>
<span class="comments">;</span>
<span class="comments">; :Params:</span>
<span class="comments">;    percent: in, optional, type=float</span>
<span class="comments">;       Starts the progress bar with this percentage completion. A number</span>
<span class="comments">;       between 0.0 and 100.0.</span>
<span class="comments">;-</span>
PRO cgProgressBar::Start, percent

    Compile_Opt idl2
    
    <span class="comments">; Standard error handling.</span>
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        void = Error_Message()
        RETURN
    ENDIF
    
    <span class="comments">; Check parameters.</span>
    IF N_Elements(percent) EQ 0 THEN percent = 0.0
    
    <span class="comments">; Realize the widget.</span>
    Widget_Control, self.tlb, /Realize, Map=1

    <span class="comments">; Get the window object reference number of the draw widget.</span>
    Widget_Control, self.drawID, Get_Value=window
    self.window = window
    
    <span class="comments">; Draw the bar.</span>
    self.window -> Draw, self.view

    <span class="comments">; Do you supply a starting percent?</span>
    IF N_Elements(percent) NE 0 THEN self -> Update, (0.0 > percent &lt<span class="comments">; 100.0)</span>

END

<span class="comments">;+</span>
<span class="comments">; The event handler for the progress bar example program.</span>
<span class="comments">;</span>
<span class="comments">; :Params:</span>
<span class="comments">;     event: in, required, type=structure</span>
<span class="comments">;        The event structure.</span>
<span class="comments">;-</span>
PRO Progressbar_Example_Event, event

    <span class="comments">; Respond to program button events.</span>

    Widget_Control, event.id, Get_Value=buttonValue
    
    CASE buttonValue OF
    
       'Start Simple Loop': BEGIN
    
          <span class="comments">; Create the progress bar.</span>
          progressbar = Obj_New('cgprogressbar', /Start)
    
          <span class="comments">; Start the loop.</span>
          count = 0
          FOR j=0, 1000 DO BEGIN
    
              IF j MOD 10 EQ 0 THEN BEGIN <span class="comments">; Update the progess bar every 100 times through loop.</span>
                progressbar -> Update, (count * 1.0)
                count = count + 1
              ENDIF
    
              Wait, 0.01 <span class="comments">; This is where you would do something useful.</span>
          ENDFOR
    
          <span class="comments">; Destroy the progress bar when you are finished with it.</span>
          progressbar -> Destroy
          ENDCASE
    
    
       'Start Cancel Loop': BEGIN
    
         <span class="comments">; Create the progress bar.</span>
          progressbar = Obj_New('cgprogressbar', /Cancel)
    
          <span class="comments">; Place the progress bar on the display.</span>
          progressbar -> Start
    
          <span class="comments">; Start the loop.</span>
          count = 0
          FOR j=0, 1000 DO BEGIN
    
              IF j MOD 10 EQ 0 THEN BEGIN <span class="comments">; Update the progess bar every 100 times through loop.</span>
    
                <span class="comments">; Did the user try to cancel the progress bar?</span>
                IF progressbar->CheckCancel() THEN BEGIN
                   ok = Dialog_Message('User cancelled operation.') <span class="comments">; Other cleanup, etc. here.</span>
                   progressbar -> Destroy <span class="comments">; Destroy the progress bar.</span>
                   RETURN
                ENDIF
    
                <span class="comments">; If user didn't cancel, update the progress bar. Update value</span>
                <span class="comments">; must be between 0 and 100.</span>
                progressbar -> Update, (count * 1.0)
                count = count + 1
              ENDIF
    
              Wait, 0.01 <span class="comments">; This is where you would do something useful.</span>
          ENDFOR
    
          <span class="comments">; Destroy the progress bar when you are finished with it.</span>
          progressbar -> Destroy
          ENDCASE
    
       'Quit': Widget_Control, event.top, /Destroy
    
    ENDCASE

END


<span class="comments">;+</span>
<span class="comments">; This is an example program that illustrates how the cgProgressBar</span>
<span class="comments">; object can be used.</span>
<span class="comments">;-</span>
PRO Progressbar_Example
    tlb = Widget_Base(Column=1, Xoffset=200, Yoffset=200)
    button = Widget_Button(tlb, Value='Start Simple Loop')
    button = Widget_Button(tlb, Value='Start Cancel Loop')
    quiter = Widget_Button(tlb, Value='Quit')
    Widget_Control, tlb, /Realize
    XManager, 'progressbar_example', tlb, /No_Block
END


<span class="comments">;+</span>
<span class="comments">; The class definition module for the cgPROGRESSBAR object class.</span>
<span class="comments">;</span>
<span class="comments">; :Params:</span>
<span class="comments">;     class: out, optional, type=structure</span>
<span class="comments">;        The object class definition as a structure. Occasionally useful.</span>
<span class="comments">;-</span>
PRO cgProgressBar__Define, class

   class = { cgPROGRESSBAR, $
             INHERITS IDL_OBJECT, $
             image: Obj_New(), $
             mask: Obj_New(), $
             text: Obj_New(), $
             view: Obj_New(), $
             model: Obj_New(), $
             window: Obj_New(), $
             xsize: 0L, $
             ysize: 0L, $
             tlb: 0L, $
             drawID: 0L, $
             cancelID: 0L, $
             labelID: 0L $
            }
END
</code>
    </div>
  </body>
</html>