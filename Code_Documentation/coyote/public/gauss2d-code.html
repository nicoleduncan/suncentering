<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:16 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>gauss2d.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="gauss2d.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME: </span>
<span class="comments">;  gauss2d</span>
<span class="comments">; PURPOSE: </span>
<span class="comments">;  Compute a two dimensional gaussian within an array.</span>
<span class="comments">; DESCRIPTION:</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;  Mathematical</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;  pro gauss2d,nx,ny,x,y,fwhm,array</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;  nx   - X size of output array</span>
<span class="comments">;  ny   - Y size of output array</span>
<span class="comments">;  x    - X location of gaussian in array</span>
<span class="comments">;  y    - Y location of gaussian in array</span>
<span class="comments">;  fwhm - Full width at half-maximum of gaussian.</span>
<span class="comments">; OPTIONAL INPUT PARAMETERS:</span>
<span class="comments">; KEYWORD INPUT PARAMETERS:</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;  array - Result array with gaussian inserted.</span>
<span class="comments">; KEYWORD OUTPUT PARAMETERS:</span>
<span class="comments">; COMMON BLOCKS:</span>
<span class="comments">; SIDE EFFECTS:</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;  94/04/07, Written by Marc W. Buie, Lowell Observatory</span>
<span class="comments">;-</span>
<a id="gauss2d:source"></a>pro gauss2d,nx,ny,x,y,fwhm,array

<span class="comments">;   if badpar(nx,  [1,2,3,4,5],0,CALLER='gauss2d (nx)') then return</span>
<span class="comments">;   if badpar(ny,  [1,2,3,4,5],0,CALLER='gauss2d (ny)') then return</span>
<span class="comments">;   if badpar(x,   [1,2,3,4,5],0,CALLER='gauss2d (x)') then return</span>
<span class="comments">;   if badpar(y,   [1,2,3,4,5],0,CALLER='gauss2d (y)') then return</span>
<span class="comments">;   if badpar(fwhm,[1,2,3,4,5],0,CALLER='gauss2d (fwhm)') then return</span>

   ehwd = fwhm/2.0/sqrt(alog(2.0))

   ix = findgen(nx)
   iy = findgen(ny)
   onex = replicate(1.0,nx)
   oney = replicate(1.0,ny)

   xarr = ((ix-x)/ehwd)^2 # oney
   yarr = onex # ((iy-y)/ehwd)^2

   rsq = xarr + yarr
   array = fltarr(nx,ny)

<span class="comments">; Protection against underflow in exp call.</span>
   big = where(rsq le 87.3, count)
   if count ne 0 then array[big] = exp(-rsq[big])

end
</code>
    </div>
  </body>
</html>