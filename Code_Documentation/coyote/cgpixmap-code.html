<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:56:25 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>cgpixmap.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="cgpixmap.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">; docformat = 'rst'</span>
<span class="comments">;</span>
<span class="comments">; NAME:</span>
<span class="comments">;   cgPixmap</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;   Creates an invisible graphics window for IDL traditional commands (Plot, Contour, </span>
<span class="comments">;   Surface, etc. or for Coyote Graphics routines, cgPlot, cgContour, cgSurf, etc.). </span>
<span class="comments">;   In addition, the window contents can be saved as PostScript files or as raster image </span>
<span class="comments">;   files. If ImageMagick is installed on your machine, the raster image files can be </span>
<span class="comments">;   created in very high quality from PostScript files. This window is identical to</span>
<span class="comments">;   cgWindow, except that it doesn't appear on the display, unless you want it to.</span>
<span class="comments">;</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Copyright (c) 2012, by Fanning Software Consulting, Inc. All rights reserved.           ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Redistribution and use in source and binary forms, with or without                      ;</span>
<span class="comments">;  modification, are permitted provided that the following conditions are met:             ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;      * Redistributions of source code must retain the above copyright                    ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer.                     ;</span>
<span class="comments">;      * Redistributions in binary form must reproduce the above copyright                 ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer in the               ;</span>
<span class="comments">;        documentation and/or other materials provided with the distribution.              ;</span>
<span class="comments">;      * Neither the name of Fanning Software Consulting, Inc. nor the names of its        ;</span>
<span class="comments">;        contributors may be used to endorse or promote products derived from this         ;</span>
<span class="comments">;        software without specific prior written permission.                               ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  THIS SOFTWARE IS PROVIDED BY FANNING SOFTWARE CONSULTING, INC. ''AS IS'' AND ANY        ;</span>
<span class="comments">;  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES    ;</span>
<span class="comments">;  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT     ;</span>
<span class="comments">;  SHALL FANNING SOFTWARE CONSULTING, INC. BE LIABLE FOR ANY DIRECT, INDIRECT,             ;</span>
<span class="comments">;  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED    ;</span>
<span class="comments">;  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;         ;</span>
<span class="comments">;  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND             ;</span>
<span class="comments">;  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT              ;</span>
<span class="comments">;  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS           ;</span>
<span class="comments">;  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                            ;</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;+</span>
<span class="comments">;  Creates an invisible graphics window for IDL traditional commands (Plot, Contour, </span>
<span class="comments">;  Surface, etc. or for Coyote Graphics routines, cgPlot, cgContour, cgSurf, etc.). </span>
<span class="comments">;  In addition, the window contents can be saved as PostScript files or as raster image </span>
<span class="comments">;  files. If ImageMagick is installed on your machine, the raster image files can be </span>
<span class="comments">;  created in very high quality from PostScript files. This window is identical to</span>
<span class="comments">;  cgWindow, except that it doesn't appear on the display unless you want it to.</span>
<span class="comments">;</span>
<span class="comments">;  The program is designed to work with any IDL traditional graphics routine</span>
<span class="comments">;  that is a procedure and includes no more than three positional parameters.</span>
<span class="comments">;  Any number of keywords can be used to specify properties of the graphical</span>
<span class="comments">;  output. Any number of graphics commands can be "added" the the cgWindow.</span>
<span class="comments">;  Simply use the `AddCmd` keyword to add commands.</span>
<span class="comments">;  </span>
<span class="comments">;  If your program does not load its own color tables, the color tables in</span>
<span class="comments">;  effect when cgWindow is first called are used to display the graphics</span>
<span class="comments">;  commands.</span>
<span class="comments">;    </span>
<span class="comments">;  To create PostScript output from within cgWindow, your graphics program</span>
<span class="comments">;  has to be written in such a way that it can work properly in the PostScript</span>
<span class="comments">;  device. This means there are no Window commands, WSet commands, and the like</span>
<span class="comments">;  that are not allowed in the PostScript device. Such commands are allowed in </span>
<span class="comments">;  programs, of course, if they are "protected". Usually such protection looks </span>
<span class="comments">;  like this::</span>
<span class="comments">;  </span>
<span class="comments">;     IF (!D.Flags AND 256) NE 0 THEN Window, ...</span>
<span class="comments">;     </span>
<span class="comments">;  The Coyote Graphics program `cgDisplay` is a good program for opening graphics </span>
<span class="comments">;  "windows", because such PostScript protection is built into the program. In a PostScript </span>
<span class="comments">;  device, cgDisplay produces a "window" with the same aspect ratio as the current</span>
<span class="comments">;  display graphics window, which is an aid in producing PostScript output that</span>
<span class="comments">;  looks like the same output in the display window.</span>
<span class="comments">;   </span>
<span class="comments">;  Much better looking raster files can be created from the cgWindow contents,</span>
<span class="comments">;  if the raster files are created by converting PostScript files to the raster </span>
<span class="comments">;  file. If the ImageMagick "convert" command can be found on your machine, you</span>
<span class="comments">;  will have the option to create raster files using this method. I *highly*</span>
<span class="comments">;  recommend doing so, as fonts and other plot annotation will be of much higher</span>
<span class="comments">;  quality using this method.</span>
<span class="comments">;   </span>
<span class="comments">;  cgWindow has been designed to work with other Coyote Graphics routines: `cgPlot`,</span>
<span class="comments">;  `cgContour`, `cgSurf`, and so on, although I expect it to work with any IDL</span>
<span class="comments">;  traditional graphics routine, if the routine is well written.</span>
<span class="comments">;        </span>
<span class="comments">;  Default properties of the object can be controled with cgWindow_SetDefs and cgControl,</span>
<span class="comments">;  as with cgWindow. Be sure to delete the pixmap object when you are done with it, by</span>
<span class="comments">;  using (for example) cgDelete.</span>
<span class="comments">;</span>
<span class="comments">; :Categories:</span>
<span class="comments">;    Graphics</span>
<span class="comments">;    </span>
<span class="comments">; :Author:</span>
<span class="comments">;    FANNING SOFTWARE CONSULTING::</span>
<span class="comments">;       David W. Fanning </span>
<span class="comments">;       1645 Sheely Drive</span>
<span class="comments">;       Fort Collins, CO 80526 USA</span>
<span class="comments">;       Phone: 970-221-0438</span>
<span class="comments">;       E-mail: david@idlcoyote.com</span>
<span class="comments">;       Coyote's Guide to IDL Programming: http://www.idlcoyote.com</span>
<span class="comments">;</span>
<span class="comments">; :Params:</span>
<span class="comments">;    command: in, required, type=string</span>
<span class="comments">;       The graphics procedure command to be executed. This parameter</span>
<span class="comments">;       must be a string and the the command must be a procedure. Examples</span>
<span class="comments">;       are 'Surface', 'Contour', 'Plot', 'cgPlot', cgContour, etc.</span>
<span class="comments">;    p1: in, optional, type=any</span>
<span class="comments">;       The first positional parameter appropriate for the graphics command.</span>
<span class="comments">;    p2: in, optional, type=any</span>
<span class="comments">;       The second positional parameter appropriate for the graphics command.</span>
<span class="comments">;    p3: in, optional, type=any</span>
<span class="comments">;       The third positional parameter appropriate for the graphics command.</span>
<span class="comments">;    p4: in, optional, type=any</span>
<span class="comments">;       The fourth positional parameter appropriate for the graphics command.</span>
<span class="comments">;       </span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    addcmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to add an additional graphics command to an cgWindow.</span>
<span class="comments">;       The command is added to the last created cgWindow, unless the WinID</span>
<span class="comments">;       keyword is used to select another cgWindow. Adding a command causes</span>
<span class="comments">;       all the commands in the window to be immediately executed. If this is</span>
<span class="comments">;       not behavior you desire, use the LOADCMD keyword instead. If CMDINDEX</span>
<span class="comments">;       is used to select a command index, the new command is added before</span>
<span class="comments">;       the command currently occuping that index in the command list.</span>
<span class="comments">;    altps_Keywords: in, optional, type=string</span>
<span class="comments">;       A structure containing alternative keyword names (as tags) and values for</span>
<span class="comments">;       those keywords to be used when the current device is the PostScript device.</span>
<span class="comments">;       See http://www.idlcoyote.com/cg_tips/kwexpressions.php and the examples</span>
<span class="comments">;       below for details on how to use this keyword.</span>
<span class="comments">;    altps_Params: in, optional, type=IntArr(3)</span>
<span class="comments">;       A structure containing alternative parameter values to be used when </span>
<span class="comments">;       the current device is the PostScript device. Structure names are restricted</span>
<span class="comments">;       to the names "P1", "P2", "P3" and "P4" to correspond to the equivalent positional</span>
<span class="comments">;       parameter. See http://www.idlcoyote.com/cg_tips/kwexpressions.php and the </span>
<span class="comments">;       examples below for details on how to use this keyword.</span>
<span class="comments">;    cmddelay: in, optional, type=float</span>
<span class="comments">;       Ignored. Used only for compatibility with cgWindow.</span>
<span class="comments">;    cmdindex: in, optional, type=integer</span>
<span class="comments">;       This keyword is used to select which command in an cgWindow to act on</span>
<span class="comments">;       when the AllCmd, DeleteCmd, LoadCmd and ReplaceCmd keywords are used. </span>
<span class="comments">;       See the descriptions of these keywords for details on what happens when </span>
<span class="comments">;       CmdIndex is missing.</span>
<span class="comments">;    deletecmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to delete a graphics command from an cgWindow.</span>
<span class="comments">;       If CmdIndex is undefined the last command entered into the window is</span>
<span class="comments">;       deleted. It is not possible to delete the last command in the window.</span>
<span class="comments">;       Use WinID to identify the cgWindow you are interested in. If WinID </span>
<span class="comments">;       is undefined, the last cgWindow created is used.</span>
<span class="comments">;    executecmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to immediate execute all the commands in an cgWindow.</span>
<span class="comments">;       Normally, this is used after commands have been loaded with LOADCMD.</span>
<span class="comments">;    group_leader: in, optional</span>
<span class="comments">;       The identifier of a widget to serve as a group leader for this program.</span>
<span class="comments">;       If the group leader is destroyed, this program is also destroyed. Used</span>
<span class="comments">;       when calling this program from another widget program.</span>
<span class="comments">;    listcmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       If this keyword is set, the commands currently in the cgWindow are</span>
<span class="comments">;       listed. Use WinID to identify the cgWindow you are interested in.</span>
<span class="comments">;       If WinID is undefined, the last cgWindow created is used.</span>
<span class="comments">;    loadcmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to add an additional graphics command to an cgWindow.</span>
<span class="comments">;       The command is added to the last created cgWindow, unless the WinID</span>
<span class="comments">;       keyword is used to select another cgWindow. Loaded commands are not</span>
<span class="comments">;       automatically executed. Set the EXECUTECMD keyword at the end of loading</span>
<span class="comments">;       to execute the loaded commands. If CMDINDEX is used to select a command </span>
<span class="comments">;       index, the new command is loaded before the command currently occuping </span>
<span class="comments">;       that index in the command list.</span>
<span class="comments">;    method: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword if the command is an object method call rather than a </span>
<span class="comments">;       procedure call. If this keyword is set, the first positional parameter, p1,</span>
<span class="comments">;       must be present and must be a valid object reference.</span>
<span class="comments">;    replacecmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to replace a graphics command from an cgWindow.</span>
<span class="comments">;       If CmdIndex is undefined, *all* commands in the window are replaced. Use </span>
<span class="comments">;       WinID to identify the cgWindow you are interested in. If WinID is </span>
<span class="comments">;       undefined, the last cgWindow created is used for the replacement.</span>
<span class="comments">;    waspect: in, optional, type=float, default=normal</span>
<span class="comments">;       Set this keyword to the aspect ratio you would like the window to have.</span>
<span class="comments">;       The aspect ratio is calculated as (ysize/xsize). Must be a float value.</span>
<span class="comments">;       If this keyword is set, the window will maintain this aspect ratio,</span>
<span class="comments">;       even when it is resized.</span>
<span class="comments">;    wbackground: in, optional, type=varies, default=!P.Background</span>
<span class="comments">;       The background color of the window. Specifying a background color </span>
<span class="comments">;       automatically sets the WErase keyword.</span>
<span class="comments">;    wdestroyobjects: in, optional, type=boolean, default=0</span>
<span class="comments">;       If this keyword is set, and any of the input parameters p1-p4 is an object,</span>
<span class="comments">;       the object parameter will be destroyed when the window is destroyed.</span>
<span class="comments">;    werase: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to cause the window to be erased before graphics commands </span>
<span class="comments">;       are drawn. This may need to be set, for example, to display images.</span>
<span class="comments">;    winid: in, optional, type=integer</span>
<span class="comments">;       Use this keyword to select the window cgWindow identifier (the number between</span>
<span class="comments">;       the parentheses in the title bar of cgWindow). The AddCmd, ReplaceCmd, ListCmd,</span>
<span class="comments">;       and DeleteCmd keywords will all apply to the commands in the last cgWindow</span>
<span class="comments">;       created unless this keyword is used to select another cgWindow to apply the </span>
<span class="comments">;       commands to.</span>
<span class="comments">;    wmulti: in, optional, type=intarr(5)</span>
<span class="comments">;        Set this keyword in exactly the same way you would set the !P.Multi keyword.</span>
<span class="comments">;        It will allow you to display multi-plots in the cgWindow graphics window.</span>
<span class="comments">;    wobject: out, optional, type=object</span>
<span class="comments">;       cgWindow creates a FSC_CmdWindow object. This object reference is returned</span>
<span class="comments">;       if this keyword is present.</span>
<span class="comments">;    woxmargin: in, optional, type=float</span>
<span class="comments">;       A two-element array indicating the left and right X outside margins for the</span>
<span class="comments">;       graphical display. Used only when doing multiple plots with `WMulti`.</span>
<span class="comments">;    woymargin: in, optional, type=float</span>
<span class="comments">;       A two-element array indicating the bottom and top Y outside margins for the</span>
<span class="comments">;       graphical display. Used only when doing multiple plots with `WMulti`.</span>
<span class="comments">;    wxpos: in, optional, type=integer, default=5</span>
<span class="comments">;       Ignored. Used only for compatibility with cgWindow.</span>
<span class="comments">;    wypos: in, optional, type=integer, default=5</span>
<span class="comments">;       Ignored. Used only for compatibility with cgWindow.</span>
<span class="comments">;    wxsize: in, optional, type=integer, default=640</span>
<span class="comments">;       The x size in device coordinates of the graphics window.</span>
<span class="comments">;    wysize: in, optional, type=integer, default=5</span>
<span class="comments">;       The y size in device coordinates of the the graphics window.</span>
<span class="comments">;    wtitle: in, optional, type=string, default='Resizeable Graphics Window'</span>
<span class="comments">;       Ignored. Used only for compatibility with cgWindow.</span>
<span class="comments">;          </span>
<span class="comments">; :Examples:</span>
<span class="comments">;    Test code::</span>
<span class="comments">;       data = cgDemoData(17)</span>
<span class="comments">;       pixmap = cgPixmap()</span>
<span class="comments">;       cgPlot, data, COLOR='red', /Window</span>
<span class="comments">;       cgPlot, data, PSYM=2, /Overplot, COLOR='dodger blue', /AddCmd</span>
<span class="comments">;       cgPlot, cgDemoData(17), color='olive', linestyle = 2, /Overplot, /AddCmd</span>
<span class="comments">;       pixmap = cgPixmap(/ListCmd)</span>
<span class="comments">;       pixmap = cgPixmap('cgPlot', data, COLOR='purple', /ReplaceCMD, CMDINDEX=0)</span>
<span class="comments">;       pixmap -> Output, 'myplot.png'</span>
<span class="comments">;       </span>
<span class="comments">;    Example using different keyword parameters for the display and PostScript output::</span>
<span class="comments">;    </span>
<span class="comments">;       pixmap = cgPixmap('cgPlot', cgDemoData(1), $</span>
<span class="comments">;             THICK=1.0, XTITLE='Distance (' + cgGreek('mu') + 'm)', $</span>
<span class="comments">;             ALTPS_KEYWORDS={THICK:4.0, XTITLE:'Distance (' + cgGreek('mu', /PS) + 'm)'})</span>
<span class="comments">;           </span>
<span class="comments">;    Example using different positional parameters::</span>
<span class="comments">;    </span>
<span class="comments">;       pixmap = cgPixmap('cgText', 0.20, 0.85, /Normal, 'Line of Text', ALIGNMENT=0.0, $</span>
<span class="comments">;             ALTPS_KEYWORDS={ALIGNMENT:1.0}, ALTPS_PARAMS={P1:0.88})</span>
<span class="comments">;             </span>
<span class="comments">;    Example copying pixmap contents to a normal IDL graphics window::</span>
<span class="comments">;    </span>
<span class="comments">;       Window</span>
<span class="comments">;       pixmap -> Copy</span>
<span class="comments">;           </span>
<span class="comments">; :Copyright:</span>
<span class="comments">;     Copyright (c) 2012, Fanning Software Consulting, Inc.</span>
<span class="comments">;     </span>
<span class="comments">; :History:</span>
<span class="comments">;     Change History::</span>
<span class="comments">;        Written, 7 February 2012, based on cgWindow, by David W. Fanning.</span>
<span class="comments">;        Added WDESTROYOBJECTS keyword. 11 Nov 2012. DWF.</span>
<span class="comments">;-</span>
FUNCTION cgPixmap, $
   command, $                       <span class="comments">; The graphics "command" to execute.</span>
   p1, p2, p3, p4, $                <span class="comments">; The four allowed positional parameters.</span>
   AddCmd=addcmd, $                 <span class="comments">; Set this keyword to add a command to the interface and immediate execute commands.</span>
   AltPS_Keywords=altps_Keywords, $ <span class="comments">; A structure of PostScript alternative keywords and values.</span>
   AltPS_Params=altps_Params, $     <span class="comments">; A structure of PostScript alternative parameters and values. Fields </span>
                                    <span class="comments">; should be "P1", "P2", "P3" or "P4".</span>
   CmdDelay=cmdDelay, $             <span class="comments">; Set this keyword to a value to "wait" before executing the next command.</span>
   CmdIndex=cmdIndex, $             <span class="comments">; Set this keyword to identify the index of the command to manipulate.</span>
   DeleteCmd=deletecmd, $           <span class="comments">; Set the keyword to delete a command.</span>
   ExecuteCmd=executecmd, $         <span class="comments">; Set this keyword to execute the commands in the window.</span>
   Group_Leader = group_leader, $   <span class="comments">; The group leader of the cgPixmap program.</span>
   ListCmd=listCmd, $               <span class="comments">; Set this keyword to list the commands in the window.</span>
   LoadCmd=loadCmd, $               <span class="comments">; Set this keyword to load commands in the window, but not execute them.</span>
   Method=method, $                 <span class="comments">; If set, will use CALL_METHOD instead of CALL_PROCEDURE to execute command.</span>
   ReplaceCmd=replacecmd, $         <span class="comments">; Set this keyword to replace a command in the window.</span>
   WAspect = waspect, $             <span class="comments">; Set the window aspect ratio to this value.</span>
   WBackground = wbackground, $     <span class="comments">; The background color. Set to !P.Background by default.</span>
   WDestroyObjects=wdestroyobjects, $ <span class="comments">; Set this keyword to destroy object parameters upon exit.</span>
   WErase = weraseit, $             <span class="comments">; Set this keyword to erase the display before executing the command.</span>
   WinID=winid, $                   <span class="comments">; Set this keyword to select an cgPixmap.</span>
   WMulti = wmulti, $               <span class="comments">; Set this in the same way !P.Multi is used.   </span>
   WObject=wobject, $               <span class="comments">; The FSC_CMDWindow object. A return value.</span>
   WOXMargin = woxmargin, $         <span class="comments">; Set the !X.OMargin. A two element array.</span>
   WOYMargin = woymargin, $         <span class="comments">; Set the !Y.OMargin. A two element array</span>
   WXPos = wxpos, $                 <span class="comments">; The X offset of the window on the display. The window is tiled if not set.</span>
   WXSize = wxsize, $               <span class="comments">; The X size of the cgPixmap graphics window in pixels. By default: 640.</span>
   WYPos = wypos, $                 <span class="comments">; The Y offset of the window on the display. The window is tiled if not set.</span>
   WYSize = wysize, $               <span class="comments">; The Y size of the cgPixmap graphics window in pixels. By default: 512.</span>
   WTitle = wtitle, $               <span class="comments">; The window title.</span>
    _Extra = extra                   <span class="comments">; Any extra keywords. Usually the "command" keywords.</span>

    Compile_Opt idl2
    
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        void = Error_Message(Traceback=0)
        RETURN, Obj_New()
    ENDIF

    <span class="comments">; Did the user want to execute the commands in the window?</span>
    IF N_Elements(executeCmd) NE 0 THEN BEGIN
   
      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN, Obj_New()
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgPixmap with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    thisWindowStruct.windowObj -> ExecuteCommands
                ENDIF ELSE BEGIN
                    Message, 'The cgPixmap referred to does not exist.'
                ENDELSE
                RETURN, thisWindowStruct.windowObj
           ENDIF ELSE Message, 'A valid cgPixmap does not exist to execute commands in.'
       ENDIF ELSE Message, 'A cgPixmap object not exist to execute commands in.'
    ENDIF
    
    <span class="comments">; Did the user want to list the commands in a cgPixmap?</span>
    IF N_Elements(listCmd) NE 0 THEN BEGIN
   
      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN, Obj_New()
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgPixmap with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    thisWindowStruct.windowObj -> ListCommand
                ENDIF ELSE BEGIN
                    Message, 'The cgPixmap referred to does not exist.'
                ENDELSE
                RETURN, thisWindowStruct.windowObj
           ENDIF ELSE Message, 'A valid cgPixmap does not exist to list commands from.'
       ENDIF ELSE Message, 'A cgPixmap object not exist to list commands from.'
    ENDIF
    
    <span class="comments">; Did the user want to delete a command in the window?</span>
    IF N_Elements(deleteCmd) NE 0 THEN BEGIN
   
      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN, Obj_New()
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgPixmap with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    <span class="comments">; If the cmdIndex is undefined, the last entered command is deleted.</span>
                    thisWindowStruct.windowObj -> DeleteCommand, cmdIndex
                ENDIF ELSE BEGIN
                    Message, 'The cgPixmap referred to does not exist.'
                ENDELSE
                RETURN, thisWindowStruct.windowObj
           ENDIF ELSE Message, 'The cgPixmap object is not a valid window object.'
       ENDIF ELSE Message, 'A cgPixmap object not exist to add a command to.'
   ENDIF

   <span class="comments">; Did the user want to replace a command or commands in the window?</span>
   IF Keyword_Set(replaceCmd) THEN BEGIN
      
      <span class="comments">; Must have a command to replace current command with.</span>
      IF N_Elements(command) EQ 0 THEN Message, 'No replacement command has been specified.'

      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN, Obj_New()
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgPixmap with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    
                    <span class="comments">; Check command components.</span>
                    IF Size(command, /TNAME) NE 'STRING' THEN $
                        Message, 'The first positional argument must be a command string.'
                    IF N_Params() GT 5 THEN $
                        Message, 'The maximum number of positional command parameters allowed is four.'
                    newCommand = Obj_New('cgWindow_Command', COMMAND=command, $
                        P1=p1, P2=p2, P3=p3, P4=p4, KEYWORDS=extra, AltPS_Keywords=altps_Keywords, $
                        AltPS_Params=altps_Params, TYPE=Keyword_Set(method), $
                        DESTROYOBJECTS=Keyword_Set(wdestroyObjects))
                        
                    <span class="comments">; If the cmdIndex is undefined, ALL current commands in the window are replaced.</span>
                    thisWindowStruct.windowObj -> ReplaceCommand, newCommand, cmdIndex, MULTI=wmulti
                    thisWindowStruct.windowObj -> ExecuteCommands
                ENDIF ELSE BEGIN
                    Message, 'The cgPixmap referred to does not exist.'
                ENDELSE
                RETURN, thisWindowStruct.windowObj
           ENDIF ELSE Message, 'A valid cgPixmap does not exist to replace commands with.'
       ENDIF ELSE Message, 'A cgPixmap does not exist to replace commands with.'
    
    ENDIF 
   
   <span class="comments">; Did the user want to load commands without executing them?</span>
   IF Keyword_Set(loadCmd) THEN BEGIN

      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN, Obj_New()
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgPixmap with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    newCommand = Obj_New('cgWindow_Command', COMMAND=command, $
                        P1=p1, P2=p2, P3=p3, P4=p4, KEYWORDS=extra, AltPS_Keywords=altps_Keywords, $
                        AltPS_Params=altps_Params, TYPE=Keyword_Set(method), $
                        DESTROYOBJECTS=Keyword_Set(wdestroyObjects))
                    thisWindowStruct.windowObj -> AddCommand, newCommand, INDEX=cmdIndex
                ENDIF ELSE BEGIN
                    Message, 'The cgPixmap referred to does not exist.'
                ENDELSE
                RETURN, thisWindowStruct.windowObj
           ENDIF ELSE Message, 'A valid cgPixmap does not exist to add a command to.'
       ENDIF ELSE Message, 'A cgPixmap does not exist to add a command to.'
    
    ENDIF 
   
   <span class="comments">; Did the user want to add a command to the window?</span>
   IF Keyword_Set(addCmd) THEN BEGIN

      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN, Obj_New()
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgPixmap with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    newCommand = Obj_New('cgWindow_Command', COMMAND=command, $
                        P1=p1, P2=p2, P3=p3, P4=p4, KEYWORDS=extra, AltPS_Keywords=altps_Keywords, $
                        AltPS_Params=altps_Params, TYPE=Keyword_Set(method), $
                        DESTROYOBJECTS=Keyword_Set(wdestroyObjects))
                    thisWindowStruct.windowObj -> AddCommand, newCommand, INDEX=cmdIndex
                    thisWindowStruct.windowObj -> ExecuteCommands
                ENDIF ELSE BEGIN
                    Message, 'The cgPixmap referred to does not exist.'
                ENDELSE
                RETURN, thisWindowStruct.windowObj
           ENDIF ELSE Message, 'A valid cgPixmap does not exist to add a command to.'
       ENDIF ELSE Message, 'A cgPixmap does not exist to add a command to.'
    
    ENDIF 
   
   <span class="comments">; Otherwise, make the command object.</span>
   wobject = Obj_New('cgPixmapWindow', $
       Command=command, $               <span class="comments">; The graphics "command" to execute.</span>
       P1=p1, P2=p2, P3=p3, P4=p4, $    <span class="comments">; The four allowed positional parameters.</span>
       _Extra = extra, $                <span class="comments">; Any extra keywords. The "command" keywords.</span>
       AltPS_Keywords=altps_Keywords, $ <span class="comments">; A structure of PostScript alternative keywords and values.</span>
       AltPS_Params=altps_Params, $     <span class="comments">; A structure of PostScript alternative parameters and values. Fields </span>
                                        <span class="comments">; should be "P1", "P2", "P3" or "P4".</span>
       Group_Leader = group_leader, $   <span class="comments">; The group leader of the cgPixmap program.</span>
       Method=method, $                 <span class="comments">; If set, will use CALL_METHOD instead of CALL_PROCEDURE to execute command.</span>
       Aspect = waspect, $              <span class="comments">; Set the window aspect ratio to this value.</span>
       Background = wbackground, $      <span class="comments">; The background color. Not used unless set.</span>
       Multi = wmulti, $                <span class="comments">; Set this in the same way !P.Multi is used.</span>
       Erase = weraseit, $              <span class="comments">; Set this keyword to erase the display before executing the command.</span>
       WDestroyObjects=wdestroyobjects, $ <span class="comments">; Set this keyword to destroy object parameters upon exit.</span>
       WXSize = wxsize, $               <span class="comments">; The X size of the cgPixmap graphics window in pixels. By default: 400.</span>
       WYSize = wysize )                <span class="comments">; The Y size of the cgPixmap graphics window in pixels. By default: 400.</span>
        
   <span class="comments">; Return the object, if it is valid.</span>
   IF Obj_Valid(wobject) THEN RETURN, wobject ELSE RETURN, Obj_New()
  
END
</code>
    </div>
  </body>
</html>