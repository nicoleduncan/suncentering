<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:55:48 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>best4.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="best4.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">FUNCTION best4, inputstruct, fidstruct
<span class="comments">;+</span>
<span class="comments">;   :Description:</span>
<span class="comments">;       Chooses best 4 fiducials (closest to disk center)</span>
<span class="comments">;</span>
<span class="comments">;   :Params:</span>
<span class="comments">;       inputstruct: in, required, type=structure</span>
<span class="comments">;           Structure containing all the solar information</span>
<span class="comments">;       fidstruct: in, required, type=structure</span>
<span class="comments">;           Structure containing all the solar information</span>
<span class="comments">;</span>
<span class="comments">;   :Keywords:</span>
<span class="comments">;       </span>
<span class="comments">;-</span>

distances= !null
nsuns = n_elements(inputstruct)
<span class="comments">; Since we're only interested in the best -4-, safe to hardcode the 4 elements of this structure</span>
fidarr = REPLICATE({x:0.,y:0.,subx:0.,suby:0.,id:''},4)
best4 = REPLICATE({fidarr:fidarr,reg:0},nsuns)

for i=0,nsuns-1 do begin
    nfid = N_ELEMENTS(((*(fidstruct[i])).fidarr.subx)[where((*(fidstruct[i])).fidarr.subx) ne 0])
    for j = 0,nfid-1 do begin
        <span class="comments">; For each fiducial, find distance to center of sun</span>
        a = howfar([((*(fidstruct[i])).fidarr)[j].subx +  inputstruct[i].limbxpos - !param.crop_box,((*(fidstruct[i])).fidarr)[j].suby +  inputstruct[i].limbypos - !param.crop_box],[inputstruct[i].limbxpos,inputstruct[i].limbypos])
        <span class="comments">; Populate array with distances</span>
        distances=[distances,a]
    endfor
    <span class="comments">; Sort by closest distance, grab lowest 4</span>
    grabfrom = (((*(fidstruct[i])).fidarr)[sort(distances)])[0:3]
    best4[i].reg = inputstruct[i].reg
    for k =0,3 do begin
        best4[i].fidarr[k].x = grabfrom[k].x
        best4[i].fidarr[k].y = grabfrom[k].y
        best4[i].fidarr[k].subx = grabfrom[k].subx
        best4[i].fidarr[k].suby = grabfrom[k].suby
    endfor
    distances= !null
endfor

RETURN,best4
end
</code>
    </div>
  </body>
</html>