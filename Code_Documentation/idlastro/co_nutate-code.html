<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:21 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>co_nutate.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="co_nutate.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO co_nutate, jd, ra, dec, d_ra, d_dec, eps=eps, d_psi=d_psi, d_eps=d_eps
<span class="comments">;+</span>
<span class="comments">;  NAME:</span>
<span class="comments">;     CO_NUTATE</span>
<span class="comments">;  PURPOSE:</span>
<span class="comments">;     Calculate changes in RA and Dec due to nutation of the Earth's rotation</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;     Calculates necessary changes to ra and dec due to</span>
<span class="comments">;     the nutation of the Earth's rotation axis, as described in Meeus, Chap 23.</span>
<span class="comments">;     Uses formulae from Astronomical Almanac, 1984, and does the calculations</span>
<span class="comments">;     in equatorial rectangular coordinates to avoid singularities at the</span>
<span class="comments">;     celestial poles.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;     CO_NUTATE, jd, ra, dec, d_ra, d_dec, [EPS=, D_PSI =, D_EPS = ]</span>
<span class="comments">; INPUTS</span>
<span class="comments">;    JD: Julian Date [scalar or vector]</span>
<span class="comments">;    RA, DEC : Arrays (or scalars) of the ra and dec's of interest</span>
<span class="comments">;</span>
<span class="comments">;   Note: if jd is a vector, ra and dec MUST be vectors of the same length.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;    d_ra, d_dec: the corrections to ra and dec due to nutation (must then</span>
<span class="comments">;                                be added to ra and dec to get corrected values).</span>
<span class="comments">; OPTIONAL OUTPUT KEYWORDS:</span>
<span class="comments">;    EPS: set this to a named variable that will contain the obliquity of the </span>
<span class="comments">;             ecliptic.</span>
<span class="comments">;    D_PSI: set this to a named variable that will contain the nutation in the</span>
<span class="comments">;           longitude of the ecliptic</span>
<span class="comments">;    D_EPS: set this to a named variable that will contain the nutation in the</span>
<span class="comments">;                       obliquity of the ecliptic</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;    (1) Example 23a in Meeus: On 2028 Nov 13.19 TD the mean position of Theta</span>
<span class="comments">;        Persei is 2h 46m 11.331s 49d 20' 54.54".    Determine the shift in </span>
<span class="comments">;        position due to the Earth's nutation.</span>
<span class="comments">;    </span>
<span class="comments">;        IDL> jd = JULDAY(11,13,2028,.19*24)       ;Get Julian date</span>
<span class="comments">;        IDL> CO_NUTATE, jd,ten(2,46,11.331)*15.,ten(49,20,54.54),d_ra,d_dec    </span>
<span class="comments">;</span>
<span class="comments">;              ====> d_ra = 15.843"   d_dec = 6.217"</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;    NUTATE </span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;    Written  Chris O'Dell, 2002</span>
<span class="comments">;    Vector call to NUTATE   W. Landsman   June 2002</span>
<span class="comments">;-</span>

 if N_Params() LT 4  then begin
     print,'Syntax - CO_NUTATE, jd, ra, dec, d_ra, d_dec, '
     print,'   Output keywords:     [EPS=, D_PSI =, D_EPS = ]'
     return
 endif
 d2r = !dpi/180.
 d2as = !dpi/(180.d*3600.d)
 T = (jd -2451545.0)/36525.0 <span class="comments">; Julian centuries from J2000 of jd.</span>

<span class="comments">; must calculate obliquity of ecliptic</span>
 nutate,jd,d_psi, d_eps 

 eps0 = 23.4392911*3600.d - 46.8150*T - 0.00059*T^2 + 0.001813*T^3
 eps = (eps0 + d_eps)/3600.*d2r <span class="comments">; true obliquity of the ecliptic in radians</span>

<span class="comments">;useful numbers</span>
 ce = cos(eps)
 se = sin(eps)

<span class="comments">; convert ra-dec to equatorial rectangular coordinates</span>
 x = cos(ra*d2r) * cos(dec*d2r)
 y = sin(ra*d2r) * cos(dec*d2r)
 z = sin(dec*d2r)

<span class="comments">; apply corrections to each rectangular coordinate</span>
 x2 = x - (y*ce + z*se)*d_psi * d2as
 y2 = y + (x*ce*d_psi - z*d_eps) * d2as
 z2 = z + (x*se*d_psi + y*d_eps) * d2as

<span class="comments">; convert back to equatorial spherical coordinates</span>
 r = sqrt(x2^2 + y2^2 + z2^2)
 xyproj = sqrt(x2^2 + y2^2)

 ra2 = x2 * 0.d
 dec2= x2 * 0.d

 w1 = where( (xyproj eq 0) AND (z ne 0) )
 w2 = where(xyproj ne 0)

<span class="comments">; Calculate Ra and Dec in RADIANS (later convert to DEGREES)</span>
 if w1[0] ne -1 then begin
	<span class="comments">; places where xyproj=0 (point at NCP or SCP)</span>
	dec2[w1] = asin(z2[w1]/r[w1])
	ra2[w1] = 0.
 endif
 if w2[0] ne -1 then begin
	<span class="comments">; places other than NCP or SCP</span>
	ra2[w2] = atan(y2[w2],x2[w2])
	dec2[w2] = asin(z2[w2]/r[w2])
 endif

                  <span class="comments">; convert to DEGREES</span>

 ra2 = ra2 /d2r
 dec2 = dec2 /d2r

 w = where(ra2 LT 0.)
 if w[0] ne -1 then ra2[w] = ra2[w] + 360.


<span class="comments">; Return changes in ra and dec in arcseconds</span>
 d_ra = (ra2 - ra) * 3600.
 d_dec = (dec2 - dec) * 3600.

END
</code>
    </div>
  </body>
</html>