<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:41 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>headfits.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="headfits.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="HEADFITS:source"></a>function HEADFITS, filename, EXTEN = exten, Compress = compress, $ 
                   ERRMSG = errmsg, SILENT = silent
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       HEADFITS</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Read a FITS (primary or extension) header into a string array.</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       HEADFITS() supports several types of compressed files including </span>
<span class="comments">;       gzip (.gz), Unix compressed (.Z), Bzip2 (.bz2) or FPACK (.fz </span>
<span class="comments">;       http://heasarc.gsfc.nasa.gov/fitsio/fpack/ )</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       Result = HEADFITS(Filename/Fileunit ,[ ERRMSG =, EXTEN= , COMPRESS=, </span>
<span class="comments">;                                            /SILENT ])</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       Filename = String containing the name of the FITS file to be read.</span>
<span class="comments">;                If set to an empty string, then user will be prompted for name.</span>
<span class="comments">;                File names ending in '.gz' are assumed to be gzip'ed compressed</span>
<span class="comments">;                and under Unix file names ending in '.Z' are assumed to be</span>
<span class="comments">;                Unix compressed, and file names ending in .bz2 are assumed to</span>
<span class="comments">;                be bzip2 compressed.    If this default behaviour is not </span>
<span class="comments">;                sufficient then use the COMPRESS keyword.</span>
<span class="comments">;                            or</span>
<span class="comments">;       Fileunit - A scalar integer specifying the unit of an already opened</span>
<span class="comments">;                  FITS file.  The unit will remain open after exiting </span>
<span class="comments">;                  HEADFITS().  There are two possible reasons for choosing </span>
<span class="comments">;                  to specify a unit number rather than a file name:</span>
<span class="comments">;          (1) For a FITS file with many extensions, one can move to the </span>
<span class="comments">;              desired extensions with FXPOSIT() and then use HEADFITS().  This</span>
<span class="comments">;              is more efficient that repeatedly starting at the beginning of </span>
<span class="comments">;              the file.</span>
<span class="comments">;          (2) For reading a FITS file across a Web http: address after opening</span>
<span class="comments">;              the unit with the SOCKET procedure.</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS:</span>
<span class="comments">;      EXTEN  = Either an integer scalar, specifying which FITS extension to </span>
<span class="comments">;               read, or a scalar string specifying the extension name (stored</span>
<span class="comments">;               in the EXTNAME keyword).   For example, to read the header of </span>
<span class="comments">;               the first extension set EXTEN = 1.   Default is to read the </span>
<span class="comments">;               primary FITS header  (EXTEN = 0).    The EXTEN keyword cannot </span>
<span class="comments">;               be used when a unit number is supplied instead of a file name.</span>
<span class="comments">;     COMPRESS - If this keyword is set and non-zero, then treat the file</span>
<span class="comments">;              as compressed.  If 1 assume a gzipped file.   Use IDL's</span>
<span class="comments">;              internal decompression facilities for gzip files, while for </span>
<span class="comments">;              Unix or bzip2 compression spawn off a process to decompress and </span>
<span class="comments">;              use its output as the FITS stream.  If the keyword is not 1, </span>
<span class="comments">;              then use its value as a string giving the command needed for </span>
<span class="comments">;              decompression.   See FXPOSIT for more info.</span>
<span class="comments">;     /SILENT - If set, then suppress any warning messages about invalid </span>
<span class="comments">;              characters in the FITS file.</span>
<span class="comments">; OPTIONAL KEYWORD OUTPUT:</span>
<span class="comments">;       ERRMSG	= If this keyword is present, then any error messages will be</span>
<span class="comments">;                 returned to the user in this parameter rather than</span>
<span class="comments">;                 depending on the MESSAGE routine in IDL.  If no errors are</span>
<span class="comments">;                 encountered, then a null string is returned.  </span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       Result of function = FITS header, string array</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Print the main FITS header of a file 'test.fits' into a string </span>
<span class="comments">;       variable, h</span>
<span class="comments">;</span>
<span class="comments">;       IDL>  print, headfits( 'test.fits')</span>
<span class="comments">;</span>
<span class="comments">;       Print the second extension header of a gzip compressed FITS file</span>
<span class="comments">;       'test.fits.gz'.  Use HPRINT for pretty format</span>
<span class="comments">;</span>
<span class="comments">;       IDL> hprint, headfits( 'test.fits.gz', ext=2)</span>
<span class="comments">;</span>
<span class="comments">;       Read the extension named CALSPEC </span>
<span class="comments">;</span>
<span class="comments">;       IDL> hprint,headfits('test.fits.gz',ext='CALSPEC')</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES CALLED</span>
<span class="comments">;       FXPOSIT(), MRD_HREAD</span>
<span class="comments">;       The version of fxposit.pro must be post- May 2009.</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       adapted by Frank Varosi from READFITS by Jim Wofford, January, 24 1989</span>
<span class="comments">;       Keyword EXTEN added, K.Venkatakrishna, May 1992</span>
<span class="comments">;       Make sure first 8 characters are 'SIMPLE'  W. Landsman October 1993</span>
<span class="comments">;       Check PCOUNT and GCOUNT   W. Landsman    December 1994</span>
<span class="comments">;       Major rewrite, work for Unix gzip files,   W. Landsman  April 1996</span>
<span class="comments">;       Added COMPRESS keyword  W. Landsman   April 2000</span>
<span class="comments">;       Added ERRMSG keyword    W. Landsman   July 2000</span>
<span class="comments">;       Added /SILENT keyword   W. Landsman    December 2000</span>
<span class="comments">;       Option to read a unit number rather than file name W.L    October 2001</span>
<span class="comments">;       Test output status of MRD_HREAD call October 2003 W. Landsman</span>
<span class="comments">;       Allow extension to be specified by name Dec 2006 W. Landsman</span>
<span class="comments">;       No need to uncompress FPACK compressed files  May 2009 W. Landsman</span>
<span class="comments">;       Use V6.0 notation   W.L.   Feb. 2011  </span>
<span class="comments">;-</span>
 On_error,2
 compile_opt idl2

 if N_params() LT 1 then begin
     print,'Syntax - header = headfits( filename,[ EXTEN=, ERRMSG=, ' + $
                   '/SILENT, COMPRESS= ])'
     return, -1
 endif

  printerr = ~arg_present(errmsg) 
  errmsg = ''
  if ~keyword_set(exten) then exten = 0

  unitsupplied = size(filename,/TNAME) NE 'STRING'
  if unitsupplied then unit = filename else begin 
     unit = FXPOSIT( filename, exten, errmsg = errmsg, $
                   /READONLY,compress = compress, SILENT=silent,/headeronly)
     if unit EQ -1 then begin 
          if printerr then  $
	         message,'ERROR - ' + errmsg,/CON 
       return,-1
     endif
     if eof(unit) then begin
        free_lun,unit
        message = 'Extension past EOF'
        if ~printerr then errmsg = message else $
               message,'ERROR - ' + message,/CON 
        return,-1
     endif
  endelse
  
  MRD_HREAD, unit, header, status, SILENT = silent
  if ~unitsupplied then free_lun, unit
  if status LT 0 then begin
         if N_elements(errmsg) GT 0 then errmsg = !ERROR_STATE.MSG else $
          message,'ERROR - ' + !ERROR_STATE.MSG,/CON 
          return, -1
  endif else return, header	  
  end
</code>
    </div>
  </body>
</html>