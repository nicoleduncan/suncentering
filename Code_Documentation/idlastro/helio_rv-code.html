<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:41 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>helio_rv.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="helio_rv.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="helio_rv:source"></a>function helio_rv,HJD,T,P,V0,K,e,omega
<span class="comments">;+ </span>
<span class="comments">; NAME:</span>
<span class="comments">;    HELIO_RV</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     Return the heliocentric radial velocity of a spectroscopic binary</span>
<span class="comments">;</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;    This function will return the heliocentric radial velocity of a </span>
<span class="comments">;    spectroscopic binary star at a given heliocentric date </span>
<span class="comments">;    given its orbit.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;</span>
<span class="comments">;  Result = HELIO_RV ( JD ,T ,Period ,Gamma , K, [,e ,Omega ] )</span>
<span class="comments">;</span>
<span class="comments">; INPUT:</span>
<span class="comments">;</span>
<span class="comments">; JD            - Time of observation</span>
<span class="comments">; T             - Time of periastron passage (max. +ve velocity</span>
<span class="comments">;                 for circular orbits), same time system as JD</span>
<span class="comments">; Period        - the period in same units as JD</span>
<span class="comments">; Gamma         - systemic velocity</span>
<span class="comments">; K             - velocity semi-amplitude in the same units as Gamma.</span>
<span class="comments">; e             - eccentricity of the orbit, default is 0.</span>
<span class="comments">; Omega         - longitude of periastron in degrees. Must be specified for</span>
<span class="comments">;                 eccentric orbits.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;</span>
<span class="comments">;  The predicted heliocentric radial velocity in the same units as Gamma</span>
<span class="comments">;  for the date(s) specified by Reduced_HJD.</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;</span>
<span class="comments">;  The user should ensure consistency with all time systems being</span>
<span class="comments">;  used (i.e. JD and T should be in the same units and time system).</span>
<span class="comments">;  Generally, users should reduce large time values by subtracting </span>
<span class="comments">;  a large constant offset, which may improve numerical accuracy.</span>
<span class="comments">;  </span>
<span class="comments">;  If using the the routines JULDATE and HELIO_JD, the reduced HJD</span>
<span class="comments">;  time system must be used throughtout.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLES:</span>
<span class="comments">;</span>
<span class="comments">; Example 1</span>
<span class="comments">;</span>
<span class="comments">;  What was the heliocentric radial velocity of the primary component of HU Tau</span>
<span class="comments">; at 1730 UT 25 Oct 1994?</span>
<span class="comments">; </span>
<span class="comments">; IDL> juldate ,[94,10,25,17,30],JD                 ;Get Geocentric julian date</span>
<span class="comments">; IDL> hjd = helio_jd(jd,ten(04,38,16)*15.,ten(20,41,05)) ; Convert to HJD</span>
<span class="comments">; IDL> print, helio_rv(hjd,46487.5303D,2.0563056D,-6.0,59.3)</span>
<span class="comments">;      -62.965569</span>
<span class="comments">;</span>
<span class="comments">; NB. 1. The routines JULDATE and HELIO_JD return a reduced HJD (HJD - 2400000)</span>
<span class="comments">;        and so T and P must be specified in the same fashion.</span>
<span class="comments">;     2. The user should be careful to use double precision format to specify</span>
<span class="comments">;        T and P to sufficient precision where necessary. </span>
<span class="comments">; </span>
<span class="comments">; Example 2</span>
<span class="comments">;</span>
<span class="comments">;  Plot two cycles of an eccentric orbit, e=0.6, omega=45 for both</span>
<span class="comments">;  components of a binary star</span>
<span class="comments">;</span>
<span class="comments">; IDL> phi=findgen(100)/50.0             ; Generates 100 phase points</span>
<span class="comments">; IDL> plot, phi,helio_rv(phi,0,1,0,100,0.6,45),yrange=[-100,150]</span>
<span class="comments">; IDL> oplot, phi,helio_rv(phi,0,1,0,50,0.6,45+180)</span>
<span class="comments">; </span>
<span class="comments">; This illustrates both the use of arrays to perform multiple calculations</span>
<span class="comments">; and generating radial velocities for a given phase by setting T=0 and P=1.</span>
<span class="comments">; Note also that omega has been changed by 180 degrees for the orbit of the</span>
<span class="comments">; second component  (the same 'trick' can be used for circular orbits).</span>
<span class="comments">;</span>
<span class="comments">; </span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;</span>
<span class="comments">;  Written by:  Pierre Maxted CUOBS, October, 1994</span>
<span class="comments">;</span>
<span class="comments">;  Circular orbits handled by setting e=0 and omega=0 to allow</span>
<span class="comments">;  binary orbits to be handled using omega and omega+180.</span>
<span class="comments">;                                                      Pierre Maxted,Feb 95</span>
<span class="comments">;  BUG - omega was altered by the routine - corrected Feb 95,Pierre Maxted</span>
<span class="comments">;  Iteration for E changed to that  given by Reidel , Feb 95,Pierre Maxted</span>
<span class="comments">;  /SINGLE keyword removed.                           May 96,Pierre Maxted</span>
<span class="comments">;;       </span>
<span class="comments">;  Removed limitation of time system on HJD, C. Markwardt, 2011-04-15</span>
<span class="comments">;</span>
<span class="comments">;  Change convergence test from relative to absolute precision on E</span>
<span class="comments">;                                                     Pierre Maxted, Apr 12</span>
<span class="comments">;-</span>
<span class="comments">;</span>
<span class="comments">; </span>
  ON_ERROR, 2   <span class="comments">; Return to caller</span>
  compile_opt idl2
<span class="comments">;</span>
<span class="comments">; Check suitable no. of parameters have been entered.</span>
<span class="comments">;</span>
  if N_params() ne 5 and N_params() ne 7 then begin
   print,'Syntax - Result = HELIO_RV (JD ,T ,Period ,Gamma, K)'
   print,'         OR'
   print,'         Result = HELIO_RV (JD ,T ,Period ,Gamma, K ,e ,Omega)'
   print,'Further help - type doc_library,"HELIO_RV".'
 endif else begin
<span class="comments">;</span>
<span class="comments">; Circular orbits</span>
<span class="comments">;</span>
  if ~keyword_set(omega) and ~keyword_set(e) then begin
   e = 0.0
   omega = 0.0
  endif 
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; Calculate the approximate eccentric anomaly, E1, via the mean </span>
<span class="comments">; anomaly, M.</span>
<span class="comments">; (from Heintz DW, "Double stars", Reidel, 1978)</span>
<span class="comments">;</span>
 M=2.D*!dpi*( (HJD-T)/P MOD 1.)
 E1=M + e*sin(M)  + ((e^2)*sin(2.0D*M)/2.0D)
<span class="comments">;</span>
<span class="comments">; Now refine this estimate using  formulae given by Reidel.</span>
<span class="comments">;</span>
 repeat begin
  E0=E1 
  M0 = E0 - e*sin(E0)
  E1 = E0 + (M-M0)/(1.0 - e*cos(E0))
 endrep until max(abs(E1-E0)) lt 1D-8
<span class="comments">;</span>
<span class="comments">; Now calculate nu</span>
<span class="comments">;</span>
 nu=2.0D*atan(sqrt((1.D0 + e)/(1.D - e))*tan(E1/2.0D))
<span class="comments">; nu=nu+((nu&lt;0D)*(2D*!dpi))</span>
<span class="comments">;</span>
<span class="comments">; Can now calculate radial velocities</span>
<span class="comments">;</span>
 rv = (K*(cos(nu+!dtor*omega) + (e*cos(!dtor*omega))))+V0
 return ,rv
<span class="comments">;</span>
<span class="comments">;</span>
 endelse
<span class="comments">;</span>
<span class="comments">;</span>
 end

</code>
    </div>
  </body>
</html>