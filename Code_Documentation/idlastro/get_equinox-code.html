<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:39 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>get_equinox.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="get_equinox.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">FUNCTION GET_EQUINOX,HDR,CODE, ALT = alt                                       
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       GET_EQUINOX</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Return the equinox value from a FITS header.  </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Checks for 4 possibilities:</span>
<span class="comments">;</span>
<span class="comments">;       (1)  If the EQUINOX keyword is found and has a numeric value, then this</span>
<span class="comments">;               value is returned</span>
<span class="comments">;       (2)  If the EQUINOX keyword has the values 'J2000' or 'B1950', then</span>
<span class="comments">;               either 2000. or 1950. is returned.</span>
<span class="comments">;       (3)  If the EQUINOX keyword is not found, then GET_EQUINOX will return</span>
<span class="comments">;               the EPOCH keyword value.   This usage of EPOCH is disparaged.</span>
<span class="comments">;       (4)  If neither EQUINOX no EPOCH is found, then the RADESYS keyword </span>
<span class="comments">;               (or the deprecated RADECSYS keyword) is checked.   If the value </span>
<span class="comments">;               is 'ICRS' or 'FK5' then 2000 is is returned, if it is 'FK4' then</span>
<span class="comments">;               1950 is returned.</span>
<span class="comments">;</span>
<span class="comments">;       According Calabretta & Greisen (2002, A&A, 395, 1077) the EQUINOX should</span>
<span class="comments">;       be written as a numeric value, as in format (1).   However, in older </span>
<span class="comments">;       FITS headers, the EQUINOX might have been written using formats (2) or </span>
<span class="comments">;       (3).      </span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       Year = GET_EQUINOX( Hdr, [ Code ] )   </span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       Hdr - FITS Header, string array, will be searched for the EQUINOX</span>
<span class="comments">;               (or EPOCH) keyword.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       Year - Year of equinox in FITS header, numeric scalar</span>
<span class="comments">; OPTIONAL OUTPUT:</span>
<span class="comments">;       Code - Result of header search, scalar</span>
<span class="comments">;               -1 - EQUINOX, EPOCH or RADECSYS keyword not found in header</span>
<span class="comments">;               0 - EQUINOX found as a numeric value</span>
<span class="comments">;               1 - EPOCH keyword used for equinox (not recommended)</span>
<span class="comments">;               2 - EQUINOX found as  'B1950'</span>
<span class="comments">;               3 - EQUINOX found as  'J2000'</span>
<span class="comments">;               4 - EQUINOX derived from value of RADESYS or RADECSYS keyword</span>
<span class="comments">;                   'ICRS', 'FK5' ==> 2000,  'FK4' ==> 1950</span>
<span class="comments">; OPTIONAL KEYWORD INPUT: </span>
<span class="comments">;       ALT -  single character 'A' through 'Z' or ' ' specifying which  </span>
<span class="comments">;             astrometry system to use in the FITS header.    The default is</span>
<span class="comments">;             to use the primary astrometry or ALT = ''.   If /ALT is set, </span>
<span class="comments">;             then this is equivalent to ALT = 'A'.   See Section 3.3 of </span>
<span class="comments">;             Greisen & Calabretta (2002, A&A, 395, 1061) for information about</span>
<span class="comments">;             alternate astrometry keywords.</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       ZPARCHECK, SXPAR()  </span>
<span class="comments">; NOTES:</span>
<span class="comments">;       Technically, RADESYS = 'ICRS' does not specify any equinox, but can be </span>
<span class="comments">;       assumed to be equivalent to J2000 for all but highest-precision work.      </span>
<span class="comments">; REVISION HISTORY:                                               </span>
<span class="comments">;       Written  W. Landsman        STX              March, 1991</span>
<span class="comments">;       Don't use !ERR          W. Landsman   February 2000</span>
<span class="comments">;       N = 1 for check of EPOCH keyword, not 0 S. Ott July 2000</span>
<span class="comments">;       Added ALT keyword, recognize RADESYS along with deprecated RADECSYS</span>
<span class="comments">;              W. Landsman   Sep 2011</span>
<span class="comments">;-     </span>
 compile_opt idl2
 On_error,2
 
 if N_elements(alt) EQ 0 then alt = '' else if (alt EQ '1') then alt = 'A' $
    else alt = strupcase(alt)
 zparcheck, 'GET_EQUINOX', hdr, 1, 7, 1, 'FITS Header array'
 code = -1                      <span class="comments">;Not found yet</span>

 year = SXPAR( Hdr, 'EQUINOX' + alt, Count = n )    <span class="comments">;YEAR of Initial equinox</span>
 if n EQ 0 then begin

     year = sxpar( Hdr, 'EPOCH', Count = n )  <span class="comments">;Check EPOCH if EQUINOX not found</span>
     if n EQ 1 then code = 1 else begin       <span class="comments">;EPOCH keyword found</span>
            
     sys = sxpar( Hdr, 'RADESYS'+alt, Count = n)
     if n EQ 0 then sys = sxpar( Hdr, 'RADECSYS', Count = n) 
              if n EQ 1 then begin
                  code = 4 
                  case strmid(sys,0,3) of
                  'ICR': year = 2000
                  'FK5': year = 2000
                  'FK4': year = 1950
                  else: 
                  endcase
               endif
         endelse
 endif else begin  

    tst = strmid(year,0,1)     <span class="comments">;Check for 'J2000' or 'B1950' values</span>
    if (tst EQ 'J') || (TST EQ 'B') then begin 
           year = float(strmid(year,1,strlen(year)-1) )
           if tst EQ 'J' then code = 3
           if tst EQ 'B' then code = 2 
    endif else code = 0

 endelse     

 return, year
 end

</code>
    </div>
  </body>
</html>