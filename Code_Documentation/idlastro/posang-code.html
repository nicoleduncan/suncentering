<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:56 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>posang.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="posang.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO POSANG,u,ra1,dc1,ra2,dc2,angle
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       POSANG</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Computes rigorous position angle of source 2 relative to source 1</span>
<span class="comments">;       </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Computes the rigorous position angle of source 2 (with given RA, Dec) </span>
<span class="comments">;       using source 1 (with given RA, Dec) as the center.</span>
<span class="comments">; </span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       POSANG, U, RA1, DC1, RA2, DC2, ANGLE</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       U    -- Describes units of inputs and output:</span>
<span class="comments">;               0:  everything radians</span>
<span class="comments">;               1:  RAx in decimal hours, DCx in decimal</span>
<span class="comments">;                       degrees, ANGLE in degrees</span>
<span class="comments">;       RA1  -- Right ascension of point 1</span>
<span class="comments">;       DC1  -- Declination of point 1</span>
<span class="comments">;       RA2  -- Right ascension of point 2</span>
<span class="comments">;       DC2  -- Declination of point 2</span>
<span class="comments">;</span>
<span class="comments">;   OUTPUTS:</span>
<span class="comments">;       ANGLE-- Angle of the great circle containing [ra2, dc2] from</span>
<span class="comments">;               the meridian containing [ra1, dc1], in the sense north</span>
<span class="comments">;               through east rotating about [ra1, dc1].  See U above </span>
<span class="comments">;               for units.</span>
<span class="comments">;</span>
<span class="comments">;   PROCEDURE:</span>
<span class="comments">;       The "four-parts formula" from spherical trig (p. 12 of Smart's</span>
<span class="comments">;       Spherical Astronomy or p. 12 of Green' Spherical Astronomy).</span>
<span class="comments">;</span>
<span class="comments">;   EXAMPLE:</span>
<span class="comments">;       For the star 56 Per, the Hipparcos catalog gives a position of </span>
<span class="comments">;       RA = 66.15593384, Dec = 33.94988843 for component A, and </span>
<span class="comments">;       RA = 66.15646079, Dec =  33.96100069 for component B.   What is the</span>
<span class="comments">;       position angle of B relative to A?</span>
<span class="comments">;</span>
<span class="comments">;       IDL> RA1 = 66.15593384/15.d   & DC1 = 33.95988843</span>
<span class="comments">;       IDL> RA2 = 66.15646079/15.d   & DC2 = 33.96100069</span>
<span class="comments">;       IDL> posang,1,ra1,dc1,ra2,dc2, ang</span>
<span class="comments">;            will give the answer of ang = 21.4 degrees</span>
<span class="comments">;   NOTES:</span>
<span class="comments">;       (1) If RA1,DC1 are scalars, and RA2,DC2 are vectors, then ANGLE is a</span>
<span class="comments">;       vector giving the position angle between each element of RA2,DC2 and </span>
<span class="comments">;       RA1,DC1.   Similarly, if RA1,DC1 are vectors, and RA2, DC2 are scalars,</span>
<span class="comments">;       then DIS is a vector giving the position angle of each element of RA1, </span>
<span class="comments">;       DC1 and RA2, DC2.    If both RA1,DC1 and RA2,DC2 are vectors then ANGLE </span>
<span class="comments">;       is a vector giving the position angle between each element of RA1,DC1 </span>
<span class="comments">;       and the corresponding element of RA2,DC2.    If then vectors are not the</span>
<span class="comments">;       same length, then excess elements of the longer one will be ignored.</span>
<span class="comments">;</span>
<span class="comments">;       (2) Note that POSANG is not commutative -- the position angle between</span>
<span class="comments">;        A and B is theta, then the position angle between B and A is 180+theta </span>
<span class="comments">;   PROCEDURE CALLS:</span>
<span class="comments">;        ISARRAY()</span>
<span class="comments">;   HISTORY:</span>
<span class="comments">;       Modified from GCIRC, R. S. Hill, RSTX, 1 Apr. 1998</span>
<span class="comments">;       Use V6.0 notation W.L. Mar 2011</span>
<span class="comments">;</span>
<span class="comments">;-</span>
 On_error,2                            <span class="comments">;Return to caller</span>
 compile_opt idl2

 npar = N_params()
 IF (npar lt 5)  THEN BEGIN
   print,'Calling sequence:  POSANG,U,RA1,DC1,RA2,DC2,ANGLE'
   print,'   U = 0  ==> Everything in radians'
   print, $
   '   U = 1  ==> RAx decimal hours, DCx decimal degrees, ANGLE degrees'
   RETURN
ENDIF

scalar = (~isarray(ra1) ) && (~isarray(ra2) )
IF scalar THEN BEGIN
    IF (ra1 eq ra2) && (dc1 eq dc2) THEN BEGIN
       angle = 0.0d0
       IF npar eq 5 THEN $
           print,'Positions are equal:  ', ra1, dc1
       RETURN
    ENDIF
ENDIF

d2r    = !DPI/180.0d0
h2r    = !DPI/12.0d0

CASE u OF
   0:  BEGIN                    
          rarad1 = ra1
          rarad2 = ra2
          dcrad1 = dc1
          dcrad2 = dc2
       END
   1:  BEGIN                    
          rarad1 = ra1*h2r
          rarad2 = ra2*h2r
          dcrad1 = dc1*d2r
          dcrad2 = dc2*d2r
       END
   ELSE:  MESSAGE, $
                'U must be 0 for radians or 1 for hours, degrees, arcsec'
ENDCASE

radif  = rarad2-rarad1
angle  = atan(sin(radif),cos(dcrad1)*tan(dcrad2)-sin(dcrad1)*cos(radif))

IF (u ne 0) THEN angle = angle/d2r  

IF (npar eq 5) && (scalar) THEN BEGIN
    IF (u ne 0) && (abs(angle) ge 0.1) $
       THEN fmt = '(F14.8)' $
       ELSE fmt = '(E15.8)'
    units = (u ne 0) ? ' degrees' : ' radians'   
    print,'Position angle of target 2 about target 1 is ' $
        + string(angle,format=fmt) + units
ENDIF

RETURN
END                   
</code>
    </div>
  </body>
</html>