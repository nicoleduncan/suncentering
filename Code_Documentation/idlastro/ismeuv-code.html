<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:43 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ismeuv.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ismeuv.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="ismeuv:source"></a>function ismeuv,wave,Hcol,HeIcol,HeIIcol,Fano=fano
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       ISMEUV</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Compute the continuum interstellar EUV optical depth </span>
<span class="comments">;</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       The EUV optical depth is computed from the photoionization of</span>
<span class="comments">;       hydrogen and helium.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       tau = ISMEUV( wave, Hcol, [ HeIcol, HeIIcol, /Fano ]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       wave - Vector of wavelength values (in Angstroms).   Useful range is</span>
<span class="comments">;               40 - 912 A; at shorter wavelengths metal opacity should be</span>
<span class="comments">;               considered, at longer wavelengths there is no photoionization.</span>
<span class="comments">;       Hcol - Scalar specifying interstellar hydrogen column density in cm-2.</span>
<span class="comments">;                 Typical values are 1E17 to 1E20.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       tau - Vector giving resulting optical depth, same number of elements </span>
<span class="comments">;               as wave, non-negative values.   To obtain the attenuation of </span>
<span class="comments">;               an input spectrum, multiply by exp(-tau).</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;       HeIcol - Scalar specifying neutral helium column density in cm-2.    </span>
<span class="comments">;               Default is 0.1*Hcol (10% of hydrogen column)</span>
<span class="comments">;       HeIIcol - Scalar specifying ionized helium column density in cm-2</span>
<span class="comments">;               Default is 0 (no HeII)</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS:</span>
<span class="comments">;       /FANO - If this keyword is set and non-zero, then the 4 strongest </span>
<span class="comments">;               auto-ionizing resonances of He I are included.   The shape </span>
<span class="comments">;               of these resonances is given by a Fano profile - see Rumph, </span>
<span class="comments">;               Bowyer, & Vennes 1994, AJ, 107, 2108.  If these resonances are</span>
<span class="comments">;               included then the input wavelength vector should have</span>
<span class="comments">;               a fine (>~0.01 A) grid between 190 A and 210 A, since the</span>
<span class="comments">;               resonances are very narrow.</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       (1) One has a model EUV spectrum with wavelength, w (in Angstroms) and </span>
<span class="comments">;       flux,f .  Plot the model flux after attenuation by 1e18 cm-2 of HI, </span>
<span class="comments">;       with N(HeI)/N(HI) = N(HeII)/N(HI) = 0.05</span>
<span class="comments">;</span>
<span class="comments">;       IDL> Hcol = 1e18</span>
<span class="comments">;       IDL> plot, w, f*exp(-ismeuv(w, Hcol, .05*Hcol, .05*Hcol))</span>
<span class="comments">;</span>
<span class="comments">;       (2)  Plot the cross-section of HeI from 180 A to 220 A for 1e18 cm-2</span>
<span class="comments">;               of HeI, showing the auto-ionizing resonances.   This is </span>
<span class="comments">;               Figure 1 in Rumph et al. (1994)</span>
<span class="comments">;</span>
<span class="comments">;       IDL> w = 180 + findgen(40000)*0.001        ;Need a fine wavelength grid</span>
<span class="comments">;       IDL> plot, w, ismeuv(w, 0, 1e18, /Fano)          </span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       (1) The more complete program  ismtau.pro at </span>
<span class="comments">;           http://hea-www.harvard.edu/PINTofALE/pro/ extends this work</span>
<span class="comments">;           to shorter wavelengths and includes metal and molecular hydrogen</span>
<span class="comments">;           opacities</span>
<span class="comments">;       (2) This program only compute continuum opacities, and for example,</span>
<span class="comments">;           the He ionization edges at 504 A  and 228 A are blurred by</span>
<span class="comments">;           converging line absorptions (Dupuis et al. 1995. ApJ, 455, 574)</span>
<span class="comments">;           </span>
<span class="comments">; HISTORY:</span>
<span class="comments">;       Written,    W. Landsman                  October, 1994</span>
<span class="comments">;       Adapted from ism.c at anonymous ftp site cea-ftp.cea.berkeley.edu</span>
<span class="comments">;       by Pat Jelinsky, Todd Rumph & others.</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Avoid underflow messages, support double prec.  W. Landsman October 2003</span>
<span class="comments">;-</span>
 On_error,2

 if N_params() LT 2 then begin
        print,'Syntax - tau = ISMEUV( wave, Hcol, [ HeIcol, HeIIcol, /FANO] )'
        return,-1
 endif

 if N_elements( HeIcol) EQ 0 then HeIcol = 0.1*Hcol
 if N_elements( HeIIcol) EQ 0 then HeIIcol = 0.0*Hcol

<span class="comments">; Compute attenuation due to photoionization of hydrogen.   See Spitzer</span>
<span class="comments">; (Physical processes in the interstellar medium), page 105</span>

 if (size(wave,/TNAME) EQ 'DOUBLE') then begin 
          pi = !dpi 
          double  = 1b
  endif else  begin 
          pi = !pi
          double = 0b
 endelse
 ratio = wave/911.75
 tauh = wave*0.
 good = where(ratio LT 1, Ngood)
 minexp = alog((machar(double=double)).xmin) <span class="comments">;Min exponent to avoid underflow</span>
 if Ngood GT 0 then begin
        r = ratio[good]
        z = sqrt( r/(1.0-r) )
        denom = replicate(1.0, Ngood)
        y = -2.*pi*z
        good1 = where(y GT minexp, Ngood1)
             if Ngood1 GT 0 then denom[good1] = (1.0 - exp(y[good1]))        
        tauh[good] = Hcol * 3.44e-16 * (r^4)*exp(-4.0*z*atan(1/z)) /  denom
  endif

<span class="comments">; Now compute photoionization cross-section of He II; just like hydrogen but </span>
<span class="comments">; with a nuclear charge Z = 2</span>

 tauheII = wave*0.
 ratio = 4. * wave/911.75
 good = where(ratio LT 1, Ngood)
 if Ngood GT 0 then begin
        r = ratio[good]
        z = sqrt( r/(1.0-r) )
        denom = replicate(1.0, Ngood)
        y = -2*PI*z
        good1 = where(y GT minexp, Ngood1)
           if Ngood1 GT 0 then denom[good1] = 1.0 - exp(y[good1])*4.
        tauheII[good] = heiicol * 3.44e-16 * (r^4)*exp(-4.0*z*atan(1/z)) / denom
            
 endif

<span class="comments">; Polynomial coefficients for He I cross-section taken from experimental</span>
<span class="comments">; data by Marr & West (1976)</span>
<span class="comments">; c1 for wavelengths greater than 46 A</span>

 c1 = [-2.953607d+01, 7.083061d+00, 8.678646d-01,-1.221932d+00,  $
       4.052997d-02, 1.317109d-01, -3.265795d-02, 2.500933d-03 ]

<span class="comments">; c2 for wavelengths less than 46 A.</span>

 c2 = [ -2.465188d+01, 4.354679d+00, -3.553024d+00, 5.573040d+00, $
       -5.872938d+00, 3.720797d+00, -1.226919d+00, 1.576657d-01 ]

<span class="comments">; parameters of autoionization resonances for 4 strongest He I resonances</span>
<span class="comments">; Numbers are from Oza (1986), Phys Rev. A, 33, 824 -- nu and gamma</span>
<span class="comments">; and Fernley et al., J. Phys. B., 20, 6457, 1987 -- q</span>

        q  = [2.81d, 2.51d, 2.45d, 2.44d ]
        nu = [1.610d, 2.795d, 3.817d, 4.824d ]
        fano_gamma = [2.64061d-03, 6.20116d-04, 2.56061d-04, 1.320159d-04 ]
        esubi = 3.0d - 1.0d/nu^2 + 1.807317d

 tauHeI = wave*0.
 good = where( wave LT 503.97, Ngood )
 if Ngood GT 0 then begin

        x = alog10(wave[good])
        y = x*0.

        good1 = where(wave LT 46.0, Ngood1 )
        if Ngood1 GT 0 then y[good1] = poly( x[good1], c2)      

        good2 = where(wave GE 46.0, Ngood2 )
        if Ngood2 GT 0 then begin 

                y[good2] = poly( x[good2], c1)

        if keyword_set(fano) then begin
                epsilon = 911.2671/wave
                for i=0,3 do begin       <span class="comments">;Loop over first four HeI resonances</span>
                        x = 2.0 * ((epsilon-esubi[i] )/ fano_gamma[i] ) 
                        y = y + alog10( (x - q[i])^2/ (1 + x*x ) )
                endfor
        endif
        endif

  tauHeI[good] = HeIcol * 10^y

 endif

<span class="comments">; Total optical depth from HI, HeII and HeI</span>

 return, tauH + tauHeII + tauHeI

 end
</code>
    </div>
  </body>
</html>