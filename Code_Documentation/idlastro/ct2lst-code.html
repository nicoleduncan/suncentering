<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:23 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ct2lst.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ct2lst.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO CT2LST, lst, lng, tz, tme, day, mon, year
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;     CT2LST</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     To convert from Local Civil Time to Local Mean Sidereal Time.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;     CT2LST, Lst, Lng, Tz, Time, [Day, Mon, Year] </span>
<span class="comments">;                       or</span>
<span class="comments">;     CT2LST, Lst, Lng, dummy, JD</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;     Lng  - The longitude in degrees (east of Greenwich) of the place for </span>
<span class="comments">;            which the local sidereal time is desired, scalar.   The Greenwich </span>
<span class="comments">;            mean sidereal time (GMST) can be found by setting Lng = 0.</span>
<span class="comments">;     Tz  - The time zone of the site in hours, positive East  of the Greenwich</span>
<span class="comments">;           meridian (ahead of GMT).  Use this parameter to easily account </span>
<span class="comments">;           for Daylight Savings time (e.g. -4=EDT, -5 = EST/CDT), scalar</span>
<span class="comments">;           This parameter is not needed (and ignored) if Julian date is </span>
<span class="comments">;           supplied.    ***Note that the sign of TZ was changed in July 2008</span>
<span class="comments">;           to match the standard definition.*** </span>
<span class="comments">;     Time or JD  - If more than four parameters are specified, then this is </span>
<span class="comments">;               the time of day of the specified date in decimal hours.  If </span>
<span class="comments">;               exactly four parameters are specified, then this is the </span>
<span class="comments">;               Julian date of time in question, scalar or vector</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;      Day -  The day of the month (1-31),integer scalar or vector</span>
<span class="comments">;      Mon -  The month, in numerical format (1-12), integer scalar or vector</span>
<span class="comments">;      Year - The 4 digit year (e.g. 2008), integer scalar or vector</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       Lst   The Local Sidereal Time for the date/time specified in hours.</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;       If specified, the date should be in numerical form.  The year should</span>
<span class="comments">;       appear as yyyy.</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;       The Julian date of the day and time is question is used to determine</span>
<span class="comments">;       the number of days to have passed since 0 Jan 2000.  This is used</span>
<span class="comments">;       in conjunction with the GST of that date to extrapolate to the current</span>
<span class="comments">;       GST; this is then used to get the LST.    See Astronomical Algorithms</span>
<span class="comments">;       by Jean Meeus, p. 84 (Eq. 11-4) for the constants used.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Find the Greenwich mean sidereal time (GMST) on 2008 Jul 30 at 15:53 pm</span>
<span class="comments">;       in Baltimore, Maryland (longitude=-76.72 degrees).   The timezone is </span>
<span class="comments">;       EDT or tz=-4</span>
<span class="comments">;</span>
<span class="comments">;       IDL> CT2LST, lst, -76.72, -4,ten(15,53), 30, 07, 2008</span>
<span class="comments">;</span>
<span class="comments">;               ==> lst =  11.356505  hours  (= 11h 21m 23.418s)</span>
<span class="comments">;</span>
<span class="comments">;       The Web site  http://tycho.usno.navy.mil/sidereal.html contains more</span>
<span class="comments">;       info on sidereal time, as well as an interactive calculator.</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       jdcnv - Convert from year, month, day, hour to julian date</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;     Adapted from the FORTRAN program GETSD by Michael R. Greason, STX, </span>
<span class="comments">;               27 October 1988.</span>
<span class="comments">;     Use IAU 1984 constants Wayne Landsman, HSTX, April 1995, results </span>
<span class="comments">;               differ by about 0.1 seconds  </span>
<span class="comments">;     Longitudes measured *east* of Greenwich   W. Landsman    December 1998</span>
<span class="comments">;     Time zone now measure positive East of Greenwich W. Landsman July 2008</span>
<span class="comments">;     Remove debugging print statement  W. Landsman April 2009</span>
<span class="comments">;-</span>
 On_error,2
 compile_opt idl2

 if N_params() LT 3 THEN BEGIN
        print,'Syntax - CT2LST, Lst, Lng, Tz, Time, Day, Mon, Year' 
        print,'                 or'
        print,'         CT2LST, Lst, Lng, Tz, JD'
        return
 endif
<span class="comments">;                            If all parameters were given, then compute</span>
<span class="comments">;                            the Julian date; otherwise assume it is stored</span>
<span class="comments">;                            in Time.</span>
<span class="comments">;</span>

 IF N_params() gt 4 THEN BEGIN
   time = tme - tz
   jdcnv, year, mon, day, time, jd 

 ENDIF ELSE jd = double(tme)
<span class="comments">;</span>
<span class="comments">;                            Useful constants, see Meeus, p.84</span>
<span class="comments">;</span>
 c = [280.46061837d0, 360.98564736629d0, 0.000387933d0, 38710000.0 ]
 jd2000 = 2451545.0D0
 t0 = jd - jd2000
 t = t0/36525
<span class="comments">;</span>
<span class="comments">;                            Compute GST in seconds.</span>
<span class="comments">;</span>
 theta = c[0] + (c[1] * t0) + t^2*(c[2] - t/ c[3] )
<span class="comments">;</span>
<span class="comments">;                            Compute LST in hours.</span>
<span class="comments">;</span>
 lst = ( theta + double(lng))/15.0d
 neg = where(lst lt 0.0D0, n)
 if n gt 0 then lst[neg] = 24.D0 + (lst[neg] mod 24)
 lst = lst mod 24.D0
<span class="comments">;   </span>
 RETURN
 END
</code>
    </div>
  </body>
</html>