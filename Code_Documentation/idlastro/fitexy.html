<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:30 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>fitexy.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="fitexy.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="fitexy-code.html" title="Chromocoded source">Source</a> <a href="fitexy.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">fitexy.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      
      <div>
        <h2>Routines</h2>

        <dl class="routine-summary">
          
            <dt class="syntax"><a href="#chisq_fitexy"><code><span class="var">result</span> = chisq_fitexy(<span class="argument">B_angle</span>)</code></a></dt>
            <dd class="small"><p> NAME:       FITEXY PURPOSE:       Best straight-line fit to data with errors in both coordinates EXPLANATION:       Linear Least-squares approximation in one-dimension (y = a + b*x),               when both x and y data have errors</p>

</dd>
          
            <dt class="syntax"><a href="#fitexy"><code>fitexy<span class="argument">, x</span><span class="argument">, y</span><span class="argument">, A_intercept</span><span class="argument">, B_slope</span><span class="argument">, sigma_A_B</span><span class="argument">, chi_sq</span><span class="argument">, q</span><span class="argument">, TOLERANCE=<span class="var">TOLERANCE</span></span><span class="argument">, X_SIGMA=<span class="var">X_SIGMA</span></span><span class="argument">, Y_SIGMA=<span class="var">Y_SIGMA</span></span></code></a></dt>
            <dd class="small"></dd>
          
        </dl>
      </div>
      


      
      <div id="routine-details">
        <h2>Routine details</h2>

        
        <div class="routine-details details" id="chisq_fitexy">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="fitexy-code.html#chisq_fitexy:source" class="top">source</a> chisq_fitexy<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = chisq_fitexy(<span class="argument"><a href="#chisq_fitexy:p:B_angle">B_angle</a></span>)</code></p>

          
          <div class="small "><p> NAME:
       FITEXY
 PURPOSE:
       Best straight-line fit to data with errors in both coordinates
 EXPLANATION:
       Linear Least-squares approximation in one-dimension (y = a + b*x),
               when both x and y data have errors
</p>

<p> CALLING EXAMPLE:
       FITEXY, x, y, A, B, X_SIG= , Y_SIG= , [sigma_A_B, chi_sq, q, TOL=]
</p>

<p> INPUTS:
       x = array of values for independent variable.
       y = array of data values assumed to be linearly dependent on x.
</p>

<p> REQUIRED INPUT KEYWORDS:
       X_SIGMA = scalar or array specifying the standard deviation of x data.
       Y_SIGMA = scalar or array specifying the standard deviation of y data.
</p>

<p> OPTIONAL INPUT KEYWORD:
       TOLERANCE = desired accuracy of minimum & zero location, default=1.e-3.
</p>

<p> OUTPUTS:
       A_intercept = constant parameter result of linear fit,
       B_slope = slope parameter, so that:
                       ( A_intercept + B_slope * x ) approximates the y data.
 OPTIONAL OUTPUT:
       sigma_A_B = two element array giving standard deviation of
                A_intercept and B_slope parameters, respectively.
                The standard deviations are not meaningful if (i) the
                fit is poor (see parameter q), or (ii) b is so large that
                the data are consistent with a vertical (infinite b) line.
                If the data are consistent with *all* values of b, then
                sigma_A_B = [1e33,e33]
       chi_sq = resulting minimum Chi-Square of Linear fit, scalar
       q - chi-sq probability, scalar (0-1) giving the probability that
              a correct model would give a value equal or larger than the
              observed chi squared.   A small value of q indicates a poor
              fit, perhaps because the errors are underestimated.   As
              discussed by Tremaine et al. (2002, ApJ, 574, 740) an
              underestimate of the errors (e.g. due to an intrinsic dispersion)
              can lead to a bias in the derived slope, and it may be worth
              enlarging the error bars to get a reduced chi_sq ~ 1
</p>

<p> COMMON:
       common fitexy, communicates the data for computation of chi-square.
</p>

<p> PROCEDURE CALLS:
       CHISQ_FITEXY()            ;Included in this file
       MINF_BRACKET, MINF_PARABOLIC, ZBRENT    ;In IDL Astronomy Library
       MOMENT(), CHISQR_PDF()     ;In standard IDL distribution
</p>

<p> PROCEDURE:
       From "Numerical Recipes" column by Press and Teukolsky:
       in "Computer in Physics",  May, 1992 Vol.6 No.3
       Also see the 2nd edition of the book "Numerical Recipes" by Press et al.
</p>

<p>       In order to avoid  problems with data sets where X and Y are of very
       different order of magnitude the data are normalized before the fitting
       process is started.     The following normalization is used:
       xx = (x - xm) / xs    and    sigx = x_sigma / xs
                             where xm = MEAN(x) and xs = STDDEV(x)
       yy = (y - ym) / ys    and    sigy = y_sigma / ys
                             where ym = MEAN(y) and ys = STDDEV(y)
</p>

<p> MODIFICATION HISTORY:
       Written, Frank Varosi NASA/GSFC  September 1992.
       Now returns q rather than 1-q   W. Landsman  December 1992
       Use CHISQR_PDF, MOMENT instead of STDEV,CHI_SQR1 W. Landsman April 1998
       Fixed typo for initial guess of slope, this error was nearly
             always insignificant          W. Landsman   March 2000
       Normalize X,Y before calculation (from F. Holland) W. Landsman Nov 2006
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="chisq_fitexy:p:B_angle">B_angle <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="fitexy">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="fitexy-code.html#fitexy:source" class="top">source</a> fitexy<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>fitexy<span class="argument">, <a href="#fitexy:p:x">x</a></span><span class="argument">, <a href="#fitexy:p:y">y</a></span><span class="argument">, <a href="#fitexy:p:A_intercept">A_intercept</a></span><span class="argument">, <a href="#fitexy:p:B_slope">B_slope</a></span><span class="argument">, <a href="#fitexy:p:sigma_A_B">sigma_A_B</a></span><span class="argument">, <a href="#fitexy:p:chi_sq">chi_sq</a></span><span class="argument">, <a href="#fitexy:p:q">q</a></span><span class="argument">, <a href="#fitexy:k:TOLERANCE">TOLERANCE</a>=<span class="var">TOLERANCE</span></span><span class="argument">, <a href="#fitexy:k:X_SIGMA">X_SIGMA</a>=<span class="var">X_SIGMA</span></span><span class="argument">, <a href="#fitexy:k:Y_SIGMA">Y_SIGMA</a>=<span class="var">Y_SIGMA</span></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="fitexy:p:x">x <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fitexy:p:y">y <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fitexy:p:A_intercept">A_intercept <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fitexy:p:B_slope">B_slope <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fitexy:p:sigma_A_B">sigma_A_B <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fitexy:p:chi_sq">chi_sq <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fitexy:p:q">q <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="fitexy:k:TOLERANCE">TOLERANCE <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fitexy:k:X_SIGMA">X_SIGMA <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fitexy:k:Y_SIGMA">Y_SIGMA <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>201</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:30 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>