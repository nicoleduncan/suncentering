<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:56 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>precess_xyz.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="precess_xyz.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="precess_xyz:source"></a>pro precess_xyz,x,y,z,equinox1,equinox2
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	PRECESS_XYZ</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Precess equatorial geocentric rectangular coordinates. </span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	precess_xyz, x, y, z, equinox1, equinox2</span>
<span class="comments">;</span>
<span class="comments">; INPUT/OUTPUT:</span>
<span class="comments">;	x,y,z: scalars or vectors giving heliocentric rectangular coordinates</span>
<span class="comments">;              THESE ARE CHANGED UPON RETURNING.</span>
<span class="comments">; INPUT:</span>
<span class="comments">;	EQUINOX1: equinox of input coordinates, numeric scalar</span>
<span class="comments">;       EQUINOX2: equinox of output coordinates, numeric scalar</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;	x,y,z are changed upon return</span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;   The equatorial geocentric rectangular coords are converted</span>
<span class="comments">;      to RA and Dec, precessed in the normal way, then changed</span>
<span class="comments">;      back to x, y and z using unit vectors.</span>
<span class="comments">;</span>
<span class="comments">;EXAMPLE:</span>
<span class="comments">;	Precess 1950 equinox coords x, y and z to 2000.</span>
<span class="comments">;	IDL> precess_xyz,x,y,z, 1950, 2000</span>
<span class="comments">;</span>
<span class="comments">;HISTORY:</span>
<span class="comments">;	Written by P. Plait/ACC March 24 1999 </span>
<span class="comments">;	   (unit vectors provided by D. Lindler)</span>
<span class="comments">;       Use /Radian call to PRECESS     W. Landsman     November 2000</span>
<span class="comments">;       Use two parameter call to ATAN   W. Landsman    June 2001</span>
<span class="comments">;-</span>
<span class="comments">;check inputs</span>
   if N_params() NE 5 then begin
      print,'Syntax - PRECESS_XYZ,x,y,z,equinox1,equinox2'
      return
   endif

<span class="comments">;take input coords and convert to ra and dec (in radians)</span>

   ra = atan(y,x)
   del = sqrt(x*x + y*y + z*z)  <span class="comments">;magnitude of distance to Sun</span>
   dec = asin(z/del) 

<span class="comments">;   precess the ra and dec</span>
    precess, ra, dec, equinox1, equinox2, /Radian

<span class="comments">;convert back to x, y, z</span>
   xunit = cos(ra)*cos(dec)
   yunit = sin(ra)*cos(dec)
   zunit = sin(dec)

   x = xunit * del
   y = yunit * del
   z = zunit * del

   return
   end

</code>
    </div>
  </body>
</html>