<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:13 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>where_tag.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="where_tag.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="where_Tag:source"></a>function where_Tag, Struct, Nfound,	TAG_NAME=Tag_Name,	$
					TAG_NUMBER=Tag_Num,	$
					ISELECT=ipart, NOPRINT=noprint,	$
					RANGE=range, VALUES=values
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	WHERE_TAG</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Like WHERE but works on structure tag names</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;	Obtain subscripts of elements in structure array for which</span>
<span class="comments">;	a particular Tag has values in a range or matching specified values.</span>
<span class="comments">;	Like the WHERE function but for use with structures</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;			Structures</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	 w = where_tag( struct, [ Nfound,  TAG_NAME=, TAG_NUMBER = , RANGE =, </span>
<span class="comments">;				VALUES =, RANGE =, ISELECT =, /NOPRINT ]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	Struct = structure array to search.</span>
<span class="comments">;</span>
<span class="comments">; INPUT KEYWORDS:</span>
<span class="comments">;	User *must* specify (1) TAG_NAME or TAG_NUMBER to search, and (2)</span>
<span class="comments">;		the VALUES or RANGE to search on</span>
<span class="comments">;</span>
<span class="comments">;	TAG_NAME = Scalar string specifying Tag Name</span>
<span class="comments">;	TAG_NUMBER = otherwise give the Tag Number,</span>
<span class="comments">;	RANGE = [min,max] range to search for in Struct,</span>
<span class="comments">;	VALUES = one or array of numbers to match for in Struct,</span>
<span class="comments">;	ISELECT= specifies indices to select only part of structure array,</span>
<span class="comments">;		(use it to recycle subscripts from previous searches).</span>
<span class="comments">;	/NOPRINT = suppress informational messages about nothing found.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;	Nfound = # of occurences found.</span>
<span class="comments">;</span>
<span class="comments">; RESULT:</span>
<span class="comments">;	Function returns subscripts (indices) to desired elements.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLES:</span>
<span class="comments">;	Suppose STR is a structure with tags CAT_NO:indgen(10), and </span>
<span class="comments">;		NAME:strarr(10).   Find the indices where STR.CAT_NO is</span>
<span class="comments">;		between 3 and 5.</span>
<span class="comments">;</span>
<span class="comments">;	IDL> print, WHERE_TAG( str, TAG_NAME = 'CAT_NO', VALUE = [3,4,5] )  ;or</span>
<span class="comments">;	IDL> print, WHERE_TAG( str, TAG_NUM = 0, RANGE = [3,5]) </span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;	Get tag number and apply the WHERE function appropriately.</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;	written 1990 Frank Varosi STX @ NASA/GSFC</span>
<span class="comments">;	Stop printing "Tag &lt;xxx> not found" with /NOPRINT, CD Pike 8-Jun-93</span>
<span class="comments">;       Use STRJOIN for display  W.L. July 2009</span>
<span class="comments">;-</span>
<span class="comments">;First check required parameters...</span>

        On_Error,2
	compile_opt idl2
	Ntag = N_tags( Struct )

	if (Ntag LE 1) then begin
		message,"expecting a Structure Array, try again...",/CONTIN
		return,[-1]
	   endif

	if (N_elements( Tag_Num ) NE 1) AND $
	   (N_elements( Tag_Name ) NE 1) then begin
		message,"specify TAG_NAME= or TAG_NUMBER= to search",/CONTIN
		return,[-1]
	   endif

	Tags = Tag_names( Struct )

	if N_elements( Tag_Name ) EQ 1 then begin
		Tag_Name = strupcase( Tag_Name )
		Tag_Num = where( Tags EQ Tag_Name )
		Tag_Num = Tag_Num[0]
		if (Tag_Num LT 0) then begin
		 if NOT keyword_set( noprint ) then $
			message,"Tag &lt;"+Tag_Name+"> not found",/CONTIN
			return,[-2]
		   endif
	   endif

	if (Tag_Num LT 0) OR (Tag_Num GE Ntag) then begin
		message,"Tag# " + strtrim(Tag_Num,2) + " exceeds Max Tag# " $
			+ strtrim(Ntag-1,2) + " in structure",/CONTIN
		return,[-1]
	   endif

	if N_elements( ipart ) GT 0 then begin		<span class="comments">;check if any searching	</span>
							<span class="comments">;on a subset of input.</span>
		w = where( ipart GE 0, nf )
		if (nf LE 0) then return,[-1]
		if (nf LT N_elements( ipart )) then ipart = ipart[w]
	   endif

<span class="comments">;Now find out where for RANGE :</span>

	if N_elements( range ) EQ 2 then begin

		if N_elements( ipart ) GT 0 then begin

		     w = where( (Struct[ipart].(Tag_Num) GE range[0]) AND $
				(Struct[ipart].(Tag_Num) LE range[1]), Nfound )

		     if (Nfound GT 0) then windex = ipart[w] else windex = w

		 endif $
		  else 	windex = where( (Struct.(Tag_Num) GE range[0]) AND $
					(Struct.(Tag_Num) LE range[1]), Nfound )

		if (Nfound LE 0) AND (NOT keyword_set( noprint ) ) then begin
			strnums = strtrim( range, 2 )
			string = strnums[0] + "," + strnums[1]
			message," NO values of &lt;" + Tags[Tag_num] + $
				"> found in the Range [" + string + "]",/CONTIN
		   endif
<span class="comments">;where Values:</span>

	 endif else if N_elements( values ) GE 1 then begin

		Nval = N_elements( values )
		vals = [values]
		Nfound = 0

		if N_elements( ipart ) GT 0 then begin

		    for v=0,Nval-1 do begin
			w = where( Struct[ipart].(Tag_Num) EQ vals[v], Nf )
			if (Nf GT 0) then begin
				if (Nfound GT 0) then ww = [ww,w] else ww = w
			   endif
			Nfound = Nfound + Nf
		      endfor

		    if (Nfound GT 0) then windex = ipart[ww[sort( ww )]] $
				     else windex = w

		 endif else begin

		    for v=0,Nval-1 do begin
			w = where( Struct.(Tag_Num) EQ vals[v], Nf )
			if (Nf GT 0) then begin
				if (Nfound GT 0) then ww = [ww,w] else ww = w
			   endif
			Nfound = Nfound + Nf
		      endfor

		    if (Nfound GT 0) then windex = ww[sort( ww )] $
				     else windex = w

		  endelse

		if (Nfound LE 0) AND (NOT keyword_set( noprint ) ) then begin
			string = strjoin( strtrim(vals,2) ,',') 
			message," NO values of &lt;" + Tags[Tag_num] + $
				"> found Equaling [" + string + "]",/CONTIN
		   endif

	   endif else begin

		message,"must specify a RANGE=[#,#]  or VALUES=#('s)",/CONTIN
		windex=[-1]
	    endelse

return, windex
end
</code>
    </div>
  </body>
</html>