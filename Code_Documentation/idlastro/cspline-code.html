<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:23 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>cspline.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="cspline.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="cspline:source"></a>function cspline,xx, yy, tt, Deriv = deriv
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;      CSPLINE</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;      Function to evaluate a natural cubic spline at specified data points</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;      Combines the Numerical Recipes functions SPL_INIT and SPL_INTERP</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;      result = cspline( x, y, t, [ DERIV = ])</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;      x - vector of spline node positions, must be monotonic increasing or</span>
<span class="comments">;          decreasing</span>
<span class="comments">;      y - vector of node values</span>
<span class="comments">;      t - x-positions at which to evaluate the spline, scalar or vector</span>
<span class="comments">;</span>
<span class="comments">; INPUT-OUTPUT KEYWORD:</span>
<span class="comments">;      DERIV - values of the second derivatives of the interpolating function </span>
<span class="comments">;               at the node points.   This is an intermediate step in the </span>
<span class="comments">;               computation of the natural spline that requires only the X and </span>
<span class="comments">;               Y vectors.    If repeated interpolation is to be applied to </span>
<span class="comments">;               the same (X,Y) pair, then some computation time can be saved </span>
<span class="comments">;               by supplying the DERIV keyword on each call.   On the first call</span>
<span class="comments">;               DERIV will be computed and returned on output.    </span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       the values for positions t are returned as the function value</span>
<span class="comments">;       If any of the input variables are double precision, then the output will</span>
<span class="comments">;       also be double precision; otherwise the output is floating point.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:                               </span>
<span class="comments">;       The following uses the example vectors from the SPL_INTERP documentation</span>
<span class="comments">;</span>
<span class="comments">;       IDL> x = (findgen(21)/20.0)*2.0*!PI ;X vector</span>
<span class="comments">;       IDL> y = sin(x)                     ;Y vector</span>
<span class="comments">;       IDL> t = (findgen(11)/11.0)*!PI     ;Values at which to interpolate </span>
<span class="comments">;       IDL> cgplot,x,y,psym=1                ;Plot original grid</span>
<span class="comments">;       IDL> cgplot, /over, t,cspline(x,y,t),psym=2 ;Overplot interpolated values</span>
<span class="comments">;</span>
<span class="comments">; METHOD:</span>
<span class="comments">;      The "Numerical Recipes" implementation of the natural cubic spline is </span>
<span class="comments">;      used, by calling the intrinsic IDL functions SPL_INIT and SPL_INTERP.</span>
<span class="comments">;</span>
<span class="comments">; HISTORY:</span>
<span class="comments">;      version 1  D. Lindler  May, 1989</span>
<span class="comments">;      version 2  W. Landsman April, 1997</span>
<span class="comments">;      Rewrite using the intrinsic SPL_INIT & SPL_INTERP functions</span>
<span class="comments">;      Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;      Work for monotonic decreasing X vector    W. Landsman   February 1999</span>
<span class="comments">;-</span>
<span class="comments">;--------------------------------------------------------------------------</span>

 On_error,2
 compile_opt idl2

 if N_params() LT 3 then begin
        print,'Syntax:  result = cspline( x, y, t, [ DERIV = ] )'
        return,-1
 endif 
                
 n = N_elements(xx)
 if xx[n-1] LT xx[0] then begin               <span class="comments">;Descending order?</span>
        xrev = reverse(xx)
        yrev = reverse(yy)
        if N_elements(Deriv) NE n then begin
                 if min( xx - xx[1:*]) LT 0 then $
                          message,'ERROR - Input vector not monotonic' 
                 deriv = spl_init( xrev, yrev)
        endif
        return, spl_interp( xrev, yrev, deriv, tt)
 endif

 if N_elements(Deriv) NE n then deriv = spl_init( xx, yy)
 return, spl_interp( xx, yy, deriv, tt)

 end
</code>
    </div>
  </body>
</html>