<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:19 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>avg.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="avg.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">FUNCTION AVG,ARRAY,DIMENSION, NAN = NAN, DOUBLE = DOUBLE
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       AVG</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Return the average value of an array, or 1 dimension of an array</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Calculate the average value of an array, or calculate the average</span>
<span class="comments">;       value over one dimension of an array as a function of all the other</span>
<span class="comments">;       dimensions.</span>
<span class="comments">;</span>
<span class="comments">;       In 2009, a DIMENSION keyword was added to the IDL MEAN() function,</span>
<span class="comments">;       giving it the same capability as AVG().  Thus, the use of AVG() is now</span>
<span class="comments">;       **deprecated** in favor of the MEAN() function.    </span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       RESULT = AVG( ARRAY, [ DIMENSION, /NAN, /DOUBLE ] )</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       ARRAY = Input array.  May be any type except string.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT PARAMETERS:</span>
<span class="comments">;       DIMENSION = Optional dimension to do average over, integer scalar</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL KEYWORD INPUT:</span>
<span class="comments">;      /NAN - Set this keyword to cause the routine to check for occurrences of</span>
<span class="comments">;            the IEEE floating-point value NaN in the input data.  Elements with</span>
<span class="comments">;            the value NaN are treated as missing data.</span>
<span class="comments">;      /DOUBLE - By default, if the input Array is double-precision, complex, </span>
<span class="comments">;                or double complex, the result is of the same type;  64 bit</span>
<span class="comments">;                integers are also returned as double.   Otherwise the result</span>
<span class="comments">;                the  result is floating-point.   Use of the /DOUBLE keyword </span>
<span class="comments">;                forces a double precision output.   Note that internal </span>
<span class="comments">;                computations are always done in double precision.</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       The average value of the array when called with one parameter.</span>
<span class="comments">;</span>
<span class="comments">;       If DIMENSION is passed, then the result is an array with all the</span>
<span class="comments">;       dimensions of the input array except for the dimension specified,</span>
<span class="comments">;       each element of which is the average of the corresponding vector</span>
<span class="comments">;       in the input array.</span>
<span class="comments">;</span>
<span class="comments">;       For example, if A is an array with dimensions of (3,4,5), then the</span>
<span class="comments">;       command B = AVG(A,1) is equivalent to</span>
<span class="comments">;</span>
<span class="comments">;                       B = FLTARR(3,5)</span>
<span class="comments">;                       FOR J = 0,4 DO BEGIN</span>
<span class="comments">;                               FOR I = 0,2 DO BEGIN</span>
<span class="comments">;                                       B[I,J] = TOTAL( A[I,*,J] ) / 4.</span>
<span class="comments">;                               ENDFOR</span>
<span class="comments">;                       ENDFOR</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;       Dimension specified must be valid for the array passed; otherwise the</span>
<span class="comments">;       input array is returned as the output array.</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;       AVG(ARRAY) = TOTAL(ARRAY, /DOUBLE)/N_ELEMENTS(ARRAY) when called with </span>
<span class="comments">;       one parameter.</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       William Thompson        Applied Research Corporation</span>
<span class="comments">;       July, 1986              8201 Corporate Drive</span>
<span class="comments">;                               Landover, MD  20785</span>
<span class="comments">;       Converted to Version 2      July, 1990</span>
<span class="comments">;       Replace SUM call with TOTAL    W. Landsman    May, 1992</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Added /NAN keyword   W. Landsman      July 2000</span>
<span class="comments">;       Accept a scalar input value    W. Landsman/jimm@berkeley   November 2000</span>
<span class="comments">;       Internal calculations always in double precision W. Landsman March 2002</span>
<span class="comments">;       Return NAN if all values in array are NAN  W. Landsman April 2002</span>
<span class="comments">;       Fixed coding bug if all values in array are NAN W. Landsman Jan 2004</span>
<span class="comments">;-</span>
 ON_ERROR,2
 S = SIZE(ARRAY,/STR)
 IF S.N_ELEMENTS EQ 1 THEN RETURN, array[0]
 IF S.N_ELEMENTS EQ 0 THEN $
        MESSAGE,'Variable must be an array, name= ARRAY'
<span class="comments">;</span>
    IF N_PARAMS() EQ 1 THEN BEGIN
        IF KEYWORD_SET(NAN) THEN NPTS = TOTAL(FINITE(ARRAY) ) $
                            ELSE NPTS = N_ELEMENTS(ARRAY)
        IF NPTS EQ 0 THEN AVERAGE = !VALUES.F_NAN ELSE $
                          AVERAGE = TOTAL(ARRAY, NAN=NAN,/DOUBLE) / NPTS
    ENDIF ELSE BEGIN
        IF ((DIMENSION GE 0) AND (DIMENSION LT S.N_DIMENSIONS)) THEN BEGIN
                AVERAGE = TOTAL(ARRAY,DIMENSION+1,NAN=NAN,/DOUBLE) 
<span class="comments">; Install a bug workaround since TOTAL(A,/NAN) returns 0 rather than NAN if </span>
<span class="comments">; all A values are NAN. </span>
                IF KEYWORD_SET(NAN) THEN BEGIN
                     NPTS = TOTAL(FINITE(ARRAY),DIMENSION+1 ) 
                     BAD = WHERE(NPTS EQ 0, NBAD)
                     AVERAGE = AVERAGE/(NPTS>1)
                     IF NBAD GT 0 THEN AVERAGE[BAD] = !VALUES.D_NAN
                 ENDIF ELSE AVERAGE = AVERAGE/S.DIMENSIONS[DIMENSION]
                   
        END ELSE $
                MESSAGE,'*** Dimension out of range, name= ARRAY'
    ENDELSE

<span class="comments">; Convert to floating point unless of type double, complex, or L64, or</span>
<span class="comments">; if /DOUBLE is set.</span>

 IF NOT KEYWORD_SET(DOUBLE) THEN BEGIN 
    CASE S.TYPE OF
     5: RETURN, AVERAGE
     6: RETURN, COMPLEXARR( FLOAT(AVERAGE), FLOAT(IMAGINARY(AVERAGE)) )
     9: RETURN, AVERAGE
    14: RETURN, AVERAGE
    15: RETURN, AVERAGE
    ELSE: RETURN, FLOAT(AVERAGE)
  ENDCASE
  ENDIF ELSE RETURN, AVERAGE
 END
</code>
    </div>
  </body>
</html>