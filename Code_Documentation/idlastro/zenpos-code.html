<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:14 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>zenpos.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="zenpos.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO ZENPOS, date, ra, dec
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       ZENPOS</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Return the zenith RA and Dec in radians for a given Julian date.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       ZENPOS, Date, Ra, Dec</span>
<span class="comments">;</span>
<span class="comments">; INPUT:</span>
<span class="comments">;       Date  The Julian date, in double precision, of the date and time</span>
<span class="comments">;               for which the zenith position is desired, scalar or vector.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       Ra    The right ascension in RADIANS of the zenith.</span>
<span class="comments">;       Dec   The declination in RADIANS of the zenith.</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;       The local sidereal time is computed; this is the RA of the zenith.</span>
<span class="comments">;       It and the observatories latitude (corresponding to the Dec.) are</span>
<span class="comments">;       converted to radians and returned as the zenith direction.</span>
<span class="comments">;</span>
<span class="comments">; PROMPTS:</span>
<span class="comments">;       ZENPOS will prompt for the following 3 parameters if they are not</span>
<span class="comments">;       defined in the common block SITE (see below)</span>
<span class="comments">;</span>
<span class="comments">;       LAT,LNG - north latitude and east longitude of the desired location </span>
<span class="comments">;               in DEGREES</span>
<span class="comments">;       TZONE - Time Zone (in hours) of the desired location (e.g. 4 = EDT,</span>
<span class="comments">;               5 = EST)</span>
<span class="comments">;</span>
<span class="comments">; COMMON BLOCKS:</span>
<span class="comments">;       SITE - This common block should contain the three scalars LAT, LNG</span>
<span class="comments">;               and TZONE</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE CALLS:</span>
<span class="comments">;       CT2LST - Convert to Local Mean Sidereal Time</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       Written by Michael R. Greason, STX, 14 October 1988.</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Update documentation, longitude now *east* of Greenwich W.L. July 2000</span>
<span class="comments">;-</span>
 COMMON SITE, lat, lng, tzone

 if N_params() EQ 0 then begin
     print,'Syntax - zenpos, dte, ra, dec'
     print,'         dte = Julian Date, Ouput Ra and Dec in radians'
     return
 endif

 if N_elements(lat) eq 0 then read, $
       'Enter latitude and longitude (in degrees): ',lat,lng
 if N_elements(tzone) eq 0 then read, $
       'Enter time zone (in hours): ',tzone
<span class="comments">;</span>
<span class="comments">;                            Define the needed conversion factors.</span>
<span class="comments">;</span>
 d2rad = !DPI / 180.D0
 h2rad = !DPI / 12.D0
<span class="comments">;</span>
<span class="comments">;                            Get the sidereal time corresponding to the </span>
<span class="comments">;                            supplied date.</span>
<span class="comments">;</span>
 ct2lst, lst, lng, tzone, date
<span class="comments">;</span>
<span class="comments">;                            Compute the RA and Dec.</span>
<span class="comments">;</span>
 ra = lst * h2rad
 dec = ra*0. + lat * d2rad
<span class="comments">;</span>
 RETURN
 END
</code>
    </div>
  </body>
</html>