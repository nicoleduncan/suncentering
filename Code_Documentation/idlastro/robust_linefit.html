<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:01 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>robust_linefit.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="robust_linefit.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="robust_linefit-code.html" title="Chromocoded source">Source</a> <a href="robust_linefit.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">robust_linefit.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="ROBUST_LINEFIT">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="robust_linefit-code.html#ROBUST_LINEFIT:source" class="top">source</a> ROBUST_LINEFIT<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = ROBUST_LINEFIT(<span class="argument"><a href="#ROBUST_LINEFIT:p:XIN">XIN</a></span><span class="argument">, <a href="#ROBUST_LINEFIT:p:YIN">YIN</a></span><span class="argument">, <a href="#ROBUST_LINEFIT:p:YFIT">YFIT</a></span><span class="argument">, <a href="#ROBUST_LINEFIT:p:SIG">SIG</a></span><span class="argument">, <a href="#ROBUST_LINEFIT:p:SS">SS</a></span><span class="argument">, <a href="#ROBUST_LINEFIT:k:NUMIT">NUMIT</a>=<span class="var">NUMIT</span></span><span class="argument">, <a href="#ROBUST_LINEFIT:k:BISECT">BISECT</a>=<span class="var">BISECT</span></span><span class="argument">, <a href="#ROBUST_LINEFIT:k:Bisquare_Limit">Bisquare_Limit</a>=<span class="var">Bisquare_Limit</span></span><span class="argument">, <a href="#ROBUST_LINEFIT:k:Close_Factor">Close_Factor</a>=<span class="var">Close_Factor</span></span>)</code></p>

          
          <div class="small "><p> NAME:
       ROBUST_LINEFIT
</p>

<p> PURPOSE:
       An outlier-resistant two-variable linear regression.
 EXPLANATION:
       Either Y on X or, for the case in which there is no true independent
       variable, the bisecting line of Y vs X and X vs Y is calculated. No
       knowledge of the errors of the input points is assumed.
</p>

<p> CALLING SEQUENCE:
       COEFF = ROBUST_LINEFIT( X, Y, YFIT, SIG, COEF_SIG, [ /BISECT,
                       BiSquare_Limit = , Close_factor = , NumIT = ] )
</p>

<p> INPUTS:
       X = Independent variable vector, floating-point or double-precision
       Y = Dependent variable vector
</p>

<p> OUTPUTS:
       Function result = coefficient vector.
       If = 0.0 (scalar), no fit was possible.
       If vector has more than 2 elements (the last=0) then the fit is dubious.
</p>

<p> OPTIONAL OUTPUT PARAMETERS:
       YFIT = Vector of calculated y's
       SIG  = The "standard deviation" of the fit's residuals. If BISECTOR
               is set, this will be smaller by ~ sqrt(2).
       COEF_SIG  = The estimated standard deviations of the coefficients. If
               BISECTOR is set, however, this becomes the vector of fit
               residuals measured orthogonal to the line.
</p>

<p> OPTIONAL INPUT KEYWORDS:
       NUMIT = the number of iterations allowed. Default = 25
       BISECT  if set, the bisector of the "Y vs X" and "X vs Y" fits is
               determined.  The distance PERPENDICULAR to this line is used
               in calculating weights. This is better when the uncertainties
               in X and Y are comparable, so there is no true independent
               variable.  Bisquare_Limit  Limit used for calculation of
               bisquare weights. In units of outlier-resistant standard
               deviations. Default: 6.
               Smaller limit ==&gt;more resistant, less efficient
 Close_Factor  - Factor used to determine when the calculation has converged.
               Convergence if the computed standard deviation changes by less
               than Close_Factor * ( uncertainty of the std dev of a normal
               distribution ). Default: 0.03.
 SUBROUTINE CALLS:
       ROB_CHECKFIT
       ROBUST_SIGMA, to calculate a robust analog to the std. deviation
</p>

<p> PROCEDURE:
       For the initial estimate, the data is sorted by X and broken into 2
       groups. A line is fitted to the x and y medians of each group.
       Bisquare ("Tukey's Biweight") weights are then calculated, using the
       a limit of 6 outlier-resistant standard deviations.
       This is done iteratively until the standard deviation changes by less
       than CLOSE_ENOUGH = CLOSE_FACTOR * {uncertainty of the standard
               deviation of a normal distribution}
</p>

<p> REVISION HISTORY:
       Written, H. Freudenreich, STX, 4/91.
       4/13/93 to return more realistic SS's HF
       2/94 --more error-checking, changed convergence criterion HF
       5/94 --added BISECT option. HF.
       8/94 --added Close_Factor and Bisquare_Limit options  Jack Saba.
       4/02 --V5.0 version, use MEDIAN(/EVEN)  W. Landsman
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="ROBUST_LINEFIT:p:XIN">XIN <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="ROBUST_LINEFIT:p:YIN">YIN <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="ROBUST_LINEFIT:p:YFIT">YFIT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="ROBUST_LINEFIT:p:SIG">SIG <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="ROBUST_LINEFIT:p:SS">SS <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="ROBUST_LINEFIT:k:NUMIT">NUMIT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="ROBUST_LINEFIT:k:BISECT">BISECT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="ROBUST_LINEFIT:k:Bisquare_Limit">Bisquare_Limit <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="ROBUST_LINEFIT:k:Close_Factor">Close_Factor <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>268</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:58:01 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>