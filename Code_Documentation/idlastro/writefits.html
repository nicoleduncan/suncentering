<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:13 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>writefits.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="writefits.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="writefits-code.html" title="Chromocoded source">Source</a> <a href="writefits.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">writefits.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="writefits">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="writefits-code.html#writefits:source" class="top">source</a> writefits<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>writefits<span class="argument">, <a href="#writefits:p:filename">filename</a></span><span class="argument">, <a href="#writefits:p:data">data</a></span><span class="argument">, <a href="#writefits:p:header">header</a></span><span class="argument">, <a href="#writefits:p:heap">heap</a></span><span class="argument">, <a href="#writefits:k:Append">Append</a>=<span class="var">Append</span></span><span class="argument">, <a href="#writefits:k:compress">compress</a>=<span class="var">compress</span></span><span class="argument">, <a href="#writefits:k:CheckSum">CheckSum</a>=<span class="var">CheckSum</span></span><span class="argument">, <a href="#writefits:k:NaNValue">NaNValue</a>=<span class="var">NaNValue</span></span></code></p>

          
          <div class="small "><p> NAME:
       WRITEFITS
 PURPOSE:
       Write IDL array and header variables to a disk FITS file.
</p>

<p> EXPLANATION:
       A minimal FITS header is created if not supplied.
       WRITEFITS works for all types of FITS files except random groups
</p>

<p> CALLING SEQUENCE:
       WRITEFITS, filename, data [, header, /APPEND, /COMPRESS, /CHECKSUM]
</p>

<p> INPUTS:
       FILENAME = String containing the name of the file to be written.
</p>

<p>       DATA = Image array to be written to FITS file.    If DATA is
              undefined or a scalar, then only the FITS header (which
              must have NAXIS = 0) will be written to disk
</p>

<p> OPTIONAL INPUT:
       HEADER = String array containing the header for the FITS file.
                If variable HEADER is not given, the program will generate
                a minimal FITS header.
       HEAP -   A byte array giving the heap area following, e.g. a variable
                length binary table
</p>

<p> OPTIONAL INPUT KEYWORD:
       /APPEND - If this keyword is set then the supplied header and data
                array are assumed to be an extension and are appended onto
                the end of an existing FITS file.    If the file does not
                exist, then WRITEFITS will create one with a minimal primary
                header (and /EXTEND keyword) and then append the supplied
                extension header and array.     Note that the primary
                header in an existing file must already have an EXTEND
                keyword to indicate the presence of an FITS extension.
       /COMPRESS - If this keyword is set, then the FITS file is written as
                a gzip compressed file.   An extension '.gz' is appended to
                to the file name if it does not already exist.   The /COMPRESS
                option is incompatible with the /APPEND option.
      /Checksum - If set, then the CHECKSUM keywords to monitor data integrity
                 will be included in the FITS header.    For more info, see
                  http://heasarc.gsfc.nasa.gov/docs/heasarc/fits/checksum.html
                 By default, checksum keywords will updated if they are already
                 in the FITS header.
       NaNvalue - Value in the data array which represents missing pixels.
		 This keyword should only used when missing pixels are not
		 represented by NaN values in the input array.
 OUTPUTS:
       None
</p>

<p> RESTRICTIONS:
       (1) It recommended that BSCALE and BZERO not be used (or set equal
           to 1. and 0) except with integer data
       (2) WRITEFITS will remove any group parameters from the FITS header
       (3) As of Feb 2008, WRITEFITS no longer requires the primary header of a
           FITS file with extension contain the EXTEND keyword, consistent with
           Section 4.4.2.1 of the FITS 3.0 standard.    A warning is still
           given.  See http://fits.gsfc.nasa.gov/fits_standard.html
</p>

<p> EXAMPLE:
       Write a randomn 50 x 50 array as a FITS file creating a minimal header.
</p>

<p>       IDL&gt; im = randomn(seed, 50, 50)        ;Create array
       IDL&gt; writefits, 'test', im             ;Write to a FITS file "test"
</p>

<p> PROCEDURES USED:
       CHECK_FITS, FITS_ADD_CHECKSUM, MKHDR, MRD_HREAD, SXDELPAR, SXADDPAR,
       SXPAR()
</p>

<p> MODIFICATION HISTORY:
       WRITTEN, Jim Wofford, January, 29 1989
       Added call to IS_IEEE_BIG()  W. Landsman  Apr 96
       Make sure SIMPLE is written in first line of header  W. Landsman Jun 97
       Use SYSTIME() instead of !STIME    W. Landsman  July 97
       Create a default image extension header if needed W. Landsman June 98
       Write unsigned data types W. Landsman       December 1999
       Update for IDL V5.3, add /COMPRESS keyword W. Landsman  February 2000
       Correct BZERO value for unsigned data  W. Landsman   July 2000
       Eliminate duplication of input array if possible W. Landsman April 2001
       Use FILE_SEARCH for V5.5 or later     W. Landsman    April 2002
       Create the file if not already present and /APPEND is set
                                             W. Landsman    September 2002
       Proper call to MRD_HREAD if /APPEND is set  W. Landsman December 2002
       Added /CHECKSUM keyword              W. Landsman     December 2002
	Restored NANvalue keyword, William Thompson,	     October 2003
       Write BZERO in beginning of header for unsigned integers WL April 2004
       Added ability to write heap array       WL             October 2004
       Correct checksum if writing heap array   WL           November 2004
       Assume since V5.5, no VMS support, use file_search() WL   September 2006
       Set nbytes variable to LONG64 for very large files WL  May 2007
       Update CHECKSUM keywords if already present  WL   Oct 2007
       EXTEND keyword no longer required in FITS files with extensions WL Feb 2008
       Bug fix when filename ends with '.gz' and COMPRESS is used,
            the output file must be compressed          S. Koposov June 2008
       Introduce V6.0 notation                W.L. Nov. 2010
       Set /APPEND if XTENSION specifies a table   W.L.  July 2012
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="writefits:p:filename">filename <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="writefits:p:data">data <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="writefits:p:header">header <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="writefits:p:heap">heap <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="writefits:k:Append">Append <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="writefits:k:compress">compress <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="writefits:k:CheckSum">CheckSum <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="writefits:k:NaNValue">NaNValue <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>282</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:58:13 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>