<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:32 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ftdelcol.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ftdelcol.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="ftdelcol:source"></a>pro ftdelcol,h,tab,name                                               
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	FTDELCOL</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Delete a column of data from a FITS table</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	ftdelcol, h, tab, name</span>
<span class="comments">;</span>
<span class="comments">; INPUTS-OUPUTS</span>
<span class="comments">;	h,tab - FITS table header and data array.  H and TAB will</span>
<span class="comments">;		be updated with the specified column deleted</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	name - Either (1) a string giving the name of the column to delete</span>
<span class="comments">;		or (2) a scalar giving the column number to delete</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;	Suppose it has been determined that the F7.2 format used for a field</span>
<span class="comments">;	FLUX in a FITS table is insufficient.  The old column must first be </span>
<span class="comments">;	deleted before a new column can be written with a new format.</span>
<span class="comments">;</span>
<span class="comments">;	flux = FTGET(h,tab,'FLUX')       ;Save the existing values</span>
<span class="comments">;	FTDELCOL,h,tab,'FLUX'            ;Delete the existing column            </span>
<span class="comments">;	FTADDCOL,h,tab,'FLUX',8,'F9.2'   ;Create a new column with larger format</span>
<span class="comments">;	FTPUT,h,tab,'FLUX',0,flux        ;Put back the original values</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:                                           </span>
<span class="comments">;	Written   W. Landsman        STX Co.     August, 1988</span>
<span class="comments">;	Adapted for IDL Version 2, J. Isensee, July, 1990</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Updated call to new FTINFO   W. Landsman  May 2000</span>
<span class="comments">;- </span>
<span class="comments">; On_error,2</span>

 if N_params() LT 3 then begin
     print,'Syntax - FTDELCOL, h, tab, name'
     return
 endif

 ftsize,h,tab,ncol,nrows,tfields,allcols,allrows

<span class="comments">; Make sure column exists</span>

 ftinfo, h, ft_str     <span class="comments">;Get starting column and width (in bytes)</span>
 sz = size(name)
 if ((sz[0] ne 0) or (sz[1] EQ 0)) then $
      message,'Invalid field specification, it must be a scalar'

 if sz[1] EQ 7 then begin        <span class="comments">;If a string, get the field number</span>
    ttype = strtrim(ft_str.ttype,2)
    field = where(ttype EQ strupcase(strtrim(name,2)), Npos) + 1
    if Npos EQ 0 then message, $ 
        'Specified field ' + strupcase(strtrim(field,2)) + ' not in table'
 endif
 

<span class="comments">; Eliminate relevant columns from TAB</span>

 field = field[0]
 tbcol = ft_str.tbcol[field-1]-1                     <span class="comments">;Convert to IDL indexing</span>
 width = ft_str.width[field-1]
 case 1 of 
 tbcol eq 0: tab = tab[width:*,*]                     <span class="comments">;First column</span>
 tbcol eq ncol-width: tab = tab[0:tbcol-1,*]          <span class="comments">;Last column</span>
 else: tab = [tab[0:tbcol-1,*],tab[tbcol+width:*,*]]  <span class="comments">;All other columns</span>
 endcase

<span class="comments">; Parse the header.  Remove specified keyword from header.  Lower</span>
<span class="comments">; the index of subsequent keywords.  Update the TBCOL*** index of</span>
<span class="comments">; subsequent keywords</span>

 nh = N_elements(h)
 hnew = strarr(nh)
 j = 0
 key = strupcase(strmid(h,0,5))
 for i= 0,nh-1 do begin    <span class="comments">;Loop over each element in header</span>
 if (key[i] eq 'TTYPE') OR (key[i] eq 'TFORM') or (key[i] eq 'TUNIT') or $
    (key[i] eq 'TNULL') OR (key[i] eq 'TBCOL') then begin
    row = h[i]                    
    ifield = fix(strtrim(strmid(row,5,3)))    
    if ifield GT field then begin    <span class="comments">;Subsequent field?</span>
      if ifield le 10 then fmt = "(I1,' ')" else fmt ='(I2)'
      strput,row,string(ifield-1,format=fmt),5
      if key[i] eq 'TBCOL' then begin
         value = fix(strtrim(strmid(row,10,20)))-width
         v = string(value)
         s = strlen(v)
         strput,row,v,30-s                  <span class="comments">;Right justify</span>
      endif
   endif 
   if ifield ne field then hnew[j] = row else j=j-1

 endif else hnew[j] = h[i]      

 j = j+1
 endfor   

 sxaddpar,hnew,'TFIELDS',tfields-1 <span class="comments">;Reduce number of fields by 1</span>
 sxaddpar,hnew,'NAXIS1',ncol-width <span class="comments">;Reduce num. of columns by WIDTH</span>

 h = hnew[0:j-1]
 message,'Field '+strupcase(name)+' has been deleted from the FITS table',/INF

 return  
 end
</code>
    </div>
  </body>
</html>