<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:20 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ccm_unred.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ccm_unred.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="ccm_UNRED:source"></a>pro ccm_UNRED, wave, flux, ebv, funred, R_V = r_v
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;     CCM_UNRED</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     Deredden a flux vector using the CCM 1989 parameterization </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;     The reddening curve is that of Cardelli, Clayton, and Mathis (1989 ApJ.</span>
<span class="comments">;     345, 245), including the update for the near-UV given by O'Donnell </span>
<span class="comments">;     (1994, ApJ, 422, 158).   Parameterization is valid from the IR to the </span>
<span class="comments">;     far-UV (3.5 microns to 0.1 microns).    </span>
<span class="comments">;</span>
<span class="comments">;     Users might wish to consider using the alternate procedure FM_UNRED</span>
<span class="comments">;     which uses the extinction curve of Fitzpatrick (1999).</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;     CCM_UNRED, wave, flux, ebv, funred, [ R_V = ]      </span>
<span class="comments">;             or </span>
<span class="comments">;     CCM_UNRED, wave, flux, ebv, [ R_V = ]      </span>
<span class="comments">; INPUT:</span>
<span class="comments">;     WAVE - wavelength vector (Angstroms)</span>
<span class="comments">;     FLUX - calibrated flux vector, same number of elements as WAVE</span>
<span class="comments">;             If only 3 parameters are supplied, then this vector will</span>
<span class="comments">;             updated on output to contain the dereddened flux.</span>
<span class="comments">;     EBV  - color excess E(B-V), scalar.  If a negative EBV is supplied,</span>
<span class="comments">;             then fluxes will be reddened rather than deredenned.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;     FUNRED - unreddened flux vector, same units and number of elements</span>
<span class="comments">;             as FLUX</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORD</span>
<span class="comments">;     R_V - scalar specifying the ratio of total selective extinction</span>
<span class="comments">;             R(V) = A(V) / E(B - V).    If not specified, then R_V = 3.1</span>
<span class="comments">;             Extreme values of R(V) range from 2.75 to 5.3</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;     Determine how a flat spectrum (in wavelength) between 1200 A and 3200 A</span>
<span class="comments">;     is altered by a reddening of E(B-V) = 0.1.   Assume an "average"</span>
<span class="comments">;     reddening for the diffuse interstellar medium (R(V) = 3.1)</span>
<span class="comments">;</span>
<span class="comments">;       IDL> w = 1200 + findgen(40)*50      ;Create a wavelength vector</span>
<span class="comments">;       IDL> f = w*0 + 1                    ;Create a "flat" flux vector</span>
<span class="comments">;       IDL> ccm_unred, w, f, -0.1, fnew  ;Redden (negative E(B-V)) flux vector</span>
<span class="comments">;       IDL> plot,w,fnew                   </span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;     (1) The CCM curve shows good agreement with the Savage & Mathis (1979)</span>
<span class="comments">;             ultraviolet curve shortward of 1400 A, but is probably</span>
<span class="comments">;             preferable between 1200 and 1400 A.</span>
<span class="comments">;     (2)  Many sightlines with peculiar ultraviolet interstellar extinction </span>
<span class="comments">;             can be represented with a CCM curve, if the proper value of </span>
<span class="comments">;             R(V) is supplied.</span>
<span class="comments">;     (3)  Curve is extrapolated between 912 and 1000 A as suggested by</span>
<span class="comments">;             Longo et al. (1989, ApJ, 339,474)</span>
<span class="comments">;     (4) Use the 4 parameter calling sequence if you wish to save the </span>
<span class="comments">;               original flux vector.</span>
<span class="comments">;     (5) Valencic et al. (2004, ApJ, 616, 912) revise the ultraviolet CCM</span>
<span class="comments">;             curve (3.3 -- 8.0 um-1).    But since their revised curve does</span>
<span class="comments">;             not connect smoothly with longer and shorter wavelengths, it is</span>
<span class="comments">;             not included here.</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written   W. Landsman        Hughes/STX   January, 1992</span>
<span class="comments">;       Extrapolate curve for wavelengths between 900 and 1000 A   Dec. 1993</span>
<span class="comments">;       Use updated coefficients for near-UV from O'Donnell   Feb 1994</span>
<span class="comments">;       Allow 3 parameter calling sequence      April 1998</span>
<span class="comments">;       Converted to IDLV5.0                    April 1998</span>
<span class="comments">;-</span>

 On_error, 2

 if N_params() LT 3 then begin
     print,'Syntax: CCM_UNRED, wave, flux, ebv, funred,[ R_V = ]'
     return
 endif

 if not keyword_set(R_V) then R_V = 3.1

 x = 10000./ wave                <span class="comments">; Convert to inverse microns </span>
 npts = N_elements( x )
 a = fltarr(npts)  
 b = fltarr(npts)
<span class="comments">;******************************</span>

 good = where( (x GT 0.3) and (x  LT 1.1), Ngood )       <span class="comments">;Infrared</span>
 if Ngood GT 0 then begin
      a[good] =  0.574 * x[good]^(1.61)
      b[good] = -0.527 * x[good]^(1.61)
 endif

<span class="comments">;******************************</span>

 good = where( (x GE 1.1) and (x LT 3.3) ,Ngood)           <span class="comments">;Optical/NIR</span>
 if Ngood GT 0 then begin             <span class="comments">;Use new constants from O'Donnell (1994)</span>
     y = x[good] - 1.82
<span class="comments">;     c1 = [ 1. , 0.17699, -0.50447, -0.02427,  0.72085,    $ ;Original</span>
<span class="comments">;                 0.01979, -0.77530,  0.32999 ]               ;coefficients</span>
<span class="comments">;     c2 = [ 0.,  1.41338,  2.28305,  1.07233, -5.38434,    $ ;from CCM89</span>
<span class="comments">;                -0.62251,  5.30260, -2.09002 ]</span>
      c1 = [ 1. , 0.104,   -0.609,    0.701,  1.137,    $    <span class="comments">;New coefficients</span>
                 -1.718,   -0.827,    1.647, -0.505 ]        <span class="comments">;from O'Donnell</span>
      c2 = [ 0.,  1.952,    2.908,   -3.989, -7.985,    $    <span class="comments">;(1994)</span>
                 11.102,    5.491,  -10.805,  3.347 ]

     a[good] = poly( y, c1)
     b[good] = poly( y, c2)
 endif
<span class="comments">;******************************</span>

 good = where( (x GE 3.3) and (x LT 8) ,Ngood)           <span class="comments">;Mid-UV</span>
 if Ngood GT 0 then begin

    y = x[good]
    F_a = fltarr(Ngood)    & F_b = fltarr(Ngood)
    good1 = where( (y GT 5.9), Ngood1 )
    if Ngood1 GT 0 then begin
       y1 = y[good1] - 5.9
       F_a[ good1] = -0.04473 * y1^2 - 0.009779 * y1^3
       F_b[ good1] =   0.2130 * y1^2  +  0.1207 * y1^3
    endif
    
   a[good] =  1.752 - 0.316*y - (0.104 / ( (y-4.67)^2 + 0.341 )) + F_a
   b[good] = -3.090 + 1.825*y + (1.206 / ( (y-4.62)^2 + 0.263 )) + F_b
 endif

<span class="comments">;   *******************************</span>

 good = where( (x GE 8) and (x LE 11), Ngood )         <span class="comments">;Far-UV</span>
 if Ngood GT 0 then begin
    y = x[good] - 8.
    c1 = [ -1.073, -0.628,  0.137, -0.070 ]
    c2 = [ 13.670,  4.257, -0.420,  0.374 ]
    a[good] = poly(y, c1)
    b[good] = poly(y, c2)
 endif

<span class="comments">;   *******************************</span>

<span class="comments">; Now apply extinction correction to input flux vector</span>

  A_V = R_V * EBV
  A_lambda = A_V * (a + b/R_V)
  if N_params() EQ 3 then flux = flux * 10.^(0.4*A_lambda) else $
        funred = flux * 10.^(0.4*A_lambda)       <span class="comments">;Derive unreddened flux</span>

 return     
 end                               
</code>
    </div>
  </body>
</html>