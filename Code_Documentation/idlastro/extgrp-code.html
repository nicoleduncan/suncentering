<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:29 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>extgrp.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="extgrp.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="extgrp:source"></a>pro extgrp,hdr,par
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	EXTGRP</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Extract the group parameter information out of SXREAD output</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;	This procedure extracts the group parameter information out of a </span>
<span class="comments">;	header and parameter variable obtained from SXREAD.  This allows </span>
<span class="comments">;	astrometry, photometry and other parameters to be easily SXPARed by </span>
<span class="comments">;	conventional methods and allows the image and header to be saved in </span>
<span class="comments">;	a SIMPLE format.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	ExtGrp, hdr, par</span>
<span class="comments">;</span>
<span class="comments">; INPUT:</span>
<span class="comments">;	HDR - The header which is to be converted (input and output)</span>
<span class="comments">;	PAR - The Parameter string returned from a call to SXREAD</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;	HDR -  The converted header, string array</span>
<span class="comments">;</span>
<span class="comments">; OTHER PROCEDURES CALLED:</span>
<span class="comments">;	SXPAR(), SXADDPAR, SXGPAR(), STRN()</span>
<span class="comments">;</span>
<span class="comments">; HISTORY:</span>
<span class="comments">;	25-JUN-90 Version 1 written</span>
<span class="comments">;	13-JUL-92 Header finally added to this ancient procedure, code spiffed up</span>
<span class="comments">;	a bit.  Now 3 times faster.  Added PTYPE comment inclusion.  E. Deutsch</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>

  arg=n_params(0)
  if (arg lt 2) then begin
    print,'Call: IDL> EXTGRP,header,params_string'
    print,"e.g.: IDL> EXTGRP,h,par"
    return
    endif

  h=hdr
  pcount=sxpar(h,'PCOUNT')
  if (pcount le 0) then begin
    print,'[EXTGRP] Error: PCOUNT not >0 in header'
    return
    endif

  htmp=h & ih=0
  while (strmid(h[ih],0,4) ne 'PTYP') do ih=ih+1
  itmp=ih & stbyt=0
  hquick=strarr(4) & hquick[3]='END        '	<span class="comments">; tiny temp. header for speed</span>

  for t2=0,pcount-1 do begin
    hquick=h[ih+3*t2:ih+3*t2+2]

    pty=sxpar(hquick,'PTYPE'+strn(t2+1))
    comment=strmid(hquick[0],30,50)
    pdty=sxpar(hquick,'PDTYPE'+strn(t2+1))
    psz=sxpar(hquick,'PSIZE'+strn(t2+1))/8
    pvl=sxgpar(h,par,pty,pdty,stbyt,psz)

    sz=size(pvl) & stbyt=stbyt+psz
    if (sz[1] eq 7) then pvl="'"+strn(pvl,length=18)+"'"
    tmp=pty+'='+strn(pvl,length=21)+comment

    htmp[itmp]=tmp
    itmp=itmp+1
    endfor

  while (strmid(h[ih],0,1) eq 'P') do ih=ih+1

  while (strmid(h[ih],0,3) ne 'END') do begin
    htmp[itmp]=h[ih]
    itmp=itmp+1
    ih=ih+1
    endwhile		

  htmp[itmp]=h[ih]
  hdr=htmp[0:itmp]

  sxaddpar,hdr,'SIMPLE','T',' Group Parameters extracted'
  sxaddpar,hdr,'PCOUNT',0,' All group parameters extracted'
  sxaddpar,hdr,'PSIZE',0,' All group parameters extracted'
  sxaddpar,hdr,'GROUPS','T'
  sxaddpar,hdr,'GCOUNT',1,' Number of groups'

  return
end
</code>
    </div>
  </body>
</html>