<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:38 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>gal_uvw.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="gal_uvw.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="gal_uvw:source"></a>pro gal_uvw, u, v, w, distance = distance, LSR = lsr, ra=ra,dec=dec, $
     pmra = pmra, pmdec=pmdec, vrad = vrad, plx  = plx
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;     GAL_UVW</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     Calculate the Galactic space velocity (U,V,W) of star  </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;     Calculates the Galactic space velocity U, V, W of star given its </span>
<span class="comments">;     (1) coordinates, (2) proper motion, (3) distance (or parallax), and </span>
<span class="comments">;     (4) radial velocity.</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;     GAL_UVW, U, V, W, [/LSR, RA=, DEC=, PMRA= ,PMDEC=, VRAD= , DISTANCE= </span>
<span class="comments">;              PLX= ]</span>
<span class="comments">; OUTPUT PARAMETERS:</span>
<span class="comments">;      U - Velocity (km/s) positive toward the Galactic *anti*center</span>
<span class="comments">;      V - Velocity (km/s) positive in the direction of Galactic rotation</span>
<span class="comments">;      W - Velocity (km/s) positive toward the North Galactic Pole </span>
<span class="comments">; REQUIRED INPUT KEYWORDS:</span>
<span class="comments">;      User must supply a position, proper motion,radial velocity and distance</span>
<span class="comments">;      (or parallax).    Either scalars or vectors can be supplied.</span>
<span class="comments">;     (1) Position:</span>
<span class="comments">;      RA - Right Ascension in *Degrees*</span>
<span class="comments">;      Dec - Declination in *Degrees*</span>
<span class="comments">;     (2) Proper Motion</span>
<span class="comments">;      PMRA = Proper motion in RA in arc units (typically milli-arcseconds/yr)</span>
<span class="comments">;            If given mu_alpha --proper motion in seconds of time/year - then</span>
             this is equal to 15*mu_alpha*cos(dec)
<span class="comments">;      PMDEC = Proper motion in Declination (typically mas/yr)</span>
<span class="comments">;     (3) Radial Velocity</span>
<span class="comments">;      VRAD = radial velocity in km/s</span>
<span class="comments">;     (4) Distance or Parallax</span>
<span class="comments">;      DISTANCE - distance in parsecs </span>
<span class="comments">;                 or</span>
<span class="comments">;      PLX - parallax with same distance units as proper motion measurements</span>
<span class="comments">;            typically milliarcseconds (mas)</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORD:</span>
<span class="comments">;      /LSR - If this keyword is set, then the output velocities will be</span>
<span class="comments">;             corrected for the solar motion (U,V,W)_Sun = (-8.5, 13.38, 6.49) </span>
<span class="comments">;            (Coskunoglu et al. 2011 MNRAS) to the local standard of rest.</span>
<span class="comments">;            Note that the value of the solar motion through the LSR remains</span>
<span class="comments">;            poorly determined.</span>
<span class="comments">;  EXAMPLE:</span>
<span class="comments">;      (1) Compute the U,V,W coordinates for the halo star HD 6755.  </span>
<span class="comments">;          Use values from Hipparcos catalog, and correct to the LSR</span>
<span class="comments">;      ra = ten(1,9,42.3)*15.    & dec = ten(61,32,49.5)</span>
<span class="comments">;      pmra = 628.42  &  pmdec = 76.65         ;mas/yr</span>
<span class="comments">;      dis = 139    &  vrad = -321.4</span>
<span class="comments">;      gal_uvw,u,v,w,ra=ra,dec=dec,pmra=pmra,pmdec=pmdec,vrad=vrad,dis=dis,/lsr</span>
<span class="comments">;          ===>  u=141.2  v = -491.7  w = 93.9        ;km/s</span>
<span class="comments">;</span>
<span class="comments">;      (2) Use the Hipparcos Input and Output Catalog IDL databases (see </span>
<span class="comments">;      http://idlastro.gsfc.nasa.gov/ftp/zdbase/) to obtain space velocities</span>
<span class="comments">;      for all stars within 10 pc with radial velocities > 10 km/s</span>
<span class="comments">;</span>
<span class="comments">;      dbopen,'hipp_new,hic'      ;Need Hipparcos output and input catalogs</span>
<span class="comments">;      list = dbfind('plx>100,vrad>10')      ;Plx > 100 mas, Vrad > 10 km/s</span>
<span class="comments">;      dbext,list,'pmra,pmdec,vrad,ra,dec,plx',pmra,pmdec,vrad,ra,dec,plx</span>
<span class="comments">;      ra = ra*15.                 ;Need right ascension in degrees</span>
<span class="comments">;      GAL_UVW,u,v,w,ra=ra,dec=dec,pmra=pmra,pmdec=pmdec,vrad=vrad,plx = plx </span>
<span class="comments">;      forprint,u,v,w              ;Display results</span>
<span class="comments">; METHOD:</span>
<span class="comments">;      Follows the general outline of Johnson & Soderblom (1987, AJ, 93,864)</span>
<span class="comments">;      except that U is positive outward toward the Galactic *anti*center, and </span>
<span class="comments">;      the J2000 transformation matrix to Galactic coordinates is taken from  </span>
<span class="comments">;      the introduction to the Hipparcos catalog.   </span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;      Written, W. Landsman                       December   2000</span>
<span class="comments">;      fix the bug occuring if the input arrays are longer than 32767</span>
<span class="comments">;        and update the Sun velocity           Sergey Koposov June 2008</span>
<span class="comments">;	   vectorization of the loop -- performance on large arrays </span>
<span class="comments">;        is now 10 times higher                Sergey Koposov December 2008</span>
<span class="comments">;      More recent value of solar motion WL/SK   Jan 2011</span>
<span class="comments">;-</span>
 compile_opt idl2
 if N_Params() EQ 0 then begin
       print,'Syntax - GAL_UVW, U, V, W, [/LSR, RA=, DEC=, PMRA= ,PMDEC=, VRAD='
       print,'                  Distance=, PLX='
       print,'         U, V, W - output Galactic space velocities (km/s)'
       return
 endif
 
 Nra = N_elements(ra)
 if (nra EQ 0) or (N_elements(dec) EQ 0) then message, $
     'ERROR - The RA, Dec (J2000) position keywords must be supplied (degrees)'
 if N_elements(distance) GT 0 then begin 
       bad = where(distance LE 0, Nbad)
       if Nbad GT 0 then message,'ERROR - All distances must be > 0'
       plx = 1e3/distance          <span class="comments">;Parallax in milli-arcseconds</span>
 endif else begin
       if N_elements(plx) EQ 0 then message, $
             'ERROR - Either a parallax or distance must be specified'
       bad = where(plx LE 0.0, Nbad)
       if Nbad GT 0 then message,'ERROR - Parallaxes must be > 0'
 endelse

 cosd = cos(dec/!RADEG)
 sind = sin(dec/!RADEG)
 cosa = cos(ra/!RADEG)
 sina = sin(ra/!RADEG)

 k = 4.74047     <span class="comments">;Equivalent of 1 A.U/yr in km/s   </span>
 A_G = [ [ 0.0548755604, +0.4941094279, -0.8676661490], $ 
         [ 0.8734370902, -0.4448296300, -0.1980763734], $
         [ 0.4838350155,  0.7469822445, +0.4559837762] ]

 vec1 = vrad
 vec2 = k*pmra/plx
 vec3 = k*pmdec/plx

 u = ( A_G[0,0]*cosa*cosd+A_G[0,1]*sina*cosd+A_G[0,2]*sind)*vec1+$
     (-A_G[0,0]*sina     +A_G[0,1]*cosa                   )*vec2+$
     (-A_G[0,0]*cosa*sind-A_G[0,1]*sina*sind+A_G[0,2]*cosd)*vec3
 v = ( A_G[1,0]*cosa*cosd+A_G[1,1]*sina*cosd+A_G[1,2]*sind)*vec1+$
     (-A_G[1,0]*sina     +A_G[1,1]*cosa                   )*vec2+$
     (-A_G[1,0]*cosa*sind-A_G[1,1]*sina*sind+A_G[1,2]*cosd)*vec3
 w = ( A_G[2,0]*cosa*cosd+A_G[2,1]*sina*cosd+A_G[2,2]*sind)*vec1+$
     (-A_G[2,0]*sina     +A_G[2,1]*cosa                   )*vec2+$
     (-A_G[2,0]*cosa*sind-A_G[2,1]*sina*sind+A_G[2,2]*cosd)*vec3

 lsr_vel=[-8.5,13.38,6.49]
 if keyword_set(lsr) then begin
	u = u+lsr_vel[0]
	v = v+lsr_vel[1]
 	w = w+lsr_vel[2]
 end

 return
 end
</code>
    </div>
  </body>
</html>