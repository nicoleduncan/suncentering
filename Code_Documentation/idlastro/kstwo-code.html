<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:44 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>kstwo.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="kstwo.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="kstwo:source"></a> pro kstwo, data1, data2, D, prob
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       KSTWO</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Return the two-sided Kolmogorov-Smirnov statistic</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Returns the Kolmogorov-Smirnov statistic and associated probability </span>
<span class="comments">;       that two arrays of data values are drawn from the same distribution</span>
<span class="comments">;       Algorithm taken from procedure of the same name in "Numerical</span>
<span class="comments">;       Recipes" by Press et al., 2nd edition (1992), Chapter 14</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       kstwo, data1, data2, D, prob</span>
<span class="comments">;</span>
<span class="comments">; INPUT PARAMATERS:</span>
<span class="comments">;       data1 -  vector of data values, at least 4 data values must be included</span>
<span class="comments">;               for the K-S statistic to be meaningful</span>
<span class="comments">;       data2 -  second set of data values, does not need to have the same </span>
<span class="comments">;               number of elements as data1</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT PARAMETERS:</span>
<span class="comments">;       D - floating scalar giving the Kolmogorov-Smirnov statistic.   It</span>
<span class="comments">;               specifies the maximum deviation between the cumulative </span>
<span class="comments">;               distribution of the data and the supplied function </span>
<span class="comments">;       prob - floating scalar between 0 and 1 giving the significance level of</span>
<span class="comments">;               the K-S statistic.   Small values of PROB show that the </span>
<span class="comments">;               cumulative distribution function of DATA1 is significantly </span>
<span class="comments">;               different from DATA2</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Test whether two vectors created by the RANDOMN function likely came</span>
<span class="comments">;       from the same distribution</span>
<span class="comments">;</span>
<span class="comments">;       IDL> data1 = randomn(seed,40)        ;Create data vectors to be </span>
<span class="comments">;       IDL> data2 = randomn(seed,70)        ;compared</span>
<span class="comments">;       IDL> kstwo, data1, data2, D, prob   & print,D,prob</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE CALLS</span>
<span class="comments">;       procedure PROB_KS - computes significance of K-S distribution</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written     W. Landsman                August, 1992</span>
<span class="comments">;       FP computation of N_eff      H. Ebeling/W. Landsman  March 1996</span>
<span class="comments">;       Fix for arrays containing equal values J. Ballet/W. Landsman Oct. 2001</span>
<span class="comments">;       Fix index when maximum difference is at array end Renbin Yan  Dec 2008</span>
<span class="comments">;       Handle large number when computing N_err  D. Schnitzeler/WL  Sep 2010</span>
<span class="comments">;-</span>
  On_error, 2
  compile_opt idl2 
  
 if ( N_params() LT 4 ) then begin
    print,'Syntax - KSTWO, data1, data2, d, prob'
    return
 endif

 n1 = N_elements( data1 )
 if ( N1 LE 3 ) then message, $
   'ERROR - Input data values (first param) must contain at least 4 values'

 n2 = N_elements( data2 )
 if ( n2 LE 3 ) then message, $
   'ERROR - Input data values (second param) must contain at least 4 values'

 sortdata1 = data1[ sort( data1 ) ]        <span class="comments">;Sort input arrays into </span>
 sortdata2 = data2[ sort( data2 ) ]        <span class="comments">;ascending order</span>

 fn1 = ( findgen( n1 +1 )  ) / n1          <span class="comments">;updated Dec 2008</span>
 fn2 = ( findgen( n2 +1)  ) / n2

 j1 = 0l & j2 = 0l
 id1 = lonarr(n1+n2)  & id2 = id1
 i = 0l

<span class="comments">; Form the two cumulative distribution functions, marking points where one</span>
<span class="comments">; must test their difference</span>

 while ( j1 LT N1 ) and ( j2 LT n2 ) do begin

     d1 = sortdata1[j1]
     d2 = sortdata2[j2]
     if d1 LE d2 then j1 = j1 +1
     if d2 LE d1 then j2 = j2 +1
            
     id1[i] = j1   & id2[i] = j2
     i = i+1

 endwhile

 id1 = id1[0:i-1]   &  id2 = id2[0:i-1]

<span class="comments">; The K-S statistic D is the maximum difference between the two distribution</span>
<span class="comments">; funtions</span>

 D = max( abs( fn1[id1] - fn2[id2] ) ) 
 N_eff =  long64(n1)*n2/ float(n1 + n2)           <span class="comments">;Effective # of data points</span>
 PROB_KS, D, N_eff, prob                <span class="comments">;Compute significance of statistic</span>

 return
 end
</code>
    </div>
  </body>
</html>