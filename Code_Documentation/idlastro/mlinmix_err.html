<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:47 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>mlinmix_err.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="mlinmix_err.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="mlinmix_err-code.html" title="Chromocoded source">Source</a> <a href="mlinmix_err.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">mlinmix_err.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      
      <div id="file_comments">
        <div class="small "><p>   NAME:
     MLINMIX_ERR
   PURPOSE:
      Bayesian approach to multiple linear regression with errors in  X and Y
   EXPLANATION:
 PERFORM LINEAR REGRESSION OF Y ON X WHEN THERE ARE MEASUREMENT
 ERRORS IN BOTH VARIABLES. THE REGRESSION ASSUMES :
</p>

<p>                 ETA = ALPHA + BETA ## XI + EPSILON
                 X = XI + XERR
                 Y = ETA + YERR
</p>

<p> HERE, (ALPHA, BETA) ARE THE REGRESSION COEFFICIENTS, EPSILON IS THE
 INTRINSIC RANDOM SCATTER ABOUT THE REGRESSION, XERR IS THE
 MEASUREMENT ERROR IN X, AND YERR IS THE MEASUREMENT ERROR IN
 Y. EPSILON IS ASSUMED TO BE NORMALLY-DISTRIBUTED WITH MEAN ZERO AND
 VARIANCE SIGSQR. XERR AND YERR ARE ASSUMED TO BE
 NORMALLY-DISTRIBUTED WITH MEANS EQUAL TO ZERO, COVARIANCE MATRICES
 XVAR^2 FOR X, VARIANCES YSIG^2 FOR Y, AND COVARIANCE VECTORS
 XYCOV. THE DISTRIBUTION OF XI IS MODELLED AS A MIXTURE OF NORMALS,
 WITH GROUP PROPORTIONS PI, MEANS MU, AND COVARIANCES T. BAYESIAN
 INFERENCE IS EMPLOYED, AND A STRUCTURE CONTAINING RANDOM DRAWS FROM
 THE POSTERIOR IS RETURNED. CONVERGENCE OF THE MCMC TO THE POSTERIOR
 IS MONITORED USING THE POTENTIAL SCALE REDUCTION FACTOR (RHAT,
 GELMAN ET AL.2004). IN GENERAL, WHEN RHAT &lt; 1.1 THEN APPROXIMATE
 CONVERGENCE IS REACHED.
</p>

<p> SIMPLE NON-DETECTIONS ON Y MAY ALSO BE INCLUDED
</p>

<p> AUTHOR : BRANDON C. KELLY, STEWARD OBS., JULY 2006
</p>

<p> INPUTS :
</p>

<p>   X - THE OBSERVED INDEPENDENT VARIABLES. THIS SHOULD BE AN
       [NX, NP]-ELEMENT ARRAY.
   Y - THE OBSERVED DEPENDENT VARIABLE. THIS SHOULD BE AN NX-ELEMENT
       VECTOR.
</p>

<p> OPTIONAL INPUTS :
</p>

<p>   XVAR - THE COVARIANCE MATRIX OF THE X ERRORS, AND
          [NX,NP,NP]-ELEMENT ARRAY. XVAR[I,*,*] IS THE COVARIANCE
          MATRIX FOR THE ERRORS ON X[I,*]. THE DIAGONAL OF
          XVAR[I,*,*] MUST BE GREATER THAN ZERO FOR EACH DATA POINT.
   YVAR - THE VARIANCE OF THE Y ERRORS, AND NX-ELEMENT VECTOR. YVAR
          MUST BE GREATER THAN ZERO.
   XYCOV - THE VECTOR OF COVARIANCES FOR THE MEASUREMENT ERRORS
           BETWEEN X AND Y.
   DELTA - AN NX-ELEMENT VECTOR INDICATING WHETHER A DATA POINT IS
           CENSORED OR NOT. IF DELTA[i] = 1, THEN THE SOURCE IS
           DETECTED, ELSE IF DELTA[i] = 0 THE SOURCE IS NOT DETECTED
           AND Y[i] SHOULD BE AN UPPER LIMIT ON Y[i]. NOTE THAT IF
           THERE ARE CENSORED DATA POINTS, THEN THE
           MAXIMUM-LIKELIHOOD ESTIMATE (THETA) IS NOT VALID. THE
           DEFAULT IS TO ASSUME ALL DATA POINTS ARE DETECTED, IE,
           DELTA = REPLICATE(1, NX).
   SILENT - SUPPRESS TEXT OUTPUT.
   MINITER - MINIMUM NUMBER OF ITERATIONS PERFORMED BY THE GIBBS
             SAMPLER. IN GENERAL, MINITER = 5000 SHOULD BE SUFFICIENT
             FOR CONVERGENCE. THE DEFAULT IS MINITER = 5000. THE
             GIBBS SAMPLER IS STOPPED AFTER RHAT &lt; 1.1 FOR ALPHA,
             BETA, AND SIGMA^2, AND THE NUMBER OF ITERATIONS
             PERFORMED IS GREATER THAN MINITER.
   MAXITER - THE MAXIMUM NUMBER OF ITERATIONS PERFORMED BY THE
             MCMC. THE DEFAULT IS 1D5. THE GIBBS SAMPLER IS STOPPED
             AUTOMATICALLY AFTER MAXITER ITERATIONS.
   NGAUSS - THE NUMBER OF GAUSSIANS TO USE IN THE MIXTURE
            MODELLING. THE DEFAULT IS 3.
</p>

<p> OUTPUT :
</p>

<p>    POST - A STRUCTURE CONTAINING THE RESULTS FROM THE GIBBS
           SAMPLER. EACH ELEMENT OF POST IS A DRAW FROM THE POSTERIOR
           DISTRIBUTION FOR EACH OF THE PARAMETERS.
</p>

<p>             ALPHA - THE CONSTANT IN THE REGRESSION.
             BETA - THE SLOPES OF THE REGRESSION.
             SIGSQR - THE VARIANCE OF THE INTRINSIC SCATTER.
             PI - THE GAUSSIAN WEIGHTS FOR THE MIXTURE MODEL.
             MU - THE GAUSSIAN MEANS FOR THE MIXTURE MODEL.
             T - THE GAUSSIAN COVARIANCE MATRICES FOR THE MIXTURE
                 MODEL.
             MU0 - THE HYPERPARAMETER GIVING THE MEAN VALUE OF THE
                   GAUSSIAN PRIOR ON MU.
             U - THE HYPERPARAMETER DESCRIBING FOR THE PRIOR
                 COVARIANCE MATRIX OF THE INDIVIDUAL GAUSSIAN
                 CENTROIDS ABOUT MU0.
             W - THE HYPERPARAMETER DESCRIBING THE <code>TYPICAL' SCALE</code>
                 MATRIX FOR THE PRIOR ON (T,U).
             XIMEAN - THE MEAN OF THE DISTRIBUTION FOR THE
                      INDEPENDENT VARIABLE, XI.
             XIVAR - THE STANDARD COVARIANCE MATRIX FOR THE
                     DISTRIBUTION OF THE INDEPENDENT VARIABLE, XI.
             XICORR - SAME AS XIVAR, BUT FOR THE CORRELATION MATRIX.
             CORR - THE LINEAR CORRELATION COEFFICIENT BETWEEN THE
                    DEPENDENT AND INDIVIDUAL INDEPENDENT VARIABLES,
                    XI AND ETA.
             PCORR - SAME AS CORR, BUT FOR THE PARTIAL CORRELATIONS.
</p>

<p> CALLED ROUTINES :
</p>

<p>    RANDOMCHI, MRANDOMN, RANDOMWISH, RANDOMDIR, MULTINOM
</p>

<p> REFERENCES :
</p>

<p>   Carroll, R.J., Roeder, K., & Wasserman, L., 1999, Flexible
     Parametric Measurement Error Models, Biometrics, 55, 44
</p>

<p>   Kelly, B.C., 2007, Some Aspects of Measurement Error in
     Linear Regression of Astronomical Data, ApJ, In press
     (astro-ph/0705.2774)
</p>

<p>   Gelman, A., Carlin, J.B., Stern, H.S., & Rubin, D.B., 2004,
     Bayesian Data Analysis, Chapman & Hall/CRC
</p>

</div>
      </div>
      

      

      

      

      

      
      <div>
        <h2>Routines</h2>

        <dl class="routine-summary">
          
            <dt class="syntax"><a href="#mlinmix_chol_invert"><code><span class="var">result</span> = mlinmix_chol_invert(<span class="argument">L</span>)</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#mlinmix_posdef_invert"><code>mlinmix_posdef_invert<span class="argument">, A</span></code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#mlinmix_err"><code>mlinmix_err<span class="argument">, x</span><span class="argument">, y</span><span class="argument">, post</span><span class="argument">, xvar=<span class="var">xvar</span></span><span class="argument">, yvar=<span class="var">yvar</span></span><span class="argument">, xycov=<span class="var">xycov</span></span><span class="argument">, silent=<span class="var">silent</span></span><span class="argument">, delta=<span class="var">delta</span></span><span class="argument">, miniter=<span class="var">miniter</span></span><span class="argument">, maxiter=<span class="var">maxiter</span></span><span class="argument">, ngauss=<span class="var">ngauss</span></span></code></a></dt>
            <dd class="small"></dd>
          
        </dl>
      </div>
      


      
      <div id="routine-details">
        <h2>Routine details</h2>

        
        <div class="routine-details details" id="mlinmix_chol_invert">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="mlinmix_err-code.html#mlinmix_chol_invert:source" class="top">source</a> mlinmix_chol_invert<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = mlinmix_chol_invert(<span class="argument"><a href="#mlinmix_chol_invert:p:L">L</a></span>)</code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="mlinmix_chol_invert:p:L">L <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="mlinmix_posdef_invert">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="mlinmix_err-code.html#mlinmix_posdef_invert:source" class="top">source</a> mlinmix_posdef_invert<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>mlinmix_posdef_invert<span class="argument">, <a href="#mlinmix_posdef_invert:p:A">A</a></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="mlinmix_posdef_invert:p:A">A <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="mlinmix_err">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="mlinmix_err-code.html#mlinmix_err:source" class="top">source</a> mlinmix_err<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>mlinmix_err<span class="argument">, <a href="#mlinmix_err:p:x">x</a></span><span class="argument">, <a href="#mlinmix_err:p:y">y</a></span><span class="argument">, <a href="#mlinmix_err:p:post">post</a></span><span class="argument">, <a href="#mlinmix_err:k:xvar">xvar</a>=<span class="var">xvar</span></span><span class="argument">, <a href="#mlinmix_err:k:yvar">yvar</a>=<span class="var">yvar</span></span><span class="argument">, <a href="#mlinmix_err:k:xycov">xycov</a>=<span class="var">xycov</span></span><span class="argument">, <a href="#mlinmix_err:k:silent">silent</a>=<span class="var">silent</span></span><span class="argument">, <a href="#mlinmix_err:k:delta">delta</a>=<span class="var">delta</span></span><span class="argument">, <a href="#mlinmix_err:k:miniter">miniter</a>=<span class="var">miniter</span></span><span class="argument">, <a href="#mlinmix_err:k:maxiter">maxiter</a>=<span class="var">maxiter</span></span><span class="argument">, <a href="#mlinmix_err:k:ngauss">ngauss</a>=<span class="var">ngauss</span></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="mlinmix_err:p:x">x <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="mlinmix_err:p:y">y <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="mlinmix_err:p:post">post <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="mlinmix_err:k:xvar">xvar <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="mlinmix_err:k:yvar">yvar <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="mlinmix_err:k:xycov">xycov <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="mlinmix_err:k:silent">silent <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="mlinmix_err:k:delta">delta <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="mlinmix_err:k:miniter">miniter <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="mlinmix_err:k:maxiter">maxiter <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="mlinmix_err:k:ngauss">ngauss <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>878</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:48 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>