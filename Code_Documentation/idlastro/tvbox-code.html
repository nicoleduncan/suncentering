<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:09 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>tvbox.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="tvbox.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="tvbox:source"></a>pro tvbox,width,x,y,color,DATA = data,Color=TheColor, ANGLE = angle, $
                 DEVICE=device, SQUARE=SQUARE,  _EXTRA = _EXTRA
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;      TVBOX</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;      Draw a box(es) or rectangle(s) of specified width</span>
<span class="comments">; EXPLANATION: </span>
<span class="comments">;      Positions can be specified either by the cursor position or by </span>
<span class="comments">;      supplying a vector of X,Y positions.  By default, TVBOX now</span>
<span class="comments">;     (since Jan 2012) assumes data coordinates if !X.crange is set. </span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;      TVBOX, width, [ x, y, color, /DATA, ANGLE= ,COLOR =, _EXTRA =  ]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;      WIDTH -  either a scalar giving the width of a box, or a 2 element</span>
<span class="comments">;               vector giving the length and width of a rectangle.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:           </span>
<span class="comments">;      X  -  x position for box center, scalar or vector</span>
<span class="comments">;      Y  -  y position for box center, scalar or vector.   If vector, then Y</span>
<span class="comments">;            must have the same number of elements as X</span>
<span class="comments">;            Positions are specified in device coordinates unless /DATA is set</span>
<span class="comments">;            If X and Y are not specified, and device has a cursor, then </span>
<span class="comments">;            TVBOX will draw a box at current cursor position</span>
<span class="comments">;      COLOR - String or integer specifying the color  to draw the box(es)</span>
<span class="comments">;            If COLORS is a scalar then all boxes are drawn with the same</span>
<span class="comments">;            color value.   Otherwise, the Nth box is drawn with the</span>
<span class="comments">;            Nth value of color.    Color can also be specified as </span>
<span class="comments">;            string (e.g.'red').   See cgCOLOR for a list of available</span>
<span class="comments">;            color names.     Default = "opposite".    </span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;      None</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL KEYWORD INPUTS:</span>
<span class="comments">;      ANGLE - numeric scalar specifying the clockwise rotation of</span>
<span class="comments">;              the boxes or rectangles.</span>
<span class="comments">;      COLOR - Scalar or vector, overrides the COLOR input parameter</span>
<span class="comments">;              Color can be specified as a string (e.g. 'red') or intensity </span>
<span class="comments">;              value. See cgCOLOR() for a list of color names.       </span>
<span class="comments">;               Default = 'opposite' (i.e. color opposite the background).   </span>
<span class="comments">;      /DATA - if this keyword is set and non-zero, then the box width and</span>
<span class="comments">;              X,Y position center are interpreted as being in DATA </span>
<span class="comments">;              coordinates.   Note that data coordinates must be previously</span>
<span class="comments">;              defined (with a PLOT or CONTOUR call).   The default</span>
<span class="comments">;              is to assume data coordinates if !X.CRANGE is set.    Force</span>
<span class="comments">;              device coordinates by setting DATA = 0 or /DEVICE</span>
<span class="comments">;      /DEVICE Set this keyword to force use of device coordinates</span>
<span class="comments">;      /FILL  - If set, fill the box using cgCOLORFILL</span>
<span class="comments">;      /SQUARE - If set, then a square is drawn, even if in data coordinates</span>
<span class="comments">;               with unequal X and Y axes.   The X width is used for the</span>
<span class="comments">;               square width, and the Y width is ignored.</span>
<span class="comments">;</span>
<span class="comments">;      Any keyword recognized by cgPLOTS (or cgCOLORFILL if /FILL is set) </span>
<span class="comments">;      is also recognized by TVBOX.   </span>
<span class="comments">;      In particular, the linestyle, thickness and clipping of the boxes</span>
<span class="comments">;      is controlled by the  LINESTYLE, THICK and NOCLIP keywords.</span>
<span class="comments">;      (Clipping is turned off by default, set NOCLIP=0 to activate it.)</span>
<span class="comments">;      If /FILL is set then available keywords include LINE_FILL and </span>
<span class="comments">;      FILL_PATTERN. </span>
<span class="comments">;</span>
<span class="comments">; SIDE EFFECTS:</span>
<span class="comments">;       A square or rectangle will be drawn on the device</span>
<span class="comments">;       For best results WIDTH should be odd when using the default DEVICE</span>
<span class="comments">;       coordinates.  (If WIDTH is even, the actual size of the box will be </span>
<span class="comments">;       WIDTH + 1, so that box remains centered.)</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLES:</span>
<span class="comments">;       (1) Draw a double thick box of width 13, centered at 221,256 in the</span>
<span class="comments">;       currently active window</span>
<span class="comments">;</span>
<span class="comments">;           IDL> tvbox, 13, 221, 256, thick=2</span>
<span class="comments">;</span>
<span class="comments">;       (2) Overlay a "slit" with dimension 52" x 2" on a previously displayed</span>
<span class="comments">;           image at a position angle (East of North) of 32 degrees.    The </span>
<span class="comments">;           slit is to be centered at XC, YC and the plate scale </span>
<span class="comments">;           arcsec_per_pixel is known.</span>
<span class="comments">;</span>
<span class="comments">;           IDL> w = [2.,52.]/arcsec_per_pixel ;Convert slit size to pixel units</span>
<span class="comments">;           IDL> tvbox,w,XC,YC,ang=-32          ;Draw slit</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;         Allows use of only device (default) or data (if /DATA is set) </span>
<span class="comments">;           coordinates.   Normalized coordinates are not allowed</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       cgpolygon, zparcheck</span>
<span class="comments">; REVISON HISTORY:</span>
<span class="comments">;       Written, W. Landsman   STX Co.           10-6-87</span>
<span class="comments">;       Modified to take vector arguments. Greg Hennessy Mar 1991</span>
<span class="comments">;       Fixed centering of odd width    W. Landsman    Sep. 1991</span>
<span class="comments">;       Let the user specify COLOR=0, accept vector color, W. Landsman Nov. 1995</span>
<span class="comments">;       Fixed typo in _EXTRA keyword  W. Landsman   August 1997</span>
<span class="comments">;       Added ANGLE keyword    W.Landsman     February 2000 </span>
<span class="comments">;       Make sure ANGLE is a scalar   W. Landsman  September 2001</span>
<span class="comments">;       Don't round coordinates if /DATA is set.   M. Perrin  August 2005</span>
<span class="comments">;       Use STRICT_EXTRA to flag valid keywords W. Landsman Sep 2005</span>
<span class="comments">;       Check that width has only 1 or 2 elements W. Landsman August 2010</span>
<span class="comments">;       Use Coyote Graphcis  W. Landsman February 2011</span>
<span class="comments">;       Added /FILL keyword  W. Landsman  July 2011</span>
<span class="comments">;       Default to data coordinates if !X.crange present  WL Jan 2012</span>
<span class="comments">;       Added Square keyword  WL.  April 2012</span>
<span class="comments">;       </span>
<span class="comments">;-</span>
 compile_opt idl2
 On_error,2

 npar = N_params()                         <span class="comments">;Get number of parameters</span>

 if ( npar LT 1 ) then begin
     print,'Syntax - TVBOX, width,[ x, y, color, THICK= ,/DATA, ANGLE=, COLOR=]'
     return
 endif

 zparcheck, 'TVBOX', width, 1, [1,2,3,4,5], [0,1], 'Box Width'

 if N_elements(width) GT 2 then message, $
     'ERROR - First parameter (box width) must have 1 or 2 values' 
 if ( N_elements(width) EQ 2 ) then w = width/2. else w = [width,width]/2.

<span class="comments">; Use data coordinates if !X.crange is set (previous plot) and /DEVICE not set </span>

<span class="comments">; Default to data coordinates if !X.crange is set (previous plot) </span>
   if keyword_set(device) then datacoord = 0 else begin
      if N_elements(data) eq 0 then datacoord = !x.crange[0] NE !x.crange[1]  $
                          else datacoord = logical_true(data)
   endelse   			  
 

<span class="comments">; Can't figure out in IDL how to figure out if the device has a cursor so</span>
<span class="comments">; we'll just check for a postscript device</span>

 if ( npar LT 3 ) then if  (!D.NAME NE 'PS') then begin 
    cursor,x,y,/DEVICE,/NOWAIT          <span class="comments">;Read X,Y from the window</span>
    if (x LT 0) or (y LT 0) then begin
       message,'Position cursor in window ' + strtrim(!D.WINDOW,2) + $
              ' -- then hit mouse button',/INF
       cursor,x,y,/DEVICE,/WAIT
       message, 'Box is centered at (' + strtrim(x,2) + ',' + $
                 strtrim(y,2) + ')',/INF
    endif
 endif else message, $
     'ERROR - X,Y position must be specified for Postscript device'

 if N_elements(TheColor) EQ 0 then begin 
     if N_elements(color) EQ 0 then color = cgcolor('opposite')
 endif else color = TheColor    
 nbox = N_elements(x)                      <span class="comments">;Number of boxes to draw</span>
 if ( nbox NE N_elements(Y) ) then $
       message,'ERROR - X and Y positions must have same number of elements'

 xs = x & ys = y
 
 Ncol = N_elements(color)
 xbox = [1,1,-1,-1,1]*w[0]
 ybox = [-1,1,1,-1,-1]*w[1]
 if keyword_set(angle) then begin           <span class="comments">;Non-zero rotation angle?</span>
       ang = angle[0]/!RADEG
       xprime =  xbox*cos(ang) + ybox*sin(ang)
       yprime = -xbox*sin(ang) + ybox*cos(ang)
       xbox = xprime
       ybox = yprime
 endif
 
 if keyword_set(square) && datacoord then begin
 <span class="comments">; Get ratio of unit vectors in X and Y direction</span>
   t = convert_coord([0,w[0],0],[0,0,w[0]],/data,/to_device)
   ratio = (t[0,1]-t[0,0])/(t[1,2]-t[1,0])
    ybox = ybox*ratio
 endif
      
 for i = 0l, nbox-1 do begin

  j = i &lt<span class="comments">; (Ncol-1)</span>
  xt = xs[i] + xbox      <span class="comments">;X edges of rectangle</span>
  yt = ys[i] + ybox     <span class="comments">;Y edges of rectangle</span>
   
<span class="comments">; Plot the box in data or device coordinates.   Default for Coyote graphcis</span>
<span class="comments">; is data coordinates. </span>

  if datacoord then $
     cgpolygon, xt, yt, color= color[j], _STRICT_EXTRA = _EXTRA $
   else begin    
 <span class="comments">; only round coordinates to integers if using device coords;</span>
 <span class="comments">; data coords can potentially be fractional.</span>
     xt = round(xt) & yt = round(yt)
     cgpolygon,xt,yt,/DEVICE,color=color[j],_STRICT_EXTRA=_EXTRA  
   endelse
 endfor

 return
 end
</code>
    </div>
  </body>
</html>