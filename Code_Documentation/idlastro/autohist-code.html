<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:19 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>autohist.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="autohist.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO AUTOHIST,V, ZX,ZY,XX,YY, NOPLOT=whatever,_EXTRA = _extra
<span class="comments">;</span>
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       AUTOHIST</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Draw a histogram using automatic bin-sizing.</span>
<span class="comments">; EXPLANATION</span>
<span class="comments">;       AUTOHIST chooses a number of bins (initially, SQRT(2*N). If this leads </span>
<span class="comments">;       to a histogram in which > 1/5 of the central 50% of the bins are empty,</span>
<span class="comments">;       it decreases the number of bins and tries again. The minimum # bins is </span>
<span class="comments">;       5. The max=199.     Called by HISTOGAUSS and HALFAGAUSS.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       AUTOHIST, Sample, XLines, Ylines, XCenters, YCenters, [/NOPLOT, ]</span>
<span class="comments">;                             ...Plotting Keywords</span>
<span class="comments">; INPUT:</span>
<span class="comments">;       Sample = the vector to be histogrammed</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       XLINES = vector of x coordinates of the points that trace the rectangular </span>
<span class="comments">;               histogram bins</span>
<span class="comments">;       YLINES = vector of y coordinates. To draw the histogram plot YLINES vs </span>
<span class="comments">;                 XLINES</span>
<span class="comments">;       XCENTERS = the x values of the bin centers</span>
<span class="comments">;       YCENTERS = the corresponding y values</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS:</span>
<span class="comments">;       /NOPLOT  If set, nothing is drawn</span>
<span class="comments">;</span>
<span class="comments">;       Any plotting keywords (e.g. XTITLE) may be supplied to AUTOHIST through</span>
<span class="comments">;       the _EXTRA facility. </span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written,   H. Freudenreich, STX, 1/91</span>
<span class="comments">;       1998 March 17 - Changed shading of histogram.  RSH, RSTX</span>
<span class="comments">;       V5.0 update, _EXTRA keywords  W. Landsman    April 2002</span>
<span class="comments">;       Added NOCLIP keyword for POLYFILL call C. Paxson/W. Landsman July 2003</span>
<span class="comments">;       Use Coyote graphics   W. Landsman  Feb 2011</span>
<span class="comments">;-</span>

 ON_ERROR,2
 compile_opt idl2 
 
 if N_params() LT 1 then begin
    print,'Syntax - AUTOHIST, Sample, XLines, Ylines, XCenters, YCenters, [ '
    print,'                           /NOPLOT, Plotting keywords... ]'
    return
 endif

 MINBIN=5

 N = N_ELEMENTS(V)
 NB = FIX(SQRT(2.*N)) &lt<span class="comments">; 199</span>
 NB = NB > MINBIN

 X1 = MIN(V, MAX = X2)

tryagain:

 DX = (X2-X1)/NB
 XX = FINDGEN(NB)*DX + DX/2. + X1

 IND = (V-X1)/DX > 0 &lt<span class="comments">;(NB-1)</span>

<span class="comments">;  Compute the histogram for the current binning </span>

 YY = HISTOGRAM(IND,MIN=0,MAX = NB-1)

<span class="comments">; Count the fraction of empty bins in the middle half of the histogram:</span>
 X14 = (XX[NB-1]-XX[0])/4.+X1
 X34 = XX[NB-1]-(XX[NB-1]-XX[0])/4.
 Q=WHERE( (YY EQ 0.) AND (XX GT X14) AND (XX LT X34), COUNT )
 IF (COUNT GT NB/10) AND (NB GT MINBIN) THEN BEGIN  <span class="comments">; 20% EMPTY</span>
   NB = 3*NB/4
   IF NB LT (2*N) THEN GOTO,tryagain
ENDIF

<span class="comments">; Fill in ZX,ZY:</span>
 MB = 2*NB+2
 ZX = FLTARR(MB)  &  ZY = FLTARR(MB)
 IT = INDGEN(NB)*2 + 1

 ZY[IT] = YY   &  ZY[IT+1] = YY

 ZX[0] = X1       
 ZX[IT] = XX - DX/2. &   ZX[IT+1] = XX + DX/2.
 ZX[MB-1] = X2 

IF KEYWORD_SET(WHATEVER) THEN RETURN

<span class="comments">; Plot, then fill, the bins:</span>
 YTOP = MAX(YY[1:NB-2])
 YY[0] = YY[0] &lt<span class="comments">; YTOP</span>
 YY[NB-1] = YY[NB-1] &lt<span class="comments">; YTOP</span>
 cgPLOT,XX,YY,XRAN=[X1-DX,X2+DX],YRAN=[0.,1.1*YTOP],PSYM=10,_EXTRA=_extra
 FOR J=0,NB-1 DO BEGIN
  IF YY[J] GT 0 THEN BEGIN
     A=[XX[J]-DX/2.,XX[J]+DX/2.,XX[J]+DX/2.,XX[J]-DX/2.] 
     B=[0.,0.,YY[J],YY[J]]
     cgcolorFILL,A,B,orientation=45,noclip=0
  ENDIF
ENDFOR

RETURN
END
</code>
    </div>
  </body>
</html>