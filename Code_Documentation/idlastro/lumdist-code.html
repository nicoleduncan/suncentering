<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:46 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>lumdist.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="lumdist.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME: </span>
<span class="comments">;    LUMDIST</span>
<span class="comments">;       </span>
<span class="comments">; PURPOSE: </span>
<span class="comments">;    Calculate luminosity distance (in Mpc) of an object given its redshift </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;    The luminosity distance in the Friedmann-Robertson-Walker model is </span>
<span class="comments">;    taken from  Caroll, Press, and Turner (1992, ARAA, 30, 499), p. 511</span>
<span class="comments">;    Uses a closed form (Mattig equation) to compute the distance when the </span>
<span class="comments">;    cosmological constant is zero.   Otherwise integrates the function using</span>
<span class="comments">;    QSIMP.	</span>
<span class="comments">; CALLING SEQUENCE: </span>
<span class="comments">;    result = lumdist(z, [H0 = , k = , Omega_M =, Lambda0 = , q0 = ,/SILENT])</span>
<span class="comments">;      </span>
<span class="comments">; INPUTS:</span>
<span class="comments">;    z = redshift, positive scalar or vector</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL KEYWORD INPUTS: </span>
<span class="comments">;    /SILENT - If set, the program will not display adopted cosmological</span>
<span class="comments">;        parameters at the terminal.</span>
<span class="comments">;    H0: Hubble parameter  in km/s/Mpc, default is 70</span>
<span class="comments">;</span>
<span class="comments">;        No more than two of the following four parameters should be</span>
<span class="comments">;        specified.   None of them need be specified -- the adopted defaults</span>
<span class="comments">;        are given.</span>
<span class="comments">;    k - curvature constant, normalized to the closure density.   Default is</span>
<span class="comments">;        0, indicating a flat universe</span>
<span class="comments">;    Omega_m -  Matter density, normalized to the closure density, default</span>
<span class="comments">;        is 0.3.   Must be non-negative</span>
<span class="comments">;    Lambda0 - Cosmological constant, normalized to the closure density,</span>
<span class="comments">;        default is 0.7</span>
<span class="comments">;    q0 - Deceleration parameter, numeric scalar = -R*(R'')/(R')^2, default</span>
<span class="comments">;        is -0.55</span>
<span class="comments">;       </span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;    The result of the function is the luminosity distance (in Mpc) for each </span>
<span class="comments">;    input value of z.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;    (1) Plot the distance of a galaxy in Mpc as a function of redshift out </span>
<span class="comments">;        to z = 5.0, assuming the default cosmology (Omega_m=0.3, Lambda = 0.7,</span>
<span class="comments">;        H0 = 70 km/s/Mpc)</span>
<span class="comments">;</span>
<span class="comments">;        IDL> z = findgen(50)/10.</span>
<span class="comments">;        IDL> plot,z,lumdist(z),xtit='z',ytit='Distance (Mpc)'</span>
<span class="comments">;</span>
<span class="comments">;        Now overplot the relation for zero cosmological constant and </span>
<span class="comments">;        Omega_m=0.3</span>
<span class="comments">;        IDL> oplot,z,lumdist(z,lambda=0,omega=0.3),linestyle=1</span>
<span class="comments">; COMMENTS:</span>
<span class="comments">;    (1) Integrates using the IDL Astronomy Version procedure QSIMP.    (The </span>
<span class="comments">;    intrinsic IDL QSIMP function is not called because of its ridiculous</span>
<span class="comments">;    restriction that only scalar arguments can be passed to the integrating</span>
<span class="comments">;    function.)</span>
<span class="comments">;    (2) Can fail to converge at high redshift for closed universes with</span>
<span class="comments">;    non-zero lambda.   This can presumably be fixed by replacing QSIMP with</span>
<span class="comments">;    an integrator that can handle a singularity </span>
<span class="comments">; PROCEDURES CALLED:</span>
<span class="comments">;    COSMO_PARAM, QSIMP   </span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;    Written   W. Landsman        Raytheon ITSS       April 2000</span>
<span class="comments">;    Avoid integer overflow for more than 32767 redshifts  July 2001</span>
<span class="comments">;    Use double precision J. Moustakas/W. Landsman April 2008</span>
<span class="comments">;-                                   </span>
<a id="ldist:source"></a> function ldist, z, q0 = q0, lambda0 = lambda0
   term1 = (1.+z)^2
   term2 =  1.+2.*(q0+lambda0)*z
   term3 = z*(2.+z)*lambda0
   denom = (term1*term2 - term3)
   out = z*0.  
   good = where(denom GT 0.0, Ngood)
   if Ngood GT 0 then out[good] = 1./sqrt(denom[good])
   return, out
 end 

 FUNCTION  lumdist, z, h0=h0, k = k, Lambda0 = lambda0, Omega_m = Omega_m, $
                    q0 = q0, Silent = silent

 compile_opt idl2
 if N_params() eq 0 then begin
	print,'Syntax: result = lumdist(z, H0 = ,k=, Lambda0 = ])'
	print,'Returns luminosity distance in Mpc'
	return, 0.
  endif

 n = N_elements(z)
 cosmo_param,Omega_m,Lambda0, k, q0 

<span class="comments">; Check keywords </span>
  c = 2.99792458D5                  <span class="comments">;  speed of light in km/s</span>
  if N_elements(H0) EQ 0 then H0 = 70
  if not keyword_set(silent) then $
     print,'LUMDIST: H0:', h0, ' Omega_m:', omega_m, ' Lambda0',lambda0, $
        ' q0: ',q0, ' k: ', k, f='(A,I3,A,f5.2,A,f5.2,A,f5.2,A,F5.2)' 
 
<span class="comments">; For the case of Lambda = 0, we use the closed form from equation 5.238 of</span>
<span class="comments">; Astrophysical Formulae (Lang 1998).   This avoids terms that almost cancel</span>
<span class="comments">; at small q0*z better than the more familiar Mattig formula.</span>
<span class="comments">;</span>
 if lambda0 EQ  0 then begin
    denom = sqrt(1+2*q0*z) + 1 + q0*z 
    dlum = (c*z/h0)*(1 + z*(1-q0)/denom)
    return,dlum
 
<span class="comments">; For non-zero lambda </span>
endif else begin 
    dlum = z*0.0 
    for  i=0L,N-1 do begin
         if z[i] LE 0.0 then dlum[i] = 0.0 else begin
         qsimp,'LDIST',0,z[i], lz,q0 = q0, Lambda0 = lambda0
         dlum[i] = lz
         endelse
    endfor

    if k GT 0 then $
         dlum = sinh(sqrt(k)*dlum)/sqrt(k) $
    else if k LT 0 then $
          dlum = sin(sqrt(-k)*dlum)/sqrt(-k) > 0 
    return, c*(1+z)*dlum/h0
 endelse   

 end
</code>
    </div>
  </body>
</html>