<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:59 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>rdfits_struct.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="rdfits_struct.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="rdfits_struct:source"></a>pro rdfits_struct, filename, struct,SILENT = silent, HEADER_ONLY = header_only,$
    EXTEN = exten 
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;      RDFITS_STRUCT</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;      Read an entire FITS file (all extensions) into a single IDL structure. </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;      Each header, image or table array is placed in a separate structure </span>
<span class="comments">;      tag.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;      RDFITS_STRUCT, filename, struct, /SILENT, /HEADER_ONLY, EXTEN= ]</span>
<span class="comments">;</span>
<span class="comments">; INPUT:</span>
<span class="comments">;      FILENAME = Scalar string giving the name of the FITS file.  </span>
<span class="comments">;                 One can also specify a gzip (.gz) compressed file </span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL KEYWORD: </span>
<span class="comments">;      /HEADER_ONLY - If set, then only the FITS headers (and not the data)</span>
<span class="comments">;                are read into the structure.</span>
<span class="comments">;      /SILENT - Set this keyword to suppress informational displays at the</span>
<span class="comments">;               terminal.</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;      struct = structure into which FITS data is read.   The primary header</span>
<span class="comments">;             and image are placed into tag names HDR0 and IM0.   The ith</span>
<span class="comments">;             extension is placed into the tag names HDRi, and either TABi</span>
<span class="comments">;             (if it is a binary or ASCII table) or IMi (if it is an image</span>
<span class="comments">;             extension)</span>
<span class="comments">;</span>
<span class="comments">;             If /HEADER_ONLY is set, then struct will contain tags HDR0, HDR1</span>
<span class="comments">;             ....HDRn containing all the headers of a FITS file with n </span>
<span class="comments">;             extensions</span>
<span class="comments">; OPTIONAL INPUT KEYWORD:</span>
<span class="comments">;       EXTEN - positive integer array specifying which extensions to read.</span>
<span class="comments">;             Default is to read all extensions. </span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       FITS_OPEN, FITS_READ, FITS_CLOSE</span>
<span class="comments">;</span>
<span class="comments">; METHOD:</span>
<span class="comments">;       The file is opened with FITS_OPEN which return information on the </span>
<span class="comments">;       number and type of each extension.    The CREATE_STRUCT() function</span>
<span class="comments">;       is used iteratively, with FITS_READ calls to build the final structure.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Read the FITS file 'm33.fits' into an IDL structure, st</span>
<span class="comments">;</span>
<span class="comments">;       IDL> rdfits_struct, 'm33.fits', st</span>
<span class="comments">;       IDL> help, /str, st                   ;Display info about the structure</span>
<span class="comments">;</span>
<span class="comments">;       To just read the second and fourth extensions </span>
<span class="comments">;       IDL> rdfits_struct, 'm33.fits', st, exten=[2,4]</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;       Does not handle random groups or variable length binary tables</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       Written K. Venkatakrishna, STX April 1992</span>
<span class="comments">;       Code cleaned up a bit  W. Landsman  STX  October 92</span>
<span class="comments">;       Modified for MacOS     I.  Freedman  HSTX April 1994</span>
<span class="comments">;       Work under Windows 95  W. Landsman   HSTX  January 1996</span>
<span class="comments">;       Use anonymous structures, skip extensions without data WBL April 1998</span>
<span class="comments">;       Converted to IDL V5.0, W. Landsman, April 1998</span>
<span class="comments">;       OS-independent deletion of temporary file  W. Landsman  Jan 1999</span>
<span class="comments">;       Major rewrite to use FITS_OPEN and CREATE_STRUCT() W. Landsman Sep 2002</span>
<span class="comments">;       Added /HEADER_ONLY keyword   W. Landsman  October 2003</span>
<span class="comments">;       Do not copy primary header into extension headers W. Landsman Dec 2004</span>
<span class="comments">;       Do not modify NAXIS when using /HEADER_ONLY W. Landsman Jan 2005</span>
<span class="comments">;       Added EXTEN keyword  W. Landsman July 2009</span>
<span class="comments">;-</span>

 compile_opt idl2
 if N_Params() LT 2 then begin 
        print,'Syntax - RDFITS_STRUCT, file, struct, [ /SILENT, /HEADER_ONLY ]'
        return
 endif

 fits_open, filename, fcb                <span class="comments">; Get the description of the file</span>
 if ~keyword_set(silent) then $
      message,/inf,'Now reading file ' + filename + ' with ' + $
      strtrim(fcb.nextend,2) + ' extensions'

 h_only = keyword_set(header_only)  
 if h_only then begin
     fits_read,fcb,0,h,/header_only,exten_no=0
     struct = {hdr0:h}
 endif else begin
     fits_read,fcb,d,h,exten_no=0
     struct = {hdr0:h,im0:temporary(d)}
 endelse

 if fcb.nextend EQ 0 then begin
      fits_close,fcb 
      return
 endif

 n = N_elements(exten)
 if N_elements(exten) EQ 0 then begin 
      n = fcb.nextend 
      exten = indgen(n)+1
 endif else begin 
      if max(exten) GT fcb.nextend then message, $
          'ERROR - extension ' + strtrim(max(exten),2) + ' does not exist'     
 endelse
 for i= 0, n-1 do begin
     j = exten[i]
     jj  = strtrim(j,2)
     if h_only then begin
     fits_read,fcb,0,h,/header_only,/no_pdu,exten=j
     struct = create_struct(temporary(struct), 'hdr' + jj, $
              temporary(h))
     endif else begin
     fits_read,fcb,d,h,/no_pdu,exten=j
     if fcb.xtension[j] EQ 'IMAGE' then tag = 'im' + jj $
                                else tag = 'tab' + jj
     struct = create_struct(temporary(struct), 'hdr' + jj, $
              temporary(h),tag, temporary(d))
    endelse
 endfor
     
 fits_close,fcb                             
 return
 end
</code>
    </div>
  </body>
</html>