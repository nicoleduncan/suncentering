<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:03 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>sxginfo.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="sxginfo.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="sxginfo:source"></a>pro sxginfo,h,par,type,sbyte,nbytes
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	SXGINFO</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Return information on all group parameters in an STSDAS header.</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;	Return datatype, starting byte, and number bytes for all group</span>
<span class="comments">;	parameters in an STSDAS file.     Obtaining these values </span>
<span class="comments">;	greatly speed up execution time in subsequent calls to SXGPAR.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	sxginfo, h, par, type, sbyte, nbytes</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	h - header returned by SXOPEN</span>
<span class="comments">;	par - parameter block returned by SXREAD or multiple</span>
<span class="comments">;		parameter blocks stored in array of dimension</span>
<span class="comments">;		greater than one.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;	type - data type (if not supplied or null string, the</span>
<span class="comments">;		header is searched for type,sbyte, and nbytes)</span>
<span class="comments">;	sbyte - starting byte in parameter block for data</span>
<span class="comments">;	nbytes - number of bytes in parameter block for data</span>
<span class="comments">;</span>
<span class="comments">;	The number of elements in type,sbyte and nbytes equals the total</span>
<span class="comments">;	number of group parameters.</span>
<span class="comments">;</span>
<span class="comments">; METHOD:</span>
<span class="comments">;	The parameter type for each parameter is obtained</span>
<span class="comments">;	from PDTYPEn keyword.  If not found then DATATYPE keyword</span>
<span class="comments">;	value is used.  If that is not found then BITPIX is</span>
<span class="comments">;	used.  BITPIX=8, byte; BITPIX=16 integer*2; BITPIX=32</span>
<span class="comments">;	integer*4.</span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;	For an example of the use of SXGINFO, see CONV_STSDAS</span>
<span class="comments">;</span>
<span class="comments">; HISTORY:</span>
<span class="comments">;	version 1  W. Landsman   Apr. 93</span>
<span class="comments">;</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;------------------------------------------------------------</span>
 On_error,2

 if N_params() LT 3 then begin
	print,'Syntax - sxginfo,h,par,type,sbyte,nbytes'
	return
 endif

<span class="comments">; determine size of output result</span>

	s = size(par)
	ndim = s[0]
	dtype = s[ndim+1]
	case 1 of
	    (ndim eq 0) or (dtype ne 1) : message, $
			'Invalid parameter block specified'	

	    ndim eq 1 : begin
			scalar = 1	<span class="comments">; output will be scalar</span>
			dimen = intarr(1)+1
			end
	    else: begin
			scalar = 0	<span class="comments">; output will be vector</span>
			dimen = s[2:ndim]
		 	end
	endcase
	plen = s[1]		<span class="comments">;length of parameter blocks</span>
<span class="comments">;</span>
<span class="comments">; check remaining input parameters</span>
<span class="comments">;</span>
	s=size(h)
	!err=-1
	if (s[0] ne 1) or (s[2] ne 7) then message, $
		'Header array must be string array'

	if strlen(h[0]) ne 80 then message, $
		'Header must contain 80 character strings'
<span class="comments">;</span>
<span class="comments">; get number of group parameters and size</span>
<span class="comments">;</span>
<span class="comments">;</span>
	pcount = sxpar(h,'PCOUNT')	<span class="comments">;get number of group parameters</span>
	if pcount eq 0 then begin
		message,'No group parameters present',/INFO
		return
	endif

        sbyte = intarr(pcount)
        nbytes = intarr(pcount)
        type = strarr(pcount)

<span class="comments">; Determine BITPIX and DATATYPE in case PSIZE or PDTYPE is undefined</span>

	nbits=0		<span class="comments">;number of bits to skip</span>
	dtype = strtrim(sxpar(h, 'DATATYPE') )
	bitpix = sxpar(h,'BITPIX')
	if !err lt 0 then begin
		case bitpix of
			8: dtype = 'BYTE'
			16: dtype = 'INTEGER*2'
			32: dtype = 'INTEGER*4'
                       -32: dtype = 'REAL*4'
		       -64: dtype = 'REAL*8'	
		endcase
	endif

	for i = 1,pcount do begin
		nbit = sxpar(h,'PSIZE'+strtrim(i,2))
		if !err lt 0 then nbit = bitpix
		nbits=nbits+nbit
		if i NE pcount then sbyte[i]=nbits/8   <span class="comments">;number of bytes to skip</span>
		pdtype = strtrim(sxpar(h,'PDTYPE' + strtrim(i,2)))
		if !ERR LT 0 then pdtype = dtype
		type[i-1] = pdtype
		aster = strpos(pdtype,'*')
		if aster gt 0 then $
		nbytes[i-1]=fix(strmid(pdtype,aster+1,strlen(pdtype)-aster-1)) $
		else nbytes[i-1]=4
	endfor

  return
  end
</code>
    </div>
  </body>
</html>