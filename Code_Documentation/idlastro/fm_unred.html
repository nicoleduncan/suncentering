<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:31 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>fm_unred.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="fm_unred.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="fm_unred-code.html" title="Chromocoded source">Source</a> <a href="fm_unred.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">fm_unred.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="fm_unred">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="fm_unred-code.html#fm_unred:source" class="top">source</a> fm_unred<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>fm_unred<span class="argument">, <a href="#fm_unred:p:wave">wave</a></span><span class="argument">, <a href="#fm_unred:p:flux">flux</a></span><span class="argument">, <a href="#fm_unred:p:ebv">ebv</a></span><span class="argument">, <a href="#fm_unred:p:funred">funred</a></span><span class="argument">, <a href="#fm_unred:k:R_V">R_V</a>=<span class="var">R_V</span></span><span class="argument">, <a href="#fm_unred:k:gamma">gamma</a>=<span class="var">gamma</span></span><span class="argument">, <a href="#fm_unred:k:x0">x0</a>=<span class="var">x0</span></span><span class="argument">, <a href="#fm_unred:k:c1">c1</a>=<span class="var">c1</span></span><span class="argument">, <a href="#fm_unred:k:c2">c2</a>=<span class="var">c2</span></span><span class="argument">, <a href="#fm_unred:k:c3">c3</a>=<span class="var">c3</span></span><span class="argument">, <a href="#fm_unred:k:c4">c4</a>=<span class="var">c4</span></span><span class="argument">, <a href="#fm_unred:k:avglmc">avglmc</a>=<span class="var">avglmc</span></span><span class="argument">, <a href="#fm_unred:k:lmc2">lmc2</a>=<span class="var">lmc2</span></span><span class="argument">, <a href="#fm_unred:k:ExtCurve">ExtCurve</a>=<span class="var">ExtCurve</span></span></code></p>

          
          <div class="small "><p> NAME:
     FM_UNRED
 PURPOSE:
     Deredden a flux vector using the Fitzpatrick (1999) parameterization
 EXPLANATION:
     The R-dependent Galactic extinction curve is that of Fitzpatrick & Massa
     (Fitzpatrick, 1999, PASP, 111, 63; astro-ph/9809387 ).
     Parameterization is valid from the IR to the far-UV (3.5 microns to 0.1
     microns).    UV extinction curve is extrapolated down to 912 Angstroms.
</p>

<p> CALLING SEQUENCE:
     FM_UNRED, wave, flux, ebv, [ funred, R_V = , /LMC2, /AVGLMC, ExtCurve=
                       gamma =, x0=, c1=, c2=, c3=, c4= ]
 INPUT:
      WAVE - wavelength vector (Angstroms)
      FLUX - calibrated flux vector, same number of elements as WAVE
               If only 3 parameters are supplied, then this vector will
               updated on output to contain the dereddened flux.
      EBV  - color excess E(B-V), scalar.  If a negative EBV is supplied,
               then fluxes will be reddened rather than dereddened.
</p>

<p> OUTPUT:
      FUNRED - unreddened flux vector, same units and number of elements
               as FLUX
</p>

<p> OPTIONAL INPUT KEYWORDS
      R_V - scalar specifying the ratio of total to selective extinction
               R(V) = A(V) / E(B - V).    If not specified, then R = 3.1
               Extreme values of R(V) range from 2.3 to 5.3
</p>

<p>      /AVGLMC - if set, then the default fit parameters c1,c2,c3,c4,gamma,x0
             are set to the average values determined for reddening in the
             general Large Magellanic Cloud (LMC) field by Misselt et al.
            (1999, ApJ, 515, 128)
      /LMC2 - if set, then the fit parameters are set to the values determined
             for the LMC2 field (including 30 Dor) by Misselt et al.
             Note that neither /AVGLMC or /LMC2 will alter the default value
             of R_V which is poorly known for the LMC.
</p>

<p>      The following five input keyword parameters allow the user to customize
      the adopted extinction curve.    For example, see Clayton et al. (2003,
      ApJ, 588, 871) for examples of these parameters in different interstellar
      environments.
</p>

<p>      x0 - Centroid of 2200 A bump in microns (default = 4.596)
      gamma - Width of 2200 A bump in microns (default  =0.99)
      c3 - Strength of the 2200 A bump (default = 3.23)
      c4 - FUV curvature (default = 0.41)
      c2 - Slope of the linear UV extinction component
           (default = -0.824 + 4.717/R)
      c1 - Intercept of the linear UV extinction component
           (default = 2.030 - 3.007*c2
</p>

<p> OPTIONAL OUTPUT KEYWORD:
      ExtCurve - Returns the E(wave-V)/E(B-V) extinction curve, interpolated
                 onto the input wavelength vector
</p>

<p> EXAMPLE:
       Determine how a flat spectrum (in wavelength) between 1200 A and 3200 A
       is altered by a reddening of E(B-V) = 0.1.   Assume an "average"
       reddening for the diffuse interstellar medium (R(V) = 3.1)
</p>

<p>       IDL&gt; w = 1200 + findgen(40)*50      ;Create a wavelength vector
       IDL&gt; f = w*0 + 1                    ;Create a "flat" flux vector
       IDL&gt; fm_unred, w, f, -0.1, fnew  ;Redden (negative E(B-V)) flux vector
       IDL&gt; plot,w,fnew
</p>

<p> NOTES:
       (1) The following comparisons between the FM curve and that of Cardelli,
           Clayton, & Mathis (1989), (see ccm_unred.pro):
           (a) - In the UV, the FM and CCM curves are similar for R &lt; 4.0, but
                 diverge for larger R
           (b) - In the optical region, the FM more closely matches the
                 monochromatic extinction, especially near the R band.
       (2)  Many sightlines with peculiar ultraviolet interstellar extinction
               can be represented with the FM curve, if the proper value of
               R(V) is supplied.
       (3) Use the 4 parameter calling sequence if you wish to save the
               original flux vector.
 PROCEDURE CALLS:
       CSPLINE(), POLY()
 REVISION HISTORY:
       Written   W. Landsman        Raytheon  STX   October, 1998
       Based on FMRCurve by E. Fitzpatrick (Villanova)
       Added /LMC2 and /AVGLMC keywords,  W. Landsman   August 2000
       Added ExtCurve keyword, J. Wm. Parker   August 2000
       Assume since V5.4 use COMPLEMENT to WHERE  W. Landsman April 2006
</p>

<p></p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="fm_unred:p:wave">wave <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:p:flux">flux <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:p:ebv">ebv <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:p:funred">funred <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="fm_unred:k:R_V">R_V <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:k:gamma">gamma <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:k:x0">x0 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:k:c1">c1 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:k:c2">c2 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:k:c3">c3 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:k:c4">c4 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:k:avglmc">avglmc <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:k:lmc2">lmc2 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fm_unred:k:ExtCurve">ExtCurve <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:49 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>173</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:31 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>