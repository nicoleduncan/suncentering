<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:00 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>readfits.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="readfits.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="readfits-code.html" title="Chromocoded source">Source</a> <a href="readfits.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">readfits.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="READFITS">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="readfits-code.html#READFITS:source" class="top">source</a> READFITS<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = READFITS(<span class="argument"><a href="#READFITS:p:filename">filename</a></span><span class="argument">, <a href="#READFITS:p:header">header</a></span><span class="argument">, <a href="#READFITS:p:heap">heap</a></span><span class="argument">, <a href="#READFITS:k:CHECKSUM">CHECKSUM</a>=<span class="var">CHECKSUM</span></span><span class="argument">, <a href="#READFITS:k:COMPRESS">COMPRESS</a>=<span class="var">COMPRESS</span></span><span class="argument">, <a href="#READFITS:k:HBUFFER">HBUFFER</a>=<span class="var">HBUFFER</span></span><span class="argument">, <a href="#READFITS:k:EXTEN_NO">EXTEN_NO</a>=<span class="var">EXTEN_NO</span></span><span class="argument">, <a href="#READFITS:k:NOSCALE">NOSCALE</a>=<span class="var">NOSCALE</span></span><span class="argument">, <a href="#READFITS:k:NSLICE">NSLICE</a>=<span class="var">NSLICE</span></span><span class="argument">, <a href="#READFITS:k:NO_UNSIGNED">NO_UNSIGNED</a>=<span class="var">NO_UNSIGNED</span></span><span class="argument">, <a href="#READFITS:k:NUMROW">NUMROW</a>=<span class="var">NUMROW</span></span><span class="argument">, <a href="#READFITS:k:POINTLUN">POINTLUN</a>=<span class="var">POINTLUN</span></span><span class="argument">, <a href="#READFITS:k:SILENT">SILENT</a>=<span class="var">SILENT</span></span><span class="argument">, <a href="#READFITS:k:STARTROW">STARTROW</a>=<span class="var">STARTROW</span></span><span class="argument">, <a href="#READFITS:k:NaNvalue">NaNvalue</a>=<span class="var">NaNvalue</span></span><span class="argument">, <a href="#READFITS:k:FPACK">FPACK</a>=<span class="var">FPACK</span></span><span class="argument">, <a href="#READFITS:k:UNIXpipe">UNIXpipe</a>=<span class="var">UNIXpipe</span></span>)</code></p>

          
          <div class="small "><p> NAME:
       READFITS
 PURPOSE:
       Read a FITS file into IDL data and header variables.
 EXPLANATION:
       READFITS() can read FITS files compressed with gzip or Unix (.Z)
       compression.  FPACK ( http://heasarc.gsfc.nasa.gov/fitsio/fpack/ )
       compressed FITS files can also be read provided that the FPACK software
       is installed.
       See http://idlastro.gsfc.nasa.gov/fitsio.html for other ways of
       reading FITS files with IDL.
</p>

<p> CALLING SEQUENCE:
       Result = READFITS( Filename/Fileunit,[ Header, heap, /NOSCALE, EXTEN_NO=,
                     NSLICE=, /SILENT , STARTROW =, NUMROW = , HBUFFER=,
                     /CHECKSUM, /COMPRESS, /FPACK, /No_Unsigned, NaNVALUE = ]
</p>

<p> INPUTS:
       Filename = Scalar string containing the name of the FITS file
                 (including extension) to be read.   If the filename has
                  a *.gz extension, it will be treated as a gzip compressed
                  file.   If it has a .Z extension, it will be treated as a
                  Unix compressed file.     If Filename is an empty string then
                  the user will be queried for the file name.
                                   OR
       Fileunit - A scalar integer specifying the unit of an already opened
                  FITS file.  The unit will remain open after exiting
                  READFITS().  There are two possible reasons for choosing
                  to specify a unit number rather than a file name:
          (1) For a FITS file with many extensions, one can move to the
              desired extensions with FXPOSIT() and then use READFITS().  This
              is more efficient than repeatedly starting at the beginning of
              the file.
          (2) For reading a FITS file across a Web http: address after opening
              the unit with the SOCKET procedure
</p>

<p> OUTPUTS:
       Result = FITS data array constructed from designated record.
                If the specified file was not found, then Result = -1
</p>

<p> OPTIONAL OUTPUT:
       Header = String array containing the header from the FITS file.
              If you don't need the header, then the speed may be improved by
              not supplying this parameter.    Note however, that omitting
              the header can imply /NOSCALE, i.e. BSCALE and BZERO values
              may not be applied.
       heap = For extensions, the optional heap area following the main
              data array (e.g. for variable length binary extensions).
</p>

<p> OPTIONAL INPUT KEYWORDS:
       /CHECKSUM - If set, then READFITS() will call FITS_TEST_CHECKSUM to
                verify the data integrity if CHECKSUM keywords are present
                in the FITS header.   Cannot be used with the NSLICE, NUMROW
                or STARTROW keywords, since verifying the checksum requires
               that all the data be read.  See FITS_TEST_CHECKSUM() for more
               information.
</p>

<p>       /COMPRESS - Signal that the file is gzip compressed.  By default,
               READFITS will assume that if the file name extension ends in
               '.gz' then the file is gzip compressed.   The /COMPRESS keyword
               is required only if the the gzip compressed file name does not
               end in '.gz' or .ftz
</p>

<p>       EXTEN_NO - non-negative scalar integer specifying the FITS extension to
               read.  For example, specify EXTEN = 1 or /EXTEN to read the
               first FITS extension.
</p>

<p>       /FPACK - Signal that the file is compressed with the FPACK software.
               http://heasarc.gsfc.nasa.gov/fitsio/fpack/ ) By default,
               (READFITS will assume that if the file name extension ends in
               .fz that it is fpack compressed.     The FPACK software must
               be installed on the system
</p>

<p>        HBUFFER - Number of lines in the header, set this to slightly larger
                than the expected number of lines in the FITS header, to
               improve performance when reading very large FITS headers.
               Should be a multiple of 36 -- otherwise it will be modified
               to the next higher multiple of 36.   Default is 180
</p>

<p>       /NOSCALE - If present and non-zero, then the ouput data will not be
                scaled using the optional BSCALE and BZERO keywords in the
                FITS header.   Default is to scale.
</p>

<p>       /NO_UNSIGNED - By default, if the header indicates an unsigned integer
               (BITPIX = 16, BZERO=2^15, BSCALE=1) then READFITS() will output
               an IDL unsigned integer data type (UINT).   But if /NO_UNSIGNED
               is set, then the data is converted to type LONG.
</p>

<p>       NSLICE - An integer scalar specifying which N-1 dimensional slice of a
                N-dimensional array to read.   For example, if the primary
                image of a file 'wfpc.fits' contains a 800 x 800 x 4 array,
                then
</p>

<p>                 IDL&gt; im = readfits('wfpc.fits',h, nslice=2)
                           is equivalent to
                 IDL&gt; im = readfits('wfpc.fits',h)
                 IDL&gt; im = im[*,*,2]
                 but the use of the NSLICE keyword is much more efficient.
                 Note that any degenerate dimensions are ignored, so that the
                 above code would also work with a 800 x 800 x 4 x 1 array.
</p>

<p>       NUMROW -  Scalar non-negative integer specifying the number of rows
                 of the image or table extension to read.   Useful when one
                 does not want to read the entire image or table.
</p>

<p>       POINT_LUN  -  Position (in bytes) in the FITS file at which to start
                 reading.   Useful if READFITS is called by another procedure
                 which needs to directly read a FITS extension.    Should
                 always be a multiple of 2880, and not be used with EXTEN_NO
                 keyword.
</p>

<p>       /SILENT - Normally, READFITS will display the size the array at the
                 terminal.  The SILENT keyword will suppress this
</p>

<p>        STARTROW - Non-negative integer scalar specifying the row
               of the image or extension table at which to begin reading.
               Useful when one does not want to read the entire table.
</p>

<p>       NaNVALUE - This keyword is included only for backwards compatibility
                  with routines that require IEEE "not a number" values to be
                  converted to a regular value.
</p>

<p>       /UNIXPIPE - When a FileUnit is supplied to READFITS(), then /UNIXPIPE
                 indicates that the unit is to a Unix pipe, and that
                 no automatic byte swapping is performed.
</p>

<p> EXAMPLE:
       Read a FITS file test.fits into an IDL image array, IM and FITS
       header array, H.   Do not scale the data with BSCALE and BZERO.
</p>

<p>              IDL&gt; im = READFITS( 'test.fits', h, /NOSCALE)
</p>

<p>       If the file contains a FITS extension, it could be read with
</p>

<p>              IDL&gt; tab = READFITS( 'test.fits', htab, /EXTEN )
</p>

<p>       The function TBGET() can be used for further processing of a binary
       table, and FTGET() for an ASCII table.
       To read only rows 100-149 of the FITS extension,
</p>

<p>              IDL&gt; tab = READFITS( 'test.fits', htab, /EXTEN,
                                   STARTR=100, NUMR = 50 )
</p>

<p>       To read in a file that has been compressed:
</p>

<p>              IDL&gt; tab = READFITS('test.fits.gz',h)
</p>

<p> ERROR HANDLING:
       If an error is encountered reading the FITS file, then
               (1) the system variable !ERROR_STATE.CODE is set negative
                   (via the MESSAGE facility)
               (2) the error message is displayed (unless /SILENT is set),
                   and the message is also stored in !!ERROR_STATE.MSG
               (3) READFITS returns with a value of -1
 RESTRICTIONS:
       (1) Cannot handle random group FITS
</p>

<p> NOTES:
       (1) If data is stored as integer (BITPIX = 16 or 32), and BSCALE
       and/or BZERO keywords are present, then the output array is scaled to
       floating point (unless /NOSCALE is present) using the values of BSCALE
       and BZERO.   In the header, the values of BSCALE and BZERO are then
       reset to 1. and 0., while the original values are written into the
       new keywords O_BSCALE and O_BZERO.     If the BLANK keyword was
       present (giving the value of undefined elements *prior* to the
       application of BZERO and BSCALE) then the *keyword* value will be
       updated with the values of BZERO and BSCALE.
</p>

<p>       (2) The use of the NSLICE keyword is incompatible with the NUMROW
       or STARTROW keywords.
</p>

<p>       (3) On some Unix shells, one may get a "Broken pipe" message if reading
        a Unix compressed (.Z) file, and not reading to the end of the file
       (i.e. the decompression has not gone to completion).     This is an
        informative message only, and should not affect the output of READFITS.
 PROCEDURES USED:
       Functions:   SXPAR()
       Procedures:  MRD_SKIP, SXADDPAR, SXDELPAR
</p>

<p> MODIFICATION HISTORY:
       Original Version written in 1988, W.B. Landsman   Raytheon STX
       Revision History prior to October 1998 removed
       Major rewrite to eliminate recursive calls when reading extensions
                  W.B. Landsman  Raytheon STX                    October 1998
       Add /binary modifier needed for Windows  W. Landsman    April 1999
       Read unsigned datatypes, added /no_unsigned   W. Landsman December 1999
       Output BZERO = 0 for unsigned data types   W. Landsman   January 2000
       Update to V5.3 (see notes)  W. Landsman                  February 2000
       Fixed logic error in use of NSLICE keyword  W. Landsman  March 2000
       Fixed byte swapping for Unix compress files on little endian machines
                                    W. Landsman    April 2000
       Added COMPRESS keyword, catch IO errors W. Landsman September 2000
       Option to read a unit number rather than file name W.L    October 2001
       Fix undefined variable problem if unit number supplied W.L. August 2002
       Don't read entire header unless needed   W. Landsman  Jan. 2003
       Added HBUFFER keyword    W. Landsman   Feb. 2003
       Added CHECKSUM keyword   W. Landsman   May 2003
       Restored NaNVALUE keyword for backwards compatibility,
               William Thompson, 16-Aug-2004, GSFC
       Recognize .ftz extension as compressed  W. Landsman   September 2004
       Fix unsigned integer problem introduced Sep 2004 W. Landsman Feb 2005
       Don't modify header for unsigned integers, preserve double precision
           BSCALE value  W. Landsman March 2006
       Use gzip instead of compress for Unix compress files W.Landsman Sep 2006
       Call MRD_SKIP to skip bytes on different file types W. Landsman Oct 2006
       Make ndata 64bit for very large files E. Hivon/W. Landsman May 2007
       Fixed bug introduced March 2006 in applying Bzero C. Magri/W.L. Aug 2007
       Check possible 32bit overflow when using NSKIP W. Landsman Mar 2008
       Always reset BSCALE, BZERO even for unsigned integers W. Landsman May 2008
       Make ndata 64bit for very large extensions J. Schou/W. Landsman Jan 2009
       Use PRODUCT() to compute # of data points  W. Landsman  May 2009
       Read FPACK compressed file via UNIX pipe. W. Landsman May 2009
       Fix error using NUMROW,STARTROW with non-byte data, allow these
           keywords to be used with primary array  W. Landsman July 2009
       Ignore degenerate trailing dimensions with NSLICE keyword W.L. Oct 2009
       Add DIALOG_PICKFILE() if filename is an empty string  W.L. Apr 2010
       Set BLANK values *before* applying BSCALE,BZERO, use short-circuit
           operators  W.L. May 2010
      Skip extra SPAWN with FPACK decompress J. Eastman, W.L. July 2010
      Fix possible problem when startrow=0 supplied J. Eastman/W.L. Aug 2010
      First header is not necessarily primary if unit supplied WL Jan 2011
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="READFITS:p:filename">filename <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:p:header">header <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:p:heap">heap <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="READFITS:k:CHECKSUM">CHECKSUM <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:COMPRESS">COMPRESS <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:HBUFFER">HBUFFER <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:EXTEN_NO">EXTEN_NO <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:NOSCALE">NOSCALE <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:NSLICE">NSLICE <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:NO_UNSIGNED">NO_UNSIGNED <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:NUMROW">NUMROW <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:POINTLUN">POINTLUN <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:SILENT">SILENT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:STARTROW">STARTROW <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:NaNvalue">NaNvalue <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:FPACK">FPACK <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="READFITS:k:UNIXpipe">UNIXpipe <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>597</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:58:00 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>