<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:33 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ftsort.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ftsort.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="ftsort:source"></a>pro ftsort,h,tab,hnew,tabnew,field, reverse = revers
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;      FTSORT</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;      Sort a FITS ASCII table according to a specified field</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;      FTSORT,h,tab,[field, REVERSE = ]               ;Sort original table header and array</span>
<span class="comments">;               or</span>
<span class="comments">;      FTSORT,h,tab,hnew,tabnew,[field, REVERSE =]   ;Create new sorted header</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;      H - FITS header (string array)</span>
<span class="comments">;      TAB - FITS table (byte array) associated with H.  If less than 4</span>
<span class="comments">;               parameters are supplied, then H and TAB will be updated to </span>
<span class="comments">;               contain the sorted table</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;      FIELD - Field name(s) or number(s) used to sort the entire table.  </span>
<span class="comments">;              If FIELD is a vector then the first element is used for the </span>
<span class="comments">;              primary sort, the second element is used for the secondary</span>
<span class="comments">;              sort, and so forth.   (A secondary sort only takes effect when</span>
<span class="comments">;              values in the primary sort  field are equal.)  Character fields</span>
<span class="comments">;              are sorted using the ASCII collating sequence.  If omitted,</span>
<span class="comments">;              the user will be prompted for the field name.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL OUTPUTS:</span>
<span class="comments">;      HNEW,TABNEW - Header and table containing the sorted tables</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;      Sort a FITS ASCII table by the 'DECLINATION' field in descending order</span>
<span class="comments">;      Assume that the table header htab, and array, tab, have already been</span>
<span class="comments">;      read (e.g. with READFITS or FITS_READ):</span>

<span class="comments">;      IDL> FTSORT, htab, tab,'DECLINATION',/REVERSE</span>
<span class="comments">; OPTIONAL INPUT KEYWORD:</span>
<span class="comments">;       REVERSE - If set then the table is sorted in reverse order (maximum</span>
<span class="comments">;              to minimum.    If FIELD is a vector, then REVERSE can also be</span>
<span class="comments">;              a vector.   For example, REVERSE = [1,0] indicates that the</span>
<span class="comments">;              primary sort should be in descending order, and the secondary</span>
<span class="comments">;              sort should be in ascending order.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">; SIDE EFFECTS:</span>
<span class="comments">;       A HISTORY record is added to the table header.</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;      Written W. Landsman                         June, 1988</span>
<span class="comments">;      Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;      New FTINFO calling sequence, added REVERSE keyword, allow secondary sorts</span>
<span class="comments">;                  W. Landsman   May 2000</span>
<span class="comments">;-</span>
 On_error,2 
 npar = N_params()
 if npar lt 2 then begin
        print,'Syntax:  ftsort, h, tab, [ field ]'
        print,'    OR:  ftsort,h,tab,hnew,tabnew,[field]'
        return
 endif

 if npar eq 3 then field = hnew 

 nf = N_elements(field)
 nr = N_elements(revers)
 if nr EQ 0 then revers = bytarr(nf) else $
 if nr LT nf then revers = [revers,bytarr(nf-nr)]

 ftinfo,h,ft_str
 key = ftget(ft_str,tab, field[nf-1])
 index = sort(key)
 if revers[nf-1] then index = reverse(index)
 tabnew = tab[*,index]


 if nf GT 1 then begin 
 for i= nf-2,0 do begin
    key = ftget(ft_str,tabnew,field[i])
    index = bsort(key,reverse=revers[i])
    tabnew = tabnew[*,index]
 endfor
 endif

 str = strtrim(field[0],2)
 if nf GT 1 then begin
      for i = 1,nf-1 do str = str + ',' + strtrim( field[i],2) 
      str = 'Keywords: ' + str
 endif else str = 'Keyword: ' + str
 if npar ge 4 then begin
        hnew = h
        sxaddhist,'FTSORT: '+ systime() +' Sort ' + str,hnew
 endif else begin
        tab = tabnew
        sxaddhist,'FTSORT: '+ systime() +' Sort ' + str,h
 endelse

 return
 end
</code>
    </div>
  </body>
</html>