<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:23 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>dao_value.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="dao_value.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">FUNCTION  DAO_VALUE, XX, YY, GAUSS, PSF, DVDX, DVDY
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	DAO_VALUE</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Returns the value of a DAOPHOT point-spread function at a set of points.</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;	The value of the point-spread function is the sum of a</span>
<span class="comments">;	two-dimensional integral under a bivariate Gaussian function, and </span>
<span class="comments">;	a value obtained by interpolation in a look-up table.  DAO_VALUE will</span>
<span class="comments">;	optionally compute the derivatives wrt X and Y</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	Result = DAO_VALUE( xx, yy, gauss, psf, [ dvdx, dvdy ] )</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	XX,YY   - the real coordinates of the desired point relative </span>
<span class="comments">;		to the centroid of the point-spread function.</span>
<span class="comments">;	GAUSS  -  5 element vector describing the bivariate Gaussian</span>
<span class="comments">;	GAUSS(0)- the peak height of the best-fitting Gaussian profile.</span>
<span class="comments">;	GAUSS(1,2) - x and y offsets from the centroid of the point-spread </span>
<span class="comments">;		function to the center of the best-fitting Gaussian.</span>
<span class="comments">;	GAUSS(3,4) - the x and y sigmas of the best-fitting Gaussian.</span>
<span class="comments">;	PSF  -  a NPSF by NPSF array containing the look-up table.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;    RESULT - the computed value of the point-spread function at</span>
<span class="comments">;             a position XX, YY relative to its centroid (which </span>
<span class="comments">;             coincides with the center of the central pixel of the</span>
<span class="comments">;             look-up table).</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL OUTPUTS:</span>
<span class="comments">;       DVDX,DVDY - the first derivatives of the composite point-spread</span>
<span class="comments">;             function with respect to x and y.</span>
<span class="comments">;</span>
<span class="comments">; NOTES</span>
<span class="comments">; 	although the arguments XX,YY of the function DAO_VALUE</span>
<span class="comments">;	are relative to the centroid of the PSF, the function RINTER which</span>
<span class="comments">;	DAO_VALUE calls requires coordinates relative to the corner of the </span>
<span class="comments">;	array (see code).</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES CALLED:</span>
<span class="comments">;	DAOERF, RINTER()</span>
<span class="comments">; REVISON HISTORY:</span>
<span class="comments">;	Adapted to IDL by B. Pfarr, STX, 11/17/87 from 1986 STSDAS version</span>
<span class="comments">;	of DAOPHOT</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>
 s = size(psf)
 npsf = s[1]
 half = float(npsf-1)/2 

 x = 2.*xx + half   <span class="comments">;Initialize</span>
 y = 2.*yy + half

<span class="comments">; X and Y are the coordinates relative to the corner of the look-up table, </span>
<span class="comments">; which has a half-pixel grid size.  </span>

 if ( (min(x) LT 1.) or ( max(x) GT npsf-2.) or  $
      (min(y) LT 1.) or ( max(y) GT npsf-2.) ) then begin
         message,'X,Y positions too close to edge of frame',/INF
         return,xx*0
  endif

<span class="comments">; Evaluate the approximating Gaussian.</span>
<span class="comments">; Then add a value interpolated from the look-up table to the approximating</span>
<span class="comments">; Gaussian.  Since the lookup table has a grid size of one-half pixel in each</span>
<span class="comments">; coordinate, the spatial derivatives must be multiplied by two to yield</span>
<span class="comments">; the derivatives in units of ADU/pixel in the big frame.</span>

 if N_params() GT 4 then begin   <span class="comments">;Compute derivatives?</span>

     DAOERF, xx, yy, gauss, e, pder 
     value = e + RINTER( psf, x, y, dfdx, dfdy)
     dvdx = 2.*dfdx - pder[*,1]
     dvdy = 2.*dfdy - pder[*,2]           

 endif else begin  

     DAOERF, xx, yy, gauss, e
     value = e + RINTER(psf,x,y)

 endelse

 return, value

 end                                             
</code>
    </div>
  </body>
</html>