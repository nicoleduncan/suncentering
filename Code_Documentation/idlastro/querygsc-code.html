<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:58 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>querygsc.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="querygsc.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="Querygsc:source"></a>function Querygsc, target, dis,magrange = magrange, HOURS = hours, $
   VERBOSE=verbose, BOX = box
<span class="comments">;+</span>
<span class="comments">; NAME: </span>
<span class="comments">;   QUERYGSC</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE: </span>
<span class="comments">;   Query the Guide Star Catalog (GSC V2.3.2) at STScI by position</span>
<span class="comments">; </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;   Uses the IDL SOCKET command to query the GSC 2.3.2 database over the Web.    </span>
<span class="comments">;</span>
<span class="comments">;   Alternatively, (and more reliably) one can query the GSC 2.3.2 catalog using</span>
<span class="comments">;   queryvizier.pro and the VIZIER database, e.g.  </span>
<span class="comments">;     IDL> st = queryvizier('GSC2.3',[23,35],10,/all)</span>
<span class="comments">; </span>
<span class="comments">;   GSC2.3 is an all-sky export of calibrated photographic survey plate </span>
<span class="comments">;   source parameters from the COMPASS database.  The number of unique</span>
<span class="comments">;   objects is approximately 945,592,683.   All sources are </span>
<span class="comments">;   from the second-generation plate-processing pipeline with the exception</span>
<span class="comments">;   of Tycho-2 and Skymap sources in the case of very bright objects. The </span>
<span class="comments">;   Skymap sources are exported when there is no matching GSC or Tycho </span>
<span class="comments">;   sources.  Each GSC 2.3 entry contains only one position and one </span>
<span class="comments">;   magnitude per bandpass for each unique sky object</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE: </span>
<span class="comments">;     info = QueryGSC(targetname_or_coords, [ dis, /HOURS] )</span>
<span class="comments">;</span>
<span class="comments">; INPUTS: </span>
<span class="comments">;      TARGETNAME_OR_COORDS - Either a scalar string giving a target name, </span>
<span class="comments">;          (with J2000 coordinates determined by SIMBAD), or a 2-element</span>
<span class="comments">;          numeric vector giving the J2000 right ascension in *degrees* (or </span>
<span class="comments">;          hours if /HOURS is set) and the target declination in degrees.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT:</span>
<span class="comments">;    dis - Numeric scalar giving search radius in arcminutes to search around </span>
<span class="comments">;          specified target    Default is 5 arcminutes</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS:</span>
<span class="comments">;</span>
<span class="comments">;    /BOX - if set, then radius gives  a box width in arcminutes</span>
<span class="comments">;    /HOURS - If set, then the right ascension is both input and output (in</span>
<span class="comments">;             the info .ra tag) in hours instead of degrees</span>
<span class="comments">;    /VERBOSE - If set, then the CGI command to the Webserver will be displayed</span>
<span class="comments">;;</span>
<span class="comments">; OUTPUTS: </span>
<span class="comments">;   info - IDL structure containing information on the GSC stars within the </span>
<span class="comments">;          specified distance of the specified center.   There are (currently)</span>
<span class="comments">;          23 tags in this structure  -- for further information see</span>
<span class="comments">;          http://gsss.stsci.edu/Catalogs/GSC/GSC2/gsc23/gsc23_release_notes.htm</span>
<span class="comments">;</span>
<span class="comments">;          .HSTID - GSC 2.3 name for HST operations</span>
<span class="comments">;          .GSC1ID - GSC1 name</span>
<span class="comments">;          .RA,.DEC - Position in degrees (double precision).   RA is given in</span>
<span class="comments">;                   hours if the /HOURS keyword is set.</span>
<span class="comments">;          .RAERR, .DECERR - uncertainty (in arcseconds) in the RA and Dec</span>
<span class="comments">;          .EPOCH - mean epoch of the observation</span>
<span class="comments">;          .FPGMAG, .FPGERR - magnitude and error in photographic F</span>
<span class="comments">;          .JPGMAG, .JPGERR - magnitude and error in photographic J</span>
<span class="comments">;          .VPGMAG, .VPGERR - V magnitude and error </span>
<span class="comments">;          .NPGMAG, .NPGERR - magnitude and error</span>
<span class="comments">;          .UMAG, .UERR - magnitude and error</span>
<span class="comments">;          .BMAG, .BERR - magnitude and error</span>
<span class="comments">;          .VMAG, .VERR - magnitude and error</span>
<span class="comments">;          .RMAG, .RERR - magnitude and error</span>
<span class="comments">;          .IMAG, .IERR - magnitude and error</span>
<span class="comments">;          .JMAG, .JERR - magnitude and error</span>
<span class="comments">;          .HMAG, .HERR - magnitude and error</span>
<span class="comments">;          .KMAG, .KERR - magnitude and error</span>
<span class="comments">;          .A - semi-major axis in pixels</span>
<span class="comments">;          .PA - Position angle of extended objects in degrees</span>
<span class="comments">;          .E - eccentricity of extended objects</span>
<span class="comments">;          .CLASS - classification (0-5): 0-star, 1-galaxy, 2-blend, </span>
<span class="comments">;                         3-nonstar, 4-unclassified, 5-defect</span>
<span class="comments">;          .STATUS -10 digit field  used to encode more detailed information </span>
<span class="comments">;              about the properties of the catalog object.   For more info, see</span>
<span class="comments">;http://www-gsss.stsci.edu/Catalogs/GSC/GSC2/gsc23/gsc23_release_notes.htm#ClassificationCodes</span>
<span class="comments">;           .VFLAG, MFLAG - Variability nad multiplicity flags</span>
<span class="comments">;            .FPGBAND, .NPGBAND, .JPGBAND. UBAND, BBAND, .VBAND - flag as </span>
<span class="comments">;            to wether given bandpass is available</span>
<span class="comments">; EXAMPLE: </span>
<span class="comments">;          Plot a histogram of the photographic J magnitudes of all GSC 2.3.2 </span>
<span class="comments">;          stars within 10 arcminutes of the center of the globular cluster M13 </span>
<span class="comments">;</span>
<span class="comments">;          IDL> info = querygsc('M13',10)</span>
<span class="comments">;          IDL> plothist,info.jpgmag,xran=[10,20]</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;          QUERYSIMBAD, RADEC, WEBGET()</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY: </span>
<span class="comments">;         Written by W. Landsman  SSAI  August 2002</span>
<span class="comments">;         Fixed parsing of RA and Dec  W. Landsman September 2002</span>
<span class="comments">;         Major rewrite to use new STScI Web server, remove magrange</span>
<span class="comments">;           keyword   W. Landsman Dec 2007</span>
<span class="comments">;         Update server name, added /BOX,/ VERBOSE keywords W.L 19 Dec 2007</span>
<span class="comments">;         Web server now also returns infrared data  W.L. Feb 2010</span>
<span class="comments">;         Fixed case where dec neg. and deg or min 0 Pat Fry Jul 2010</span>
<span class="comments">;</span>
<span class="comments">;-</span>
  compile_opt idl2
  if N_params() LT 2 then begin
       print,'Syntax - info = QueryGSC(targetname_or_coord, dis,'
       print,'                        [/Hours, /Box, /VERBOSE} )'
       print,'   RA (degrees), Dec (degrees) -- search coordinates of center)'
       print,'  dis -- search radius in arcminutes'
       if N_elements(info) GT 0 then return,info else return, -1
  endif
  if N_elements(dis) EQ 0 then dis = 5
    if N_elements(target) EQ 2 then begin
      ra = float(target[0])
      dec = float(target[1])
  endif else begin
       QuerySimbad, target, ra,dec, Found = Found
       if found EQ 0 then message,'Target name ' + target + $
                 ' could not be translated by SIMBAD'
  endelse  
  radius = keyword_set(box)? 'Box' : 'Radius'
  
   radec,ra,dec,hr,mn,sc,deg,dmn,dsc,hours=keyword_set(hours)
   deg = string(deg,'(i3.2)')
   dsn = strmid(deg,0,1)
   deg = strmid(deg,1,2)
   if (dmn lt 0 || dsc lt 0) then begin
       dmn = abs(dmn)
       dsc = abs(dsc)
       dsn = '-'
   endif
   sc = round(sc)
   dsc = round(dsc)
   if dsn EQ ' ' then dsn = '%2B'
  <span class="comments">;;</span>
  QueryURL = "http://gsss.stsci.edu/webservices/GSC2/GSC2DataReturn.aspx?" + $
   'RAH=' + string(hr,'(i2.2)') + '&RAM=' + string(mn,'(i2.2)') + $
   '&RAS=' + string(sc,'(i2.2)') + '&DSN=' + dsn + '&DD=' + deg +  $
   '&DM=' + string(dmn,'(i2.2)') + '&DS=' + string(dsc,'(i2.2)') + $
    '&EQ=2000&SIZE=' + strtrim(dis,2) + '&SRCH=' + radius + $
    '&FORMAT=CSV&CAT=GSC23&HSTID=&GSC1ID='
    
  if keyword_set(verbose) then print,queryurl
  <span class="comments">;;  </span>
  Result = webget(QueryURL)
 <span class="comments">;</span>
  t = result.text

  nstar = N_elements(t) -1
  if strmid(t[0],0,5) NE 'Usage' and nstar GT 0 THEN BEGIN
  headers = strsplit(t[0],',',/extract)
  
  info = create_struct(Name='gsc',headers, '','',0.0d,0.0d,0.0,0.0,0.0, $
   0.0, 0, 0.0, $   <span class="comments">;Fpg</span>
   0.0, 0, 0.0, $ <span class="comments">;Jpg</span>
   0.0, 0, 0.0, $   <span class="comments">;Npg </span>
   0.0, 0, 0.0,  $   <span class="comments">;U </span>
   0.0, 0, 0.0, $ <span class="comments">;B</span>
   0.0, 0, 0.0, $ <span class="comments">;V</span>
   0.0, 0, 0.0, $ <span class="comments">;R</span>
   0.0, 0, 0.0, $ <span class="comments">;I</span>
   0.0, 0, 0.0, $ <span class="comments">;J</span>
   0.0, 0, 0.0, $ <span class="comments">;H</span>
   0.0, 0, 0.0, $ <span class="comments">;K</span>
   0, 0ULL, 0.0, 0.0, 0.0,0,0 )
  info = replicate(info,nstar)

  for i=0,nstar-1 do begin
      temp = strsplit(t[i+1],',',/extract)
       for j=0,N_elements(temp)-1 do info[i].(j) = temp[j]
  endfor
   ENDIF ELSE BEGIN 
      message, 'No objects returned by server. The server answered:', /info
      print, Result.Text
      if N_elements(info) GT 0 then return, info else return, -1
  ENDELSE 
  if keyword_set(hours) then info.ra = info.ra/15.0d 
 return,info
END 
  
</code>
    </div>
  </body>
</html>