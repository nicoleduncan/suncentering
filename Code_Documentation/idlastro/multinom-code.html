<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:51 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>multinom.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="multinom.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;   MULTINOM</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">; SIMULATE MULTINOMIAL RANDOM VARIABLES</span>
<span class="comments">;</span>
<span class="comments">; AUTHOR : BRANDON C. KELLY, STEWARD OBS., APR 2006</span>
<span class="comments">;</span>
<span class="comments">; INPUTS :</span>
<span class="comments">;</span>
<span class="comments">;   N - THE NUMBER OF TRIALS</span>
<span class="comments">;   P - A K-ELEMENT VECTOR CONTAINING THE PROBABILITIES FOR EACH</span>
<span class="comments">;       CLASS.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS :</span>
<span class="comments">;</span>
<span class="comments">;   NRAND - THE NUMBER OF RANDOM VARIABLES TO DRAW</span>
<span class="comments">;   SEED - THE SEED FOR THE RANDOM NUMBER GENERATOR</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT :</span>
<span class="comments">;   NRAND RANDOM DRAWS FROM A MULTINOMIAL DISTRIBUTION WITH PARAMETERS</span>
<span class="comments">;   N AND P.</span>
<span class="comments">;-</span>
<span class="comments">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<a id="multinom:source"></a>function multinom, n, p, nrand, seed=seed

if n_params() lt 2 then begin
    print, 'Syntax- theta = multinom( n, p,[ nrand, seed=seed] )'
    return, 0
endif

k = n_elements(p)

bad = where(p lt 0 or p gt 1, nbad)
if nbad gt 0 then begin
    print, 'All element of p must be 0 &lt;= p &lt;= 1.'
    return, 0
endif

if n lt 1 then begin
    print, 'N must be at least 1.'
    return, 0
endif

if n_elements(nrand) eq 0 then nrand = 1

                                <span class="comments">;check if binomial</span>
if k eq 2 then begin

    binom = randomu(seed, nrand, binomial=[n, p[0]], /double)
    multi = [[binom], [n - binom]]

    return, transpose(multi)

endif

multi = lonarr(k, nrand)

for i = 0L, nrand - 1 do begin
    
    multi[0,i] = randomu(seed, 1, binomial=[n, p[0]], /double)
    j = 1L
    nj = n - total(multi[0:j-1,i])

    while nj gt 0 do begin
        
        pj = p[j] / total(p[j:*])

        multi[j,i] = randomu(seed, 1, binomial=[nj,pj], /double)

        j = j + 1
        nj = n - total(multi[0:j-1,i])

    endwhile

endfor

return, multi
end
</code>
    </div>
  </body>
</html>