<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:28 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>eci2geo.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="eci2geo.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;     ECI2GEO</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     Convert Earth-centered inertial coordinates to geographic spherical coords</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;     Converts from ECI (Earth-Centered Inertial) (X,Y,Z) rectangular </span>
<span class="comments">;     coordinates to geographic spherical coordinates (latitude, longitude, </span>
<span class="comments">;     altitude).    JD time is also needed as input.</span>
<span class="comments">;</span>
<span class="comments">;     ECI coordinates are in km from Earth center.</span>
<span class="comments">;     Geographic coordinates are in degrees/degrees/km</span>
<span class="comments">;     Geographic coordinates assume the Earth is a perfect sphere, with radius </span>
<span class="comments">;     equal to its equatorial radius.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;     gcoord=eci2geo(ECI_XYZ,JDtime)</span>
<span class="comments">;</span>
<span class="comments">; INPUT:</span>
<span class="comments">;       ECI_XYZ : the ECI [X,Y,Z] coordinates (in km), can be an array [3,n] </span>
<span class="comments">;                 of n such coordinates.</span>
<span class="comments">;       JDtime: the Julian Day time, double precision. Can be a 1-D array of n </span>
<span class="comments">;                 such times.</span>
<span class="comments">;</span>
<span class="comments">; KEYWORD INPUTS:</span>
<span class="comments">;       None</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       a 3-element array of geographic [latitude,longitude,altitude], or an </span>
<span class="comments">;         array [3,n] of n such coordinates, double precision  </span>
<span class="comments">;</span>
<span class="comments">; COMMON BLOCKS:</span>
<span class="comments">;       None</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       CT2LST - Convert Local Civil Time to Local Mean Sidereal Time</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       IDL> gcoord=eci2geo([6378.137+600,0,0], 2452343.38982663D)</span>
<span class="comments">;       IDL> print,gcoord</span>
<span class="comments">;       0.0000000       232.27096       600.00000</span>
<span class="comments">;</span>
<span class="comments">;       (The above is the geographic direction of the vernal point on </span>
<span class="comments">;       2002/03/09 21:21:21.021, in geographic coordinates. The chosen </span>
<span class="comments">;       altitude was 600 km.)</span>
<span class="comments">;</span>
<span class="comments">;       gcoord can be further transformed into geodetic coordinates (using </span>
<span class="comments">;       geo2geodetic.pro) or into geomagnetic coordinates (using geo2mag.pro)</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       Written by Pascal Saint-Hilaire (Saint-Hilaire@astro.phys.ethz.ch) on </span>
<span class="comments">;              2001/05/13</span>
<span class="comments">;       Modified on 2002/05/13, PSH : vectorization + use of JD times          </span>
<span class="comments">;-</span>

<span class="comments">;=============================================================================</span>
FUNCTION eci2geo,ECI_XYZ,JDtim

        Re=6378.137     <span class="comments">; Earth's equatorial radius, in km</span>
        coord=DOUBLE(ECI_XYZ)
        JDtime= DOUBLE(JDtim)

        theta=atan(coord[1,*],coord[0,*])       <span class="comments">; azimuth       </span>
        ct2lst,gst,0,0,JDtime
        angle_sid=gst*2.*!DPI/24.        <span class="comments">; sidereal angle</span>
        lon= (theta - angle_sid ) MOD (2* !DPI)                  <span class="comments">;longitude      </span>
        r=sqrt(coord[0,*]^2+coord[1,*]^2)
        lat=atan(coord[2,*],r)                                  <span class="comments">; latitude</span>
        alt=r/cos(lat) - Re                                     <span class="comments">; altitude </span>

        lat=lat*180./(!DPI)      <span class="comments">; to convert from radians into degrees...</span>
        lon=lon*180./(!DPI)
        ss=WHERE(lon LT 0.) 
        IF ss[0] NE -1 THEN lon[ss]=lon[ss]+360.
        
        RETURN,[lat,lon,alt]
END
<span class="comments">;====================================================================================</span>
</code>
    </div>
  </body>
</html>