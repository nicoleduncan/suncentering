<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:08 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>textopen.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="textopen.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO TEXTOPEN,PROGRAM,TEXTOUT=TEXTOUT, STDOUT = STDOUT, MORE_SET = more_set, $
             SILENT = silent, WIDTH = width
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       TEXTOPEN</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Open a device specified by TEXTOUT with unit !TEXTUNIT </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Procedure to open file for text output.   The type of output </span>
<span class="comments">;       device (disk file or terminal screen) is specified by the </span>
<span class="comments">;       TEXTOUT keyword or the (nonstandard) system variable !TEXTOUT.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       textopen, program, [ TEXTOUT =, /STDOUT, /SILENT, MORE_SET=, WIDTH= ]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       program - scalar string giving name of program calling textopen</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS:</span>
<span class="comments">;       TEXTOUT - Integer scalar (0-7) specifying output file/device to be </span>
<span class="comments">;               opened (see below) or scalar string giving name of output file.</span>
<span class="comments">;               If TEXTOUT is not supplied, then the (non-standard) system </span>
<span class="comments">;               variable !TEXTOUT is used.</span>
<span class="comments">;       /SILENT - By default, TEXTOPEN prints an informational message when</span>
<span class="comments">;                opening a file for hardcopy output.   Set /SILENT (or !QUIET)</span>
<span class="comments">;                to suppress this message.</span>
<span class="comments">;       /STDOUT - if this keyword is set and non-zero, then the standard output</span>
<span class="comments">;               (unit = -1) is used for TEXTOUT=1 or TEXTOUT=2.   The use</span>
<span class="comments">;               of STDOUT has  2 possible advantages:</span>
<span class="comments">;               (1) the output will appear in a journal file</span>
<span class="comments">;               (2) Many Unix machines print spurious control characters when</span>
<span class="comments">;               printing to /dev/tty.   These characters are eliminated by </span>
<span class="comments">;               setting /STDOUT</span>
<span class="comments">;</span>
<span class="comments">;               The disadvantage of /STDOUT is that the /MORE option is not</span>
<span class="comments">;               available.</span>
<span class="comments">;</span>
<span class="comments">;         WIDTH - Specify line width for hardcopy output line wrapping (passed onto OPENW).</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL OUTPUT KEYWORD:</span>
<span class="comments">;       MORE_SET - Returns 1 if the output unit was opened with /MORE.   This</span>
<span class="comments">;               occurs if (1) TEXTOUT = 1 and (2) the device is a tty, and </span>
<span class="comments">;               (3) /STDOUT is not set.      User can use the returned value</span>
<span class="comments">;                of MORE_SET to determine whether to end output when user</span>
<span class="comments">;                presses 'Q'.</span>
<span class="comments">; SIDE EFFECTS:</span>
<span class="comments">;       The following dev/file is opened for output.    Different effects</span>
<span class="comments">;       occur depending whether the standard output is a GUI (Macintosh,</span>
<span class="comments">;       Windows, Unix/IDLTool) or a TTY</span>
<span class="comments">;</span>
<span class="comments">;               textout=0       Nowhere</span>
<span class="comments">;               textout=1       if a TTY then TERMINAL using /more option</span>
<span class="comments">;                                   otherwise standard (Unit=-1) output</span>
<span class="comments">;               textout=2       if a TTY then TERMINAL without /more option</span>
<span class="comments">;                                   otherwise standard (Unit=-1) output</span>
<span class="comments">;               textout=3       &lt;program>.prt</span>
<span class="comments">;               textout=4       laser.tmp</span>
<span class="comments">;               textout=5      user must open file</span>
<span class="comments">;               textout=7      same as 3 but text is appended to &lt;program>.prt</span>
<span class="comments">;                               file if it already exists.</span>
<span class="comments">;               textout = filename (default extension of .prt)</span>
<span class="comments">;</span>
<span class="comments">;       The unit to be opened is obtained with the procedure GET_LUN</span>
<span class="comments">;       unless !TEXTOUT=5.  The unit number is placed in system variable </span>
<span class="comments">;       !TEXTUNIT.  For !TEXTOUT=5 the user must set !TEXTUNIT to the </span>
<span class="comments">;       appropriate unit number.</span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       When printing to a TTY terminal, the output will *not* appear in an </span>
<span class="comments">;       IDL JOURNAL session, unlike text printed with the PRINT command.</span>
<span class="comments">;</span>
<span class="comments">; NON-STANDARD SYSTEM VARIABLES:</span>
<span class="comments">;       TEXTOPEN will automatically define the following system variables if</span>
<span class="comments">;       they are not previously defined:</span>
<span class="comments">;</span>
<span class="comments">;       DEFSYSV,'!TEXTOUT',1</span>
<span class="comments">;       DEFSYSV,'!TEXTUNIT',0</span>
<span class="comments">; HISTORY:</span>
<span class="comments">;       D. Lindler  Dec. 1986  </span>
<span class="comments">;       Keyword textout added, J. Isensee, July, 1990</span>
<span class="comments">;       Made transportable, D. Neill, April, 1991</span>
<span class="comments">;       Trim input PROGRAM string W. Landsman  Feb 1993</span>
<span class="comments">;       Don't modify TEXTOUT value   W. Landsman   Aug 1993</span>
<span class="comments">;       Modified for MacOS  I. Freedman April 1994</span>
<span class="comments">;       Modified for output terminals without a TTY  W. Landsman  August 1995</span>
<span class="comments">;       Added /STDOUT keyword   W. Landsman    April 1996</span>
<span class="comments">;       added textout=7 option, D. Lindler, July, 1996</span>
<span class="comments">;       Exit with RETURN instead of RETALL  W. Landsman  June 1999</span>
<span class="comments">;       In IDL V5.4 filepath(/TERMINAL) not allowed in the IDLDE WL August 2001</span>
<span class="comments">;       Added MORE_SET output keyword   W.Landsman   January 2002</span>
<span class="comments">;       Added /SILENT keyword  W. Landsman  June 2002  </span>
<span class="comments">;	Define !TEXTOUT and !TEXTUNIT if needed.  R. Sterner, 2002 Aug 27</span>
<span class="comments">;       Return Calling Sequence if no parameters supplied W.Landsman Nov 2002</span>
<span class="comments">;       Remove VMS specific code  W. Landsman Sep 2006</span>
<span class="comments">;       Make sure MORE_SET is always defined   W. Landsman Jan 2007</span>
<span class="comments">;       Added WIDTH keyword   J. Bailin Nov 2010</span>
<span class="comments">;       Use V6.0 notation  W. Landsman April 2011</span>
<span class="comments">;-</span>
<span class="comments">;-----------------------------------------------------------</span>
  On_Error,2
  compile_opt idl2

  if N_params() LT 1 then begin
      print,'Syntax - TEXTOPEN, program, [ TEXTOUT =, /STDOUT, /SILENT,' 
      print,'                              MORE_SET=, WIDTH= ]' 
      return
  endif

  defsysv,'!TEXTOUT',exists=ex			<span class="comments">; Check if !TEXTOUT exists.</span>
  if ex eq 0 then defsysv,'!TEXTOUT',1		<span class="comments">; If not define it.</span>
  defsysv,'!TEXTUNIT',exists=ex			<span class="comments">; Check if !TEXTUNIT exists.</span>
  if ex eq 0 then defsysv,'!TEXTUNIT',0		<span class="comments">; If not define it.</span>
  more_set = 0                                  
  <span class="comments">;</span>
  <span class="comments">; Open proper unit.</span>
  <span class="comments">;</span>
  if N_elements( textout ) NE 1 then textout = !textout <span class="comments">;use default output dev.</span>

  <span class="comments">; keywords for openw</span>
  if n_elements(width) gt 0 then openw_keywords = {width: width}

  if size(textout,/tname) EQ 'STRING' then begin  <span class="comments">;test if filename entered</span>
        filename = textout
        j = strpos(filename,'.')        <span class="comments">;test if file extension given</span>
        if j lt 0 then filename = filename + ".prt"
        text_out = 6
  endif else text_out = textout     

  if TEXT_OUT eq 5 then begin
     if !TEXTUNIT eq 0 then begin
         print,' '
         print,' You must set !TEXTUNIT to the desired unit number...'
         print,'                    ...see following example'
         print,' '
         print,'                    OPENW, LUN, filename, /GET_LUN
         print,'                    !TEXTUNIT = LUN
         print,'                    DBPRINT...
         print,'
         print,' Action: returning'
         print,' '
         return
     end
     return
  end
   stndout = fstat(-1)
   isatty = (stndout.isatty) && (~stndout.isagui) && $
             (~keyword_set(STDOUT))

   if isatty || (text_out GT 2) then begin 

        if !TEXTUNIT GT 0 then free_lun,!TEXTUNIT 
        get_lun,unit
        !TEXTUNIT = unit

    endif else !TEXTUNIT = -1                     <span class="comments">;standard output</span>

  more_set = (text_out EQ 1) && isatty
  
  case text_out of
     1: if isatty then openw, !TEXTUNIT, filepath(/TERMINAL), /MORE, _extra=openw_keywords

     2: if isatty then openw, !TEXTUNIT, filepath(/TERMINAL) , _extra=openw_keywords

     3: begin
        oname = strlowcase( strtrim( PROGRAM,2) +'.prt')
         openw, !TEXTUNIT, oname, _extra=openw_keywords
        if ~keyword_set(SILENT) then $
        message,'Output is being directed to a file ' + oname,/INFORM
        end

     4: openw, !TEXTUNIT, 'laser.tmp', _extra=openw_keywords

     6: begin
        openw,!TEXTUNIT,filename, _extra=openw_keywords
        if ~keyword_set(SILENT) then $
        message,'Output is being directed to a file ' + filename,/INFORM
        end

     7: begin
        oname = strlowcase(strtrim( PROGRAM,2) +'.prt')
        openw, !TEXTUNIT, oname, /append, _extra=openw_keywords
        if ~keyword_set(SILENT) then $
        message,'Output is being appended to file ' + oname,/INFORM
        for i=0,3 do printf,!textunit,' '       <span class="comments">;added a couple of blank lines</span>
        end

     0: openw,!TEXTUNIT, strtrim(PROGRAM,2) + '.tmp',/DELETE, _extra=openw_keywords

     else: begin
        !textunit = 0
        print,' '
        print,' Invalid value for TEXTOUT =',TEXTOUT
        print,' '
        print,'                 ...the possibilities are:
        print,' '
        print,'                 textout=0      nowhere
        if isatty then begin
                print,'                 textout=1      terminal with /more 
                print,'                 textout=2      terminal without /more 
        endif else begin
                print,'                 textout=1      terminal
                print,'                 textout=2      terminal
        endelse
        print,'                 textout=3      file   &lt;program>.prt
        print,'                 textout=4      file   laser.tmp
        print,'                 textout=5      User supplied file
        print,'                 textout = filename (default extension of .prt)
        print,'                 textout=7      Same as 3 but append the file
        print,' '
        print,' Action: returning
        print,' '
        return
    end
 endcase

 return
 end   <span class="comments">; textout</span>
</code>
    </div>
  </body>
</html>