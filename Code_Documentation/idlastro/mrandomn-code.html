<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:48 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>mrandomn.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="mrandomn.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="mrandomn:source"></a>function mrandomn, seed, covar, nrand

<span class="comments">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="comments">;+</span>
<span class="comments">;  NAME:</span>
<span class="comments">;     MRANDOMN</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">; Function to draw NRAND random deviates from a multivariate normal</span>
<span class="comments">; distribution with zero mean and covariance matrix COVAR.</span>
<span class="comments">; </span>
<span class="comments">; AUTHOR : Brandon C. Kelly, Steward Obs., Sept. 2004</span>
<span class="comments">;</span>
<span class="comments">; INPUTS : </span>
<span class="comments">;</span>
<span class="comments">;    SEED - The random number generator seed, the default is IDL's</span>
<span class="comments">;           default in RANDOMN()</span>
<span class="comments">;    COVAR - The covariance matrix of the multivariate normal</span>
<span class="comments">;            distribution.    </span>
<span class="comments">; OPTIONAL INPUTS :</span>
<span class="comments">;</span>
<span class="comments">;    NRAND - The number of randomn deviates to draw. The default is</span>
<span class="comments">;            one.</span>
<span class="comments">; OUTPUT :</span>
<span class="comments">;</span>
<span class="comments">;    The random deviates, an [NRAND, NP] array where NP is the</span>
<span class="comments">;    dimension of the covariance matrix, i.e., the number of</span>
<span class="comments">;    parameters.</span>
<span class="comments">;</span>
<span class="comments">; ROUTINES CALLED :</span>
<span class="comments">;</span>
<span class="comments">;    POSITIVE, DIAG</span>
<span class="comments">;-</span>
<span class="comments">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>

if n_params() lt 2 then begin
    print, 'Syntax- Result = mrandomn( seed, covar, [nrand] )'
    return, 0
endif

<span class="comments">;check inputs and set up defaults</span>
if n_elements(nrand) eq 0 then nrand = 1
if size(covar, /n_dim) ne 2 then begin
    print, 'COVAR must be a matrix.'
    return, 0
endif

np = (size(covar))[1]
if (size(covar))[2] ne np then begin
    print, 'COVAR must be a square matrix.'
    return, 0
endif

diag = lindgen(np) * (np + 1L)
epsilon = randomn(seed, nrand, np) <span class="comments">;standard normal random deviates (NP x NRAND matrix)</span>

A = covar  <span class="comments">;store covariance into dummy variable for input into TRIRED</span>

choldc, A, P, /double           <span class="comments">;do Cholesky decomposition</span>

for j = 0, np - 1 do for i = j, np - 1 do A[i,j] = 0d

A[diag] = P

<span class="comments">;transform standard normal deviates so they have covariance matrix COVAR</span>
epsilon = A ## epsilon

return, epsilon
end
</code>
    </div>
  </body>
</html>