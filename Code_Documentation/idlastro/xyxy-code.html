<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:13 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>xyxy.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="xyxy.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO xyxy, hdra, hdrb, xa, ya, xb, yb
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	XYXY</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	To use a pair of headers to convert X/Y positions from one frame</span>
<span class="comments">;	to another.</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	XYXY, hdra, hdrb, xa, ya, [ xb, yb ]</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	hdra - The header containing the plate solution describing the</span>
<span class="comments">;	       frame of reference being converted FROM.</span>
<span class="comments">;	hdra - The header containing the plate solution describing the</span>
<span class="comments">;	       frame of reference being converted TO.</span>
<span class="comments">;	xa   - A scalar or vector containing the x coordinate(s) to convert.</span>
<span class="comments">;	ya   - A scalar or vector containing the y coordinate(s) to convert.</span>
<span class="comments">;	       Must have the same number of elements as 'xa'.</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;	xb   - The converted x coordinate(s).  If this parameter is not</span>
<span class="comments">;	       specified, it is returned through 'xa'.</span>
<span class="comments">;	yb   - The converted y coordinate(s).  If this parameter is not</span>
<span class="comments">;	       specified, it is returned through 'ya'.</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;	The procedures 'xyad' and 'adxy' are used to perform the </span>
<span class="comments">;       conversion.     The equinoxes of each header are checked with</span>
<span class="comments">;       "get_equinox" to make sure that they are identical, and "precess"</span>
<span class="comments">;       is used if they are not.   HEULER used if the headers have a different</span>
<span class="comments">;       coordinate system (e.g. Celestial, Galactic, Ecliptic)</span>
<span class="comments">;</span>
<span class="comments">;       Note that all X,Y coordinates are in the IDL convention (starting with</span>
<span class="comments">;       0,0) and not the FITS convention (first pixel is 1,1)</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;	GET_EQUINOX(), EXTAST, XYAD, ADXY, PRECESS, HEULER</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;	Written by Michael R. Greason, Hughes-STX, 13 April 1992.</span>
<span class="comments">;	Updated to use ASTROMETRY structures.  J.D.Offenberg, HSTX, Jan 1993</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Check coordinate system   J. Ballet/ W. Landsman  April 2004</span>
<span class="comments">;-</span>
On_error,2
<span class="comments">;			Check parameters.</span>
np = N_params()
if (np LT 4) then begin  
	print, "Syntax:  xyxy, hdra, hdrb, xa, ya [, xb, yb]"
	return
endif
if ( N_elements(xa) NE N_elements(ya) ) then begin  
	message,/CON, $
     'ERROR - The first two parameters must have the same number of elements.'
	return
endif
epa = get_equinox( hdra, codea)
epb = get_equinox( hdrb, codeb)

<span class="comments">;			Extract the plate solutions from the headers.  If</span>
<span class="comments">;			either header hasn't a plate solution, set the </span>
<span class="comments">;			output coordinates to the inputs and return.</span>
<span class="comments">;</span>
extast, hdra, astra, noparamsa
extast, hdrb, astrb, noparamsb
IF ( (noparamsa LT 0) OR (noparamsb LT 0)) THEN BEGIN
	xb = xa
	yb = ya
	return
endif

<span class="comments">;Convert between Celestial, Galactic, and Ecliptic if necessary</span>

typea = strmid(astra.ctype[0],0,4)
typeb = strmid(astrb.ctype[0],0,4)

IF typea NE typeb THEN $
     case typeb OF
     'GLON': HEULER, astra, /GALACTIC
     'RA--': HEULER, astra, /CELESTIAL
     'ELON': HEULER, astra, /ECLIPTIC
      ELSE : BEGIN
             PRINT, 'Cannot convert between coordinate systems ', typea, $
                      ' and ', typeb
             RETURN
      ENDELSE
   ENDCASE

<span class="comments">;			Perform the conversion.</span>

case strmid(astra.ctype[0],5,3)  of
   'GSS': gsssxyad, astra, xa, ya, a, d
   else: xy2ad, xa, ya, astra, a, d
endcase

if ( codea GE 0 ) and (codeb GE 0) then $
    if ( epa NE epb ) then $
           precess, a, d, epa, epb

case strmid( astrb.ctype[0], 5,3) of
 'GSS': gsssadxy, astrb, a, d, xb, yb
  else:  ad2xy, a, d, astrb, xb, yb 
endcase


<span class="comments">;		If 'xb' and 'yb' weren't specified in the procedure</span>
<span class="comments">;		call, overwrite xa and ya.</span>

if ( np LT 6 ) then begin  
	xa = xb
	ya = yb
endif
<span class="comments">;</span>
return
end
</code>
    </div>
  </body>
</html>