<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:19 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>baryvel.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="baryvel.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="baryvel-code.html" title="Chromocoded source">Source</a> <a href="baryvel.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">baryvel.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="baryvel">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="baryvel-code.html#baryvel:source" class="top">source</a> baryvel<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>baryvel<span class="argument">, <a href="#baryvel:p:dje">dje</a></span><span class="argument">, <a href="#baryvel:p:deq">deq</a></span><span class="argument">, <a href="#baryvel:p:dvelh">dvelh</a></span><span class="argument">, <a href="#baryvel:p:dvelb">dvelb</a></span><span class="argument">, <a href="#baryvel:k:JPL">JPL</a>=<span class="var">JPL</span></span></code></p>

          
          <div class="small "><p> NAME:
       BARYVEL
 PURPOSE:
       Calculates heliocentric and barycentric velocity components of Earth.
</p>

<p> EXPLANATION:
       BARYVEL takes into account the Earth-Moon motion, and is useful for
       radial velocity work to an accuracy of  ~1 m/s.
</p>

<p> CALLING SEQUENCE:
       BARYVEL, dje, deq, dvelh, dvelb, [ JPL =  ]
</p>

<p> INPUTS:
       DJE - (scalar) Julian ephemeris date.
       DEQ - (scalar) epoch of mean equinox of dvelh and dvelb. If deq=0
               then deq is assumed to be equal to dje.
 OUTPUTS:
       DVELH: (vector(3)) heliocentric velocity component. in km/s
       DVELB: (vector(3)) barycentric velocity component. in km/s
</p>

<p>       The 3-vectors DVELH and DVELB are given in a right-handed coordinate
       system with the +X axis toward the Vernal Equinox, and +Z axis
       toward the celestial pole.
</p>

<p> OPTIONAL KEYWORD SET:
       JPL - if /JPL set, then BARYVEL will call the procedure JPLEPHINTERP
             to compute the Earth velocity using the full JPL ephemeris.
             The JPL ephemeris FITS file JPLEPH.405 must exist in either the
             current directory, or in the directory specified by the
             environment variable ASTRO_DATA.   Alternatively, the JPL keyword
             can be set to the full path and name of the ephemeris file.
             A copy of the JPL ephemeris FITS file is available in
                 http://idlastro.gsfc.nasa.gov/ftp/data/
 PROCEDURES CALLED:
       Function PREMAT() -- computes precession matrix
       JPLEPHREAD, JPLEPHINTERP, TDB2TDT - if /JPL keyword is set
 NOTES:
       Algorithm taken from FORTRAN program of Stumpff (1980, A&A Suppl, 41,1)
       Stumpf claimed an accuracy of 42 cm/s for the velocity.    A
       comparison with the JPL FORTRAN planetary ephemeris program PLEPH
       found agreement to within about 65 cm/s between 1986 and 1994
</p>

<p>       If /JPL is set (using JPLEPH.405 ephemeris file) then velocities are
       given in the ICRS system; otherwise in the FK4 system.
 EXAMPLE:
       Compute the radial velocity of the Earth toward Altair on 15-Feb-1994
          using both the original Stumpf algorithm and the JPL ephemeris
</p>

<p>       IDL&gt; jdcnv, 1994, 2, 15, 0, jd          ;==&gt; JD = 2449398.5
       IDL&gt; baryvel, jd, 2000, vh, vb          ;Original algorithm
               ==&gt; vh = [-17.07243, -22.81121, -9.889315]  ;Heliocentric km/s
               ==&gt; vb = [-17.08083, -22.80471, -9.886582]  ;Barycentric km/s
       IDL&gt; baryvel, jd, 2000, vh, vb, /jpl   ;JPL ephemeris
               ==&gt; vh = [-17.07236, -22.81126, -9.889419]  ;Heliocentric km/s
               ==&gt; vb = [-17.08083, -22.80484, -9.886409]  ;Barycentric km/s
</p>

<p>       IDL&gt; ra = ten(19,50,46.77)*15/!RADEG    ;RA  in radians
       IDL&gt; dec = ten(08,52,3.5)/!RADEG        ;Dec in radians
       IDL&gt; v = vb[0]*cos(dec)*cos(ra) + $   ;Project velocity toward star
               vb[1]*cos(dec)*sin(ra) + vb[2]*sin(dec)
</p>

<p> REVISION HISTORY:
       Jeff Valenti,  U.C. Berkeley    Translated BARVEL.FOR to IDL.
       W. Landsman, Cleaned up program sent by Chris McCarthy (SfSU) June 1994
       Converted to IDL V5.0   W. Landsman   September 1997
       Added /JPL keyword  W. Landsman   July 2001
       Documentation update W. Landsman Dec 2005
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="baryvel:p:dje">dje <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="baryvel:p:deq">deq <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="baryvel:p:dvelh">dvelh <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="baryvel:p:dvelb">dvelb <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="baryvel:k:JPL">JPL <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:49 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>340</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:19 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>