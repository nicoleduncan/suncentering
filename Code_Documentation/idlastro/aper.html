<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:18 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>aper.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="aper.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="aper-code.html" title="Chromocoded source">Source</a> <a href="aper.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">aper.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="aper">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="aper-code.html#aper:source" class="top">source</a> aper<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>aper<span class="argument">, <a href="#aper:p:image">image</a></span><span class="argument">, <a href="#aper:p:xc">xc</a></span><span class="argument">, <a href="#aper:p:yc">yc</a></span><span class="argument">, <a href="#aper:p:mags">mags</a></span><span class="argument">, <a href="#aper:p:errap">errap</a></span><span class="argument">, <a href="#aper:p:sky">sky</a></span><span class="argument">, <a href="#aper:p:skyerr">skyerr</a></span><span class="argument">, <a href="#aper:p:phpadu">phpadu</a></span><span class="argument">, <a href="#aper:p:apr">apr</a></span><span class="argument">, <a href="#aper:p:skyrad">skyrad</a></span><span class="argument">, <a href="#aper:p:badpix">badpix</a></span><span class="argument">, <a href="#aper:k:SETSKYVAL">SETSKYVAL</a>=<span class="var">SETSKYVAL</span></span><span class="argument">, <a href="#aper:k:PRINT">PRINT</a>=<span class="var">PRINT</span></span><span class="argument">, <a href="#aper:k:SILENT">SILENT</a>=<span class="var">SILENT</span></span><span class="argument">, <a href="#aper:k:FLUX">FLUX</a>=<span class="var">FLUX</span></span><span class="argument">, <a href="#aper:k:EXACT">EXACT</a>=<span class="var">EXACT</span></span><span class="argument">, <a href="#aper:k:Nan">Nan</a>=<span class="var">Nan</span></span><span class="argument">, <a href="#aper:k:READNOISE">READNOISE</a>=<span class="var">READNOISE</span></span><span class="argument">, <a href="#aper:k:MEANBACK">MEANBACK</a>=<span class="var">MEANBACK</span></span><span class="argument">, <a href="#aper:k:CLIPSIG">CLIPSIG</a>=<span class="var">CLIPSIG</span></span><span class="argument">, <a href="#aper:k:MAXITER">MAXITER</a>=<span class="var">MAXITER</span></span><span class="argument">, <a href="#aper:k:CONVERGE_NUM">CONVERGE_NUM</a>=<span class="var">CONVERGE_NUM</span></span><span class="argument">, <a href="#aper:k:MINSKY">MINSKY</a>=<span class="var">MINSKY</span></span></code></p>

          
          <div class="small "><p> NAME:
      APER
 PURPOSE:
      Compute concentric aperture photometry (adapted from DAOPHOT)
 EXPLANATION:
     APER can compute photometry in several user-specified aperture radii.
     A separate sky value is computed for each source using specified inner
     and outer sky radii.
</p>

<p> CALLING SEQUENCE:
     APER, image, xc, yc, [ mags, errap, sky, skyerr, phpadu, apr, skyrad,
                       badpix, /NAN, /EXACT, /FLUX, PRINT = , /SILENT,
                       /MEANBACK, MINSKY=, SETSKYVAL = ]
 INPUTS:
     IMAGE -  input image array
     XC     - vector of x coordinates.
     YC     - vector of y coordinates
</p>

<p> OPTIONAL INPUTS:
     PHPADU - Photons per Analog Digital Units, numeric scalar.  Converts
               the data numbers in IMAGE to photon units.  (APER assumes
               Poisson statistics.)
     APR    - Vector of up to 12 REAL photometry aperture radii.
     SKYRAD - Two element vector giving the inner and outer radii
               to be used for the sky annulus.   Ignored if the SETSKYVAL
              keyword is set.
     BADPIX - Two element vector giving the minimum and maximum value
               of a good pixel.   If badpix is not supplied or if BADPIX[0] is
               equal to BADPIX[1] then it is assumed that there are no bad
               pixels.     Note that fluxes will not be computed for any star
               with a bad pixel within the aperture area, but that bad pixels
               will be simply ignored for the sky computation.    The BADPIX
               parameter is ignored if the /NAN keyword is set.
</p>

<p> OPTIONAL KEYWORD INPUTS:
     CLIPSIG - if /MEANBACK is set, then this is the number of sigma at which
             to clip the background.  Default=3
     CONVERGE_NUM:  if /MEANBACK is set then if the proportion of
           rejected pixels is less than this fraction, the iterations stop.
           Default=0.02, i.e., iteration stops if fewer than 2% of pixels
           excluded.
     /EXACT -  By default, APER counts subpixels, but uses a polygon
             approximation for the intersection of a circular aperture with
             a square pixel (and normalizes the total area of the sum of the
             pixels to exactly match the circular area).   If the /EXACT
             keyword, then the intersection of the circular aperture with a
             square pixel is computed exactly.    The /EXACT keyword is much
             slower and is only needed when small (~2 pixels) apertures are
             used with very undersampled data.
     /FLUX - By default, APER uses a magnitude system where a magnitude of
               25 corresponds to 1 flux unit.   If set, then APER will keep
              results in flux units instead of magnitudes.
     MAXITER if /MEANBACK is set then this is the ceiling on number of
             clipping iterations of the background.  Default=5
     /MEANBACK - if set, then the background is computed using the 3 sigma
             clipped mean (using meanclip.pro) rather than using the mode
             computed with mmm.pro.    This keyword is useful for the Poisson
             count regime or where contamination is known  to be minimal.
      MINSKY - Integer giving mininum number of sky values to be used with MMM
             APER will not compute a flux if fewer valid sky elements are
               within the sky annulus.   Default = 20.
     /NAN  - If set then APER will check for NAN values in the image.   /NAN
             takes precedence over the BADPIX parameter.   Note that fluxes
             will not be computed for any star with a NAN pixel within the
             aperture area, but that NAN pixels will be simply ignored for
             the sky computation.
     PRINT - if set and non-zero then APER will also write its results to
               a file aper.prt.   One can specify the output file name by
               setting PRINT = 'filename'.
     READNOISE - Scalar giving the read noise (or minimum noise for any
              pixel.   This value is passed to the procedure mmm.pro when
              computing the sky, and is only need for images where
              the noise is low, and pixel values are quantized.
     /SILENT -  If supplied and non-zero then no output is displayed to the
               terminal.
     SETSKYVAL - Use this keyword to force the sky to a specified value
               rather than have APER compute a sky value.    SETSKYVAL
               can either be a scalar specifying the sky value to use for
               all sources, or a 3 element vector specifying the sky value,
               the sigma of the sky value, and the number of elements used
               to compute a sky value.   The 3 element form of SETSKYVAL
               is needed for accurate error budgeting.
</p>

<p> OUTPUTS:
     MAGS   -  NAPER by NSTAR array giving the magnitude for each star in
               each aperture.  (NAPER is the number of apertures, and NSTAR
               is the number of stars).   If the /FLUX keyword is not set, then
               a flux of 1 digital unit is assigned a zero point magnitude of
               25.
     ERRAP  -  NAPER by NSTAR array giving error for each star.  If a
               magnitude could not be determined then  ERRAP = 9.99 (if in
                magnitudes) or ERRAP = !VALUES.F_NAN (if /FLUX is set).
     SKY  -    NSTAR element vector giving sky value for each star in
               flux units
     SKYERR -  NSTAR element vector giving error in sky values
</p>

<p> EXAMPLE:
       Determine the flux and error for photometry radii of 3 and 5 pixels
       surrounding the position 234.2,344.3 on an image array, im.   Compute
       the partial pixel area exactly.    Assume that the flux units are in
       Poisson counts, so that PHPADU = 1, and the sky value is already known
       to be 1.3, and that the range [-32767,80000] for bad low and bad high
       pixels
</p>

<p>       IDL&gt; aper, im, 234.2, 344.3, flux, eflux, sky,skyerr, 1, [3,5], -1, $
            [-32767,80000],/exact, /flux, setsky = 1.3
</p>

<p> PROCEDURES USED:
       GETOPT, MMM, PIXWT(), STRN(), STRNUMBER()
 NOTES:
       Reasons that a valid magnitude cannot be computed include the following:
      (1) Star position is too close (within 0.5 pixels) to edge of the frame
      (2) Less than 20 valid pixels available for computing sky
      (3) Modal value of sky could not be computed by the procedure MMM
      (4) *Any* pixel within the aperture radius is a "bad" pixel
      (5) The total computed flux is negative.     In this case the negative
          flux and error are returned.
</p>

<p>       For the case where the source is fainter than the background, APER will
       return negative fluxes if /FLUX is set, but will otherwise give
       invalid data (since negative fluxes can't be converted to magnitudes)
</p>

<p>       APER was modified in June 2000 in two ways: (1) the /EXACT keyword was
       added (2) the approximation of the intersection of a circular aperture
       with square pixels was improved (i.e. when /EXACT is not used)
 REVISON HISTORY:
       Adapted to IDL from DAOPHOT June, 1989   B. Pfarr, STX
       FLUX keyword added                       J. E. Hollis, February, 1996
       SETSKYVAL keyword, increase maxsky       W. Landsman, May 1997
       Work for more than 32767 stars           W. Landsman, August 1997
       Don't abort for insufficient sky pixels  W. Landsman  May 2000
       Added /EXACT keyword                     W. Landsman  June 2000
       Allow SETSKYVAL = 0                      W. Landsman  December 2000
       Set BADPIX[0] = BADPIX[1] to ignore bad pixels W. L.  January 2001
       Fix chk_badpixel problem introduced Jan 01 C. Ishida/W.L. February 2001
       Set bad fluxes and error to NAN if /FLUX is set  W. Landsman Oct. 2001
       Remove restrictions on maximum sky radius W. Landsman  July 2003
       Added /NAN keyword  W. Landsman November 2004
       Set badflux=0 if neither /NAN nor badpix is set  M. Perrin December 2004
       Added READNOISE keyword   W. Landsman January 2005
       Added MEANBACK keyword   W. Landsman October 2005
       Correct typo when /EXACT and multiple apertures used.  W.L. Dec 2005
       Remove VMS-specific code W.L. Sep 2006
       Add additional keywords if /MEANBACK is set W.L  Nov 2006
       Allow negative fluxes if /FLUX is set  W.L.  Mar 2008
       Previous update would crash if first star was out of range  W.L. Mar 2008
       Fix floating equality test for bad magnitudes W.L./J.van Eyken Jul 2009
       Added MINSKY keyword W.L. Dec 2011
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="aper:p:image">image <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:xc">xc <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:yc">yc <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:mags">mags <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:errap">errap <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:sky">sky <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:skyerr">skyerr <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:phpadu">phpadu <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:apr">apr <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:skyrad">skyrad <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:p:badpix">badpix <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="aper:k:SETSKYVAL">SETSKYVAL <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:PRINT">PRINT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:SILENT">SILENT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:FLUX">FLUX <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:EXACT">EXACT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:Nan">Nan <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:READNOISE">READNOISE <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:MEANBACK">MEANBACK <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:CLIPSIG">CLIPSIG <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:MAXITER">MAXITER <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:CONVERGE_NUM">CONVERGE_NUM <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="aper:k:MINSKY">MINSKY <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>476</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:19 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>