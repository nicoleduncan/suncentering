<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:28 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>eq2hor.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="eq2hor.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="eq2hor-code.html" title="Chromocoded source">Source</a> <a href="eq2hor.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">eq2hor.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      
      <div id="file_comments">
        <div class="small "><p> NAME:
   EQ2HOR
</p>

<p> PURPOSE:
    Convert celestial  (ra-dec) coords to local horizon coords (alt-az).
</p>

<p> CALLING SEQUENCE:
</p>

<p>    eq2hor, ra, dec, jd, alt, az, [ha, LAT= , LON= , /WS, OBSNAME= , $
                       /B1950 , PRECESS_= 0, NUTATE_= 0, REFRACT_= 0, $
                       ABERRATION_= 0, ALTITUDE= , /VERBOSE, _EXTRA= ]
</p>

<p> DESCRIPTION:
  This  code calculates horizon (alt,az) coordinates from equatorial
  (ra,dec) coords.   It is typically accurate to about 1 arcsecond or better (I
  have checked the output against the publicly available XEPHEM software). It
  performs precession, nutation, aberration, and refraction corrections.  The
  perhaps best thing about it is that it can take arrays as inputs, in all
  variables and keywords EXCEPT Lat, lon, and Altitude (the code assumes these
  aren't changing), and uses vector arithmetic in every calculation except
  when calculating the precession matrices.
</p>

<p> INPUT VARIABLES:
       RA   : Right Ascension of object  (J2000) in degrees (FK5); scalar or
              vector.
       Dec  : Declination of object (J2000) in degrees (FK5), scalar or vector.
       JD   : Julian Date [scalar or vector]
</p>

<p>       Note: if RA and DEC are arrays, then alt and az will also be arrays.
             If RA and DEC are arrays, JD may be a scalar OR an array of the
             same dimensionality.
</p>

<p> OPTIONAL INPUT KEYWORDS:
       lat   : north geodetic latitude of location in degrees
       lon   : EAST longitude of location in degrees (Specify west longitude
               with a negative sign.)
       /WS    : Set this to get the azimuth measured westward from south (not
               East of North).
       obsname: Set this to a valid observatory name to be used by the
              astrolib OBSERVATORY procedure, which will return the latitude
              and longitude to be used by this program.
       /B1950 : Set this if your ra and dec are specified in B1950, FK4
              coordinates (instead of J2000, FK5)
       precess_ : Set this to 1 to force precession [default], 0 for no
               precession correction
       nutate_  : Set this to 1 to force nutation [default], 0 for no nutation.
       aberration_ : Set this to 1 to force aberration correction [default],
                     0 for no correction.
       refract_ : Set to 1 to force refraction correction [default], 0 for no
                     correction.
       altitude: The altitude of the observing location, in meters. [default=0].
       verbose: Set this for verbose output.  The default is verbose=0.
       _extra: This is for setting TEMPERATURE or PRESSURE explicitly, which are
               used by CO_REFRACT to calculate the refraction effect of the
               atmosphere. If you don't set these, the program will make an
               intelligent guess as to what they are (taking into account your
               altitude).  See CO_REFRACT for more details.
</p>

<p> OUTPUT VARIABLES: (all double precision)
       alt    : altitude (in degrees)
       az     : azimuth angle (in degrees, measured EAST from NORTH, but see
                keyword WS above.)
       ha     : hour angle (in degrees) (optional)
</p>

<p> DEPENDENCIES:
       NUTATE, PRECESS, OBSERVATORY, SUNPOS, ADSTRING()
       CO_NUTATE, CO_ABERRATION, CO_REFRACT, ALTAZ2HADEC, SETDEFAULTVALUE
</p>

<p> BASIC STEPS
   Apply refraction correction to find apparent Alt.
   Calculate Local Mean Sidereal Time
   Calculate Local Apparent Sidereal Time
   Do Spherical Trig to find apparent hour angle, declination.
   Calculate Right Ascension from hour angle and local sidereal time.
   Nutation Correction to Ra-Dec
   Aberration correction to Ra-Dec
       Precess Ra-Dec to current equinox.
</p>

<p>CORRECTIONS I DO NOT MAKE:
   *  Deflection of Light by the sun due to GR. (typically milliarcseconds,
        can be arseconds within one degree of the sun)
   *  The Effect of Annual Parallax (typically &lt; 1 arcsecond)
   *  and more (see below)
</p>

<p> TO DO
    * Better Refraction Correction.  Need to put in wavelength dependence,
    and integrate through the atmosphere.
        * Topocentric Parallax Correction (will take into account elevation of
          the observatory)
    * Proper Motion (but this will require crazy lookup tables or something).
        * Difference between UTC and UT1 in determining LAST -- is this
          important?
        * Effect of Annual Parallax (is this the same as topocentric Parallax?)
    * Polar Motion
        * Better connection to Julian Date Calculator.
</p>

<p> EXAMPLE
</p>

<p>  Find the position of the open cluster NGC 2264 at the Effelsburg Radio
  Telescope in Germany, on June 11, 2023, at local time 22:00 (METDST).
  The inputs will then be:
</p>

<p>       Julian Date = 2460107.250
       Latitude = 50d 31m 36s
       Longitude = 06h 51m 18s
       Altitude = 369 meters
       RA (J2000) = 06h 40m 58.2s
       Dec(J2000) = 09d 53m 44.0s
</p>

<p>  IDL&gt; eq2hor, ten(6,40,58.2)*15., ten(9,53,44), 2460107.250d, alt, az, $
               lat=ten(50,31,36), lon=ten(6,51,18), altitude=369.0, /verb, $
                pres=980.0, temp=283.0
</p>

<p> The program produces this output (because the VERBOSE keyword was set)
</p>

<p> Latitude = +50 31 36.0   Longitude = +06 51 18.0
 Julian Date =  2460107.250000
 Ra, Dec:  06 40 58.2  +09 53 44.0   (J2000)
 Ra, Dec:  06 42 15.7  +09 52 19.2   (J2023.4422)
 Ra, Dec:  06 42 13.8  +09 52 26.9   (fully corrected)
 LMST = +11 46 42.0
 LAST = +11 46 41.4
 Hour Angle = +05 04 27.6  (hh:mm:ss)
 Az, El =  17 42 25.6  +16 25 10.3   (Apparent Coords)
 Az, El =  17 42 25.6  +16 28 22.8   (Observer Coords)
</p>

<p> Compare this with the result from XEPHEM:
 Az, El =  17h 42m 25.6s +16d 28m 21s
</p>

<p> This 1.8 arcsecond discrepancy in elevation arises primarily from slight
 differences in the way I calculate the refraction correction from XEPHEM, and
 is pretty typical.
</p>

<p> AUTHOR:
   Chris O'Dell
       Univ. of Wisconsin-Madison
   Observational Cosmology Laboratory
   Email: odell@cmb.physics.wisc.edu
  Revision History:
    August 2012  Use Strict_Extra to flag spurious keywords W. Landsman
</p>

</div>
      </div>
      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="eq2hor">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="eq2hor-code.html#eq2hor:source" class="top">source</a> eq2hor<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>eq2hor<span class="argument">, <a href="#eq2hor:p:ra">ra</a></span><span class="argument">, <a href="#eq2hor:p:dec">dec</a></span><span class="argument">, <a href="#eq2hor:p:jd">jd</a></span><span class="argument">, <a href="#eq2hor:p:alt">alt</a></span><span class="argument">, <a href="#eq2hor:p:az">az</a></span><span class="argument">, <a href="#eq2hor:p:ha">ha</a></span><span class="argument">, <a href="#eq2hor:k:lat">lat</a>=<span class="var">lat</span></span><span class="argument">, <a href="#eq2hor:k:lon">lon</a>=<span class="var">lon</span></span><span class="argument">, <a href="#eq2hor:k:WS">WS</a>=<span class="var">WS</span></span><span class="argument">, <a href="#eq2hor:k:obsname">obsname</a>=<span class="var">obsname</span></span><span class="argument">, <a href="#eq2hor:k:B1950">B1950</a>=<span class="var">B1950</span></span><span class="argument">, <a href="#eq2hor:k:verbose">verbose</a>=<span class="var">verbose</span></span><span class="argument">, <a href="#eq2hor:k:precess_">precess_</a>=<span class="var">precess_</span></span><span class="argument">, <a href="#eq2hor:k:nutate_">nutate_</a>=<span class="var">nutate_</span></span><span class="argument">, <a href="#eq2hor:k:refract_">refract_</a>=<span class="var">refract_</span></span><span class="argument">, <a href="#eq2hor:k:aberration_">aberration_</a>=<span class="var">aberration_</span></span><span class="argument">, <a href="#eq2hor:k:altitude">altitude</a>=<span class="var">altitude</span></span><span class="argument">, <a href="#eq2hor:k:_extra">_extra</a>=<span class="var">_extra</span></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="eq2hor:p:ra">ra <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:p:dec">dec <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:p:jd">jd <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:p:alt">alt <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:p:az">az <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:p:ha">ha <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="eq2hor:k:lat">lat <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:lon">lon <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:WS">WS <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:obsname">obsname <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:B1950">B1950 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:verbose">verbose <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:precess_">precess_ <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:nutate_">nutate_ <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:refract_">refract_ <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:aberration_">aberration_ <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:altitude">altitude <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="eq2hor:k:_extra">_extra <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:49 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>266</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:28 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>