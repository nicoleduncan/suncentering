<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:53 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>nstar.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="nstar.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="nstar-code.html" title="Chromocoded source">Source</a> <a href="nstar.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">nstar.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="nstar">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="nstar-code.html#nstar:source" class="top">source</a> nstar<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>nstar<span class="argument">, <a href="#nstar:p:image">image</a></span><span class="argument">, <a href="#nstar:p:id">id</a></span><span class="argument">, <a href="#nstar:p:xc">xc</a></span><span class="argument">, <a href="#nstar:p:yc">yc</a></span><span class="argument">, <a href="#nstar:p:mags">mags</a></span><span class="argument">, <a href="#nstar:p:sky">sky</a></span><span class="argument">, <a href="#nstar:p:group">group</a></span><span class="argument">, <a href="#nstar:p:phpadu">phpadu</a></span><span class="argument">, <a href="#nstar:p:readns">readns</a></span><span class="argument">, <a href="#nstar:p:psfname">psfname</a></span><span class="argument">, <a href="#nstar:p:errmag">errmag</a></span><span class="argument">, <a href="#nstar:p:iter">iter</a></span><span class="argument">, <a href="#nstar:p:chisq">chisq</a></span><span class="argument">, <a href="#nstar:p:peak">peak</a></span><span class="argument">, <a href="#nstar:k:DEBUG">DEBUG</a>=<span class="var">DEBUG</span></span><span class="argument">, <a href="#nstar:k:PRINT">PRINT</a>=<span class="var">PRINT</span></span><span class="argument">, <a href="#nstar:k:SILENT">SILENT</a>=<span class="var">SILENT</span></span><span class="argument">, <a href="#nstar:k:VARSKY">VARSKY</a>=<span class="var">VARSKY</span></span></code></p>

          
          <div class="small "><p> NAME:
       NSTAR
 PURPOSE:
       Simultaneous point spread function fitting (adapted from DAOPHOT)
 EXPLANATION:
       This PSF fitting algorithm is based on a very old (~1987) version of
       DAOPHOT, and much better algorithms (e.g. ALLSTAR) are now available
       -- though not in IDL.
</p>

<p> CALLING SEQUENCE:
       NSTAR, image, id, xc, yc, mags, sky, group, [ phpadu, readns, psfname,
               magerr, iter, chisq, peak, /PRINT , /SILENT, /VARSKY, /DEBUG ]
</p>

<p> INPUTS:
       image - image array
       id    - vector of stellar ID numbers given by FIND
       xc    - vector containing X position centroids of stars (e.g. as found
               by FIND)
       yc    - vector of Y position centroids
       mags  - vector of aperture magnitudes (e.g. as found by APER)
               If 9 or more parameters are supplied then, upon output
               ID,XC,YC, and MAGS will be modified to contain the new
               values of these parameters as determined by NSTAR.
               Note that the number of output stars may be less than
               the number of input stars since stars may converge, or
               "disappear" because they are too faint.
       sky   - vector of sky background values (e.g. as found by APER)
       group - vector containing group id's of stars as found by GROUP
</p>

<p> OPTIONAL INPUT:
       phpadu - numeric scalar giving number of photons per digital unit.
               Needed for computing Poisson error statistics.
       readns - readout noise per pixel, numeric scalar.   If not supplied,
               NSTAR will try to read the values of READNS and PHPADU from
               the PSF header.  If still not found, user will be prompted.
       psfname - name of FITS image file containing the point spread
               function residuals as determined by GETPSF, scalar string.
               If omitted, then NSTAR will prompt for this parameter.
</p>

<p> OPTIONAL OUTPUTS:
       MAGERR - vector of errors in the magnitudes found by NSTAR
       ITER - vector containing the number of iterations required for
               each output star.
       CHISQ- vector containing the chi square of the PSF fit for each
               output star.
       PEAK - vector containing the difference of the mean residual of
               the pixels in the outer half of the fitting circle and
               the mean residual of pixels in the inner half of the
               fitting circle
</p>

<p> OPTIONAL KEYWORD INPUTS:
       /SILENT - if set and non-zero, then NSTAR will not display its results
               at the terminal
       /PRINT - if set and non-zero then NSTAR will also write its results to
               a file nstar.prt.   One also can specify the output file name
               by setting PRINT = 'filename'.
       /VARSKY - if this keyword is set and non-zero, then the sky level of
               each group is set as a free parameter.
       /DEBUG - if this keyword is set and non-zero, then the result of each
               fitting iteration will be displayed.
</p>

<p> PROCEDURES USED:
       DAO_VALUE(), READFITS(), REMOVE, SPEC_DIR(), STRN(), SXPAR()
</p>

<p> COMMON BLOCK:
       RINTER - contains pre-tabulated values for cubic interpolation
 REVISION HISTORY
       W. Landsman                 ST Systems Co.       May, 1988
       Adapted for IDL Version 2, J. Isensee, September, 1990
       Minor fixes so that PRINT='filename' really prints to 'filename', and
       it really silent if SILENT is set.  J.Wm.Parker HSTX 1995-Oct-31
       Added /VARSKY option   W. Landsman   HSTX      May 1996
       Converted to IDL V5.0   W. Landsman   September 1997
       Replace DATATYPE() with size(/TNAME)  W. Landsman November 2001
       Assume since V5.5, remove VMS calls W. Landsman September 2006
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="nstar:p:image">image <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:id">id <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:xc">xc <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:yc">yc <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:mags">mags <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:sky">sky <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:group">group <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:phpadu">phpadu <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:readns">readns <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:psfname">psfname <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:errmag">errmag <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:iter">iter <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:chisq">chisq <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:p:peak">peak <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="nstar:k:DEBUG">DEBUG <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:k:PRINT">PRINT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:k:SILENT">SILENT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="nstar:k:VARSKY">VARSKY <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>485</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:53 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>