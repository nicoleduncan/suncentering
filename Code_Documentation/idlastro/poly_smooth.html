<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:56 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>poly_smooth.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="poly_smooth.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="poly_smooth-code.html" title="Chromocoded source">Source</a> <a href="poly_smooth.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">poly_smooth.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="poly_smooth">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="poly_smooth-code.html#poly_smooth:source" class="top">source</a> poly_smooth<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = poly_smooth(<span class="argument"><a href="#poly_smooth:p:data">data</a></span><span class="argument">, <a href="#poly_smooth:p:width">width</a></span><span class="argument">, <a href="#poly_smooth:k:DEGREE">DEGREE</a>=<span class="var">DEGREE</span></span><span class="argument">, <a href="#poly_smooth:k:NLEFT">NLEFT</a>=<span class="var">NLEFT</span></span><span class="argument">, <a href="#poly_smooth:k:NRIGHT">NRIGHT</a>=<span class="var">NRIGHT</span></span><span class="argument">, <a href="#poly_smooth:k:DERIV_ORDER">DERIV_ORDER</a>=<span class="var">DERIV_ORDER</span></span><span class="argument">, <a href="#poly_smooth:k:COEFFICIENTS">COEFFICIENTS</a>=<span class="var">COEFFICIENTS</span></span>)</code></p>

          
          <div class="small "><p> NAME:
       POLY_SMOOTH
</p>

<p> PURPOSE:
       Apply a least-squares (Savitzky-Golay) polynomial smoothing filter
 EXPLANATION:
       Reduce noise in 1-D data (e.g. time-series, spectrum) but retain
       dynamic range of variations in the data by applying a least squares
       smoothing polynomial filter,
</p>

<p>       Also called the Savitzky-Golay smoothing filter, cf. Numerical
       Recipes (Press et al. 1992, Sec.14.8)
</p>

<p>       The low-pass filter coefficients are computed by effectively
       least-squares fitting a polynomial in moving window,
       centered on each data point, so the new value will be the
       zero-th coefficient of the polynomial. Approximate first derivates
       of the data can be computed by using first degree coefficient of
       each polynomial, and so on. The filter coefficients for a specified
       polynomial degree and window width are computed independent of any
       data, and stored in a common block. The filter is then convolved
       with the data array to result in smoothed data with reduced noise,
       but retaining higher order variations (better than SMOOTH).
</p>

<p>       This procedure became partially obsolete in IDL V5.4 with the
       introduction of the SAVGOL function, which computes the smoothing
       coefficients.
 CALLING SEQUENCE:
</p>

<p>       spectrum = poly_smooth( data, [ width, DEGREE = , NLEFT = , NRIGHT =
                                       DERIV_ORDER = ,COEFF = ]
</p>

<p> INPUTS:
       data = 1-D array, such as a spectrum or time-series.
</p>

<p>       width = total number of data points to use in filter convolution,
               (default = 5, using 2 past and 2 future data points),
               must be larger than DEGREE of polynomials, and a guideline is to
               make WIDTH between 1 and 2 times the FWHM of desired features.
</p>

<p> OPTIONAL INPUT KEYWORDS:
</p>

<p>       DEGREE = degree of polynomials to use in designing the filter
               via least squares fits, (default DEGREE = 2)
               The higher degrees will preserve sharper features.
</p>

<p>       NLEFT = # of past data points to use in filter convolution,
               excluding current point, overrides width parameter,
               so that width = NLEFT + NRIGHT + 1.  (default = NRIGHT)
</p>

<p>       NRIGHT = # of future data points to use (default = NLEFT).
</p>

<p>       DERIV_ORDER = order of derivative desired (default = 0, no derivative).
</p>

<p> OPTIONAL OUTPUT KEYWORD:
</p>

<p>       COEFFICIENTS = optional output of the filter coefficients applied,
               but they are all stored in common block for reuse, anyway.
 RESULTS:
       Function returns the data convolved with polynomial filter coefs.
</p>

<p> EXAMPLE:
</p>

<p>       Given a wavelength - flux spectrum (w,f), apply a 31 point quadratic
       smoothing filter and plot
</p>

<p>       IDL&gt; cgplot, w, poly_smooth(f,31)
 COMMON BLOCKS:
       common poly_smooth, degc, nlc, nrc, coefs, ordermax
</p>

<p> PROCEDURE:
       As described in Numerical Recipies, 2nd edition sec.14.8,
       Savitsky-Golay filter.
       Matrix of normal eqs. is formed by starting with small terms
       and then adding progressively larger terms (powers).
       The filter coefficients of up to derivative ordermax are stored
       in common, until the specifications change, then recompute coefficients.
       Coefficients are stored in convolution order, zero lag in the middle.
</p>

<p> MODIFICATION HISTORY:
       Written, Frank Varosi NASA/GSFC 1993.
       Converted to IDL V5.0   W. Landsman   September 1997
       Use /EDGE_TRUNCATE keyword to CONVOL  W. Landsman March 2006
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="poly_smooth:p:data">data <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="poly_smooth:p:width">width <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="poly_smooth:k:DEGREE">DEGREE <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="poly_smooth:k:NLEFT">NLEFT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="poly_smooth:k:NRIGHT">NRIGHT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="poly_smooth:k:DERIV_ORDER">DERIV_ORDER <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="poly_smooth:k:COEFFICIENTS">COEFFICIENTS <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>191</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:56 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>