<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:40 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>gsss_stdast.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="gsss_stdast.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="GSSS_StdAst:source"></a>pro GSSS_StdAst,h,xpts,ypts
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;      GSSS_STDAST</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;      Insert the closest tangent projection astrometry into an GSSS Image</span>
<span class="comments">;   </span>
<span class="comments">; DESCRIPTION:</span>
<span class="comments">;       This procedure takes a header with GSSS (ST Guide Star Survey) </span>
<span class="comments">;       astrometry and writes a roughly equivalent tangent projection </span>
<span class="comments">;       astrometry into the header.     One might want to do this if (1)</span>
<span class="comments">;       one needs to use software which does not recognize the GSSS astrometric</span>
<span class="comments">;       parameters or (2) if the the image to be transformed, since the </span>
<span class="comments">;       highly nonlinear GSSS solution does not transform easily.  </span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       GSSS_STDAST, H, [Xpts, Ypts]</span>
<span class="comments">;</span>
<span class="comments">; INPUT - OUTPUT:</span>
<span class="comments">;       H -  FITS header (string array) containing GSSS astrometry.  </span>
<span class="comments">;       GSSS_STDAST will write the roughly equivalent tangent projection </span>
<span class="comments">;               astrometry solution into H.</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;       xpts, ypts -- Vectors giving the X and Y positions of the three </span>
<span class="comments">;               reference points used to find approximate tangent projection.</span>
<span class="comments">;               Default is Xpts = [0.2,0.8,0.5], Ypts = [0.2, 0.4, 0.8]</span>
<span class="comments">; METHOD:</span>
<span class="comments">;       The procedures GSSSXYAD is used to exactly determine the RA and Dec</span>
<span class="comments">;       at 3 reference points.    STARAST is then used to find the tangent</span>
<span class="comments">;       projection astrometry that best matches these reference points.</span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       Images from the STScI server (http://archive.stsci.edu/dss/) contain</span>
<span class="comments">;       both a GSSS polynomial plate solution and an approximate WCS tangent</span>
<span class="comments">;       projection.    The value  of the WCSNAME keyword in the FITS header </span>
<span class="comments">;       is 'DSS'.    If WCSNAME = "DSS' then the more accurate DSS astrometry</span>
<span class="comments">;       is extracted by EXTAST    This procedure changes the value of WCSNAME  </span>
<span class="comments">;       to 'DSS_TANGENT' to indicate that the tangent solution should be used.</span>
<span class="comments">;    </span>
<span class="comments">;       Some early GSSS images (before the 1994 CD-Rom) used keywords CRPIXx</span>
<span class="comments">;       rather than CNPIXx.    The GSSS astrometry in these images could be</span>
<span class="comments">;       corrupted by this procedure as the CRPIXx values will be altered.</span>
<span class="comments">;</span>
<span class="comments">;       The tangent is only a approximation of the nonlinear GSSS astrometry,</span>
<span class="comments">;       but is generally accurate to about 0.1 pixels on a 1024 x 1024 image.</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       GSSSEXTAST, GSSSXYAD, STARAST, PUTAST, SXADDHIST, SXDELPAR</span>
<span class="comments">;</span>
<span class="comments">; HISTORY:</span>
<span class="comments">;       13-AUG-91 Version 2 written from MAKEASTGSSS  Eric Deutsch (STScI)</span>
<span class="comments">;       Delete CDELT* keywords from header   W. Landsman      May 1994</span>
<span class="comments">;       Remove call to BUILDAST  W. Landsman                  Jan, 1995</span>
<span class="comments">;       Added optional Xpts, Ypts parameters   E. Deutsch     Oct, 1995</span>
<span class="comments">;       Add WCSNAME   W. Landsman                             Nov 2006</span>
<span class="comments">;-</span>
  On_error,2
  compile_opt idl2

  arg = N_params()

  if (arg lt 1) then begin
    print,'Syntax - GSSS_StdAst, header, [xpts, ypts]'
    print,'Purpose - Write tangent projection astrometry into a GSSS header'
    return
    endif

<span class="comments">; options for supplying of this info by Deutsch 10/5/95</span>
  if (n_elements(xpts) eq 0) or (n_elements(ypts) eq 0) then begin
    NAXIS1 = sxpar(h,'NAXIS1') & NAXIS2 = sxpar(h,'NAXIS2')
    X = [.2,.8,.5]*NAXIS1 & Y=[.2,.4,.8]*NAXIS2
  endif else begin
    x=xpts & y=ypts
    endelse

  GSSSExtAst,h,gsa
  GSSSXYAD,gsa,X,Y,ra,dec

  starast, RA, DEC, X, Y, cd
  crval=[RA[0],DEC[0]] & crpix=[X[0],Y[0]]+1

  sxaddpar, h, 'WCSNAME', 'DSS_TANGENT', $
            'WCS Tangent Approximation to full plate solution' 
  sxaddpar, h, 'CTYPE1','RA---TAN'
  sxaddpar, h, 'CTYPE2','DEC--TAN'
  sxaddpar, h, 'CD1_1', cd[0,0]
  sxaddpar, h, 'CD1_2', cd[0,1]
  sxaddpar, h, 'CD2_1', cd[1,0]
  sxaddpar, h, 'CD2_2', cd[1,1]
  sxaddpar, h, 'CRPIX1', crpix[0]
  sxaddpar, h, 'CRPIX2', crpix[1]
  sxaddpar, h, 'CRVAL1', crval[0]
  sxaddpar, h, 'CRVAL2', crval[1]

  hist = ['GSSS_STDAST: Astrometry calculated from GSSS format and written', $
          'GSSS_STDAST: in tangent projection format: ' + systime() ]
  sxaddhist,hist,h

  sxdelpar, h, 'CDELT1'
  sxdelpar, h, 'CDELT2'
  

  return
  end
</code>
    </div>
  </body>
</html>