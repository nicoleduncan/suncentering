<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:06 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>table_append.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="table_append.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="table_append:source"></a>pro table_append,list,name
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	TABLE_APPEND</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Routine to append STSDAS tables to create a single table. </span>
<span class="comments">;	Input tables must all have identical columns.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	table_append,list,name</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	list - string array listing the file names or a string</span>
<span class="comments">;		scalar giving a file name template.</span>
<span class="comments">;	name - output file name.</span>
<span class="comments">; SIDE EFFECTS:</span>
<span class="comments">;	a new STSDAS table is created with the specified name.</span>
<span class="comments">;</span>
<span class="comments">; OPERATIONAL NOTES:</span>
<span class="comments">;	all input tables must have the same number of columns</span>
<span class="comments">;	with the same names, datatypes, and column order.</span>
<span class="comments">;	Header parameters are taken only from the first table.</span>
<span class="comments">;</span>
<span class="comments">; HISTORY:</span>
<span class="comments">;	version 1  D. Lindler	April 1989</span>
<span class="comments">;       Removed call to non-standard system variable !DUMP WBL  September 1997</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Use file_search rather than findfile  W. Landsman Sep 2006</span>
<span class="comments">;-</span>
<span class="comments">;---------------------------------------------------------------------</span>
<span class="comments">;</span>
<span class="comments">; get list of file names if list is a scalar</span>
<span class="comments">;</span>
	if n_elements(list) eq 1 then files=file_search(list) $
				 else files=list
		print,'Merging files:'
		print,files
	nfiles=n_elements(files)
<span class="comments">;</span>
<span class="comments">; read first table as template for the output table</span>
<span class="comments">;</span>
	tab_read,strtrim(files[0]),tcb,tab,h
	nrows=tcb[3]
	max_rows=tcb[4]>nrows
	ncols=tcb[5]
	rowlen=tcb[7]
	max_rowlen=tcb[8]>rowlen
	cnames=strarr(20,ncols)
	for i=1,ncols do begin
		tab_col,tcb,i,offset,width,datatype,cname
		cnames[i-1]=cname
	endfor
<span class="comments">;</span>
<span class="comments">; loop on remaining tables</span>
<span class="comments">;</span>
	if nfiles gt 1 then begin
	    for ifile=1,nfiles-1 do begin
		tab_read,strtrim(files[ifile]),tcb1,tab1
		nr=tcb1[3]			<span class="comments">;number of rows</span>
		nc=tcb1[5]			<span class="comments">;number of columns</span>
		rl=tcb1[7]			<span class="comments">;row length</span>
		if (rl ne rowlen) or (nc ne ncols) then begin
			print,'table_append-- input tables are not compatible'
			retall
		endif
<span class="comments">;</span>
<span class="comments">; do columns match</span>
<span class="comments">;</span>
		for i=1,ncols-1 do begin
			tab_col,tcb1,i,offset,width,datatype,cname
			if strtrim(cname) ne strtrim(cnames[i-1]) then begin
				print,'table_append-- column names must be'+ $
					' the same in all input tables'
				retall
			endif
		endfor
<span class="comments">;</span>
<span class="comments">; do we need to expand the output table?</span>
<span class="comments">;</span>
		if (nr+nrows) gt max_rows then $
			tab_expand,tcb,tab,0,nrows+nr*(nfiles-ifile+1)
		max_rows=tcb[4]
<span class="comments">;</span>
<span class="comments">; insert new rows and update the table control block</span>
<span class="comments">;</span>
		tab[0,nrows]=tab1[0:rowlen*2-1,0:nr-1]
		nrows=nrows+nr
		tcb[3]=nrows
	    endfor
	endif
<span class="comments">;</span>
<span class="comments">; write the new table</span>
<span class="comments">;</span>
	tab_write,name,tcb,tab,h
	return
end
</code>
    </div>
  </body>
</html>