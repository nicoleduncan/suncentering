<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:47 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>mkhdr.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="mkhdr.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="mkhdr:source"></a>pro mkhdr, header, im, naxisx, IMAGE = image, EXTEND = extend
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       MKHDR</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Make a minimal primary (or IMAGE extension) FITS header</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       If an array is supplied,  then the created FITS header will be </span>
<span class="comments">;       appropriate to the supplied array.  Otherwise, the user can specify </span>
<span class="comments">;       the dimensions and datatype.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       MKHDR, header                   ;Prompt for image size and type</span>
<span class="comments">;               or</span>
<span class="comments">;       MKHDR, header, im, [ /IMAGE, /EXTEND ]</span>
<span class="comments">;               or</span>
<span class="comments">;       MKHDR, header, type, naxisx, [/IMAGE, /EXTEND ]         </span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;       IM - If IM is a vector or array then the header will be made</span>
<span class="comments">;               appropriate to the size and type of IM.  IM does not have</span>
<span class="comments">;               to be the actual data; it can be a dummy array of the same</span>
<span class="comments">;               type and size as the data.    Set IM = '' to create a dummy</span>
<span class="comments">;               header with NAXIS = 0. </span>
<span class="comments">;       TYPE - If 2 parameters are supplied, then the second parameter</span>
<span class="comments">;               is interpreted as an integer giving the IDL datatype e.g. </span>
<span class="comments">;               1 - Byte, 2 - 16 bit integer, 4 - float, 3 - Long</span>
<span class="comments">;       NAXISX - Vector giving the size of each dimension (NAXIS1, NAXIS2, </span>
<span class="comments">;               etc.).  </span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       HEADER - image header, (string array) with required keywords</span>
<span class="comments">;               BITPIX, NAXIS, NAXIS1, ... Further keywords can be added</span>
<span class="comments">;               to the header with SXADDPAR. </span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS:</span>
<span class="comments">;       /IMAGE   = If set, then a minimal header for a FITS IMAGE extension</span>
<span class="comments">;               is created.    An IMAGE extension header is identical to</span>
<span class="comments">;               a primary FITS header except the first keyword is </span>
<span class="comments">;               'XTENSION' = 'IMAGE' instead of 'SIMPLE  ' = 'T'</span>
<span class="comments">;       /EXTEND  = If set, then the keyword EXTEND is inserted into the file,</span>
<span class="comments">;               with the value of "T" (true).    The EXTEND keyword can </span>
<span class="comments">;               optionally be included in a primary header, if the FITS file </span>
<span class="comments">;               contains extensions.</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;       (1)  MKHDR should not be used to make an STSDAS header or a FITS</span>
<span class="comments">;               ASCII or Binary Table extension header.   Instead use</span>
<span class="comments">;</span>
<span class="comments">;               SXHMAKE - to create a minimal STSDAS header</span>
<span class="comments">;               FXBHMAKE - to create a minimal FITS binary table header</span>
<span class="comments">;               FTCREATE - to create a minimal FITS ASCII table header</span>
<span class="comments">;</span>
<span class="comments">;       (2)  Any data already in the header before calling MKHDR</span>
<span class="comments">;               will be destroyed.</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Create a minimal FITS header, Hdr, for a 30 x 40 x 50 INTEGER*2 array</span>
<span class="comments">;</span>
<span class="comments">;             IDL> mkhdr, Hdr, 2, [30,40,50]</span>
<span class="comments">;</span>
<span class="comments">;       Alternatively, if the array already exists as an IDL variable, Array,</span>
<span class="comments">;</span>
<span class="comments">;              IDL> mkhdr, Hdr, Array</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES CALLED:</span>
<span class="comments">;       SXADDPAR, GET_DATE</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written November, 1988               W. Landsman</span>
<span class="comments">;       May, 1990, Adapted for IDL Version 2.0, J. Isensee</span>
<span class="comments">;       Aug, 1997, Use SYSTIME(), new DATE format  W. Landsman</span>
<span class="comments">;       Allow unsigned data types    W. Landsman   December 1999</span>
<span class="comments">;       Set BZERO = 0 for unsigned integer data  W. Landsman January 2000</span>
<span class="comments">;       EXTEND keyword must immediately follow last NAXISi W. Landsman Sep 2000</span>
<span class="comments">;       Add FITS definition COMMENT to primary headers W. Landsman Oct. 2001</span>
<span class="comments">;       Allow (nonstandard) 64 bit integers   W. Landsman  Feb. 2003</span>
<span class="comments">;       Add V6.0 notation W. Landsman July 2012</span>
<span class="comments">;-                          </span>
 On_error,2
 compile_opt idl2

 npar = N_params()
 if npar LT 1 then begin
   print,'Syntax:  MKHDR, header, [ im, /IMAGE, /EXTEND ]'
   print,'    or   MKHDR, header, [ type, naxisx, /IMAGE, /EXTEND ]'
   print,'   header - output FITS header to be created'
   return
 endif

 if (npar eq 1) then begin               <span class="comments">;Prompt for keyword values</span>
    read,'Enter number of dimensions (NAXIS): ',naxis
    s = lonarr(naxis+2)
    s[0] = naxis
    if ( naxis GT 0 ) then begin       <span class="comments">;Make sure not a dummy header</span>
    for i = 1,naxis do begin       <span class="comments">;Get dimension of each axis</span>
      keyword = 'NAXIS' + strtrim(i,2)
      read,'Enter size of dimension '+ strtrim(i,2) + ' ('+keyword+'): ',nx
      s[i] = nx                            
    endfor
  endif

  print,'Allowed datatypes are (1) Byte, (2) 16 bit integer, (3) 32 bit integer'
  print,'                      (4) 32bit floating, (5) 64 bit double precision' 
  print,'                  or (14) 64bit integer'
  read,'Enter datatype: ',stype
  s[s[0] + 1] = stype

 endif else $
     if ( npar EQ 2 ) then s = size(im) $  <span class="comments">;Image array supplied</span>
          else  s = [ N_elements(naxisx),naxisx, im ] <span class="comments">;Keyword values supplied</span>

 stype = s[s[0]+1]              <span class="comments">;Type of data    </span>
        case stype of
        0:      message,'ERROR: Input data array is undefined'
        1:      bitpix = 8  
        2:      bitpix = 16  
        3:      bitpix = 32  
        4:      bitpix = -32 
        5:      bitpix = -64 
        6:      message,'Complex types not allowed as FITS primary arrays'  
        7:      bitpix = 8
       12:      bitpix = 16
       13:      bitpix = 32
       14:      bitpix = 64
        else:   message,'ERROR: Illegal Image Datatype'
        endcase

 header = strarr(s[0] + 7) + string(' ',format='(a80)')      <span class="comments">;Create empty array</span>
 header[0] = 'END' + string(replicate(32b,77))

 if keyword_set( IMAGE) then $
    sxaddpar, header, 'XTENSION', 'IMAGE   ',' IMAGE extension' $
 else $
    sxaddpar, header, 'SIMPLE', 'T',' Written by IDL:  '+ systime()

 sxaddpar, header, 'BITPIX', bitpix, ' Number of bits per data pixel'
 sxaddpar, header, 'NAXIS', S[0],' Number of data axes'       <span class="comments">;# of dimensions</span>

 if ( s[0] GT 0 ) then begin
   for i = 1, s[0] do sxaddpar,header,'NAXIS' + strtrim(i,2),s[i]
 endif

 if keyword_set( IMAGE) then begin
     sxaddpar, header, 'PCOUNT', 0, ' No Group Parameters'
     sxaddpar, header, 'GCOUNT', 1, ' One Data Group'
 endif else begin
     if keyword_set( EXTEND) or (s[0] EQ 0) then $
          sxaddpar, header, 'EXTEND', 'T', ' FITS data may contain extensions'
     Get_date, dte                       <span class="comments">;Get current date as CCYY-MM-DD</span>
     sxaddpar, header, 'DATE', dte, $
           ' Creation UTC (CCCC-MM-DD) date of FITS header'
  endelse

 if stype EQ 12 then sxaddpar, header,'O_BZERO',32768, $
            ' Original Data is Unsigned Integer'
 if stype EQ 13 then sxaddpar, header,'O_BZERO',2147483648, $
            ' Original Data is Unsigned Long'
 header = header[0:s[0]+7]

 if ~keyword_set(IMAGE) then begin   <span class="comments">;Add FITS definition for primary header</span>
     sxaddpar,header,'COMMENT ', $
      "FITS (Flexible Image Transport System) format is defined in 'Astronomy"
     sxaddpar,header,'COMMENT ', $
      "and Astrophysics', volume 376, page 359; bibcode 2001A&A...376..359H"
 endif 
 end
</code>
    </div>
  </body>
</html>