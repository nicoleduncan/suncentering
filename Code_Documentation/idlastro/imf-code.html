<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:43 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>imf.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="imf.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="imf:source"></a>function imf, mass, expon, mass_range
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       IMF</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Compute an N-component power-law logarithmic initial mass function </span>
<span class="comments">; EXPLANTION:</span>
<span class="comments">;       The function is normalized so that the total mass distribution </span>
<span class="comments">;       equals one solar mass.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       psi = IMF( mass, expon,  mass_range )</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       mass - mass in units of solar masses (scalar or vector)</span>
<span class="comments">;               Converted to floating point if necessary</span>
<span class="comments">;       expon - power law exponent, usually negative, scalar or vector</span>
<span class="comments">;               The number of values in expon equals the number of different</span>
<span class="comments">;               power-law components in the IMF</span>
<span class="comments">;               A Saltpeter IMF has a scalar value of expon = -1.35</span>
<span class="comments">;       mass_range - vector containing the mass upper and lower limits of the </span>
<span class="comments">;               IMF and masses where the IMF exponent changes.   The number </span>
<span class="comments">;               of values in mass_range should be one more than in expon.   </span>
<span class="comments">;               The values in mass_range should be monotonically increasing.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS</span>
<span class="comments">;       psi - mass function, number of stars per unit logarithmic mass interval</span>
<span class="comments">;               evaluated for supplied masses</span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       The mass spectrum f(m) giving the number of stars per unit mass </span>
<span class="comments">;       interval is related to psi(m) by  m*f(m) = psi(m).    The normalization</span>
<span class="comments">;       condition is that the integral of psi(m) between the upper and lower</span>
<span class="comments">;       mass limit is unity.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       (1) Print the number of stars per unit mass interval at 3 Msun </span>
<span class="comments">;               for a Salpeter (expon = -1.35) IMF, with a mass range from </span>
<span class="comments">;               0.1 MSun to 110 Msun.</span>
<span class="comments">;</span>
<span class="comments">;               IDL> print, imf(3, -1.35, [0.1, 110] ) / 3</span>
<span class="comments">;</span>
<span class="comments">;       (2) Lequex et al. (1981, A & A 103, 305) describes an IMF with an</span>
<span class="comments">;               exponent of -0.6 between 0.007 Msun and 1.8 Msun, and an</span>
<span class="comments">;               exponent of -1.7 between 1.8 Msun and 110 Msun.    Plot</span>
<span class="comments">;               the mass spectrum f(m)</span>
<span class="comments">;</span>
<span class="comments">;               IDL> m = [0.01,0.1,indgen(110) + 1 ]  ;Make a mass vector</span>
<span class="comments">;               IDL> expon = [-0.6, -1.7]       ;Exponent Vector</span>
<span class="comments">;               IDL> mass_range = [ 0.007, 1.8, 110]    ;Mass range</span>
<span class="comments">;               IDL> plot,/xlog,/ylog, m, imf(m, expon, mass_range ) / m</span>
<span class="comments">;</span>
<span class="comments">; METHOD</span>
<span class="comments">;       IMF first calculates the constants to multiply the power-law </span>
<span class="comments">;       components such that the IMF is continuous at the intermediate masses, </span>
<span class="comments">;       and that the total mass integral is one solar mass.  The IMF is then </span>
<span class="comments">;       calculated for the supplied masses.   Also see Scalo (1986, Fund. of</span>
<span class="comments">;       Cosmic Physics, 11, 1)</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES CALLED:</span>
<span class="comments">;       None</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written    W. Landsman              August, 1989  </span>
<span class="comments">;       Set masses LE mass_u rather than LT mass_u  August, 1992</span>
<span class="comments">;       Major rewrite to accept arbitrary power-law components   April 1993</span>
<span class="comments">;       Convert EXPON to float if necessary  W. Landsman     March 1996</span>
<span class="comments">;       Remove call to DATATYPE, V5.3 version  W. Landsman  August 2000</span>
<span class="comments">;-</span>
  On_error,2

 if N_params() LT 3 then begin
        print,'Syntax - psi = IMF( mass, expon, mass_range)'
        return,-1
 endif

  Ncomp = N_elements(expon)
  if N_elements( mass_range) NE Ncomp + 1 then message, $
    'ERROR - Mass Range Vector must have ' + strtrim(Ncomp+1,2) + ' components' 

 if ( min(mass_range) LE 0 ) then message, $
        'ERROR - Mass range Vector must be positive definite'

 npts = N_elements(mass)
 if ( npts LT 1 ) then begin
     message, 'Mass vector (first parameter) has not been defined',/CON
     return,0
 endif

 if size(mass,/TNAME) NE 'DOUBLE' then mass = float(mass)     <span class="comments">;Make sure not integer</span>
 if size(expon,/TNAME) NE 'DOUBLE' then expon = float(expon)  

<span class="comments">; Get normalization constants for supplied power-law exponents</span>

 integ = fltarr(ncomp)

<span class="comments">;Compute the unnormalized integral over each power law section</span>

 for i = 0, Ncomp-1 do begin

 if ( expon[i] NE -1 ) then integ[i] =   $
    (mass_range[i+1]^(1+expon[i]) - mass_range[i]^(1+expon[i]))/(1+expon[i]) $

 else integ[i] = alog(mass_range[i+1]/mass_range[i])

 endfor 

<span class="comments">; Insure continuity where the power law functions meet</span>

 joint = fltarr(ncomp)
 joint[0] = 1
 if ncomp GT 1 then for i = 1,ncomp-1 do begin
           joint[i] = joint[i-1]*mass_range[i]^( expon[i-1] - expon[i] )
 endfor

 norm = fltarr(ncomp)
 norm[0] = 1./ total(integ*joint)
 if ncomp GT 1 then for i = 1,ncomp-1 do norm[i] = norm[0]*joint[i]

 f = mass*0.

 for i = 0, Ncomp-1 do begin

 test = where( (mass GT mass_range[i]) and (mass LE mass_range[i+1]), Ntest ) 
 if ( Ntest GT 0 ) then f[test] = norm[i]*mass[test]^(expon[i])

 endfor

 return,f
 end
</code>
    </div>
  </body>
</html>