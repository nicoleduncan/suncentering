<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:09 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>tsum.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="tsum.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">FUNCTION TSUM,X,Y,IMIN,IMAX               <span class="comments">;Trapezoidal summation</span>
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       TSUM</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Trapezoidal summation of the area under a curve. </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Adapted from the procedure INTEG in the IUE procedure library.  </span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       Result = TSUM(y)</span>
<span class="comments">;              or</span>
<span class="comments">;       Result = TSUM( x, y, [ imin, imax ] )  </span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       x = array containing monotonic independent variable.  If omitted, then</span>
<span class="comments">;               x is assumed to contain the index of the y variable.</span>
<span class="comments">;               x = lindgen( N_elements(y) ).</span>
<span class="comments">;       y = array containing dependent variable y = f(x)</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;       imin = scalar index of x array at which to begin the integration</span>
<span class="comments">;               If omitted, then summation starts at x[0].</span>
<span class="comments">;       imax = scalar index of x value at which to end the integration </span>
<span class="comments">;               If omitted then the integration ends at x[npts-1].</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       result = area under the curve y=f(x) between x[imin] and x[imax].</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       IDL> x = [0.0,0.1,0.14,0.3] </span>
<span class="comments">;       IDL> y = sin(x)</span>
<span class="comments">;       IDL> print,tsum(x,y)    ===>  0.0445843</span>
<span class="comments">;       </span>
<span class="comments">;       In this example, the exact curve can be computed analytically as </span>
<span class="comments">;       1.0 - cos(0.3) = 0.0446635     </span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;       The area is determined of individual trapezoids defined by x[i],</span>
<span class="comments">;       x[i+1], y[i] and y[i+1].</span>
<span class="comments">;</span>
<span class="comments">;       If the data is known to be at all smooth, then a more accurate</span>
<span class="comments">;       integration can be found by interpolation prior to the trapezoidal</span>
<span class="comments">;       sums, for example, by the standard IDL User Library int_tabulated.pro.</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       Written, W.B. Landsman, STI Corp. May 1986</span>
<span class="comments">;       Modified so X is not altered in a one parameter call Jan 1990</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Allow non-integer values of imin and imax  W. Landsman April 2001</span>
<span class="comments">;       Fix problem if only 1 parameter supplied W. Landsman June 2002</span>
<span class="comments">;-</span>
<span class="comments">; Set default parameters</span>
 On_error,2
 npar = N_params()
   
 if npar EQ 1 then begin
    npts = N_elements(x)
    yy = x
    xx = lindgen(npts)
    ilo = 0   & imin = ilo
    ihi = npts-1 & imax = ihi
 endif else begin

   if ( npar LT 3 ) then imin = 0
   npts = min( [N_elements(x), N_elements(y)] )
   if ( npar LT 4 ) then imax = npts-1
   ilo = long(imin)
   ihi = long(imax)
   xx = x[ilo:ihi]
   yy = y[ilo:ihi]
   npts = ihi - ilo + 1
 endelse         
<span class="comments">;</span>
<span class="comments">; Compute areas of trapezoids and sum result</span>
<span class="comments">;</span>
  xdif = xx[1:*] - xx
  yavg =  ( yy[0:npts-2] + yy[1:npts-1] ) / 2.  
  sum = total( xdif*yavg ) 

<span class="comments">; Now account for edge effects if IMIN or IMAX parameter are not integers</span>

  hi = imax - ihi
  lo = imin - ilo
  if (ihi LT imax) then sum = sum + (x[ihi+1]-x[ihi])*hi* $
              (y[ihi] + (hi/2.) *(y[ihi+1] - y[ihi]) )
  if (ilo LT imin) then sum = sum - (x[ilo+1]-x[ilo])*lo* $
              (y[ilo] + (lo/2.) *(y[ilo+1] - y[ilo]) )
  return, sum

  end     
</code>
    </div>
  </body>
</html>