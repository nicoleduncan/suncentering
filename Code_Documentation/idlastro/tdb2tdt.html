<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:08 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>tdb2tdt.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="tdb2tdt.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="tdb2tdt-code.html" title="Chromocoded source">Source</a> <a href="tdb2tdt.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">tdb2tdt.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      
      <div id="file_comments">
        <div class="small "><p> NAME:
   TDB2TDT
</p>

<p> AUTHOR:
   Craig B. Markwardt, NASA/GSFC Code 662, Greenbelt, MD 20770
   craigm@lheamail.gsfc.nasa.gov
   UPDATED VERSIONs can be found on my WEB PAGE:
      http://cow.physics.wisc.edu/~craigm/idl/idl.html
</p>

<p> PURPOSE:
   Relativistic clock corrections due to Earth motion in solar system
</p>

<p> MAJOR TOPICS:
   Planetary Orbits
</p>

<p> CALLING SEQUENCE:
   corr = TDB2TDT(JD, TBASE=, DERIV=deriv)
</p>

<p> DESCRIPTION:
</p>

<p>   The function TDB2TDT computes relativistic corrections that must
   be applied when performing high precision absolute timing in the
   solar system.
</p>

<p>   According to general relativity, moving clocks, and clocks at
   different gravitational potentials, will run at different rates
   with respect to each other.  A clock placed on the earth will run
   at a time-variable rate because of the non-constant influence of
   the sun and other planets.  Thus, for the most demanding
   astrophysical timing applications -- high precision pulsar timing
   -- times in the accelerating earth observer's frame must be
   corrected to an inertial frame, such as the solar system
   barycenter (SSB).  This correction is also convenient because the
   coordinate time at the SSB is the ephemeris time of the JPL
   Planetary Ephemeris.
</p>

<p>   In general, the difference in the rate of Ti, the time kept by an
   arbitrary clock, and the rate of T, the ephemeris time, is given
   by the expression (Standish 1998):
</p>

<p>      dTi/dT = 1 - (Ui + vi^2/2) / c^2
</p>

<p>   where Ui is the potential of clock i, and vi is the velocity of
   clock i.  However, when integrated, this expression depends on the
   position of an individual clock.  A more convenient approximate
   expression is:
</p>

<p>     T = Ti + (robs(Ti) . vearth(T))/c^2 + dtgeo(Ti) + TDB2TDT(Ti)
</p>

<p>   where robs is the vector from the geocenter to the observer;
   vearth is the vector velocity of the earth; and dtgeo is a
   correction to convert from the observer's clock to geocentric TT
   time.  TDB2TDT is the value computed by this function, the
   correction to convert from the geocenter to the solar system
   barycenter.
</p>

<p>   As the above equation shows, while this function provides an
   important component of the correction, the user must also be
   responsible for (a) correcting their times to the geocenter (ie,
   by maintaining atomic clock corrections); (b) estimating the
   observatory position vector; and and (c) estimating earth's
   velocity vector (using JPLEPHINTERP).
</p>

<p>   Users may note a circularity to the above equation, since
   vearth(T) is expressed in terms of the SSB coordinate time.  This
   appears to be a chicken and egg problem since in order to get the
   earth's velocity, the ephemeris time is needed to begin with.
   However, to the precision of the above equation, &lt; 25 ns, it is
   acceptable to replace vearth(T) with vearth(TT).
</p>

<p>   The method of computation of TDB2TDT in this function is based on
   the analytical formulation by Fairhead, Bretagnon & Lestrade, 1988
   (so-called FBL model) and Fairhead & Bretagnon 1990, in terms of
   sinusoids of various amplitudes.  TDB2TDT has a dominant periodic
   component of period 1 year and amplitude 1.7 ms.  The set of 791
   coefficients used here were drawn from the Princeton pulsar timing
   program TEMPO version 11.005 (Taylor & Weisberg 1989).
</p>

<p>   Because the TDB2TDT quantity is rather expensive to compute but
   slowly varying, users may wish to also retrieve the time
   derivative using the DERIV keyword, if they have many times to
   convert over a short baseline.
</p>

<p> Verification
</p>

<p>   This implementation has been compared against a set of FBL test
   data found in the 1996 IERS Conventions, Chapter 11, provided by
   T. Fukushima.  It has been verified that this routine reproduces
   the Fukushima numbers to the accuracy of the table, within
   10^{-14} seconds.
</p>

<p>   Fukushima (1995) has found that the 791-term Fairhead & Bretagnon
   analytical approximation use here has a maximum error of 23
   nanoseconds in the time range 1980-2000, compared to a numerical
   integration.  In comparison the truncated 127-term approximation
   has an error of ~130 nanoseconds.
</p>

<p> PARAMETERS:
</p>

<p>   JD - Geocentric time TT, scalar or vector, expressed in Julian
        days.  The actual time used is (JD + TBASE).  For maximum
        precision, TBASE should be used to express a fixed epoch in
        whole day numbers, and JD should express fractional offset
        days from that epoch.
</p>

<p> KEYWORD PARAMETERS:
</p>

<p>   TBASE - scalar Julian day of a fixed epoch, which provides the
           origin for times passed in JD.
          Default: 0
</p>

<p>   DERIV - upon return, contains the derivative of TDB2TDT in units
           of seconds per day.  As many derivatives are returned as
           values passed in JD.
</p>

<p> RETURNS:
   The correction offset(s) in units of seconds, to be applied as
   noted above.
</p>

<p> EXAMPLE:
</p>

<p>   Find the correction at ephemeris time 2451544.5 (JD):
     IDL&gt; print, tdb2tdt(2451544.5d)
       -0.00011376314
   or 0.11 ms.
</p>

<p> REFERENCES:
</p>

<p>   Princeton TEMPO Program
      http://pulsar.princeton.edu/tempo/
</p>

<p>   FBL Test Data Set
      ftp://maia.usno.navy.mil/conventions/chapter11/fbl.results
</p>

<p>   Fairhead, L. & Bretagnon, P. 1990, A&A, 229, 240
     (basis of this routine)
</p>

<p>   Fairhead, L. Bretagnon, P. & Lestrade, J.-F. 1988, in *The Earth's
     Rotation and Reference Frames for Geodesy and Geodynamics*,
     ed. A. K. Babcock and G. A. Wilkins, (Dordrecht: Kluwer), p. 419
     (original "FBL" paper)
</p>

<p>   Fukushima, T. 1995, A&A, 294, 895  (error analysis)
</p>

<p>   Irwin, A. W. & Fukushima, T. 1999, A&A, 348, 642  (error analysis)
</p>

<p>   Standish, E. M. 1998, A&A, 336, 381 (description of time scales)
</p>

<p>   Taylor, J. H. & Weisberg, J. M. 1989, ApJ, 345, 434 (pulsar timing)
</p>

<p> SEE ALSO
   JPLEPHREAD, JPLEPHINTERP, JPLEPHTEST
</p>

<p> MODIFICATION HISTORY:
   Original logic from Fairhead & Bretagnon, 1990
   Drawn from TEMPO v. 11.005, copied 20 Jun 2001
   Documented and vectorized, 30 Jun 2001
</p>

<p>  $Id: tdb2tdt.pro,v 1.4 2001/07/01 07:37:40 craigm Exp $
</p>

<p></p>

</div>
      </div>
      

      

      

      

      

      
      <div>
        <h2>Routines</h2>

        <dl class="routine-summary">
          
            <dt class="syntax"><a href="#tdb2tdt_calc"><code><span class="var">result</span> = tdb2tdt_calc(<span class="argument">jd</span><span class="argument">, deriv=<span class="var">deriv</span></span><span class="argument">, tbase=<span class="var">tbase</span></span>)</code></a></dt>
            <dd class="small"></dd>
          
            <dt class="syntax"><a href="#tdb2tdt"><code><span class="var">result</span> = tdb2tdt(<span class="argument">jd</span><span class="argument">, deriv=<span class="var">deriv</span></span><span class="argument">, tbase=<span class="var">tbase</span></span>)</code></a></dt>
            <dd class="small"></dd>
          
        </dl>
      </div>
      


      
      <div id="routine-details">
        <h2>Routine details</h2>

        
        <div class="routine-details details" id="tdb2tdt_calc">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="tdb2tdt-code.html#tdb2tdt_calc:source" class="top">source</a> tdb2tdt_calc<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = tdb2tdt_calc(<span class="argument"><a href="#tdb2tdt_calc:p:jd">jd</a></span><span class="argument">, <a href="#tdb2tdt_calc:k:deriv">deriv</a>=<span class="var">deriv</span></span><span class="argument">, <a href="#tdb2tdt_calc:k:tbase">tbase</a>=<span class="var">tbase</span></span>)</code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="tdb2tdt_calc:p:jd">jd <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="tdb2tdt_calc:k:deriv">deriv <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="tdb2tdt_calc:k:tbase">tbase <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        
        <div class="routine-details details" id="tdb2tdt">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="tdb2tdt-code.html#tdb2tdt:source" class="top">source</a> tdb2tdt<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = tdb2tdt(<span class="argument"><a href="#tdb2tdt:p:jd">jd</a></span><span class="argument">, <a href="#tdb2tdt:k:deriv">deriv</a>=<span class="var">deriv</span></span><span class="argument">, <a href="#tdb2tdt:k:tbase">tbase</a>=<span class="var">tbase</span></span>)</code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="tdb2tdt:p:jd">jd <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="tdb2tdt:k:deriv">deriv <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="tdb2tdt:k:tbase">tbase <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:49 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>1,071</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:58:08 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>