<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:39 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>get_date.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="get_date.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="get_date:source"></a>pro get_date, dte, in_date, OLD = old, TIMETAG = timetag
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       GET_DATE</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Return the (current) UTC date in CCYY-MM-DD format for FITS headers</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       This is the format required by the DATE and DATE-OBS keywords in a </span>
<span class="comments">;       FITS header.  </span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       GET_DATE, FITS_date, [ in_date, /OLD, /TIMETAG ]</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;       in_date - string (scalar or vector) containing dates in IDL</span>
<span class="comments">;            systime() format (e.g. 'Tue Sep 25 14:56:14 2001')</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       FITS_date = A scalar character string giving the current date.    Actual</span>
<span class="comments">;               appearance of dte depends on which keywords are supplied.</span>
<span class="comments">;       </span>
<span class="comments">;       No Keywords supplied - dte is a 10 character string with the format</span>
<span class="comments">;               CCYY-MM-DD where &lt;CCYY> represents a calendar year, &lt;MM> the</span>
<span class="comments">;               ordinal number of a calendar month within the calendar year, </span>
<span class="comments">;               and &lt;DD> the ordinal number of a day within the calendar month.</span>
<span class="comments">;       /TIMETAG set - dte is a 19 character string with the format</span>
<span class="comments">;               CCYY-MM-DDThh:mm:ss where &lt;hh> represents the hour in the day,</span>
<span class="comments">;                &lt;mm> the minutes, &lt;ss> the seconds, and the literal 'T' the </span>
<span class="comments">;               ISO 8601 time designator</span>
<span class="comments">;       /OLD set - dte is an 8 character string in DD/MM/YY format</span>
<span class="comments">;</span>
<span class="comments">; INPUT KEYWORDS:</span>
<span class="comments">;       /TIMETAG - Specify the time to the nearest second in the DATE format</span>
<span class="comments">;       /OLD - Return the DATE format formerly (pre-1997) recommended for FITS</span>
<span class="comments">;               Note that this format is now deprecated because it uses only</span>
<span class="comments">;               a 2 digit representation of the year. </span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Add the current date to the DATE keyword in a FITS header,h</span>
<span class="comments">;     </span>
<span class="comments">;       IDL> GET_DATE,dte</span>
<span class="comments">;       IDL> sxaddpar, h, 'DATE', dte, 'Date header was created'</span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       (1) A discussion of the DATExxx syntax in FITS headers can be found in</span>
<span class="comments">;       http://www.cv.nrao.edu/fits/documents/standards/year2000.txt</span>
<span class="comments">;</span>
<span class="comments">;       (2) Those who wish to use need further flexibility in their date </span>
<span class="comments">;       formats (e.g. to use TAI time) should look at Bill Thompson's time</span>
<span class="comments">;       routines in http://sohowww.nascom.nasa.gov/solarsoft/gen/idl/time</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       DAYCNV - Convert Julian date to Gregorian calendar date</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written      W. Landsman          March 1991</span>
<span class="comments">;       Major rewrite to write new DATExxx syntax  W. Landsman  August 1997</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Work after year 2000 even with /OLD keyword W. Landsman January 2000</span>
<span class="comments">;       Don't need to worry about TIME_DIFF since V5.4 W. Landsman July 2001</span>
<span class="comments">;       Assume since V5.4, remove LOCAL_DIFF keyword  W. Landsman April 2006</span>
<span class="comments">;-</span>
 On_error,2
 compile_opt idl2
 
 if N_params() LT 1 then begin
     print,'Syntax - Get_date, FITS_date, [ in_date, /TIMETAG, /OLD ]'
     print,'  FITS_date - output string giving date(s) in FITS format'
     print,'  in-date - Optional input string giving date in systime() format'
     return
 endif

 if N_elements(in_date) GT 0 then begin
     mn = strmid(in_date,4,3)
     month = month_cnv(mn)
     day = fix(strmid(in_date,8,2))
     ihr = fix(strmid(in_date,11,2))
     imn = fix(strmid(in_date,14,2))
     sec = fix(strmid(in_date,17,2))
     yr = fix(strmid(in_date,20,4))
 endif else begin
     seconds = systime(1)          <span class="comments">;Number of seconds since Jan 1, 1970</span>
     dayseconds = 86400.D0               <span class="comments">;Number of seconds in a day</span>
     mjd = seconds/dayseconds + 40587.0D
     jd =  2400000.5D + mjd
     DAYCNV, jd, yr, month, day, hr
 endelse 

 if keyword_set(old) then begin

 if yr GE 2000 then yr = yr - 100
 dte =  string(day,f='(I2.2)') + '/' + string(month,f='(i2.2)') +  $
        '/' + string( yr-1900,f='(I2.2)')                          

 endif else $ 

 dte =  string(yr,f='(I4.4)') + '-' + string(month,f='(i2.2)') + '-' + $
        string(day,f='(I2.2)')

 if keyword_set(TIMETAG) then begin
 if N_elements(in_date) EQ 0 then begin
   ihr = fix(hr)
   mn = (hr - ihr)*60.
   imn = fix(mn)
   sec = round((mn - imn)*60.)
 endif 

 dte =  dte + 'T' + string(ihr,f='(I2.2)') + ':' + string(imn,f='(I2.2)') +  $
               ':' + string(round(sec),f='(I2.2)')
 endif
         
 return
 end
</code>
    </div>
  </body>
</html>