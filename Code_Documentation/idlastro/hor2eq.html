<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:41 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>hor2eq.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="hor2eq.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="hor2eq-code.html" title="Chromocoded source">Source</a> <a href="hor2eq.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">hor2eq.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      
      <div id="file_comments">
        <div class="small "><p> NAME:
   HOR2EQ
</p>

<p> PURPOSE:
    Converts local horizon coords (alt-az) of something to equatorial (ra-dec).
</p>

<p> EXPLANATION:
     This is a nice code to calculate equatorial (ra,dec) coordinates from
     horizon (alt,az) coords.    It is typically accurate to about 1 arcsecond
     or better (I have checked the output against the publicly available XEPHEM
     software). It performs precession, nutation, aberration, and refraction
     corrections.  The perhaps best thing about it is that it can take arrays
     as inputs, in all variables and keywords EXCEPT Lat, lon, and Altitude
    (the code assumes these aren't changing), and uses vector arithmetic in
     every calculation except when calculating the precession matrices.
</p>

<p> CALLING SEQUENCE:
</p>

<p>    HOR2EQ, alt, az, jd, ra, dec, [ha, LAT= , LON= , /WS, OBSNAME= , $
                       /B1950 , PRECESS_= 0, NUTATE_= 0, REFRACT_= 0, $
                       ABERRATION_= 0, ALTITUDE= , /VERBOSE, _EXTRA= ]
</p>

<p> INPUT VARIABLES
       alt  : altitude (in degrees) [scalar or vector]
       az   : azimuth angle (in degrees, measured EAST from NORTH, but see
              keyword WS below.) [scalar or vector]
       JD   : Julian Date [scalar or vector], double precision
       Note: if RA and DEC are arrays, then alt and az will also be arrays.
             If RA and DEC are arrays, JD may be a scalar OR an array of
              the same dimensionality.
</p>

<p> OPTIONAL INPUT KEYWORDS:
       lat   : north geodetic latitude of location in degrees
       lon   : EAST longitude of location in degrees
               (Specify west longitude with a negative sign.)
       /WS   : Set this to get the azimuth measured westward from south
               (not East of North).
       obsname   : Set this to a valid observatory name to be used by the
               astrolib OBSERVATORY procedure, which will return the latitude
               and longitude to be used by this program.
       /B1950  : Set this if your ra and dec are specified in B1950,
               FK4 coordinates (instead of J2000, FK5)
       precess_ : Set this to 1 to force precession [default], 0 for no
                 precession.
       nutate_  : Set this to 1 to force nutation [default], 0 for no nutation.
       aberration_ : Set this to 1 to force aberration correction [default],
                 0 for no correction.
       refract_  : Set to 1 to force refraction correction [default], 0 for
                   no correction.
       altitude: The altitude of the observing location, in meters. [default=0].
       /verbose: Set this for verbose output.  The default is verbose=0.
   _extra: This is for setting TEMPERATURE or PRESSURE explicitly, which are
           used by CO_REFRACT to calculate the refraction effect of the
           atmosphere. If you don't set these, the program will make an
           intelligent guess as to what they are (taking into account your
            altitude).  See CO_REFRACT for more details.
</p>

<p> OUTPUT VARIABLES
       ra   : Right Ascension of object  (J2000) in degrees (FK5); scalar or
              vector.
       dec  : Declination of object (J2000) in degrees (FK5), scalar or vector.
       ha   : hour angle (in degrees) (optional)
</p>

<p> DEPENDENCIES:
       NUTATE, PRECESS, ADSTRING(), SUNPOS, OBSERVATORY (from the astrolib)
       CO_NUTATE, CO_ABERRATION, CO_REFRACT, HADEC2ALTAZ
</p>

<p> BASIC STEPS
   Precess Ra-Dec to current equinox.
   Nutation Correction to Ra-Dec
   Aberration correction to Ra-Dec
   Calculate Local Mean Sidereal Time
   Calculate Local Apparent Sidereal Time
   Calculate Hour Angle
   Do Spherical Trig to find Apparent Alt-Az
   Apply refraction correction to find observed Alt.
</p>

<p>CORRECTIONS I DO NOT MAKE:
   *  Deflection of Light by the sun due to GR. (typically milliarcseconds,
        can be arcseconds within one degree of the sun)
   *  The Effect of Annual Parallax (typically &lt; 1 arcsecond)
   *  and more (see below)
</p>

<p> TO DO
    * Better Refraction Correction.  Need to put in wavelength dependence,
       and integrate through the atmosphere.
    * Topocentric Parallax Correction (will take into account elevation of
          the observatory)
    * Proper Motion (but this will require crazy lookup tables or something).
    * Difference between UTC and UT1 in determining LAST -- is this important?
    * Effect of Annual Parallax (is this the same as topocentric Parallax?)
    * Polar Motion
    * Better connection to Julian Date Calculator.
</p>

<p> EXAMPLE:
</p>

<p>   You are at Kitt Peak National Observatory, looking at a star at azimuth
   angle 264d 55m 06s and elevation 37d 54m 41s (in the visible).  Today is
   Dec 25, 2041 and the local time is 10 PM precisely.  What is the ra and dec
   (J2000) of the star you're looking at?   The temperature here is about 0
   Celsius, and the pressure is 781 millibars.    The Julian date for this
   time is 2466879.7083333
</p>

<p>  IDL&gt; hor2eq, ten(37,54,41), ten(264,55,06), 2466879.7083333d, ra, dec, $
           /verb, obs='kpno', pres=781.0, temp=273.0
</p>

<p> The program produces this output (because the VERBOSE keyword was set):
</p>

<p> Latitude = +31 57 48.0   Longitude = *** 36  0.0   ; longitude prints weirdly b/c of negative input to ADSTRING!!
 Julian Date =  2466879.708333
 Az, El =  17 39 40.4  +37 54 41.0   (Observer Coords)
 Az, El =  17 39 40.4  +37 53 39.6   (Apparent Coords)
 LMST = +03 53 54.1
 LAST = +03 53 53.6
 Hour Angle = +03 38 30.1  (hh:mm:ss)
 Ra, Dec:  00 15 23.5  +15 25  1.9   (Apparent Coords)
 Ra, Dec:  00 15 24.2  +15 25  0.1   (J2041.9841)
 Ra, Dec:  00 13 14.1  +15 11  0.3   (J2000)
</p>

<p> The star is therefore Algenib!  Compare the derived Ra, Dec with what XEPHEM
 got:
 Ra, Dec:      00 13 14.2  +15 11  1.0   (J2000)
</p>

<p> AUTHOR:
   Chris O'Dell
       Univ. of Wisconsin-Madison
   Observational Cosmology Laboratory
   Email: odell@cmb.physics.wisc.edu
 REVISION HISTORY:
     Made all integers type LONG  W. Landsman   September 2007
     Fixed for case of scalar Julian date but vector positions W L June 2009
</p>

</div>
      </div>
      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="hor2eq">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="hor2eq-code.html#hor2eq:source" class="top">source</a> hor2eq<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>hor2eq<span class="argument">, <a href="#hor2eq:p:alt">alt</a></span><span class="argument">, <a href="#hor2eq:p:az">az</a></span><span class="argument">, <a href="#hor2eq:p:jd">jd</a></span><span class="argument">, <a href="#hor2eq:p:ra">ra</a></span><span class="argument">, <a href="#hor2eq:p:dec">dec</a></span><span class="argument">, <a href="#hor2eq:p:ha">ha</a></span><span class="argument">, <a href="#hor2eq:k:lat">lat</a>=<span class="var">lat</span></span><span class="argument">, <a href="#hor2eq:k:lon">lon</a>=<span class="var">lon</span></span><span class="argument">, <a href="#hor2eq:k:WS">WS</a>=<span class="var">WS</span></span><span class="argument">, <a href="#hor2eq:k:obsname">obsname</a>=<span class="var">obsname</span></span><span class="argument">, <a href="#hor2eq:k:B1950">B1950</a>=<span class="var">B1950</span></span><span class="argument">, <a href="#hor2eq:k:verbose">verbose</a>=<span class="var">verbose</span></span><span class="argument">, <a href="#hor2eq:k:precess_">precess_</a>=<span class="var">precess_</span></span><span class="argument">, <a href="#hor2eq:k:nutate_">nutate_</a>=<span class="var">nutate_</span></span><span class="argument">, <a href="#hor2eq:k:refract_">refract_</a>=<span class="var">refract_</span></span><span class="argument">, <a href="#hor2eq:k:aberration_">aberration_</a>=<span class="var">aberration_</span></span><span class="argument">, <a href="#hor2eq:k:altitude">altitude</a>=<span class="var">altitude</span></span><span class="argument">, <a href="#hor2eq:k:_extra">_extra</a>=<span class="var">_extra</span></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="hor2eq:p:alt">alt <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:p:az">az <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:p:jd">jd <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:p:ra">ra <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:p:dec">dec <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:p:ha">ha <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="hor2eq:k:lat">lat <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:lon">lon <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:WS">WS <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:obsname">obsname <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:B1950">B1950 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:verbose">verbose <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:precess_">precess_ <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:nutate_">nutate_ <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:refract_">refract_ <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:aberration_">aberration_ <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:altitude">altitude <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="hor2eq:k:_extra">_extra <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:49 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>256</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:41 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>