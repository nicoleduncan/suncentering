<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:41 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>helio_jd.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="helio_jd.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="helio_jd:source"></a>function helio_jd,date,ra,dec, B1950 = B1950, TIME_DIFF = time_diff
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;      HELIO_JD</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;      Convert geocentric (reduced) Julian date to heliocentric Julian date</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;      This procedure correct for the extra light travel time between the Earth </span>
<span class="comments">;      and the Sun.</span>
<span class="comments">;</span>
<span class="comments">;       An online calculator for this quantity is available at </span>
<span class="comments">;       http://www.physics.sfasu.edu/astro/javascript/hjd.html</span>
<span class="comments">;</span>
<span class="comments">;       Users requiring more precise calculations and documentation should </span>
<span class="comments">;       look at the IDL code available at </span>
<span class="comments">;       http://astroutils.astronomy.ohio-state.edu/time/</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       jdhelio = HELIO_JD( date, ra, dec, /B1950, /TIME_DIFF)</span>
<span class="comments">;</span>
<span class="comments">; INPUTS</span>
<span class="comments">;       date - reduced Julian date (= JD - 2400000), scalar or vector, MUST</span>
<span class="comments">;               be double precision</span>
<span class="comments">;       ra,dec - scalars giving right ascension and declination in DEGREES</span>
<span class="comments">;               Equinox is J2000 unless the /B1950 keyword is set</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       jdhelio - heliocentric reduced Julian date.  If /TIME_DIFF is set, then</span>
<span class="comments">;                 HELIO_JD() instead returns the time difference in seconds</span>
<span class="comments">;                 between the geocentric and heliocentric Julian date.</span>
<span class="comments">;                 </span>
<span class="comments">; OPTIONAL INPUT KEYWORDS </span>
<span class="comments">;       /B1950 - if set, then input coordinates are assumed to be in equinox </span>
<span class="comments">;                B1950 coordinates.</span>
<span class="comments">;       /TIME_DIFF - if set, then HELIO_JD() returns the time difference</span>
<span class="comments">;                (heliocentric JD - geocentric JD ) in seconds </span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       What is the heliocentric Julian date of an observation of V402 Cygni</span>
<span class="comments">;       (J2000: RA = 20 9 7.8, Dec = 37 09 07) taken June 15, 1973 at 11:40 UT?</span>
<span class="comments">;</span>
<span class="comments">;       IDL> juldate, [1973,6,15,11,40], jd      ;Get geocentric Julian date</span>
<span class="comments">;       IDL> hjd = helio_jd( jd, ten(20,9,7.8)*15., ten(37,9,7) )  </span>
<span class="comments">;                                                            </span>
<span class="comments">;       ==> hjd = 41848.9881</span>
<span class="comments">;</span>
<span class="comments">; Wayne Warren (Raytheon ITSS) has compared the results of HELIO_JD with the</span>
<span class="comments">; FORTRAN subroutines in the STARLINK SLALIB library (see </span>
<span class="comments">; http://star-www.rl.ac.uk/).    </span>
<span class="comments">;                                                  Time Diff (sec)</span>
<span class="comments">;      Date               RA(2000)   Dec(2000)  STARLINK      IDL</span>
<span class="comments">;</span>
<span class="comments">; 1999-10-29T00:00:00.0  21 08 25.  -67 22 00.  -59.0        -59.0</span>
<span class="comments">; 1999-10-29T00:00:00.0  02 56 33.4 +00 26 55.  474.1        474.1</span>
<span class="comments">; 1940-12-11T06:55:00.0  07 34 41.9 -00 30 42.  366.3        370.2</span>
<span class="comments">; 1992-02-29T03:15:56.2  12 56 27.4 +42 10 17.  350.8        350.9</span>
<span class="comments">; 2000-03-01T10:26:31.8  14 28 36.7 -20 42 11.  243.7        243.7</span>
<span class="comments">; 2100-02-26T09:18:24.2  08 26 51.7 +85 47 28.  104.0        108.8</span>
<span class="comments">; PROCEDURES CALLED:</span>
<span class="comments">;       bprecess, xyz, zparcheck</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Algorithm from the book Astronomical Photometry by Henden, p. 114</span>
<span class="comments">;       Written,   W. Landsman       STX     June, 1989 </span>
<span class="comments">;       Make J2000 default equinox, add B1950, /TIME_DIFF keywords, compute</span>
<span class="comments">;       variation of the obliquity      W. Landsman   November 1999</span>
<span class="comments">;-</span>
 On_error,2
 If N_params() LT 3 then begin
    print,'Syntax -   jdhelio = HELIO_JD( date, ra, dec, /B1950, /TIME_DIFF)'
    print,'      date - reduced Julian date (= JD - 2400000)'
    print,'      Ra and Dec must be in degrees'
 endif

<span class="comments">;Because XYZ uses default B1950 coordinates, we'll convert everything to B1950</span>

 if not keyword_set(B1950) then bprecess,ra,dec,ra1,dec1 else begin
        ra1 = ra
        dec1 = dec
 endelse
 
 radeg = 180.0d/!DPI   
 zparcheck,'HELIO_JD',date,1,[3,4,5],[0,1],'Reduced Julian Date'

 delta_t = (double(date) - 33282.42345905d)/36525.0d
 epsilon_sec = poly( delta_t, [44.836d, -46.8495, -0.00429, 0.00181])
 epsilon = (23.433333d0 + epsilon_sec/3600.0d)/radeg
 ra1 = ra1/radeg
 dec1 = dec1/radeg

 xyz, date, x, y, z

<span class="comments">;Find extra distance light must travel in AU, multiply by 1.49598e13 cm/AU,</span>
<span class="comments">;and divide by the speed of light, and multiply by 86400 second/year</span>

 time = -499.00522d*( cos(dec1)*cos(ra1)*x + $
                 (tan(epsilon)*sin(dec1) + cos(dec1)*sin(ra1))*y)

 if keyword_set(TIME_DIFF) then return, time else $
           
       return, double(date) + time/86400.0d

 end
</code>
    </div>
  </body>
</html>