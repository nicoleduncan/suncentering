<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:22 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>cosmo_param.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="cosmo_param.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="cosmo_param:source"></a>pro cosmo_param,Omega_m, Omega_Lambda, Omega_k, q0
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;     COSMO_PARAM</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     Derive full set of cosmological density parameters from a partial set</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;     This procedure is called by LUMDIST and GALAGE to allow the user a choice</span>
<span class="comments">;     in defining any two of four cosmological density parameters.</span>
<span class="comments">;</span>
<span class="comments">;     Given any two of the four input parameters -- (1) the normalized matter </span>
<span class="comments">;     density Omega_m (2) the normalized cosmological constant, Omega_lambda </span>
<span class="comments">;     (3) the normalized curvature term, Omega_k and (4) the deceleration </span>
<span class="comments">;     parameter q0 --  this  program will derive the remaining two.     Here </span>
<span class="comments">;     "normalized" means divided by the closure density so that </span>
<span class="comments">;     Omega_m + Omega_lambda + Omega_k = 1.    For a more</span>
<span class="comments">;     precise definition see Carroll, Press, & Turner (1992, ArAA, 30, 499).     </span>
<span class="comments">;</span>
<span class="comments">;     If less than two parameters are defined, this procedure sets default </span>
<span class="comments">;     values of Omega_k=0 (flat space), Omega_lambda = 0.7, Omega_m = 0.3</span>
<span class="comments">;     and q0 = -0.55</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       COSMO_PARAM, Omega_m, Omega_lambda, Omega_k, q0</span>
<span class="comments">;</span>
<span class="comments">; INPUT-OUTPUTS:</span>
<span class="comments">;     Omega_M - normalized matter energy density, non-negative numeric scalar</span>
<span class="comments">;     Omega_Lambda - Normalized cosmological constant, numeric scalar</span>
<span class="comments">;     Omega_k - normalized curvature parameter, numeric scalar.   This is zero</span>
<span class="comments">;               for a flat universe</span>
<span class="comments">;     q0 - Deceleration parameter, numeric scalar = -R*(R'')/(R')^2</span>
<span class="comments">;          = 0.5*Omega_m - Omega_lambda</span>
<span class="comments">; NOTES:</span>
<span class="comments">;     If more than two parameters are defined upon input (overspecification), </span>
<span class="comments">;     then the first two defined parameters in the ordered list Omega_m, </span>
<span class="comments">;     Omega_lambda, Omega_k, q0 are used to define the cosmology.</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;     Suppose one has Omega_m = 0.3, and Omega_k = 0.5 then to determine</span>
<span class="comments">;     Omega_lambda and q0</span>
<span class="comments">;    </span>
<span class="comments">;       IDL> cosmo_param, 0.3, omega_lambda, 0.5, q0</span>
<span class="comments">;   </span>
<span class="comments">;       which will return omega_lambda = 0.2 and q0 = -2.45</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       W. Landsman         Raytheon ITSS         April 2000</span>
<span class="comments">;       Better Error checking  W. Landsman/D. Syphers   October 2010</span>
<span class="comments">;-</span>

 On_error,2
 compile_opt idl2
 
 if N_params() LT 3 then begin
      print,'Syntax - COSMO_PARAM, Omega_m, Omega_lambda, Omega_k, q0'
      return
 endif
 
 Nk = n_elements(Omega_k) &lt<span class="comments">; 1</span>
 NLambda = N_elements(Omega_lambda) &lt<span class="comments">; 1</span>
 Nomega = N_elements(Omega_m) &lt<span class="comments">; 1</span>
 Nq0 = N_elements(q0) &lt<span class="comments">; 1</span>

<span class="comments">; Use must specify 0 or 2 parameters</span>

 if total(Nk + Nlambda + Nomega + Nq0,/int) EQ 1 then $
     message,'ERROR - At least 2 cosmological parameters must be specified'
     
<span class="comments">; Check which two parameters are defined, and then determine the other two</span>

 if (Nomega and Nlambda) then begin 
       if Nk EQ 0 then Omega_k = 1 - omega_m - Omega_lambda 
       if Nq0 EQ 0 then q0 = omega_m/2. - Omega_lambda
 endif else $

 if (Nomega and Nk) then begin 
        if Nlambda EQ 0 then Omega_lambda = 1. -omega_m - Omega_k
        if Nq0 EQ 0 then q0 = -1 + Omega_k + 3*Omega_m/2
 endif else $

 if (Nlambda and Nk) then begin 
         if Nomega EQ 0 then omega_m = 1.-Omega_lambda - Omega_k
         if Nq0 EQ 0 then q0 = (1 - Omega_k - 3.*Omega_lambda)/2.
 endif else $

 if (Nomega and Nq0) then begin
         if Nk EQ 0 then Omega_k = 1 + q0 - 3*omega_m/2. 
         if Nlambda EQ 0 then Omega_lambda  = 1. - omega_m - Omega_k
 endif else $

 if (Nlambda and Nq0) then begin
         if Nk EQ 0 then Omega_k = 1 - 2*q0 - 3*Omega_lambda
         if Nomega EQ 0 then omega_m = 1.-Omega_lambda - Omega_k
 endif else $

 if (Nk and Nq0) then begin
         if Nomega EQ 0 then omega_m = (1 + q0 - Omega_k)*2/3.
         if Nlambda EQ 0 then Omega_lambda = 1. - omega_m - Omega_k
 endif

<span class="comments">;Set default values</span>

 if N_elements(Omega_k) EQ 0 then Omega_k = 0       <span class="comments">;Default is flat space</span>
 if N_elements(Omega_lambda) EQ 0 then Omega_lambda = 0.7
 if N_elements(omega_m) EQ 0 then omega_m = 1 - Omega_lambda
 if N_elements(q0) EQ 0 then q0 = (1 - Omega_k - 3*Omega_lambda)/2.

 return
 end
</code>
    </div>
  </body>
</html>