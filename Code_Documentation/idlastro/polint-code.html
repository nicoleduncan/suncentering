<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:56 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>polint.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="polint.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="polint:source"></a>pro polint, xa, ya, x, y, dy
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;     POLINT</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     Interpolate a set of N points by fitting a polynomial of degree N-1</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;     Adapted from algorithm in Numerical Recipes, Press et al. (1992), </span>
<span class="comments">;     Section 3.1.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE</span>
<span class="comments">;     POLINT, xa, ya, x, y, [ dy ]</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;     XA - X Numeric vector, all values must be distinct.   The number of</span>
<span class="comments">;          values in XA should rarely exceed 10 (i.e. a 9th order polynomial)</span>
<span class="comments">;     YA - Y Numeric vector, same number of elements</span>
<span class="comments">;     X - Numeric scalar specifying value to be interpolated </span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;     Y - Scalar, interpolated value in (XA,YA) corresponding to X</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL OUTPUT</span>
<span class="comments">;     DY - Error estimate on Y, scalar</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;     Find sin(2.5) by polynomial interpolation on sin(indgen(10))</span>
<span class="comments">;</span>
<span class="comments">;               IDL> xa = indgen(10)</span>
<span class="comments">;               IDL> ya = sin( xa )</span>
<span class="comments">;               IDL> polint, xa, ya, 2.5, y ,dy</span>
<span class="comments">;             </span>
<span class="comments">;     The above method gives  y = .5988 & dy = 3.1e-4  a close</span>
<span class="comments">;     approximation to the actual sin(2.5) = .5985</span>
<span class="comments">;</span>
<span class="comments">; METHOD:</span>
<span class="comments">;     Uses Neville's algorithm to iteratively build up the correct</span>
<span class="comments">;     polynomial, with each iteration containing one higher order.</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;     Written W. Landsman                 January, 1992</span>
<span class="comments">;     Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>
 On_error,2

 if N_params() LT 4 then begin
     print,'Syntax - polint, xa, ya, x, y, [ dy ]'
     print,'     xa,ya - Input vectors to be interpolated'
     print,'     x - Scalar specifying point at which to interpolate'
     print,'     y - Output interpolated scalar value'
     print,'     dy - Optional error estimate on y'
     return
 endif

 N = N_elements( xa ) 
 if N_elements( ya ) NE N then message, $
      'ERROR - Input X and Y vectors must have same number of elements'

<span class="comments">; Find the index of XA which is closest to X</span>

 dif = min( abs(x-xa), ns )

 c = ya   &   d = ya
 y = ya[ns]
 ns = ns - 1

 for m = 1,n-1 do begin

    ho = xa[0:n-m-1] - x
    hp = xa[m:n-1] - x
    w = c[1:n-m] - d[0:n-m-1]
    den = ho - hp
    if min( abs(den) ) EQ 0 then message, $
           'ERROR - All input X vector values must be distinct'
    den = w / den
    d = hp * den
    c = ho * den
    if ( 2*ns LT n-m-1 ) then dy = c[ns+1] else begin
                  dy = d[ns]
                  ns = ns - 1
    endelse
    y = y + dy
 endfor

 return
 end
</code>
    </div>
  </body>
</html>