<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:31 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>flegendre.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="flegendre.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="flegendre:source"></a>function flegendre,x,m
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;        FLEGENDRE</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Compute the first M terms in a Legendre polynomial expansion.  </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Meant to be used as a supplied function to SVDFIT.</span>
<span class="comments">;</span>
<span class="comments">;       This procedure became partially obsolete in IDL V5.0 with the </span>
<span class="comments">;       introduction of the /LEGENDRE keyword to SVDFIT and the associated </span>
<span class="comments">;       SVDLEG function.    However, note that, unlike SVDLEG, FLEGENDRE works</span>
<span class="comments">;       on vector values of X.     </span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       result = FLEGENDRE( X, M)</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       X - the value of the independent variable, scalar or vector</span>
<span class="comments">;       M - number of term of the Legendre expansion to compute, integer scalar </span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       result - (N,M) array, where N is the number of elements in X and M</span>
<span class="comments">;               is the order.   Contains the value of each Legendre term for</span>
<span class="comments">;               each value of X</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       (1) If x = 2.88 and M = 3 then </span>
<span class="comments">;       IDL> print, flegendre(x,3)   ==>   [1.00, 2.88, 11.9416]</span>
<span class="comments">;</span>
<span class="comments">;       This result can be checked by explicitly computing the first 3 Legendre</span>
<span class="comments">;       terms, 1.0, x, 0.5*( 3*x^2 -1)</span>
<span class="comments">;</span>
<span class="comments">;       (2) Find the coefficients to an M term Legendre polynomial that gives</span>
<span class="comments">;               the best least-squares fit to a dataset (x,y)</span>
<span class="comments">;               IDL> coeff = SVDFIT( x,y,M,func='flegendre')</span>
<span class="comments">;       </span>
<span class="comments">;           The coefficients can then be supplied to the function POLYLEG to </span>
<span class="comments">;               compute the best YFIT values for any X. </span>
<span class="comments">; METHOD:</span>
<span class="comments">;       The recurrence relation for the Legendre polynomials is used to compute</span>
<span class="comments">;       each term.   Compare with the function FLEG in "Numerical Recipes"</span>
<span class="comments">;       by Press et al. (1992), p. 674</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written     Wayne Landsman    Hughes STX      April 1995                </span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-      </span>
 On_Error,2

 if N_params() LT 2 then begin
        print,'Syntax - result = FLEGENDRE( x, m)'
        return,0
 endif  

 if m LT 1 then message, $
        'ERROR - Order of Legendre polynomial must be at least 1'
 N = N_elements(x)
 size_x = size(x)
 leg = make_array(n, m, type = size_x[size_x[0]+1] > 4)    
 
 leg[0,0] = replicate( 1., n)
 if m GE 2 then leg[0,1] = x
 if m GE 3 then begin
        twox = 2.*x
        f2 = x
        d = 1.
        for j=2,m-1 do begin
                f1 = d
                f2 = f2 + 2.*x
                d = d+1.
                leg[0,j] = ( f2*leg[*,j-1] - f1*leg[*,j-2] )/d
        endfor
 endif
 return, leg
 end
</code>
    </div>
  </body>
</html>