<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:20 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>calz_unred.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="calz_unred.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="calz_unred:source"></a>pro calz_unred, wave, flux, ebv, funred, R_V = R_V
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;     CALZ_UNRED</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     Deredden a galaxy spectrum using the Calzetti et al. (2000) recipe</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;     Calzetti et al.  (2000, ApJ 533, 682) developed a recipe for dereddening </span>
<span class="comments">;     the spectra of galaxies where massive stars dominate the radiation output,</span>
<span class="comments">;     valid between 0.12 to 2.2 microns.     (CALZ_UNRED extrapolates between</span>
<span class="comments">;     0.12 and 0.0912 microns.)   </span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;     CALZ_UNRED, wave, flux, ebv, [ funred, R_V = ]</span>
<span class="comments">; INPUT:</span>
<span class="comments">;      WAVE - wavelength vector (Angstroms)</span>
<span class="comments">;      FLUX - calibrated flux vector, same number of elements as WAVE</span>
<span class="comments">;               If only 3 parameters are supplied, then this vector will</span>
<span class="comments">;               updated on output to contain the dereddened flux.</span>
<span class="comments">;      EBV  - color excess E(B-V), scalar.  If a negative EBV is supplied,</span>
<span class="comments">;               then fluxes will be reddened rather than deredenned.</span>
<span class="comments">;               Note that the supplied color excess should be that derived for </span>
<span class="comments">;               the stellar  continuum, EBV(stars), which is related to the </span>
<span class="comments">;               reddening derived from the gas, EBV(gas), via the Balmer </span>
<span class="comments">;               decrement by EBV(stars) = 0.44*EBV(gas)</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;      FUNRED - unreddened flux vector, same units and number of elements</span>
<span class="comments">;               as FLUX.   FUNRED values will be zeroed outside valid domain</span>
<span class="comments">;               Calz_unred (0.0912 - 2.2 microns).</span>
<span class="comments">;           </span>
<span class="comments">; OPTIONAL INPUT KEYWORD:</span>
<span class="comments">;       R_V - Ratio of total to selective extinction, default = 4.05.  </span>
<span class="comments">;             Calzetti et al. (2000) estimate R_V = 4.05 +/- 0.80 from optical</span>
<span class="comments">;             -IR observations of 4 starbursts.</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Estimate how a flat galaxy spectrum (in wavelength) between 1200 A </span>
<span class="comments">;       and 3200 A is altered by a reddening of E(B-V) = 0.1.   </span>
<span class="comments">;</span>
<span class="comments">;       IDL> w = 1200 + findgen(40)*50      ;Create a wavelength vector</span>
<span class="comments">;       IDL> f = w*0 + 1                    ;Create a "flat" flux vector</span>
<span class="comments">;       IDL> calz_unred, w, f, -0.1, fnew  ;Redden (negative E(B-V)) flux vector</span>
<span class="comments">;       IDL> plot,w,fnew                   </span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       Use the 4 parameter calling sequence if you wish to save the </span>
<span class="comments">;               original flux vector.</span>
<span class="comments">; PROCEDURE CALLS:</span>
<span class="comments">;      POLY()</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written   W. Landsman        Raytheon  ITSS   December, 2000</span>
<span class="comments">;-</span>
 On_error, 2

 if N_params() LT 3 then begin
     print,'Syntax: CALZ_UNRED, wave, flux, ebv, [ funred, R_V=]'
    return
 endif

 if N_elements(R_V) EQ 0 then R_V = 4.05
 w1 = where((wave GE 6300) AND (wave LE 22000), c1)
 w2 = where((wave GE  912) AND (wave LT  6300), c2)
 x  = 10000.0/wave                      <span class="comments">;Wavelength in inverse microns</span>

 IF (c1 + c2) NE N_elements(wave) THEN message,/INF, $
       'Warning - some elements of wavelength vector outside valid domain'

 klam = 0.0*flux

 IF c1 GT 0 THEN $
    klam[w1] = 2.659*(-1.857 + 1.040*x[w1]) + R_V
   
 IF c2 GT 0 THEN $
    klam[w2] = 2.659*(poly(x[w2], [-2.156, 1.509d0, -0.198d0, 0.011d0])) + R_V
 
 funred = flux*10.0^(0.4*klam*ebv)
 if N_params() EQ 3 then flux = funred

 end
</code>
    </div>
  </body>
</html>