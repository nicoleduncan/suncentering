<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:06 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>tab_print.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="tab_print.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="tab_print:source"></a>pro tab_print,tcb,tab,columns,row1,row2
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	TAB_PRINT </span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Routine to print an stsdas table.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	tab_print, tcb, tab, columns, row1, row2</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	tcb - table control block returned by TAB_READ</span>
<span class="comments">;	tab - table array read by TAB_READ</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;	columns - vector of column numbers to be printed or a string</span>
<span class="comments">;		with column names separated by commas. If not supplied</span>
<span class="comments">;		or set to the null string, all columns are printed.</span>
<span class="comments">;</span>
<span class="comments">;	row1 - first row to print.  (default=0)</span>
<span class="comments">;	row2 - last row to print.  (default=last row in table)</span>
<span class="comments">;</span>
<span class="comments">; SIDE EFFECTS:</span>
<span class="comments">;	text is printed as directed by !textout</span>
<span class="comments">;</span>
<span class="comments">; HISTORY:</span>
<span class="comments">;	version 1, D. Lindler  Apr 89</span>
<span class="comments">;	April 90  Converted to NEW IDL D. Lindler</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>
<span class="comments">;-----------------------------------------------------------------------------</span>
<span class="comments">;</span>
<span class="comments">; get table size</span>
<span class="comments">;</span>
	nrows=tcb[3]
	ncols=tcb[5]
	maxcols=tcb[6]
	if nrows*ncols eq 0 then begin
		print,'TAB_PRINT--input table is empty'
		return
	endif
<span class="comments">;</span>
<span class="comments">; set defaults for non-supplied parameters</span>
<span class="comments">;</span>
	if n_params(0) lt 3 then columns=''
	if n_params(0) lt 4 then row1=0
	if n_params(0) lt 5 then row2=nrows-1
<span class="comments">;</span>
<span class="comments">; convert columns to integer vector if not supplied that way</span>
<span class="comments">;</span>
	s=size(columns) & dtype=s[s[0]+1]
	if dtype eq 7 then begin
		st=strtrim(columns)
		if st eq '' then begin
			colno=indgen(ncols)+1
		  end else begin
			colno=intarr(100)
			ncol=0
			while st ne '' do begin
			    next_col=strtrim(gettok(st,','),2)
			    tab_col,tcb,next_col
			    if !err lt 1 then begin
				print,'TAB_PRINT-- column '+next_col+ $
						' not found'
				retall
			    endif
			    colno[ncol]=!err
			    ncol=ncol+1
			endwhile
			colno=colno[0:ncol-1]
		endelse
	   end else begin
		colno=intarr(n_elements(columns))+columns
	endelse
	if (max(colno) gt ncols) or (min(colno) lt 1) then begin
		print,'TAB_PRINT-- Invalid column number specified'
		retall
	endif
<span class="comments">;</span>
<span class="comments">; check validity of row numbers</span>
<span class="comments">;</span>
	row1=row1>0
	row2=row2>row1&lt<span class="comments">;(nrows-1)</span>
<span class="comments">;</span>
<span class="comments">; get column information</span>
<span class="comments">;</span>
	ncol=n_elements(colno)
	byte1=intarr(ncol)		<span class="comments">;byte positions within row</span>
	byte2=intarr(ncol)
	dtypes=intarr(ncol)
	names=strarr(ncol)
	units=strarr(ncol)
	formats=strarr(ncol)		<span class="comments">;fortran formats</span>
	fwidth=intarr(ncol)		<span class="comments">;print field widths</span>
	for i=0,ncol-1 do begin
		tab_col,tcb,colno[i],off,width,dtype,name,unit,sppformat
		byte1[i]=off
		byte2[i]=off+width-1
		dtypes[i]=dtype
		names[i]=name
		units[i]=unit
		tab_spptofor,sppformat,format,width	<span class="comments">;convert to fortran</span>
		fwidth[i]=width
		formats[i]='('+format+')'
	endfor
<span class="comments">;</span>
<span class="comments">; create header lines</span>
<span class="comments">;</span>
	line1='  row  '
	line2='       '
	for i=0,ncol-1 do begin
		name=strmid(strtrim(names[i]),0,fwidth[i])
		while strlen(name) lt fwidth[i] do name=' '+name
		line1=line1+' '+name
		unit=strmid(strtrim(units[i]),0,fwidth[i])
		while strlen(unit) lt fwidth[i] do unit=' '+unit
		line2=line2+' '+unit
	endfor
	line0='    '+nulltrim(string(byte(tcb[*,maxcols+1],0,64)))<span class="comments">;file name</span>
<span class="comments">;</span>
<span class="comments">; loop on rows and print headers every 50 lines</span>
<span class="comments">;</span>
	textopen,'tab_print'
	nlines=50
	for row=row1,row2 do begin

		if nlines ge 50 then begin	<span class="comments">;new page ?</span>
			printf,!textunit,string(12B)	<span class="comments">;page eject</span>
			printf,!textunit,line0
			printf,!textunit,line1
			printf,!textunit,line2		
			printf,!textunit,' '
			nlines=0
		endif
		
		line=string(row,'(i7)')
		for i=0,ncol-1 do begin
			val=tab[byte1[i]:byte2[i],row]
			case dtypes[i] of
				6: val=float(val,0)
				7: val=double(val,0)
				4: val=long(val,0)
				1: val=long(val,0)
				2: val=nulltrim(string(val))
			endcase
			line=line+' '+string(val,formats[i])
		endfor
		printf,!textunit,line
		nlines=nlines+1
	endfor
	textclose
	return
	end
</code>
    </div>
  </body>
</html>