<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:29 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>f_format.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="f_format.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="f_format:source"></a>function f_format, minval, maxval, factor, length
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	F_FORMAT</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Choose a nice floating format for displaying an array of REAL data.</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;	Called by TVLIST, IMLIST.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	fmt = F_FORMAT( minval, maxval, factor, [ length ] )</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	MINVAL - REAL scalar giving the minimum value of an array of numbers</span>
<span class="comments">;		for which one desires a nice format.</span>
<span class="comments">;	MAXVAL - REAL scalar giving maximum value in array of numbers</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT:</span>
<span class="comments">;	LENGTH - length of the output F format (default = 5)</span>
<span class="comments">;		must be an integer scalar > 2</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;	FMT - an F or I format string, e.g. 'F5.1'</span>
<span class="comments">;	FACTOR - factor of 10 by which to multiply array of numbers to achieve</span>
<span class="comments">;		a pretty display using format FMT.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;	Find a nice format to print an array of numbers with a minimum of 5.2e-3</span>
<span class="comments">;	and a maximum  of 4.2e-2.</span>
<span class="comments">;</span>
<span class="comments">;		IDL> fmt = F_FORMAT( 5.2e-3, 4.2e-2, factor )</span>
<span class="comments">;         </span>
<span class="comments">;	yields fmt = '(F5.2)' and factor = .01, i.e. the array can be displayed</span>
<span class="comments">;	with a F5.2 format after multiplication by 100.</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;	Written W. Landsman              December 1988</span>
<span class="comments">;	Deal with factors &lt; 1.           August 1991</span>
<span class="comments">;	Deal with factors &lt; 1. *and* a large range    October 1992</span>
<span class="comments">;	Now returns In format rather than Fn.0    February, 1994</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>
 On_error,2

 if N_params() LT 3 then begin                                         
    print,'Syntax  - fmt = F_FORMAT( minval, maxval, factor, [ length ])'
    return,''
 endif

 if N_params() LT 4 then length = 5 else length = length > 2
 factor = 1.

 RANGE: if ( maxval GT 0) then begin 
       mxlog = fix( alog10( maxval ) ) 
       mxval =  (mxlog>0) + 1 
 endif else if ( maxval LT 0) then begin
       mxlog =   fix( alog10( abs( maxval ) ) ) 
       mxval =  (mxlog>0) + 2 
 endif else begin
        mxlog = 0
        mxval = 1
 endelse

 if ( minval GT 0 ) then begin 
       mnlog = fix( alog10( minval ))
       mnval =  (mnlog>0) + 1 
 endif else if ( minval LT 0) then begin
       mnlog =   fix(alog10(abs(minval))) 
       mnval =   (mnlog>0) + 2 
 endif else begin
        mnlog = 0
        mnval = 1
 endelse

 if ( mnlog LT 0 ) and ( mxlog LT 0 ) then begin        <span class="comments">;All numbers are &lt; 1.0</span>
      expon = max( [ mnlog,mxlog ] ) -1
      factor = factor*10.^(expon)
      maxval = maxval / factor
      minval = minval / factor
      goto, RANGE  
 endif

 dif = abs( mxlog - mnlog )
 if ( dif GE length-3 ) then begin

     factor =  factor*10.^(mxlog-(length-3))    
     abs = 0

 endif else begin

 TEST:  tpairv = abs( [mxval,mnval] ) 
        test   = max( tpairv )          

 if ( test LE length-3 ) then begin        <span class="comments">;No factor needed</span>
      abs = length - test - 2         
 endif else begin
     expon = min( [mxlog, mnlog] ) 
     if expon EQ 0 then expon = 1         <span class="comments">;Avoid infinite loop</span>
     factor = factor*10.^(expon)
     mxval = mxval - expon
     mnval = mnval - expon
     goto, TEST 
 endelse 
 endelse

 if abs EQ 0 then begin
        factor = factor/10
	return,'I' + strtrim(length,2)
 endif else return,'F' + strtrim( length, 2 ) + '.' + strtrim( abs, 2 )
 
 end
</code>
    </div>
  </body>
</html>