<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:18 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>altaz2hadec.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="altaz2hadec.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO altaz2hadec, alt, az, lat, ha, dec
<span class="comments">;+</span>
<span class="comments">;  NAME:</span>
<span class="comments">;    ALTAZ2HADEC</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;    Convert Horizon (Alt-Az) coordinates to Hour Angle and Declination.</span>
<span class="comments">; EXPLANATION::</span>
<span class="comments">;    Can deal with the NCP singularity.    Intended mainly to be used by</span>
<span class="comments">;    program hor2eq.pro</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;   ALTAZ2HADEC, alt, az, lat, ha, dec</span>
<span class="comments">;</span>
<span class="comments">; INPUTS</span>
<span class="comments">;   alt - the local apparent altitude, in DEGREES, scalar or vector</span>
<span class="comments">;   az  - the local apparent azimuth, in DEGREES, scalar or vector,</span>
<span class="comments">;         measured EAST of NORTH!!!  If you have measured azimuth west-of-south</span>
<span class="comments">;        (like the book MEEUS does), convert it to east of north via:</span>
<span class="comments">;                       az = (az + 180) mod 360</span>
<span class="comments">;</span>
<span class="comments">;   lat -  the local geodetic latitude, in DEGREES, scalar or vector.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS</span>
<span class="comments">;   ha  -  the local apparent hour angle, in DEGREES.  The hour angle is the </span>
<span class="comments">;          time that right ascension of 0 hours crosses the local meridian.  </span>
<span class="comments">;          It is unambiguously defined.</span>
<span class="comments">;   dec -  the local apparent declination, in DEGREES.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;     Arcturus is observed at an apparent altitude of 59d,05m,10s and an </span>
<span class="comments">;     azimuth (measured east of north) of 133d,18m,29s while at the </span>
<span class="comments">;     latitude of +43.07833 degrees.</span>
<span class="comments">;     What are the local hour angle and declination of this object?</span>
<span class="comments">;</span>
<span class="comments">;     IDL> altaz2hadec, ten(59,05,10), ten(133,18,29), 43.07833, ha, dec</span>
<span class="comments">;     ===> Hour angle ha = 336.683 degrees</span>
<span class="comments">;          Declination, dec = 19.1824 degrees</span>
<span class="comments">;</span>
<span class="comments">;       The widely available XEPHEM code gets:</span>
<span class="comments">;                 Hour Angle = 336.683</span>
<span class="comments">;                 Declination = 19.1824</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;    Written  Chris O'Dell Univ. of Wisconsin-Madison May 2002</span>
<span class="comments">;-</span>

 if N_params() LT 4 then begin
     print,'Syntax - ALTAZ2HADEC, alt, az, lat, ha, dec'
     return
 endif
 d2r = !dpi/180.0d
 alt_r  = alt*d2r
 az_r = az*d2r
 lat_r = lat*d2r

<span class="comments">;******************************************************************************</span>
<span class="comments">; find local HOUR ANGLE (in degrees, from 0. to 360.)</span>
 ha = atan( -sin(az_r)*cos(alt_r), $
           -cos(az_r)*sin(lat_r)*cos(alt_r)+sin(alt_r)*cos(lat_r))
 ha = ha / d2r
 w = where(ha LT 0.)
 if w[0] ne -1 then ha[w] = ha[w] + 360.
 ha = ha mod 360.

<span class="comments">; Find declination (positive if north of Celestial Equator, negative if south)</span>
 sindec = sin(lat_r)*sin(alt_r) + cos(lat_r)*cos(alt_r)*cos(az_r)
 dec = asin(sindec)/d2r  <span class="comments">; convert dec to degrees</span>


END
</code>
    </div>
  </body>
</html>