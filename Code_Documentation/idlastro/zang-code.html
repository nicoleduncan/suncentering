<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:14 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>zang.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="zang.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="zang:source"></a>function zang,dl,z, h0=h0, k = k, Lambda0 = lambda0, Omega_m = Omega_m, $
                    q0 = q0, SILENT = silent
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       ZANG</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Determine the angular size of an object as a function of redshift</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Requires an input size in kpc and returns an angular size in arc seconds</span>
<span class="comments">;       Default cosmology has a Hubble constant of 70 km/s/Mpc, Omega (matter)</span>
<span class="comments">;       =0.3 and a normalized cosmological constant Lambda = 0.7; however these</span>
<span class="comments">;       values can be changed with appropriate keywords.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       angsiz = zang( dl, [ z, H0 =, Omega_m =, Lambda0 = , q0 = , k =, </span>
<span class="comments">;                               /SILENT] )</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       dl - linear size of the object *in kpc*, non-negative scalar or vector</span>
<span class="comments">;       z - redshift of object, postive  scalar or vector</span>
<span class="comments">;           Either dl and z must have the same number of elements, or at least</span>
<span class="comments">;           one of them must be a vector.</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS</span>
<span class="comments">;    H0 -  Hubble constant in km/s/Mpc, default is 70</span>
<span class="comments">;</span>
<span class="comments">;        No more than two of the following four parameters should be</span>
<span class="comments">;        specified.    None of them need be specified, default values are given</span>
<span class="comments">;    k - curvature constant, normalized to the closure density.   Default is</span>
<span class="comments">;        0, indicating a flat universe</span>
<span class="comments">;    Omega_m -  Matter density, normalized to the closure density, default</span>
<span class="comments">;        is 0.3.   Must be non-negative</span>
<span class="comments">;    Lambda0 - Cosmological constant, normalized to the closure density,</span>
<span class="comments">;        default is 0.7</span>
<span class="comments">;    q0 - Deceleration parameter, numeric scalar = -R*(R'')/(R')^2, default</span>
<span class="comments">;        is -0.55</span>
<span class="comments">;</span>
<span class="comments">;    Note that Omega_m + lambda0 + k = 1 and q0 = 0.5*omega_m - lambda0</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       angsiz - Angular size of the object at the given redshift in </span>
<span class="comments">;               arc seconds </span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;  (1) What would be the angular size of galaxy of diameter 50 kpc at a redshift</span>
<span class="comments">;      of 1.5 in an open universe with Lambda = 0 and Omega (matter) = 0.3.</span>
<span class="comments">;      Assume the default Hubble constant value of 70 km/s/Mpc.</span>
<span class="comments">;      </span>
<span class="comments">;      IDL> print,zang(50,1.5, Lambda = 0,omega_m = 0.3)</span>
<span class="comments">;             ====> 6.58 arc seconds</span>
<span class="comments">;</span>
<span class="comments">;  (2) Now plot the angular size of a 50 kpc diameter galaxy as a function of </span>
<span class="comments">;      redshift for the default cosmology (Lambda = 0.7, Omega_m=0.3) up to </span>
<span class="comments">;      z = 0.5</span>
<span class="comments">;      IDL> z = findgen(50)/10. + 0.1    ;Angular size undefined at z = 0</span>
<span class="comments">;      IDL> plot,z,zang(50,z),xtit='z',ytit='Angular Size (")'</span>
<span class="comments">; NOTES:</span>
<span class="comments">;      This procedure underwent a major revision in April 2000 to allow for a </span>
<span class="comments">;      cosmological constant, ***including a change of the calling sequence***</span>
<span class="comments">;</span>
<span class="comments">;      Be sure to supply the input linear size dl in units of kpc.</span>
<span class="comments">; PROCEDURES CALLED:</span>
<span class="comments">;      LUMDIST() -- Calculates the luminosity distance</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;      Written    J. Hill   STX           July, 1988</span>
<span class="comments">;      Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;      Major rewrite to call LUMDIST function  W. Landsman   April 2000     </span>
<span class="comments">;-</span>

 if N_params() LT 2 then begin 
      print,'Sytnax - ' + $
 'angsiz = zang( dl, z, [H0 =, Omega_m =, Lambda0 = , q0 = , k =, /SILENT])'
      return,-1
 endif

 d = lumdist(z,H0 = h0,k = k, Lambda0 = lambda0, Omega_m = Omega_m,  q0 = q0, $
               SILENT = silent)

<span class="comments">; Angular distance is equal to the luminosity distance times (1+z)^2</span>
 return,!RADEG*3600.*dl*(1.+z)^2/(1000.*d)
 end
</code>
    </div>
  </body>
</html>