<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:27 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>dbsort.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="dbsort.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="dbsort:source"></a>function dbsort,list,items,REVERSE = rev
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       DBSORT</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Routine to sort list of entries in data base</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE: </span>
<span class="comments">;       result = dbsort( list, items , [ REVERSE = ])</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       list - list of entry numbers to sort</span>
<span class="comments">;               -1 to sort all entries</span>
<span class="comments">;       items - list of items to sort (up to 9 items)</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       result - numeric vector giving input list sorted by items</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL KEYWORD INPUT:</span>
<span class="comments">;       REVERSE - scalar or vector with the same number of elements as the</span>
<span class="comments">;         the number of items to sort.  If the corresponding element of REVERSE </span>
<span class="comments">;         is non-zero then that item is sorted in descending rather than </span>
<span class="comments">;         ascending order.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Sort an astronomical catalog with RA as primary sort, and declination</span>
<span class="comments">;       as secondary sort (used when RA values are equal)</span>
<span class="comments">;</span>
<span class="comments">;          IDL> NEWLIST = DBSORT( -1, 'RA,DEC' )</span>
<span class="comments">;</span>
<span class="comments">;       If for some reason, one wanted the DEC sorted in descending order, but</span>
<span class="comments">;       the RA in ascending order</span>
<span class="comments">;</span>
<span class="comments">;          IDL> NEWLIST = DBSORT( -1, 'RA,DEC', REV = [ 0, 1 ] )</span>
<span class="comments">;</span>
<span class="comments">; METHOD:</span>
<span class="comments">;       The list is sorted such that each item is sorted into</span>
<span class="comments">;       asscending order starting with the last item.</span>
<span class="comments">; COMMON BLOCKS:</span>
<span class="comments">;       DBCOM</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       ZPARCHECK, BSORT, DBEXT, DB_ITEM</span>
<span class="comments">; HISTORY</span>
<span class="comments">;       VERSION 1  D. Lindler  Oct. 86</span>
<span class="comments">;       Added REVERSE keyword   W. Landsman        August, 1991</span>
<span class="comments">;       Avoid use of EXECUTE() for V6.1 or later   W. Landsman Dec 2006</span>
<span class="comments">;       Assume since V6.1   W. Landsman   June 2009</span>
<span class="comments">;       Add TEMPORARY call  W. Lnadsman  July 2009</span>
<span class="comments">;-</span>
 On_error,2
 compile_opt idl2
 if N_params() LT 2 then begin
     print,'Syntax: newlist = dbsort( list, items, [ REVERSE = ] )'
     return, -1
 endif
<span class="comments">;---------------------------------------------------------</span>
<span class="comments">; data base common block, see DBOPEN for meanings</span>

 common db_com,QDB,QITEMS,QLINK

<span class="comments">; check parameters</span>

 zparcheck, 'DBSORT', list, 1, [1,2,3], [0,1], 'entry list'
 zparcheck, 'DBSORT', items, 2, [1,2,3,7], [0,1], 'item list'

<span class="comments">; extract values of items</span>

 db_item, items, it
 nitems = N_elements(it)                    <span class="comments">;Number of items</span>
 if nitems GT 9 then message, $
        'ERROR -  Can only sort on nine items or less'

                                            <span class="comments">;Verify REVERSE vector</span>
 if not keyword_set(REV) then rev = bytarr(nitems) else $
         if N_elements(rev) NE nitems then $
             message,'ERROR - REVERSE vector must contain ' + $
                   strtrim(nitems,2) + ' elements'

<span class="comments">; make list vector</span>

 qnentry = long(qdb,84)
 if list[0] EQ -1 then vlist = lindgen(qnentry)+1 else vlist = list

<span class="comments">; create line to execute in the form:</span>
<span class="comments">;       dbext, vlist, it, v1,v2,...,v(nitems)</span>
 case nitems of 
        1: dbext, vlist, it, v1
        2: dbext, vlist, it, v1, v2
        3: dbext, vlist, it, v1, v2, v3
        4: dbext, vlist, it, v1, v2, v3, v4
        5: dbext, vlist, it, v1, v2, v3, v4, v5
        6: dbext, vlist, it, v1, v2, v3, v4, v5, v6
        7: dbext, vlist, it, v1, v2, v3, v4, v5, v6, v7
        8: dbext, vlist, it, v1, v2, v3, v4, v5, v6, v7, v8
        9: dbext, vlist, it, v1, v2, v3, v4, v5, v6, v7, v8, v9
 endcase

<span class="comments">; sort on each item</span>

 sub = lindgen(N_elements(vlist))               <span class="comments">;list of subscripts</span>
 for i = 0,nitems-1 do begin

<span class="comments">; get item</span>

        j = nitems-i
        vv = 'v' + strtrim(j,2) 
        v = temporary(scope_varfetch(vv, level=0))

<span class="comments">; perform previous sorts on item</span>

        if i GT 0 then v = v[sub]
         
<span class="comments">; sort item</span>

        sub = sub[ bsort( v, REVERSE = rev[j-1] ) ]

 end

<span class="comments">; return sorted list</span>

 return, vlist[sub]
 end
</code>
    </div>
  </body>
</html>