<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:55 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>planck.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="planck.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="planck:source"></a>function planck,wave,temp
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       PLANCK()   </span>
<span class="comments">; PURPOSE: </span>
<span class="comments">;       To calculate the Planck function in units of ergs/cm2/s/A  </span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE: </span>
<span class="comments">;       bbflux = PLANCK( wave, temp) </span>
<span class="comments">;</span>
<span class="comments">; INPUT PARAMETERS: </span>
<span class="comments">;       WAVE   Scalar or vector giving the wavelength(s) in **Angstroms**</span>
<span class="comments">;               at which the Planck function is to be evaluated.</span>
<span class="comments">;       TEMP   Scalar giving the temperature of the planck function in degree K</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT PARAMETERS:</span>
<span class="comments">;       BBFLUX - Scalar or vector giving the blackbody flux (i.e. !pi*Intensity)</span>
<span class="comments">;               in erg/cm^2/s/A in at the specified wavelength points.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLES:</span>
<span class="comments">;       To calculate the blackbody flux at 30,000 K every 100 Angstroms between</span>
<span class="comments">;       2000A and 2900 A</span>
<span class="comments">;   </span>
<span class="comments">;       IDL> wave = 2000 + findgen(10)*100</span>
<span class="comments">;       IDL> bbflux = planck(wave,30000)</span>
<span class="comments">;</span>
<span class="comments">;       If a star with a blackbody spectrum has a radius R, and distance,d, then</span>
<span class="comments">;       the flux at Earth in erg/cm^2/s/A will be bbflux*R^2/d^2</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;       The wavelength data are converted to cm, and the Planck function</span>
<span class="comments">;       is calculated for each wavelength point. See Allen (1973), Astrophysical</span>
<span class="comments">;       Quantities, section 44 for more information.</span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       See the procedure planck_radiance.pro in </span>
<span class="comments">;       ftp://origin.ssec.wisc.edu/pub/paulv/idl/Radiance/planck_radiance.pro</span>
<span class="comments">;       for computation of Planck radiance given wavenumber in cm-1 or  </span>
<span class="comments">;       wavelength in microns </span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       Adapted from the IUE RDAF               August, 1989</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Improve precision of constants    W. Landsman  January 2002</span>
<span class="comments">;-</span>
 On_error,2

 if ( N_elements(wave) LT 1 ) then begin
     print,'Syntax - bbflux = planck( wave, temp)'
     return,0
  endif    

  if ( N_elements( temp ) NE 1 ) then $
      read,'Enter a blackbody temperature', temp

  bbflux = wave*0.

<span class="comments">; Gives the blackbody flux (i.e. PI*Intensity) ergs/cm2/s/a</span>

  w = wave / 1.E8                              <span class="comments">; Angstroms to cm    </span>
<span class="comments">;constants appropriate to cgs units.</span>
  c1 =  3.7417749d-5                <span class="comments">; =2*!DPI*h*c*c       </span>
  C2 =  1.4387687d                  <span class="comments">; =h*c/k</span>
  val =  c2/w/temp  
  mstr = machar(double = (size(val,/type) EQ 5) )  <span class="comments">;Get machine precision      </span>
  good = where( val LT alog(mstr.xmax), Ngood )    <span class="comments">;Avoid floating underflow</span>

  if ( Ngood GT 0 ) then  $
      bbflux[ good ] =  C1 / ( w[good]^5 * ( exp( val[good])-1. ) )

  return, bbflux*1.E-8              <span class="comments">; Convert to ergs/cm2/s/A</span>

  end 
</code>
    </div>
  </body>
</html>