<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:24 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>daycnv.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="daycnv.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO DAYCNV, XJD, YR, MN, DAY, HR
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       DAYCNV</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Converts Julian dates to Gregorian calendar dates</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       DAYCNV, XJD, YR, MN, DAY, HR</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       XJD = Julian date, positive double precision scalar or vector</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       YR = Year (Integer)</span>
<span class="comments">;       MN = Month (Integer)</span>
<span class="comments">;       DAY = Day (Integer)</span>
<span class="comments">;       HR = Hours and fractional hours (Real).   If XJD is a vector,</span>
<span class="comments">;               then YR,MN,DAY and HR will be vectors of the same length.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       IDL> DAYCNV, 2440000.D, yr, mn, day, hr    </span>
<span class="comments">;</span>
<span class="comments">;       yields yr = 1968, mn =5, day = 23, hr =12.   </span>
<span class="comments">;</span>
<span class="comments">; WARNING:</span>
<span class="comments">;       Be sure that the Julian date is specified as double precision to</span>
<span class="comments">;       maintain accuracy at the fractional hour level.</span>
<span class="comments">;</span>
<span class="comments">; METHOD:</span>
<span class="comments">;       Uses the algorithm of Fliegel and Van Flandern (1968) as reported in</span>
<span class="comments">;       the "Explanatory Supplement to the Astronomical Almanac" (1992), p. 604</span>
<span class="comments">;       Works for all Gregorian calendar dates with XJD > 0, i.e., dates after</span>
<span class="comments">;       -4713 November 23.</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Converted to IDL from Yeoman's Comet Ephemeris Generator, </span>
<span class="comments">;       B. Pfarr, STX, 6/16/88</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>
 On_error,2
 compile_opt idl2

 if N_params() lt 2 then begin
    print,"Syntax - DAYCNV, xjd, yr, mn, day, hr'
    print,'  Julian date, xjd, should be specified in double precision'
    return
 endif

<span class="comments">; Adjustment needed because Julian day starts at noon, calendar day at midnight</span>

 jd = long(xjd)                         <span class="comments">;Truncate to integral day</span>
 frac = double(xjd) - jd + 0.5          <span class="comments">;Fractional part of calendar day</span>
 after_noon = where(frac ge 1.0, Next)
 if Next GT 0 then begin                <span class="comments">;Is it really the next calendar day?</span>
      frac[after_noon] = frac[after_noon] - 1.0
      jd[after_noon] = jd[after_noon] + 1
 endif
 hr = frac*24.0
 l = jd + 68569
 n = 4*l / 146097l
 l = l - (146097*n + 3l) / 4
 yr = 4000*(l+1) / 1461001
 l = l - 1461*yr / 4 + 31        <span class="comments">;1461 = 365.25 * 4</span>
 mn = 80*l / 2447
 day = l - 2447*mn / 80
 l = mn/11
 mn = mn + 2 - 12*l
 yr = 100*(n-49) + yr + l
 return
 end
</code>
    </div>
  </body>
</html>