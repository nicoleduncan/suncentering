<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:30 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>fits_read.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="fits_read.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="fits_read-code.html" title="Chromocoded source">Source</a> <a href="fits_read.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">fits_read.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="fits_read">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="fits_read-code.html#fits_read:source" class="top">source</a> fits_read<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>fits_read<span class="argument">, <a href="#fits_read:p:file_or_fcb">file_or_fcb</a></span><span class="argument">, <a href="#fits_read:p:data">data</a></span><span class="argument">, <a href="#fits_read:p:header">header</a></span><span class="argument">, <a href="#fits_read:p:group_par">group_par</a></span><span class="argument">, <a href="#fits_read:k:noscale">noscale</a>=<span class="var">noscale</span></span><span class="argument">, <a href="#fits_read:k:exten_no">exten_no</a>=<span class="var">exten_no</span></span><span class="argument">, <a href="#fits_read:k:extname">extname</a>=<span class="var">extname</span></span><span class="argument">, <a href="#fits_read:k:extver">extver</a>=<span class="var">extver</span></span><span class="argument">, <a href="#fits_read:k:extlevel">extlevel</a>=<span class="var">extlevel</span></span><span class="argument">, <a href="#fits_read:k:xtension">xtension</a>=<span class="var">xtension</span></span><span class="argument">, <a href="#fits_read:k:no_abort">no_abort</a>=<span class="var">no_abort</span></span><span class="argument">, <a href="#fits_read:k:message">message</a>=<span class="var">message</span></span><span class="argument">, <a href="#fits_read:k:first">first</a>=<span class="var">first</span></span><span class="argument">, <a href="#fits_read:k:last">last</a>=<span class="var">last</span></span><span class="argument">, <a href="#fits_read:k:group">group</a>=<span class="var">group</span></span><span class="argument">, <a href="#fits_read:k:header_only">header_only</a>=<span class="var">header_only</span></span><span class="argument">, <a href="#fits_read:k:data_only">data_only</a>=<span class="var">data_only</span></span><span class="argument">, <a href="#fits_read:k:no_pdu">no_pdu</a>=<span class="var">no_pdu</span></span><span class="argument">, <a href="#fits_read:k:enum">enum</a>=<span class="var">enum</span></span><span class="argument">, <a href="#fits_read:k:no_unsigned">no_unsigned</a>=<span class="var">no_unsigned</span></span><span class="argument">, <a href="#fits_read:k:pdu">pdu</a>=<span class="var">pdu</span></span></code></p>

          
          <div class="small "><p> NAME:
       FITS_READ
 PURPOSE:
       To read a FITS file.
</p>

<p> CALLING SEQUENCE:
       FITS_READ, filename_or_fcb, data [,header, group_par]
</p>

<p> INPUTS:
       FILENAME_OR_FCB - this parameter can be the FITS Control Block (FCB)
               returned by FITS_OPEN or the file name of the FITS file.  If
               a file name is supplied, FITS_READ will open the file with
               FITS_OPEN and close the file with FITS_CLOSE before exiting.
               When multiple extensions are to be read from the file, it is
               more efficient for the user to call FITS_OPEN and leave the
               file open until all extensions are read. FPACK
               ( http://heasarc.gsfc.nasa.gov/fitsio/fpack/ ) compressed FITS
               files can be read provided that the FPACK software is installed.
</p>

<p> OUTPUTS:
       DATA - data array.  If /NOSCALE is specified, BSCALE and BZERO
               (if present in the header) will not be used to scale the data.
               If Keywords FIRST and LAST are used to read a portion of the
               data or the heap portion of an extension, no scaling is done
               and data is returned as a 1-D vector. The user can use the IDL
               function REFORM to convert the data to the correct dimensions
               if desired.  If /DATA_ONLY is specified, no scaling is done.
       HEADER - FITS Header.  The STScI inheritance convention is recognized
               http://fits.gsfc.nasa.gov/registry/inherit/fits_inheritance.txt
               If an extension is read, and the INHERIT keyword exists with a
               value of T, and the /NO_PDU keyword keyword is not supplied,
               then the primary data unit header and the extension header will
                be combined.  The header will have the form:
</p>

<p>                       &lt;required keywords for the extension: XTENSION, BITPIX,
                               NAXIS, ...&gt;
                       BEGIN MAIN HEADER --------------------------------
                       &lt;PDU header keyword and history less required keywords:
                               SIMPLE, BITPIX, NAXIS, ...&gt;
                       BEGIN EXTENSION HEADER ---------------------------
                       &lt;extension header less required keywords that were
                               placed at the beginning of the header.
                       END
</p>

<p>               The structure of the header is such that if a keyword is
               duplicated in both the PDU and extension headers, routine
               SXPAR will print a warning and return the extension value of
               the keyword.
</p>

<p>       GROUP_PAR - Group parameter block for FITS random groups format files
               or the heap area for variable length binary tables.
               Any scale factors in the header (PSCALn and PZEROn) are not
               applied to the group parameters.
</p>

<p> INPUT KEYWORD PARAMETERS:
</p>

<p>       /NOSCALE: Set to return the FITS data without applying the scale
               factors BZERO and BSCALE.
       /HEADER_ONLY: set to read the header only.
       /DATA_ONLY: set to read the data only.  If set, if any scale factors
               are present (BSCALE or BZERO), they will not be applied.
       /NO_PDU: By default, FITS_READ will add the primary data unit header
               keywords to the output header, *if* the header includes
               INHERIT = T.   Set /NO_PDU to never append the primary header.
       /NO_ABORT: Set to return to calling program instead of a RETALL
               when an I/O error is encountered.  If set, the routine will
               return  a non-null string (containing the error message) in the
               keyword MESSAGE.    (For backward compatibility, the obsolete
               system variable !ERR is also set to -1 in case of an error.)
               If /NO_ABORT not set, then FITS_READ will print the message and
               issue a RETALL
       /NO_UNSIGNED - By default, if  the header indicates an unsigned integer
              (BITPIX = 16, BZERO=2^15, BSCALE=1) then FITS_READ will output
               an IDL unsigned integer data type (UINT).   But if /NO_UNSIGNED
               is set, then the data is converted to type LONG.
       /PDU - If set, then always add the primary data unit header keywords
              to the output header, even if the INHERIT=T keyword is not found
              This was the default behavior of FITS_READ prior to April 2007
       EXTEN_NO - extension number to read.  If not set, the next extension
               in the file is read.  Set to 0 to read the primary data unit.
       XTENSION - string name of the xtension to read
       EXTNAME - string name of the extname to read
       EXTVER - integer version number to read
       EXTLEVEL - integer extension level to read
       FIRST - set this keyword to only read a portion of the data.  It gives
               the first word of the data to read
       LAST - set this keyword to only read a portion of the data.  It gives
               the last word number of the data to read
       GROUP - group number to read for GCOUNT&gt;1.  (Default=0, the first group)
</p>

<p> OUTPUT KEYWORD PARAMETERS:
       ENUM - Output extension number that was read.
       MESSAGE = value: Output error message
</p>

<p> NOTES:
       Determination or which extension to read.
               case 1: EXTEN_NO specified. EXTEN_NO will give the number of the
                       extension to read.  The primary data unit is refered
                       to as extension 0. If EXTEN_NO is specified, XTENSION,
                       EXTNAME, EXTVER, and EXTLEVEL parameters are ignored.
               case 2: if EXTEN_NO is not specified, the first extension
                       with the specified XTENSION, EXTNAME, EXTVER, and
                       EXTLEVEL will be read.  If any of the 4 parameters
                       are not specified, they will not be used in the search.
                       Setting EXTLEVEL=0, EXTVER=0, EXTNAME='', or
                       XTENSION='' is the same as not supplying them.
               case 3: if none of the keyword parameters, EXTEN_NO, XTENSION,
                       EXTNAME, EXTVER, or EXTLEVEL are supplied.  FITS_READ
                       will read the next extension in the file.  If the
                       primary data unit (PDU), extension 0, is null, the
                       first call to FITS_READ will read the first extension
                       of the file.
</p>

<p>               The only way to read a null PDU is to use EXTEN_NO = 0.
</p>

<p>       If FIRST and LAST are specified, the data is returned without applying
       any scale factors (BSCALE and BZERO) and the data is returned in a
       1-D vector.  This will allow you to read any portion of a multiple
       dimension data set.  Once returned, the IDL function REFORM can be
       used to place the correct dimensions on the data.
</p>

<p>       IMPLICIT IMAGES: FITS_READ will construct an implicit image
               for cases where NAXIS=0 and the NPIX1, NPIX2, and PIXVALUE
               keywords are present.  The output image will be:
                       image = replicate(PIXVALUE,NPIX1,NPIX2)
</p>

<p>      FPACK compressed files are always closed and reopened when exiting
      FITS_READ so that the pointer is set to the beginning of the file. (Since
      FPACK files are opened with a bidirectional pipe rather than OPEN, one
      cannot use POINT_LUN to move to a specified position in the file.)
</p>

<p> EXAMPLES:
       Read the primary data unit of a FITS file, if it is null read the
       first extension:
               FITS_READ, 'myfile.fits', data, header
</p>

<p>       Read the first two extensions of a FITS file and the extension with
       EXTNAME = 'FLUX' and EXTVER = 4
               FITS_OPEN, 'myfile.fits', fcb
               FITS_READ, fcb,data1, header2, exten_no = 1
               FITS_READ, fcb,data1, header2, exten_no = 2
               FITS_READ, fcb,data3, header3, extname='flux', extver=4
               FITS_CLOSE, fcb
</p>

<p>       Read the sixth image in a data cube for the fourth extension.
</p>

<p>               FITS_OPEN, 'myfile.fits', fcb
               image_number = 6
               ns = fcb.axis(0,4)
               nl = fcb.axis(1,4)
               i1 = (ns*nl)*(image_number-1)
               i2 = i2 + ns*nl-1
               FITS_READ,fcb,image,header,first=i1,last=i2
               image = reform(image,ns,nl,/overwrite)
               FITS_CLOSE
</p>

<p> PROCEDURES USED:
       FITS_CLOSE, FITS_OPEN
       SXADDPAR, SXDELPAR, SXPAR()
 WARNINGS:
       In Sep 2006, FITS_OPEN was modified to open FITS files using the
       /SWAP_IF_LITTLE_ENDIAN keyword to OPEN, so that subsequent routines
       (FITS_READ, FITS_WRITE) did not require any byte swapping.    An error
       may result if an pre-Sep 2006 version of FITS_OPEN is used with a
       post Sep 2006 version of FITS_READ, FITS_WRITE or MODFITS.
 HISTORY:
       Written by:     D. Lindler, August 1995
       Avoid use of !ERR       W. Landsman   August 1999
       Read unsigned datatypes, added /no_unsigned   W. Landsman December 1999
       Don't call FITS_CLOSE unless fcb is defined   W. Landsman January 2000
       Set BZERO = 0 for unsigned integer data   W. Landsman  January 2000
       Only call IEEE_TO_HOST if needed          W. Landsman February 2000
       Ensure EXTEND keyword in primary header   W. Landsman April 2001
       Don't erase ERROR message when closing file  W. Landsman April 2002
       Assume at least V5.1 remove NANValue keyword  W. Landsman November 2002
       Work with compress files (read file size from fcb),
       requires updated (Jan 2003) version of FITS_OPEN W. Landsman Jan 2003
       Do not modify BSCALE/BZERO for  unsigned integers W. Landsman April 2006
       Asuume FITS_OPEN has opened the file with /SWAP_IF_LITTLE_ENDIAN
                         W. Landsman   September 2006
       Fix problem with /DATA_ONLY keyword  M.Buie/W.Landsman  October 2006
       Only append primary header if INHERIT=T  W. Landsman  April 2007
       Make ndata 64bit for very large files E. Hivon/W. Landsman May 2007
       Added /PDU keyword to always append primary header W. Landsman June 2007
       Use PRODUCT to compute # of data points   W. Landsman  May 2009
       Make sure FIRST is long64 when computing position W.L. October 2009
       Read FPACK compressed files, W.L.  December 2010
       Don't assume FCB has a FCOMPRESS tag  W.L./Satori UeNO   September 2012
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="fits_read:p:file_or_fcb">file_or_fcb <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:p:data">data <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:p:header">header <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:p:group_par">group_par <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="fits_read:k:noscale">noscale <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:exten_no">exten_no <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:extname">extname <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:extver">extver <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:extlevel">extlevel <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:xtension">xtension <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:no_abort">no_abort <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:message">message <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:first">first <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:last">last <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:group">group <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:header_only">header_only <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:data_only">data_only <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:no_pdu">no_pdu <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:enum">enum <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:no_unsigned">no_unsigned <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="fits_read:k:pdu">pdu <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>566</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:30 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>