<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:20 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>bsort.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="bsort.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="Bsort:source"></a>function Bsort, Array, Asort, INFO=info, REVERSE = rev
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       BSORT</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Function to sort data into ascending order, like a simple bubble sort.</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Original subscript order is maintained when values are equal (FIFO).</span>
<span class="comments">;       (This differs from the IDL SORT routine alone, which may rearrange </span>
<span class="comments">;       order for equal values)</span>
<span class="comments">;</span>
<span class="comments">;       A faster algorithm (radix sort) for numeric data is available  at </span>
<span class="comments">;       http://idldatapoint.com/2012/04/19/an-lsd-radix-sort-algorithm-in-idl/</span>
<span class="comments">; CALLING SEQUENCE:  </span>
<span class="comments">;       result = bsort( array, [ asort, /INFO, /REVERSE ] )</span>
<span class="comments">;</span>
<span class="comments">; INPUT:</span>
<span class="comments">;       Array - array to be sorted</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       result - sort subscripts are returned as function value</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL OUTPUT:</span>
<span class="comments">;       Asort - sorted array</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL KEYWORD INPUTS:</span>
<span class="comments">;       /REVERSE - if this keyword is set, and non-zero, then data is sorted</span>
<span class="comments">;                 in descending order instead of ascending order.</span>
<span class="comments">;       /INFO = optional keyword to cause brief message about # equal values.</span>
<span class="comments">;</span>
<span class="comments">; HISTORY</span>
<span class="comments">;       written by F. Varosi Oct.90:</span>
<span class="comments">;       uses WHERE to find equal clumps, instead of looping with IF ( EQ ).</span>
<span class="comments">;       compatible with string arrays, test for degenerate array </span>
<span class="comments">;       20-MAY-1991     JKF/ACC via T AKE- return indexes if the array to </span>
<span class="comments">;                       be sorted has all equal values.</span>
<span class="comments">;       Aug - 91  Added  REVERSE keyword   W. Landsman      </span>
<span class="comments">;       Always return type LONG    W. Landsman     August 1994</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>
        N = N_elements( Array )
        if N lt 1 then begin
                print,'Input to BSORT must be an array'
                return, [0L]
           endif

        if N lt 2 then begin
            asort = array       <span class="comments">;MDM added 24-Sep-91</span>
            return,[0L]    <span class="comments">;Only 1 element</span>
        end
<span class="comments">;</span>
<span class="comments">; sort array (in descending order if REVERSE keyword specified )</span>
<span class="comments">;</span>
        subs = sort( Array )
        if keyword_set( REV ) then subs = rotate(subs,5)  
        Asort = Array[subs]
<span class="comments">;</span>
<span class="comments">; now sort subscripts into ascending order</span>
<span class="comments">; when more than one Asort has same value</span>
<span class="comments">;</span>
             weq = where( (shift( Asort, -1 ) eq Asort) , Neq ) 

        if keyword_set( info ) then $
                message, strtrim( Neq, 2 ) + " equal values Located",/CON,/INF

        if (Neq EQ n) then return,lindgen(n) <span class="comments">;Array is degenerate equal values</span>

        if (Neq GT 0) then begin

                if (Neq GT 1) then begin              <span class="comments">;find clumps of equality</span>

                        wclump = where( (shift( weq, -1 ) - weq) GT 1, Nclump )
                        Nclump = Nclump + 1

                  endif else Nclump = 1

                if (Nclump LE 1) then begin
                        Clump_Beg = 0
                        Clump_End = Neq-1
                  endif else begin
                        Clump_Beg = [0,wclump+1]
                        Clump_End = [wclump,Neq-1]
                   endelse

                weq_Beg = weq[ Clump_Beg ]              <span class="comments">;subscript ranges</span>
                weq_End = weq[ Clump_End ] + 1          <span class="comments">; of Asort equalities.</span>

                if keyword_set( info ) then message, strtrim( Nclump, 2 ) + $
                                " clumps of equal values Located",/CON,/INF

                for ic = 0L, Nclump-1 do begin          <span class="comments">;sort each clump.</span>

                        subic = subs[ weq_Beg[ic] : weq_End[ic] ]
                        subs[ weq_Beg[ic] ] = subic[ sort( subic ) ]
                  endfor

                if N_params() GE 2 then Asort = Array[subs]     <span class="comments">;resort array.</span>
           endif

return, subs
end
</code>
    </div>
  </body>
</html>