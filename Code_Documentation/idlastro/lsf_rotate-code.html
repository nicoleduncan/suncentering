<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:46 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>lsf_rotate.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="lsf_rotate.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="lsf_rotate:source"></a> function lsf_rotate, deltav, vsini, EPSILON = epsilon, VELGRID = velgrid
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;     LSF_ROTATE:</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     Create a 1-d convolution kernel to broaden a spectrum from a rotating star</span>
<span class="comments">;</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;     Can be used to derive the broadening effect (line spread function; LSF) </span>
<span class="comments">;     due to  rotation on a synthetic stellar spectrum.     Assumes constant </span>
<span class="comments">;     limb darkening across the disk.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE</span>
<span class="comments">;     lsf = LSF_ROTATE(deltav, vsini, EPSILON=, VELGRID=)</span>
<span class="comments">;</span>
<span class="comments">; INPUT PARAMETERS:</span>
<span class="comments">;    deltaV - numeric scalar giving the step increment (in km/s) in the output </span>
<span class="comments">;             rotation kernel.  </span>
<span class="comments">;    Vsini - the rotational velocity projected  along the line of sight (km/s)</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT PARAMETERS:</span>
<span class="comments">;    LSF - The convolution kernel vector for the specified rotational velocity.</span>
<span class="comments">;          The  number of points in LSF will be always be odd (the kernel is</span>
<span class="comments">;          symmetric) and equal to  either ceil(2*Vsini/deltav) or </span>
<span class="comments">;          ceil(2*Vsini/deltav) +1 (whichever number is odd).    LSF will </span>
<span class="comments">;          always be of type FLOAT.</span>
<span class="comments">;</span>
<span class="comments">;          To actually compute the broadening. the spectrum should be convolved</span>
<span class="comments">;          with the rotational LSF. </span>
<span class="comments">; OPTIONAL INPUT PARAMETERS:</span>
<span class="comments">;    Epsilon - numeric scalar giving the limb-darkening coefficient, </span>
<span class="comments">;          default = 0.6 which is typical for  photospheric lines.    The</span>
<span class="comments">;          specific intensity I at any angle theta from the specific intensity</span>
<span class="comments">;          Icen at the center of the disk is given by:</span>
<span class="comments">;  </span>
<span class="comments">;          I = Icen*(1-epsilon*(1-cos(theta))</span>
<span class="comments">;                    </span>
<span class="comments">; OPTIONAL OUTPUT PARAMETER:</span>
<span class="comments">;     Velgrid - Vector with the same number of elements as LSF </span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;    (1) Plot the LSF for a star rotating at 90 km/s in both velocity space and</span>
<span class="comments">;        for a central wavelength of 4300 A.    Compute the LSF every 3 km/s</span>
<span class="comments">;</span>
<span class="comments">;       IDL> lsf = lsf_rotate(3,90,velgrid=vel)      ;LSF will contain 61 pts</span>
<span class="comments">;       IDL> plot,vel,lsf                    ;Plot the LSF in velocity space</span>
<span class="comments">;       IDL> wgrid = 4300*(1+vel/3e5)       ;Speed of light = 3e5 km/s</span>
<span class="comments">;       IDL> oplot,wgrid,lsf                ;Plot in wavelength space</span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;    Adapted from rotin3.f in the SYNSPEC software of Hubeny & Lanz </span>
<span class="comments">;        .http://nova.astro.umd.edu/index.html    Also see Eq. 17.12 in </span>
<span class="comments">;    "The Observation and Analysis of Stellar Photospheres" by D. Gray (1992)</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;    Written,   W. Landsman                November 2001</span>
<span class="comments">;-</span>
    On_error,2
    compile_opt idl2
    if N_params() LT 1 then begin
         print,'Syntax - rkernel = lsf_rotate(deltav, vsini)'
         print,'      Input Keyword: Epsilon'
         print,'      Output Keyword: Velgrid'
         return,-1
    endif

    if N_elements(epsilon) EQ 0 then epsilon = 0.6
    e1 = 2.0d*(1.0d - epsilon)
    e2 = !dpi*epsilon/2.0d
    e3 = !dpi*(1.0d - epsilon/3.0d)

    npts = ceil(2*vsini/deltav)
    if npts mod 2 EQ 0 then npts = npts +1
    nwid = npts/2
    x = (dindgen(npts)- nwid)
    x = x*deltav/vsini  
    if arg_present(velgrid) then velgrid = x*vsini
    x1 = abs(1.0d - x^2)
    return, float((e1*sqrt(x1) + e2*x1)/e3)
   
    end   
</code>
    </div>
  </body>
</html>