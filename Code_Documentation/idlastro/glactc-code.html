<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:39 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>glactc.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="glactc.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="glactc:source"></a>pro glactc,ra,dec,year,gl,gb,j, degree=degree, fk4 = fk4, $
   SuperGalactic = superGalactic
<span class="comments">;+</span>
<span class="comments">; NAME:  </span>
<span class="comments">;       GLACTC</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;        Convert between celestial and Galactic (or Supergalactic) coordinates.</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Program to convert right ascension (ra) and declination (dec) to</span>
<span class="comments">;       Galactic longitude (gl) and latitude (gb) (j=1) or vice versa (j=2).</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE: </span>
<span class="comments">;       GLACTC, ra, dec, year, gl, gb, j, [ /DEGREE, /FK4, /SuperGalactic ]</span>
<span class="comments">;</span>
<span class="comments">; INPUT PARAMETERS: </span>
<span class="comments">;       year     equinox of ra and dec, scalar       (input)</span>
<span class="comments">;       j        direction of conversion     (input)</span>
<span class="comments">;               1:  ra,dec --> gl,gb</span>
<span class="comments">;               2:  gl,gb  --> ra,dec</span>
<span class="comments">;</span>
<span class="comments">; INPUTS OR OUTPUT PARAMETERS: ( depending on argument J )</span>
<span class="comments">;       ra       Right ascension, hours (or degrees if /DEGREES is set), </span>
<span class="comments">;                         scalar or vector</span>
<span class="comments">;       dec      Declination, degrees,scalar or vector</span>
<span class="comments">;       gl       Galactic longitude, degrees, scalar or vector</span>
<span class="comments">;       gb       Galactic latitude, degrees, scalar or vector</span>
<span class="comments">;</span>
<span class="comments">;       All results forced double precision floating.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORD PARAMETERS:</span>
<span class="comments">;       /DEGREE - If set, then the RA parameter (both input and output) is </span>
<span class="comments">;                given in degrees rather than hours. </span>
<span class="comments">;       /FK4 - If set, then the celestial (RA, Dec) coordinates are assumed</span>
<span class="comments">;              to be input/output in the FK4 system.    By default,  coordinates</span>
<span class="comments">;              are assumed to be in the FK5 system.    For B1950 coordinates,</span>
<span class="comments">;              set the /FK4 keyword *and* set the year to 1950.</span>
<span class="comments">;       /SuperGalactic - If set, the GLACTC returns SuperGalactic coordinates</span>
<span class="comments">;              as defined by deVaucouleurs et al. (1976) to account for the </span>
<span class="comments">;              local supercluster. The North pole in SuperGalactic coordinates </span>
<span class="comments">;              has Galactic coordinates l = 47.47, b = 6.32, and the origin is </span>
<span class="comments">;              at Galactic coordinates l = 137.37, b= 0 </span>
<span class="comments">;              </span>
<span class="comments">; EXAMPLES:</span>
<span class="comments">;       Find the Galactic coordinates of Altair (RA (J2000): 19 50 47 </span>
<span class="comments">;       Dec (J2000): 08 52 06)</span>
<span class="comments">;</span>
<span class="comments">;       IDL> glactc, ten(19,50,47),ten(8,52,6),2000,gl,gb,1</span>
<span class="comments">;       ==> gl = 47.74, gb = -8.91</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE CALLS:</span>
<span class="comments">;       BPRECESS, JPRECESS, PRECESS</span>
<span class="comments">; HISTORY: </span>
<span class="comments">;       FORTRAN subroutine by T. A. Nagy, 21-MAR-78.</span>
<span class="comments">;       Conversion to IDL, R. S. Hill, STX, 19-OCT-87.</span>
<span class="comments">;       Modified to handle vector input, E. P. Smith, GSFC, 14-OCT-94</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Added DEGREE keyword, C. Markwardt, Nov 1999</span>
<span class="comments">;       Major rewrite, default now FK5 coordinates, added /FK4 keyword</span>
<span class="comments">;       use external precession routines    W. Landsman   April 2002</span>
<span class="comments">;       Add /Supergalactic keyword W. Landsman  September 2002</span>
<span class="comments">;       Fix major bug when year not 2000 and /FK4 not set W. Landsman July 2003</span>
<span class="comments">;-</span>
 On_error,2
 compile_opt idl2

if N_params() lt 6 then begin
     print,'Syntax -  glactc, ra, dec, year, gl, gb, j, [/DEGREE, /FK4]'
     print,'j = 1: ra,dec --> gl,gb   j = 2:  gl,gb -->ra,dec'
     return
endif
radeg = 180.0d/!DPI
<span class="comments">;</span>
<span class="comments">; Galactic pole at ra 12 hrs 49 mins, dec 27.4 deg, equinox B1950.0</span>
<span class="comments">; position angle from Galactic center to equatorial pole = 123 degs.</span>

 if keyword_set(SuperGalactic) then begin
    rapol = 283.18940711d/15.0d & decpol = 15.64407736d
    dlon =  26.73153707 
 endif else begin 
   rapol = 12.0d0 + 49.0d0/60.0d0 
   decpol = 27.4d0
   dlon = 123.0d0
 endelse
   sdp = sin(decpol/radeg)
   cdp = sqrt(1.0d0-sdp*sdp)
   radhrs=radeg/15.0d0

 <span class="comments">;</span>
<span class="comments">; Branch to required type of conversion.   Convert coordinates to B1950 as </span>
<span class="comments">; necessary</span>
case j of                   
    1:  begin
        if ~keyword_set(degree) then  ras = ra*15.0d else ras =ra
        decs = dec
        if ~keyword_set(fk4) then begin
                 if year NE 2000 then precess,ras,decs,year,2000
                 bprecess,ras,decs,ra2,dec2
                 ras = ra2
                 decs = dec2
       endif else if year NE 1950 then precess,ras,decs,year,1950,/fk4
        ras = ras/radeg - rapol/radhrs 
        sdec = sin(decs/radeg)
        cdec = sqrt(1.0d0-sdec*sdec)
        sgb = sdec*sdp + cdec*cdp*cos(ras)
        gb = radeg * asin(sgb)
        cgb = sqrt(1.0d0-sgb*sgb)
        sine = cdec * sin(ras) / cgb
        cose = (sdec-sdp*sgb) / (cdp*cgb)
        gl = dlon - radeg*atan(sine,cose)
        ltzero=where(gl lt 0.0, Nltzero)
        if Nltzero ge 1 then gl[ltzero]=gl[ltzero]+360.0d0
        return
        end
    2:  begin
        sgb = sin(gb/radeg)
        cgb = sqrt(1.0d0-sgb*sgb)
        sdec = sgb*sdp + cgb*cdp*cos((dlon-gl)/radeg)
        dec = radeg * asin(sdec)
        cdec = sqrt(1.0d0-sdec*sdec)
        sinf = cgb * sin((dlon-gl)/radeg) / cdec
        cosf = (sgb-sdp*sdec) / (cdp*cdec)
        ra = rapol + radhrs*atan(sinf,cosf)
        ra = ra*15.0d
         if not keyword_set(fk4) then begin
                    ras = ra & decs = dec
                  jprecess,ras,decs,ra,dec
                  if year NE 2000 then precess,ra,dec,2000,year
        endif else if year NE 1950 then begin
                  precess,ra,dec,1950,year,/fk4
        endif 
                   
        gt36 = where(ra gt 360.0, Ngt36)
        if Ngt36 ge 1 then ra[gt36] = ra[gt36] - 360.0d0
        if ~keyword_set(degree) then      ra = ra / 15.0D0

   
        return
        end
endcase
end
</code>
    </div>
  </body>
</html>