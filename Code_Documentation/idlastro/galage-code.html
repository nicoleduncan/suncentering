<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:38 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>galage.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="galage.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME: </span>
<span class="comments">;   GALAGE</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;   Determine the age of a galaxy given its redshift and a formation redshift.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;   age = galage(z, [zform,  H0 =, k=, lambda0 =, Omega_m= , q0 =, /SILENT])' </span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;    z - positive numeric vector or scalar of measured redshifts </span>
<span class="comments">;    zform - redshift of galaxy formation (> z), numeric positive scalar </span>
<span class="comments">;        To determine the age of the universe at a given redshift, set zform</span>
<span class="comments">;        to a large number (e.g. ~1000).</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL KEYWORD INPUTS: </span>
<span class="comments">;    H0 - Hubble constant in km/s/Mpc, positive scalar, default is 70</span>
<span class="comments">;    /SILENT - If set, then the adopted cosmological parameters are not </span>
<span class="comments">;         displayed at the terminal.</span>
<span class="comments">;</span>
<span class="comments">;        No more than two of the following four parameters should be</span>
<span class="comments">;        specified.   None of them need be specified -- the adopted defaults</span>
<span class="comments">;        are given. </span>
<span class="comments">;    k - curvature constant, normalized to the closure density.   Default is</span>
<span class="comments">;        0, (indicating a flat universe)</span>
<span class="comments">;    Omega_m -  Matter density, normalized to the closure density, default</span>
<span class="comments">;        is 0.3.   Must be non-negative</span>
<span class="comments">;    Lambda0 - Cosmological constant, normalized to the closure density,</span>
<span class="comments">;        default is 0.7</span>
<span class="comments">;    q0 - Deceleration parameter, numeric scalar = -R*(R'')/(R')^2, default</span>
<span class="comments">;        is -0.55</span>
<span class="comments">;       </span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;    age -  age of galaxy in years, will have the same number of elements</span>
<span class="comments">;           as the input Z vector</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;    (1) Determine the age of a galaxy observed at z = 1.5 in a cosmology with</span>
<span class="comments">;    Omega_matter = 0.3 and Lambda = 0.0.    Assume the formation redshift was</span>
<span class="comments">;    at z = 25, and use the default Hubble constant (=70 km/s/Mpc)</span>
<span class="comments">;</span>
<span class="comments">;    IDL> print,galage(1.5,25,Omega_m=0.3, Lambda = 0)</span>
<span class="comments">;             ===> 3.35 Gyr</span>
<span class="comments">;     </span>
<span class="comments">;    (2) Plot the age of a galaxy in Gyr out to a redshift of z = 5, assuming </span>
<span class="comments">;        the default cosmology (omega_m=0.3, lambda=0.7), and zform = 100</span>
<span class="comments">;</span>
<span class="comments">;    IDL> z = findgen(50)/10.</span>
<span class="comments">;    IDL> plot,z,galage(z,100)/1e9,xtit='z',ytit = 'Age (Gyr)'</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;    For a given formation time zform and a measured z, integrate dt/dz from </span>
<span class="comments">;    zform to z. Analytic formula of dt/dz in Gardner, PASP 110:291-305, 1998 </span>
<span class="comments">;    March  (eq. 7)</span>
<span class="comments">; </span>
<span class="comments">; COMMENTS:</span>
<span class="comments">;    (1) Integrates using the IDL Astronomy Library procedure QSIMP.    (The </span>
<span class="comments">;    intrinsic IDL QSIMP() function is not called because of its ridiculous</span>
<span class="comments">;    restriction that only scalar arguments can be passed to the integrating</span>
<span class="comments">;    function.)    The function 'dtdz' is defined at the beginning of the </span>
<span class="comments">;    routine (so it can compile first).</span>
<span class="comments">;    </span>
<span class="comments">;    (2) Should probably be fixed to use a different integrator from QSIMP when</span>
<span class="comments">;    computing age from an "infinite" redshift of formation.    But using a </span>
<span class="comments">;    large value of zform seems to work adequately.</span>
<span class="comments">;</span>
<span class="comments">;     (3) An alternative set of IDL procedures for computing cosmological</span>
<span class="comments">;    parameters is available at </span>
<span class="comments">;            http://cerebus.as.arizona.edu/~ioannis/research/red/</span>
<span class="comments">; PROCEDURES CALLED:</span>
<span class="comments">;    COSMO_PARAM, QSIMP</span>
<span class="comments">; HISTORY: </span>
<span class="comments">;     STIS version by P. Plait (ACC)                  June 1999</span>
<span class="comments">;     IDL Astro Version   W. Landsman (Raytheon ITSS)      April 2000</span>
<span class="comments">;     Avoid integer overflow for more than 32767 redshifts  July 2001</span>
<span class="comments">;-</span>
<span class="comments">;</span>
<span class="comments">; define function dtdz</span>
<span class="comments">;</span>

<a id="dtdz:source"></a>function dtdz, z, lambda0 = lambda0, q0 = q0
   term1 = (1.0d + z)
   term2 = 2.0d * (q0 + lambda0) * z + 1.0d - lambda0
   term3 = (1.0d + z) * (1.0d +z)
   return, 1.0 / (term1 * sqrt(term2 * term3 + lambda0))
   end

<span class="comments">;;;;;;;;;;;;;;;;;;;;;;;;;</span>

<a id="galage:source"></a>function galage, z, zform, h0 = h0, Omega_m=omega_m, lambda0 = lambda0, k = k, $
                  q0 = q0, SILENT = silent

 if N_params() LE 1 then begin
    print,$
  'Syntax: age = GALAGE(z, zform, [H0= , Omega_M = ,lambda0 =, k= , q0=, /SIL]'
   return, 0
 endif

<span class="comments">;</span>
<span class="comments">; initialize numbers</span>
<span class="comments">;</span>

  if N_elements(h0) EQ 0 then h0 = 70.0
  COSMO_PARAM, Omega_m, lambda0, k, q0
  if not keyword_set(silent) then $
     print,'GALAGE: H0:', h0, ' Omega_m:', omega_m, ' Lambda0',lambda0, $
        ' q0: ',q0, ' k: ', k, f='(A,I3,A,f5.2,A,f5.2,A,f5.2,A,F5.2)' 

   nz = N_elements(z)
   age = z*0.            <span class="comments">;Return same dimensions and data type as Z</span>

<span class="comments">; </span>
<span class="comments">; use qsimp to integrate dt/dz to get age for each z</span>
<span class="comments">;   watch out for null case of z >= zform </span>
<span class="comments">;</span>
 
    for i= 0L, nz-1 do begin
      if (z[i] ge zform) then age_z = 0 else $
          qsimp,'dtdz', z[i], zform, age_z, q0 = q0, lambda0 = lambda0
      age[i] = age_z
   endfor

<span class="comments">; convert units of age: km/s/Mpc to years, divide by H0</span>
<span class="comments">;    3.085678e19 km --> 1 Mpc</span>
<span class="comments">;    3.15567e+07 sec --> 1 year </span>

   return, age * 3.085678e+19 / 3.15567e+7/ H0
   end

</code>
    </div>
  </body>
</html>