<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:38 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>gal_flat.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="gal_flat.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">FUNCTION GAL_FLAT,IMAGE,ANG,INC,CEN,INTERP = interp
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	GAL_FLAT</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Transforms the image of a galaxy so that the galaxy appears face-on</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;	Either a nearest-neighbor approximations or a bilinear interpolation </span>
<span class="comments">;	may  be used.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	RESULT = GAL_FLAT( image, ang, inc, [, cen, /INTERP ] )  </span>
<span class="comments">;</span>
<span class="comments">; INPUTS:   </span>
<span class="comments">;	IMAGE  - Image to be transformed</span>
<span class="comments">;	ANG  - Angle of major axis, counterclockwise from Y-axis, degrees</span>
<span class="comments">;		For an image in standard orientation (North up, East left)</span>
<span class="comments">;		this is the Position Angle</span>
<span class="comments">;	INC - Angle of inclination of galaxy, degrees</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;	CEN - Two element vector giving the X and Y position of galaxy center</span>
<span class="comments">;		If not supplied, then the galaxy center is assumed to coincide</span>
<span class="comments">;		 with the image center</span>
<span class="comments">;</span>
<span class="comments">; INPUT KEYWORDS:</span>
<span class="comments">;	INTERP - If present, and non-zero, then bilinear interpolation will be</span>
<span class="comments">;		performed.  Otherwise a nearest neighbor approximation  is used.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;	RESULT - the transformed image, same dimensions and type as IMAGE</span>
<span class="comments">;</span>
<span class="comments">; METHOD:</span>
<span class="comments">;	A set of 4 equal spaced control points are corrected for inclination</span>
<span class="comments">;	using the procedure POLYWARP.   These control points are used by </span>
<span class="comments">;	POLY_2D to correct the whole image.</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;	Written by R. S. Hill, SASC Technologies Inc., 4 December 1985</span>
<span class="comments">;	Code cleaned up a bit    W. Landsman      December 1992</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>

  if ( N_params() lt 3 ) then begin  
      print,'Syntax - result = gal_flat( image, ang, inc, [ cen, /INTERP ])'
      print,'ANG - Position Angle of major axis (degrees)'                
      print,'INC - Inclination of galaxy (degrees)'
      return, -1
  endif 

  if not keyword_set( INTERP ) then interp = 0

  angr = (ang+90)/!RADEG
  tanang = tan(angr)
  cosang = cos(angr)
  cosinc = cos(inc/!RADEG)
<span class="comments">;                                    Parameters of image</span>
  dims = SIZE(image)

  if N_elements(cen) NE 2 then begin 

      xcen = dims[1]/2.0                  <span class="comments">;Center</span>
      ycen = dims[2]/2.0
      if not !QUIET then message,'Galaxy nucleus assumed in image center',/CONT

  endif else begin

      xcen = cen[0]
      ycen = cen[1]

  endelse
<span class="comments">;                                    Equation of rotation axis</span>
  b = ycen - xcen*tanang
<span class="comments">;                                    Fiducial grid (as in ROT_INT)   </span>
  gridx = xcen + [ [-1,1], [-1,1] ] * dims[1]/6.0
  gridy = ycen + [ [-1,-1], [1,1] ] * dims[2]/6.0      
<span class="comments">;                                    Distorted version of grid</span>
  yprime = gridx*tanang + b            <span class="comments">;Equation of major axis</span>
  r0 = (gridy-yprime)*cos(angr)        <span class="comments">;Dist of control pts to major axis</span>
  delr = r0*(1.0-cosinc)               <span class="comments">;Correct distance for inclination</span>
  dely = -delr*cos(angr)               
  delx =  delr*sin(angr)
  distx = gridx + delx
  disty = gridy + dely
<span class="comments">;                                    Parameters of undistorted grid</span>
  x0 = dims[1]/3.0
  y0 = dims[2]/3.0
  dx = x0                              <span class="comments">;In this case only</span>
  dy = y0
<span class="comments">;                                    Do it</span>
  polywarp, distx, disty, gridx, gridy, 1, kx, ky
  RETURN,poly_2d( image, kx, ky, interp, MISSING = 0)
  end  
</code>
    </div>
  </body>
</html>