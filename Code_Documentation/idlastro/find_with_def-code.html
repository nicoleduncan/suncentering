<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:29 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>find_with_def.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="find_with_def.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">        FUNCTION FIND_WITH_DEF, FILENAME, PATHS, EXTENSIONS,    $
                NOCURRENT=NOCURRENT, RESET=RESET
<span class="comments">;+</span>
<span class="comments">; NAME: </span>
<span class="comments">;     FIND_WITH_DEF()    </span>
<span class="comments">; PURPOSE: </span>
<span class="comments">;     Searches for files with a default path and extension. </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;     Finds files using default paths and extensions,   Using this routine</span>
<span class="comments">;     together with environment variables allows an OS-independent approach</span>
<span class="comments">;     to finding files.</span>
<span class="comments">; CALLING SEQUENCE: </span>
<span class="comments">;     Result = FIND_WITH_DEF( FILENAME, PATHS  [, EXTENSIONS ] )</span>
<span class="comments">;</span>
<span class="comments">; INPUTS: </span>
<span class="comments">;     FILENAME   = Name of file to be searched for.  It may either be a</span>
<span class="comments">;                    complete filename, or the path or extension could be left</span>
<span class="comments">;                    off, in which case the routine will attempt to find the</span>
<span class="comments">;                    file using the default paths and extensions.</span>
<span class="comments">;</span>
<span class="comments">;     PATHS      = One or more default paths to use in the search in case</span>
<span class="comments">;                    FILENAME does not contain a path itself.  The individual</span>
<span class="comments">;                    paths are separated by commas, although in UNIX, colons</span>
<span class="comments">;                    can also be used.  In other words, PATHS has the same</span>
<span class="comments">;                    format as !PATH, except that commas can be used as a</span>
<span class="comments">;                    separator regardless of operating system.  The current</span>
<span class="comments">;                    directory is always searched first, unless the keyword</span>
<span class="comments">;                    NOCURRENT is set.</span>
<span class="comments">;</span>
<span class="comments">;                    A leading $ can be used in any path to signal that what</span>
<span class="comments">;                    follows is an environmental variable, but the $ is not</span>
<span class="comments">;                    necessary.  Environmental variables can themselves contain</span>
<span class="comments">;                    multiple paths.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS: </span>
<span class="comments">;     EXTENSIONS = Scalar string giving one or more extensions to append to </span>
<span class="comments">;                  end of filename if the filename does not contain one (e.g. </span>
<span class="comments">;                   ".dat").  The period is optional.  Multiple extensions can </span>
<span class="comments">;                   be separated by commas or colons.</span>
<span class="comments">; OUTPUTS: </span>
<span class="comments">;     The result of the function is the name of the file if successful, or</span>
<span class="comments">;     the null string if unsuccessful.</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS: </span>
<span class="comments">;     NOCURRENT = If set, then the current directory is not searched.</span>
<span class="comments">;</span>
<span class="comments">;      RESET      = The FIND_WITH_DEF routine supports paths which are</span>
<span class="comments">;                    preceeded with the plus sign to signal that all</span>
<span class="comments">;                    subdirectories should also be searched.  Often this is</span>
<span class="comments">;                    used with logical names.  It can be rather slow to search</span>
<span class="comments">;                    through these subdirectories.  The /RESET keyword can be</span>
<span class="comments">;                    used to redefine an environment variable so that</span>
<span class="comments">;                    subsequent calls don't need to look for the</span>
<span class="comments">;                    subdirectories.</span>
<span class="comments">;</span>
<span class="comments">;                    To use /RESET, the PATHS parameter must contain the name</span>
<span class="comments">;                    of a *single* environment variable.  For example</span>
<span class="comments">;</span>
<span class="comments">;                     setenv,'FITS_DATA=+/datadisk/fits'</span>
<span class="comments">;                     file = find_with_def('test.fits','FITS_DATA',/reset)</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;</span>
<span class="comments">;       FILENAME = ''</span>
<span class="comments">;       READ, 'File to open: ', FILENAME</span>
<span class="comments">;       FILE = FIND_WITH_DEF( FILENAME, 'SERTS_DATA', '.fix' )</span>
<span class="comments">;       IF FILE NE '' THEN ...</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE CALLS: </span>
<span class="comments">;       BREAK_PATH(), FIND_ALL_DIR(), STR_SEP()</span>
<span class="comments">; REVISION HISTORY: </span>
<span class="comments">;       Version 1, William Thompson, GSFC, 3 May 1993.</span>
<span class="comments">;               Removed trailing / and : characters.</span>
<span class="comments">;               Fixed bugs</span>
<span class="comments">;               Allow for commas within values of logical names.</span>
<span class="comments">;               Added keyword NOCURRENT.</span>
<span class="comments">;               Changed to call BREAK_PATH</span>
<span class="comments">;       Version 2, William Thompson, GSFC, 3 November 1994</span>
<span class="comments">;               Made EXTENSIONS optional.</span>
<span class="comments">;       Version 3, William Thompson, GSFC, 30 April 1996</span>
<span class="comments">;               Call FIND_ALL_DIR to resolve any plus signs.</span>
<span class="comments">;       Version 4, S.V. Haugan, UiO, 5 June 1996</span>
<span class="comments">;               Using OPENR,..,ERROR=ERROR to avoid an IDL 3.6</span>
<span class="comments">;               internal nesting error.</span>
<span class="comments">;       Version 5, R.A. Schwartz, GSFC, 11 July 1996</span>
<span class="comments">;               Use SPEC_DIR to interpret PATH under VMS</span>
<span class="comments">;       Version 6, William Thompson, GSFC, 5 August 1996</span>
<span class="comments">;               Took out call to SPEC_DIR (i.e., reverted to version 4).  The</span>
<span class="comments">;               use of SPEC_DIR was required to support logical names defined</span>
<span class="comments">;               via SETLOG,/CONFINE.  However, it conflicted with the ability</span>
<span class="comments">;               to use logical names with multiple values.  Removing the</span>
<span class="comments">;               /CONFINE made it unnecessary to call SPEC_DIR in this routine.</span>
<span class="comments">;       Version 7, William Thompson, GSFC, 6 August 1996</span>
<span class="comments">;               Added keyword RESET</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   October 1997</span>
<span class="comments">;       Use STRTRIM instead of TRIM,   W. Landsman   November 1998</span>
<span class="comments">;       Use STRSPLIT instead of STR_SEP  W. Landsman  July 2002</span>
<span class="comments">;-</span>
<span class="comments">;</span>
        ON_ERROR, 2
<span class="comments">;</span>
<span class="comments">;  Check the number of parameters:</span>
<span class="comments">;</span>
        IF N_PARAMS() LT 2 THEN MESSAGE, 'Syntax:  Result = ' + $
                'FIND_WITH_DEF(FILENAME, PATHS [, EXTENSIONS])'
<span class="comments">;</span>
<span class="comments">;  If there are any plus signs, then expand them.</span>
<span class="comments">;</span>
        PATH = FIND_ALL_DIR(PATHS, /PLUS_REQUIRED, /PATH, RESET=RESET)
<span class="comments">;</span>
<span class="comments">;  Reformat PATHS into an array.  The first element is the null string.</span>
<span class="comments">;</span>
        PATH = BREAK_PATH(PATH)
<span class="comments">;</span>
<span class="comments">;  If NOCURRENT was set, then remove the first (blank) entry from the PATH</span>
<span class="comments">;  array.</span>
<span class="comments">;</span>
        IF KEYWORD_SET(NOCURRENT) THEN PATH = PATH[1:*]
<span class="comments">;</span>
<span class="comments">;  Reformat EXTENSIONS into an array.  The first element is the null string.</span>
<span class="comments">;</span>
       EXT = '' 
       IF N_PARAMS() EQ 3 THEN $
            EXT = ['',STRSPLIT(EXTENSIONS,',:',/EXTRACT)] 
<span class="comments">;</span>
<span class="comments">;  Make sure that the extensions begin with a period.</span>
<span class="comments">;</span>
        FOR I = 0,N_ELEMENTS(EXT)-1 DO IF EXT[I] NE '' THEN     $
                IF STRMID(EXT[I],0,1) NE '.' THEN EXT[I] = '.' + EXT[I]
<span class="comments">;</span>
<span class="comments">;  Set up variables used by the loops below.</span>
<span class="comments">;</span>
        I_PATH = -1
        GET_LUN, UNIT
	FNAME = STRTRIM(FILENAME,2) + EXT
<span class="comments">;</span>
<span class="comments">;  Step through each of the paths.</span>
<span class="comments">;</span>
        FOR I_PATH = 0, N_ELEMENTS(PATH)- 1 DO BEGIN 
<span class="comments">;</span>
<span class="comments">;  If the file is found then terminate the loop and clean up.</span>
<span class="comments">;</span>
        FILE = FILE_SEARCH(PATH[I_PATH] + FNAME, COUNT = COUNT)
        IF COUNT GT 0 THEN BREAK
        ENDFOR
<span class="comments">;</span>
<span class="comments">;  Otherwise, we jump directly to here when we find a file.</span>
<span class="comments">;</span>
DONE:
        FREE_LUN, UNIT
	!ERR = COUNT
        RETURN, FILE[0]
        END
</code>
    </div>
  </body>
</html>