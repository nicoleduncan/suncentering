<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:04 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>sxwrite.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="sxwrite.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="SXWRITE:source"></a>pro SXWRITE, Unit, Data, Par
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	SXWRITE</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Write a group of data and parameters in ST format</span>
<span class="comments">;	to a STSDAS data file.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	SXWRITE, Unit, Data,[ Par]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	Unit = unit number of file.  The file must have been</span>
<span class="comments">;		previously opened by SXOPEN.</span>
<span class="comments">;	Data = Array of data to be written.  The dimensions</span>
<span class="comments">;		must agree with those supplied to SXOPEN and written</span>
<span class="comments">;		into the FITS header.  The type is converted if</span>
<span class="comments">;		necessary.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT PARAMETERS:</span>
<span class="comments">;	Par = parameter block.  The size of this array must</span>
<span class="comments">;		agree with the Psize parameter in the FITS header.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;	None.</span>
<span class="comments">; COMMON BLOCKS:</span>
<span class="comments">;	STCOMMN - Contains RESULT(20,10) where RESULT(i,LUN) =</span>
<span class="comments">;	0 - 121147 for consistency check, 1 - Unit for consistency,</span>
<span class="comments">;	2 - bitpix, 3 - naxis, 4 - groups (0 or 1), 5 - pcount,</span>
<span class="comments">;	6 - gcount, 7 - psize, 8 - data type as idl type code,</span>
<span class="comments">;	9 - bytes / record, 10 to 10+N-1 - dimension N,</span>
<span class="comments">;	18 - # of groups written, 19 = gcount.</span>
<span class="comments">;</span>
<span class="comments">; SIDE EFFECTS:</span>
<span class="comments">;	The data are written into the next group.</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;	SXOPEN must have been called to initialize the</span>
<span class="comments">;	header and the common block.</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;	DMS, July, 1983.</span>
<span class="comments">;	D.Lindler July, 1986 - changed block size of file to 512</span>
<span class="comments">;			moved group parameters after the groups data.</span>
<span class="comments">;	D.Lindler July, 1987 - modified to allow any size parameter block</span>
<span class="comments">;			(in bytes).</span>
<span class="comments">;	D. Lindler  April, 1990 - converted to new VMS IDL</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>
<span class="comments">;----------------------------------------------------------------------------</span>
<span class="comments">;</span>
	common stcommn, result, filename
	if N_params() LT 2 then begin
		print,'Syntax - SXWRITE, Unit, Data,[ Par]
		return
        endif	
<span class="comments">;</span>
	if N_elements(result) ne 200 then begin
		print,'SXWRITE - Sxopen not called'
		return
		endif
	if result[1,unit] ne unit then begin
		print,'SXWRITE - unit not opened with SXOPEN'
		return
		endif
<span class="comments">;</span>
	on_error,2			<span class="comments">;return to caller on error</span>
	s = size(data)			<span class="comments">;get data dims</span>
<span class="comments">;</span>
<span class="comments">; determine position in file to write</span>
<span class="comments">;</span>
	start=result[18,unit]*result[9,unit]
<span class="comments">;</span>
<span class="comments">; create assoc variable for data</span>
<span class="comments">;</span>
	rec = assoc(unit,data,start)
<span class="comments">;</span>
<span class="comments">; write data</span>
<span class="comments">;</span>
	rec[0]=data
<span class="comments">;</span>
<span class="comments">; write pblk</span>
<span class="comments">;</span>
	if result[7,unit] gt 0 then begin
		if n_params(0) lt 3 then par=bytarr(result[7,unit])
		p=byte(par,0,result[7,unit])
		rec=assoc(unit,p,start+result[9,unit]-result[7,unit])
		rec[0]=p
	end
	result[18,unit] = result[18,unit]+1 <span class="comments">;did one more group</span>
	return
end
</code>
    </div>
  </body>
</html>