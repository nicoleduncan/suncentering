<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:44 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>kuipertwo.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="kuipertwo.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="kuipertwo:source"></a> pro kuipertwo, data1, data2, D, prob, PLOT = plot, _EXTRA = extra,WINDOW=window
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       KUIPERTWO</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Compute the two-sided Kuiper statistic (invariant Kolmogorov-Smirnov)</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Returns the Kuiper statistic and associated probability </span>
<span class="comments">;       that two arrays of data values are drawn from the same distribution</span>
<span class="comments">;       Algorithm adapted from KSTWO in "Numerical</span>
<span class="comments">;       Recipes" by Press et al., 2nd edition (1992), Chapter 14</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       kuipertwo, data1, data2, D, prob, [ /PLOT ]</span>
<span class="comments">;</span>
<span class="comments">; INPUT PARAMETERS:</span>
<span class="comments">;       data1 -  vector of data values, at least 4 data values must be included</span>
<span class="comments">;               for the Kuiper statistic to be meaningful</span>
<span class="comments">;       data2 -  second set of data values, does not need to have the same </span>
<span class="comments">;               number of elements as data1</span>
<span class="comments">;</span>
<span class="comments">; OUTPUT PARAMETERS:</span>
<span class="comments">;       D - floating scalar giving the Kuiper statistic.   It</span>
<span class="comments">;               specifies the sum of positive and negative deviations between</span>
<span class="comments">;               the cumulative distributions of the two data sets</span>
<span class="comments">;       prob - floating scalar between 0 and 1 giving the significance level of</span>
<span class="comments">;               the Kuiper statistic.   Small values of PROB show that the </span>
<span class="comments">;               cumulative distribution function of DATA1 is significantly </span>
<span class="comments">;               different from DATA2</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORD:</span>
<span class="comments">;       /PLOT - If this keyword is set and non-zero, then KUIPERTWO will display</span>
<span class="comments">;               a plot of the CDF of the two data sets.</span>
<span class="comments">;               The data values where the Kuiper statistic is</span>
<span class="comments">;               computed (i.e. at the maximum difference between the CDF of</span>
<span class="comments">;               the two data sets) are indicated by vertical dashed lines.</span>
<span class="comments">;               KUIPERTWO accepts the _EXTRA keyword, so that most plot keywords</span>
<span class="comments">;               (e.g. TITLE, XTITLE, XSTYLE) can also be passed to KUIPERTWO.</span>
<span class="comments">;       /WINDOW - If set the plot to a resizeable graphics window.</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Test whether two vectors created by the RANDOMN function likely came</span>
<span class="comments">;       from the same distribution</span>
<span class="comments">;</span>
<span class="comments">;       IDL> data1 = randomn(seed,40)        ;Create data vectors to be </span>
<span class="comments">;       IDL> data2 = randomn(seed,70)        ;compared</span>
<span class="comments">;       IDL> kuipertwo, data1, data2, D, prob   & print,D,prob</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE CALLS</span>
<span class="comments">;       procedure PROB_KUIPER - computes significance of Kuiper distribution</span>
<span class="comments">;</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written     W. Landsman                August, 1992</span>
<span class="comments">;       FP computation of N_eff      H. Ebeling/W. Landsman  March 1996</span>
<span class="comments">;       Fix for arrays containing equal values J. Ballet/W. Landsman</span>
<span class="comments">;       Oct. 2001</span>
<span class="comments">;       Adapted from KSTWO, added PLOT keyword  J. Ballet     July 2004</span>
<span class="comments">;       Use Coyote Graphics W. Landsman   Feb 2011</span>
<span class="comments">;-</span>
  On_error, 2
  compile_opt idl2

 if ( N_params() LT 4 ) then begin
    print,'Syntax - KUIPERTWO, data1, data2, d, prob [, /PLOT]'
    return
 endif

 n1 = N_elements( data1 )
 if ( N1 LE 3 ) then message, $
   'ERROR - Input data values (first param) must contain at least 4 values'

 n2 = N_elements( data2 )
 if ( n2 LE 3 ) then message, $
   'ERROR - Input data values (second param) must contain at least 4 values'

 sortdata1 = data1[ sort( data1 ) ]        <span class="comments">;Sort input arrays into </span>
 sortdata2 = data2[ sort( data2 ) ]        <span class="comments">;ascending order</span>

 fn1 = ( findgen( n1 )  ) / n1
 fn2 = ( findgen( n2 )  ) / n2

 j1 = 0l & j2 = 0l
 id1 = lonarr(n1+n2)  & id2 = id1
 i = 0l

<span class="comments">; Form the two cumulative distribution functions, marking points where one</span>
<span class="comments">; must test their difference</span>

 while ( j1 LT n1 ) and ( j2 LT n2 ) do begin

     d1 = sortdata1[j1]
     d2 = sortdata2[j2]
     if d1 LE d2 then j1 = j1 +1
     if d2 LE d1 then j2 = j2 +1
            
     id1[i] = j1   & id2[i] = j2
     i = i+1

 endwhile

 id1 = id1[0:i-1]   &  id2 = id2[0:i-1]

<span class="comments">; The Kuiper statistic D is the sum of the maximum positive and</span>
<span class="comments">; negative differences between the two distribution functions</span>

 D1 = max(fn1[id1] - fn2[id2], sub1, MIN=D2, SUBSCRIPT_MIN=sub2)
 D = D1 - D2
 N_eff =  n1*n2/ float(n1 + n2)              <span class="comments">;Effective # of data points</span>
 PROB_KUIPER, D, N_eff, prob                 <span class="comments">;Compute significance of statistic</span>

 if keyword_set(plot) || keyword_set(Window) then begin

<span class="comments">; Prepare the step functions</span>
     xx1 = REBIN(sortdata1,2*n1,/SAMPLE)
     yy1 = REBIN(fn1,2*n1,/SAMPLE)
     yy1 = [yy1[1:*],1.]

     xx2 = REBIN(sortdata2,2*n2,/SAMPLE)
     yy2 = REBIN(fn2,2*n2,/SAMPLE)
     yy2 = [yy2[1:*],1.]

     cgplot, xx1, yy1, _EXTRA = extra, WINDOW=window
     cgplot, /over, xx2, yy2, lines=1, thick=2, WINDOW=window
     j1 = id1[sub1] - 1
     j2 = id1[sub2]
     cgplots, [sortdata1[j2], sortdata1[j2]], [0,fn2[id2[sub2]]], linestyle=2,$
         WINDOW=window
     cgplots, [sortdata1[j1], sortdata1[j1]], [fn2[id2[sub1]],1], linestyle=2,$
        WINDOW=window
 endif

 return
 end
</code>
    </div>
  </body>
</html>