<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:21 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>cntrd.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="cntrd.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="cntrd-code.html" title="Chromocoded source">Source</a> <a href="cntrd.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">cntrd.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="cntrd">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="cntrd-code.html#cntrd:source" class="top">source</a> cntrd<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>cntrd<span class="argument">, <a href="#cntrd:p:img">img</a></span><span class="argument">, <a href="#cntrd:p:x">x</a></span><span class="argument">, <a href="#cntrd:p:y">y</a></span><span class="argument">, <a href="#cntrd:p:xcen">xcen</a></span><span class="argument">, <a href="#cntrd:p:ycen">ycen</a></span><span class="argument">, <a href="#cntrd:p:fwhm">fwhm</a></span><span class="argument">, <a href="#cntrd:k:SILENT">SILENT</a>=<span class="var">SILENT</span></span><span class="argument">, <a href="#cntrd:k:DEBUG">DEBUG</a>=<span class="var">DEBUG</span></span><span class="argument">, <a href="#cntrd:k:EXTENDBOX">EXTENDBOX</a>=<span class="var">EXTENDBOX</span></span><span class="argument">, <a href="#cntrd:k:KeepCenter">KeepCenter</a>=<span class="var">KeepCenter</span></span></code></p>

          
          <div class="small "><p>  NAME:
       CNTRD
  PURPOSE:
       Compute the centroid  of a star using a derivative search
 EXPLANATION:
       CNTRD uses an early DAOPHOT "FIND" centroid algorithm by locating the
       position where the X and Y derivatives go to zero.   This is usually a
       more "robust"  determination than a "center of mass" or fitting a 2d
       Gaussian  if the wings in one direction are affected by the presence
       of a neighboring star.
</p>

<p>  CALLING SEQUENCE:
       CNTRD, img, x, y, xcen, ycen, [ fwhm , /KEEPCENTER, /SILENT, /DEBUG
                                       EXTENDBOX = ]
</p>

<p>  INPUTS:
       IMG - Two dimensional image array
       X,Y - Scalar or vector integers giving approximate integer stellar
             center
</p>

<p>  OPTIONAL INPUT:
       FWHM - floating scalar; Centroid is computed using a box of half
               width equal to 1.5 sigma = 0.637* FWHM.  CNTRD will prompt
               for FWHM if not supplied
</p>

<p>  OUTPUTS:
       XCEN - the computed X centroid position, same number of points as X
       YCEN - computed Y centroid position, same number of points as Y,
              floating point
</p>

<p>       Values for XCEN and YCEN will not be computed if the computed
       centroid falls outside of the box, or if the computed derivatives
       are non-decreasing.   If the centroid cannot be computed, then a
       message is displayed and XCEN and YCEN are set to -1.
</p>

<p>  OPTIONAL OUTPUT KEYWORDS:
       /SILENT - Normally CNTRD prints an error message if it is unable
               to compute the centroid.   Set /SILENT to suppress this.
       /DEBUG - If this keyword is set, then CNTRD will display the subarray
               it is using to compute the centroid.
       EXTENDBOX = {non-negative positive integer}.   CNTRD searches a box with
              a half width equal to 1.5 sigma  = 0.637* FWHM to find the
              maximum pixel.    To search a larger area, set EXTENDBOX to
              the number of pixels to enlarge the half-width of the box.
              Default is 0; prior to June 2004, the default was EXTENDBOX= 3
       /KeepCenter = By default, CNTRD finds the maximum pixel in a box
              centered on the input X,Y coordinates, and then extracts a new
              box about this maximum pixel.   Set the /KeepCenter keyword
              to skip then step of finding the maximum pixel, and instead use
              a box centered on the input X,Y coordinates.
  PROCEDURE:
       Maximum pixel within distance from input pixel X, Y  determined
       from FHWM is found and used as the center of a square, within
       which the centroid is computed as the value (XCEN,YCEN) at which
       the derivatives of the partial sums of the input image over (y,x)
       with respect to (x,y) = 0.    In order to minimize contamination from
       neighboring stars stars, a weighting factor W is defined as unity in
       center, 0.5 at end, and linear in between
</p>

<p>  RESTRICTIONS:
       (1) Does not recognize (bad) pixels.   Use the procedure GCNTRD.PRO
           in this situation.
       (2) DAOPHOT now uses a newer algorithm (implemented in GCNTRD.PRO) in
           which centroids are determined by fitting 1-d Gaussians to the
           marginal distributions in the X and Y directions.
       (3) The default behavior of CNTRD changed in June 2004 (from EXTENDBOX=3
           to EXTENDBOX = 0).
       (4) Stone (1989, AJ, 97, 1227) concludes that the derivative search
           algorithm in CNTRD is not as effective (though faster) as a
            Gaussian fit (used in GCNTRD.PRO).
  MODIFICATION HISTORY:
       Written 2/25/86, by J. K. Hill, S.A.S.C., following
       algorithm used by P. Stetson in DAOPHOT.
       Allowed input vectors        G. Hennessy       April,  1992
       Fixed to prevent wrong answer if floating pt. X & Y supplied
               W. Landsman        March, 1993
       Convert byte, integer subimages to float  W. Landsman  May 1995
       Converted to IDL V5.0   W. Landsman   September 1997
       Better checking of edge of frame David Hogg October 2000
       Avoid integer wraparound for unsigned arrays W.Landsman January 2001
       Handle case where more than 1 pixel has maximum value W.L. July 2002
       Added /KEEPCENTER, EXTENDBOX (with default = 0) keywords WL June 2004
       Some errrors were returning X,Y = NaN rather than -1,-1  WL Aug 2010
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="cntrd:p:img">img <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="cntrd:p:x">x <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="cntrd:p:y">y <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="cntrd:p:xcen">xcen <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="cntrd:p:ycen">ycen <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="cntrd:p:fwhm">fwhm <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="cntrd:k:SILENT">SILENT <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="cntrd:k:DEBUG">DEBUG <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="cntrd:k:EXTENDBOX">EXTENDBOX <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="cntrd:k:KeepCenter">KeepCenter <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>245</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:21 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>