<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:27 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>fsc_psconfig__define.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="fsc_psconfig__define.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;   FSC_PSCONFIG__DEFINE</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;</span>
<span class="comments">;   The purpose of this program is to implement an object that</span>
<span class="comments">;   can keep track of--and allow the user to change--the current</span>
<span class="comments">;   configuration of the PostScript device.</span>
<span class="comments">;</span>
<span class="comments">; AUTHOR:</span>
<span class="comments">;</span>
<span class="comments">;   FANNING SOFTWARE CONSULTING</span>
<span class="comments">;   David Fanning, Ph.D.</span>
<span class="comments">;   1645 Sheely Drive</span>
<span class="comments">;   Fort Collins, CO 80526 USA</span>
<span class="comments">;   Phone: 970-221-0438</span>
<span class="comments">;   E-mail: david@idlcoyote.com</span>
<span class="comments">;   Coyote's Guide to IDL Programming: http://www.idlcoyote.com/</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;</span>
<span class="comments">;   General programming.</span>
<span class="comments">;</span>
<span class="comments">; DOCUMENTATION:</span>
<span class="comments">;</span>
<span class="comments">;   Complete documentation for the FSC_PSCONFIG object, including</span>
<span class="comments">;   keyword and method descriptions, and example programs using the object</span>
<span class="comments">;   can be found on the Coyote's Guide to IDL Programming web page:</span>
<span class="comments">;</span>
<span class="comments">;     http://www.idlcoyote.com/programs/docs/fsc_psconfig.html</span>
<span class="comments">;</span>
<span class="comments">;   Or, if you would prefer, you can download a self-contained PDF file:</span>
<span class="comments">;</span>
<span class="comments">;     http://www.idlcoyote.com/programs/docs/fsc_psconfig.pdf</span>
<span class="comments">;</span>
<span class="comments">; KEYWORDS:</span>
<span class="comments">;</span>
<span class="comments">;   Any keyword accepted by the FSC_PSCONFIG object can be used with</span>
<span class="comments">;   this program. Here are a few of the most popular keywords.</span>
<span class="comments">;</span>
<span class="comments">;   Bits_per_Pixel - The number of image bits saved for each image pixel: 2, 4, or 8. The default is 8.</span>
<span class="comments">;   Color - Set this keyword to select Color PostScript output. Turned on by default.</span>
<span class="comments">;   Decomposed - Set this keyword to 0 to select indexed color and to 1 to select decomposed color.</span>
<span class="comments">;   DefaultSetup - Set this keyword to the "name" of a default style. Current styles (you can easily</span>
<span class="comments">;     create and add your own to the source code) are the following:</span>
<span class="comments">;</span>
<span class="comments">;       "System (Portrait)" - The normal "default" system set-up. Also, "System".</span>
<span class="comments">;       "System (Landscape)" - The normal "default" landscape system set-up.</span>
<span class="comments">;       "Centered (Portrait)" - The window centered on the page. Also, "Center" or "Centered".</span>
<span class="comments">;       "Centered (Landscape)" - The window centered on the landscape page. Also, "Landscape".</span>
<span class="comments">;       "Square (Portrait)" - A square plot, centered on the page.</span>
<span class="comments">;       "Square (Landscape)" - A square plot, centered on the landscape page.</span>
<span class="comments">;       "Figure (Small)" - A small encapsulated figure size, centered on page. Also, "Encapsulated" or "Encapsulate".</span>
<span class="comments">;       "Figure (Large)" - A larger encapsulated figure size, centered on page. Also, "Figure".</span>
<span class="comments">;       "Color (Portrait)" - A "centered" plot, with color turned on. Also, "Color".</span>
<span class="comments">;       "Color (Landscape)" - A "centered" landscape plot, with color turned on.</span>
<span class="comments">;</span>
<span class="comments">;   Directory - Set this keyword to the name of the starting directory. The current directory is used by default.</span>
<span class="comments">;   Encapsulated - Set this keyword to select Encapsulated PostScript output. Turned off by default.</span>
<span class="comments">;   European - This keyword has been depreciated in favor of METRIC.</span>
<span class="comments">;   Filename - Set thie keyword to the name of the PostScript file. The default is "idl.ps".</span>
<span class="comments">;   Inches - Set this keyword to indicate sizes and offsets are in inches as opposed to centimeters. Set by Metric keyword by default.</span>
<span class="comments">;   Landscape - Set this keyword to select Landscape page output. Portrait page output is the default.</span>
<span class="comments">;   Language_Level - Set this keyword to select the Language Level interpreter. Default is 1.</span>
<span class="comments">;   Metric - Set this keyword to indicate metric mode (i.e., A4 page and centimeter units). Turned off by default.</span>
<span class="comments">;   PageType - Set this keyword to the "type" of page. Possible values are:</span>
<span class="comments">;       "Letter" - 8.5 by 11 inches. (Default, unless the Metric keyword is set.)</span>
<span class="comments">;       "Legal" - 8.5 by 14 inches.</span>
<span class="comments">;       "Ledger" - 11 by 17 inches.</span>
<span class="comments">;       "A4" - 21.0 by 29.7 centimeters. (Default, if the Metric keyword is set.)</span>
<span class="comments">;   XOffset - Set this keyword to the X Offset. Uses "System (Portrait)" defaults. (Note: offset calculated from lower-left corner of page.)</span>
<span class="comments">;   XSize - Set this keyword to the X size of the PostScript "window". Uses "System (Portrait)" defaults.</span>
<span class="comments">;   YOffset - Set this keyword to the Y Offset. Uses "System (Portrait)" defaults. (Note: offset calculated from lower-left corner of page.)</span>
<span class="comments">;   YSize - Set this keyword to the Y size of the PostScript "window". Uses "System (Portrait)" defaults.</span>
<span class="comments">;</span>
<span class="comments">;   In addition, the following keywords can be used:</span>
<span class="comments">;</span>
<span class="comments">;   CANCEL -- An output keyword that will be set to 1 if the user</span>
<span class="comments">;   chooses the Cancel button on the form. It will be 0 otherwise.</span>
<span class="comments">;</span>
<span class="comments">;   FONTINFO -- Set this keyword is you wish to have font information</span>
<span class="comments">;   appear on the form. The default is to not include font information.</span>
<span class="comments">;</span>
<span class="comments">;   FONTTYPE -- Set this keyword to a named variable that will indicate</span>
<span class="comments">;   the user's preference for font type. Values will be -1 (Hershey fonts),</span>
<span class="comments">;   0 (hardware fonts), and 1 (true-type fonts). This keyword will always</span>
<span class="comments">;   return -1 unless the FONTINFO keyword has also been set.</span>
<span class="comments">;</span>
<span class="comments">;   GROUP_LEADER -- Set this keyword to a widget identifier of the widget</span>
<span class="comments">;   you wish to be a group leader for this program.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;</span>
<span class="comments">;   A simple sequence of using the object would look something like this:</span>
<span class="comments">;</span>
<span class="comments">;     psObject = Obj_New("FSC_PSCONFIG")</span>
<span class="comments">;     psObject->GUI</span>
<span class="comments">;     psKeywords = psObject->GetKeywords()</span>
<span class="comments">;     thisDevice = !D.Name</span>
<span class="comments">;     Set_Plot, 'PS'</span>
<span class="comments">;     Device, _Extra=psKeywords</span>
<span class="comments">;     cgImage, image</span>
<span class="comments">;     Device, /Close_File</span>
<span class="comments">;     Set_Plot, thisDevice</span>
<span class="comments">;     Obj_Destroy, psObject</span>
<span class="comments">;</span>
<span class="comments">;  Note that the object can also be called from the PS_CONFIG interface:</span>
<span class="comments">;</span>
<span class="comments">;     psKeywords = PSConfig()</span>
<span class="comments">;</span>
<span class="comments">; OTHER PROGRAMS NEEDED:</span>
<span class="comments">;</span>
<span class="comments">;   The following programs are required to run this one:</span>
<span class="comments">;</span>
<span class="comments">;     fsc_droplist.pro</span>
<span class="comments">;     fsc_fileselect.pro</span>
<span class="comments">;     fsc_field.pro</span>
<span class="comments">;     fsc_plotwindow</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATIONS:</span>
<span class="comments">;</span>
<span class="comments">;   Written by David W. Fanning, 31 January 2000.</span>
<span class="comments">;   Added capability to call GUI methods when the current graphics device</span>
<span class="comments">;      doesn't support windows. Device is restored when the GUI exits. 11 May 2000. DWF.</span>
<span class="comments">;   Changed the default value for the Color keyword to 1. 16 May 2000. DWF.</span>
<span class="comments">;   Fixed a bug where filename changed when switching Setups. 8 AUG 2000. DWF.</span>
<span class="comments">;   Fixed a bug when saving setup in Landscape mode. 8 AUG 2000. DWF.</span>
<span class="comments">;   Added the ability to Get and Set the object's name via the SetProperty</span>
<span class="comments">;      and a very abbreviated GetProperty method. Also added a GetName method. 26 SEP 2000. DWF.</span>
<span class="comments">;   Fixed a problem in which the proper configuration was not restored if in Landscape mode. 20 Nov 2000. DWF.</span>
<span class="comments">;   Made a number of modifications at the request of Martin Schultz. 4 Dec 2000. DWF.</span>
<span class="comments">;   Fixed a bug when setting file  and directory names with the SetProperty method. 18 Dec 2000. DWF.</span>
<span class="comments">;   Fixed a small problem in initializing the page size properly. 3 Jan 2001. DWF.</span>
<span class="comments">;   Corrected a problem that resulted from a change to FSC_DROPLIST. 6 Jan 2001. DWF.</span>
<span class="comments">;   Added the ability to restore the font type instead of always reverting to !P.Font. 7 Jan 2001. DWF.</span>
<span class="comments">;   Increased the length of the file/directory name fields. 7 Jan 2001. DWF.</span>
<span class="comments">;   Fixed another problem with Landscape mode interacting with A4 paper size. 7 Jan 2001. DWF.</span>
<span class="comments">;   Seems I only half fixed the previous problem. :-( 26 April 2001. DWF.</span>
<span class="comments">;   Forgot to update program to reflect change in FSC_FIELD. Fixed 26 April 2001. DWF.</span>
<span class="comments">;   Changed BOOKMAN keyword to BKMAN to avoid conflict with BOOKSTYLE keyword. 26 April 2001. DWF.</span>
<span class="comments">;   Modified the System Defaults to say "None" if none is used. Improved documentation. 10 September 2001. DWF.</span>
<span class="comments">;   Added the ability to specify a filename at the same time as a Default Setup. 10 September 2001. DWF.</span>
<span class="comments">;   Fixed a small problem in not setting new page sizes appropriately. 22 May 2002. DWF.</span>
<span class="comments">;   Fixed a problem that occurred when the Accept button was not named "Accept". 6 May 2003.DWF.</span>
<span class="comments">;   Whoops! I was a bit overly agressive on that last fix. :-( 17 July 2003. DWF.</span>
<span class="comments">;   Fixed a problem with setting page types when using the DEFAULTSETUP keyword. 31 July 2003. DWF.</span>
<span class="comments">;   Fixed a problem with turning encapsulation on in the GUI. Renamed ENCAPSULATE keyword ENCAPSULATED</span>
<span class="comments">;      to avoid obvious errors. 31 July 2003. DWF.</span>
<span class="comments">;   Removed obsolete STR_SEP and replaced with STRSPLIT. 27 Oct 2004. DWF.</span>
<span class="comments">;   Now honoring EUROPEAN keyword when setting system default setups in the INIT method. 12 Nov 2004. DWF.</span>
<span class="comments">;   Added CMYK output option 24 August 2007. Assumes LANGUAGE_LEVEL=2 printer. L. Anderson.</span>
<span class="comments">;   Fixed a problem with the filename on WINDOWS computers coming back with forward slashes instead of</span>
<span class="comments">;       backward slashes. 20 May 2008. DWF.</span>
<span class="comments">;   Modified the program to return as the default, ISOLATIN1=1. 18 July 2008. DWF.</span>
<span class="comments">;   Fixed a problem with filenames when a DEFAULTSETUP was used with it. 12 Nov 2008. DWF.</span>
<span class="comments">;   Changed default window size when LANDSCAPE keyword is set. 10 April 2009. DWF.</span>
<span class="comments">;   Changed the default window size for PORTRAIT mode to be a bit larger. 10 April 2009. DWF.</span>
<span class="comments">;   Updated for IDL 7.1 and 24-bit color PostScript support. 24 May 2009. DWF.</span>
<span class="comments">;   Added PAGETYPE field to returned structure to allow PostScript page type to be determined. 8 August 2009. DWF.</span>
<span class="comments">;   Fixed a problem with 24-bit color support that allowed only IDL 7 versions to work correctly. 20 Sept 2009. DWF.</span>
<span class="comments">;   Added a LANGUAGE_LEVEL keyword. 13 Dec 2010. DWF.</span>
<span class="comments">;   Added the FONTYPE value to the keyword return structure. 14 Dec 2010. DWF.</span>
<span class="comments">;   Modified the return structure to turn landscape mode off and set offsets to zero if in </span>
<span class="comments">;        encapsulated mode. 19 Feb 2011. DWF.</span>
<span class="comments">;   Changes to handle inability to create raster files from PS encapsulated files in </span>
<span class="comments">;        landscape mode. Also removed changes of 19 Feb 2011 as no longer needed. 26 Aug 2011. DWF.</span>
<span class="comments">;   The PAGETYPE was not getting set properly in the return keywords when the Metric </span>
<span class="comments">;        option was selected on the GUI. 12 October 2011. DWF.</span>
<span class="comments">;   The program now remembers the last directory you used and will start in that</span>
<span class="comments">;       directory, unless told otherwise. 26 Oct 2011. DWF.</span>
<span class="comments">;   Parsing of full filename failing. Fixed 27 Oct 2011. DWF.</span>
<span class="comments">;-</span>

<span class="comments">;******************************************************************************************;</span>
<span class="comments">;  Copyright (c) 2008-2011, by Fanning Software Consulting, Inc.                           ;</span>
<span class="comments">;  All rights reserved.                                                                    ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Redistribution and use in source and binary forms, with or without                      ;</span>
<span class="comments">;  modification, are permitted provided that the following conditions are met:             ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;      * Redistributions of source code must retain the above copyright                    ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer.                     ;</span>
<span class="comments">;      * Redistributions in binary form must reproduce the above copyright                 ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer in the               ;</span>
<span class="comments">;        documentation and/or other materials provided with the distribution.              ;</span>
<span class="comments">;      * Neither the name of Fanning Software Consulting, Inc. nor the names of its        ;</span>
<span class="comments">;        contributors may be used to endorse or promote products derived from this         ;</span>
<span class="comments">;        software without specific prior written permission.                               ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  THIS SOFTWARE IS PROVIDED BY FANNING SOFTWARE CONSULTING, INC. ''AS IS'' AND ANY        ;</span>
<span class="comments">;  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES    ;</span>
<span class="comments">;  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT     ;</span>
<span class="comments">;  SHALL FANNING SOFTWARE CONSULTING, INC. BE LIABLE FOR ANY DIRECT, INDIRECT,             ;</span>
<span class="comments">;  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED    ;</span>
<span class="comments">;  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;         ;</span>
<span class="comments">;  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND             ;</span>
<span class="comments">;  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT              ;</span>
<span class="comments">;  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS           ;</span>
<span class="comments">;  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                            ;</span>
<span class="comments">;******************************************************************************************;</span>

FUNCTION FSC_PSCONFIG_RStrPos, Expr, SubStr, Pos

<span class="comments">; This function finds the last occurance of a substring</span>
<span class="comments">; in a string. It was made obsolete in IDL 5.3. It is</span>
<span class="comments">; provided here for backwards compatibility. It normally</span>
<span class="comments">; resides in the IDL obsolete directory.</span>

<span class="comments">; PURPOSE:</span>
<span class="comments">;  This function finds the last occurrence of a substring within</span>
<span class="comments">;  an object string. If the substring is found in the expression,</span>
<span class="comments">;  RSTRPOS returns the character position of the match, otherwise</span>
<span class="comments">;  it returns -1.</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;  String processing.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;        Result = RSTRPOS(Expr, SubStr [, Pos])</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       Expr:  The expression string in which to search for the substring.</span>
<span class="comments">;  SubStr: The substring to search for.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;  Pos:  The character position before which the search is begun.</span>
<span class="comments">;           If Pos is omitted, the search begins at the last character</span>
<span class="comments">;           of Expr.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;        Returns the position of the substring, or -1 if the</span>
<span class="comments">;   substring was not found within Expr.</span>
<span class="comments">;</span>

  ON_ERROR, 2
  N = N_PARAMS()
  if (n lt 2) then message, 'Incorrect number of arguments.'

  <span class="comments">; Is expr an array or a scalar? In either case, make a result</span>
  <span class="comments">; that matches.</span>
  if (size(expr, /n_dimensions) eq 0) then result = 0 $
  else result = make_array(dimension=size(expr,/dimensions), /INT)

  RSubStr = STRING(REVERSE(BYTE(SubStr))) <span class="comments">; Reverse the substring</span>

  for i = 0, n_elements(expr) - 1 do begin
    Len = STRLEN(Expr[i])
    IF (N_ELEMENTS(Pos) EQ 0) THEN Start=0 ELSE Start = Len - Pos

    RString = STRING(REVERSE(BYTE(Expr[i]))) <span class="comments">; Reverse the string</span>

    SubPos = STRPOS(RString, RSubStr, Start)
    IF SubPos NE -1 THEN SubPos = Len - SubPos - STRLEN(SubStr)
    result[i] = SubPos
  endfor

  RETURN, result
END <span class="comments">;-------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG_CenterTLB, tlb

<span class="comments">; This procedure centers the given top-level base on the display.</span>

   <span class="comments">; Get the screen size and find its center.</span>

screenSize = Get_Screen_Size()
IF screenSize[0] GT 2000 THEN screenSize[0] = screenSize[0]/2 <span class="comments">; Dual monitors.</span>
xCenter = screenSize(0) / 2
yCenter = screenSize(1) / 2

   <span class="comments">; Get the size of the widget program and calculate a half-size.</span>

geom = Widget_Info(tlb, /Geometry)
xHalfSize = geom.Scr_XSize / 2
yHalfSize = geom.Scr_YSize / 2

   <span class="comments">; Position the widget program on the display.</span>

Widget_Control, tlb, XOffset = xCenter-xHalfSize, $
   YOffset = yCenter-yHalfSize

END <span class="comments">;-------------------------------------------------------------------------</span>



FUNCTION FSC_PSCONFIG_Error_Message, theMessage, Traceback=traceback, $
   NoName=noName

<span class="comments">; Handles program errors.</span>

On_Error, 2

   <span class="comments">; Check for presence and type of message.</span>

IF N_Elements(theMessage) EQ 0 THEN theMessage = !Error_State.Msg
s = Size(theMessage)
messageType = s[s[0]+1]
IF messageType NE 7 THEN BEGIN
   Message, "The message parameter must be a string."
ENDIF

   <span class="comments">; Get the call stack and the calling routine's name.</span>

Help, Calls=callStack
callingRoutine = (StrSplit(StrCompress(callStack[1])," ", /Extract))[0]

   <span class="comments">; Are widgets supported? Doesn't matter in IDL 5.3 and higher.</span>

widgetsSupported = ((!D.Flags AND 65536L) NE 0) OR Float(!Version.Release) GE 5.3
IF widgetsSupported THEN BEGIN
   IF Keyword_Set(noName) THEN answer = Dialog_Message(theMessage) ELSE BEGIN
      IF StrUpCase(callingRoutine) EQ "$MAIN$" THEN answer = Dialog_Message(theMessage) ELSE $
         answer = Dialog_Message(StrUpCase(callingRoutine) + ": " + theMessage)
   ENDELSE
ENDIF ELSE BEGIN
      Message, theMessage, /Continue, /NoPrint, /NoName, /NoPrefix
      Print, '%' + callingRoutine + ': ' + theMessage
      answer = 'OK'
ENDELSE

   <span class="comments">; Provide traceback information if requested.</span>

IF Keyword_Set(traceback) THEN BEGIN
   Help, /Last_Message, Output=traceback
   FOR j=0,N_Elements(traceback)-1 DO Print, traceback[j]
ENDIF

RETURN, answer
END <span class="comments">;---------------------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG_Events, event

<span class="comments">; This is the main event hander for the program. Its purpose</span>
<span class="comments">; is to dispatch events to the appropriate event handler</span>
<span class="comments">; methods by parsing the user value of the widget causing</span>
<span class="comments">; the event.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message()
   RETURN
ENDIF

   <span class="comments">; Get the instructions from the widget causing the event and</span>
   <span class="comments">; act on them.</span>

thisEvent = Tag_Names(event, /Structure_Name)
CASE thisEvent OF

   'FSC_DROPLIST_EVENT' : BEGIN
         Widget_Control, event.id, Get_UValue=instructions
      ENDCASE

   'FSC_FIELD_EVENT': BEGIN
         Widget_Control, event.id, Get_UValue=instructions
      ENDCASE

   'WIDGET_BUTTON': BEGIN
         Widget_Control, event.id, Get_UValue=instructions
      ENDCASE

   'WIDGET_DRAW': BEGIN
         Widget_Control, event.id, Get_UValue=instructions
      ENDCASE

   ELSE: BEGIN <span class="comments">; FSC_PLOTWINDOW events.</span>
         Widget_Control, event.id, Get_UValue=object
         instructions = object->GetUValue()
      ENDCASE

ENDCASE

   <span class="comments">; Turn the status light to OFF, if necessary.</span>

IF instructions.method NE 'HELP' AND instructions.method NE 'REVERT' $
   AND instructions.method NE 'ACCEPT' THEN instructions.object->StatusLight, 0
IF instructions.method NE 'NULL' THEN $
   Call_Method, instructions.method, instructions.object, event

END <span class="comments">;--------------------------------------------------------------------------------</span>



FUNCTION FSC_PSCONFIG_Normalize, range, Position=position

<span class="comments">; The program creates a scaling and translating factor for</span>
<span class="comments">; positioning objects in the view coordinate system.</span>

On_Error, 1
IF N_Params() EQ 0 THEN Message, 'Please pass range vector as argument.'

IF (N_Elements(position) EQ 0) THEN position = [0.0, 1.0] ELSE $
    position=Float(position)
range = Float(range)

scale = [((position[0]*range[1])-(position[1]*range[0])) / $
    (range[1]-range[0]), (position[1]-position[0])/(range[1]-range[0])]

RETURN, scale
END <span class="comments">;-------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG_Help_Event, event

<span class="comments">; Destroy the HELP widget window.</span>

Widget_Control, event.top, /Destroy
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG_Restore_Device, id
Widget_Control, id, Get_UValue=thisDevice
Set_Plot, thisDevice
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::Accept, event

<span class="comments">; This method handles the event from the ACCEPT or APPLY buttons.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

   <span class="comments">; Get all the values from the form and load the appropriate</span>
   <span class="comments">; self fields.</span>

self.cancel = 0
self.pageTypeSet = self.pageTypeID->GetSelection()
self.landscapeSet = self.orientationID->GetIndex()
self.inchesSet = self.unitsID->GetIndex()
self.cmykSet = self.cmykID->GetIndex()
self.colorSet = self.colorID->GetIndex()
self.encapsulationSet = self.encapsulationID->GetIndex()
self.langLevelSet = self.langLevelID->GetSelection()
self.previewSet = self.previewID->GetIndex()
IF self.encapsulationSet EQ 0 THEN self.previewSet = 0
self.bitsSet = self.bitsID->GetSelection()
IF Float(!Version.Release) GE 7.1 THEN self.decomposedSet = self.decomposedID->GetIndex()

IF N_Elements(self.xsizeID->Get_Value()) EQ 0 THEN BEGIN
   IF self.inchesSet THEN xsize = 1.0 ELSE xsize = 2.54
   self.xsizeID->Set_Value, xsize
ENDIF ELSE xsize = self.xsizeID->Get_Value()
self.xsizeSet = xsize

IF N_Elements(self.ysizeID->Get_Value()) EQ 0 THEN BEGIN
   IF self.inchesSet THEN ysize = 1.0 ELSE ysize = 2.54
   self.ysizeID->Set_Value, ysize
ENDIF ELSE ysize = self.ysizeID->Get_Value()
self.ysizeSet = ysize

IF N_Elements(self.xoffsetID->Get_Value()) EQ 0 THEN BEGIN
   xoffset = 0.0
   self.xoffsetID->Set_Value, xoffset
ENDIF ELSE xoffset = self.xoffsetID->Get_Value()
self.xoffsetSet = xoffset

IF N_Elements(self.yoffsetID->Get_Value()) EQ 0 THEN BEGIN
   yoffset = 0.0
   self.yoffsetID->Set_Value, yoffset
ENDIF ELSE yoffset = self.yoffsetID->Get_Value()
self.yoffsetSet = yoffset

self.plotID->SetWindowLocation, xsize, ysize, xoffset, yoffset

   <span class="comments">; Get the font information if it is on the form.</span>

IF self.fontInfo THEN BEGIN
   <span class="comments">;fonttype = self.fontTypeID->GetIndex()</span>
   <span class="comments">;self.fonttypeSet = fonttype - 1</span>
   self.fontsizeSet = self.fontsizeID->GetSelection()

   values = self.fontnameID->GetValues()
   selection = self.fontnameID->GetSelection()
   IF StrUpCase(selection) EQ 'AVANTGARDE' THEN self.AVANTGARDE = 1 ELSE self.AVANTGARDE = 0
   IF StrUpCase(selection) EQ 'BOOKMAN' THEN self.BOOKMAN = 1 ELSE self.BOOKMAN = 0
   IF StrUpCase(selection) EQ 'COURIER' THEN self.COURIER = 1 ELSE self.COURIER = 0
   IF StrUpCase(selection) EQ 'HELVETICA' THEN self.HELVETICA = 1 ELSE self.HELVETICA = 0
   IF StrUpCase(selection) EQ 'PALATINO' THEN self.PALATINO = 1 ELSE self.PALATINO = 0
   IF StrUpCase(selection) EQ 'SCHOOLBOOK' THEN self.SCHOOLBOOK = 1 ELSE self.SCHOOLBOOK = 0
   IF StrUpCase(selection) EQ 'SYMBOL' THEN self.SYMBOL = 1 ELSE self.SYMBOL = 0
   IF StrUpCase(selection) EQ 'TIMES' THEN self.TIMES = 1 ELSE self.TIMES = 0
   IF StrUpCase(selection) EQ 'ZAPFCHANCERY' THEN self.ZAPFCHANCERY = 1 ELSE self.ZAPFCHANCERY = 0
   IF StrUpCase(selection) EQ 'ZAPFDINGBATS' THEN self.ZAPFDINGBATS = 1 ELSE self.ZAPFDINGBATS = 0
   index = Where(StrUpCase(values) EQ StrUpCase(selection))
   self.fontnameSet = values[index[0]]

   self.isolatinSet = self.isolatinID->GetIndex()
   IF Obj_Valid(self.set_fontID) THEN self.set_fontSet = self.Set_FontID->Get_Value()
   self.truetypeSet = self.truetypeID->GetIndex()
   self.fontTypeSet = self.fontTypeID->GetIndex() - 1
ENDIF

   <span class="comments">; Get the filename information.</span>

self.filenameID->GetProperty, File=filename, Directory=directory

<span class="comments">; Save the name of the directory, if you can.</span>
DEFSYSV, '!cgPostScript_LastDir', EXISTS=exists
IF exists THEN BEGIN
    IF File_Test(directory, /DIRECTORY) THEN !cgPostScript_LastDir = directory 
ENDIF ELSE BEGIN
    IF File_Test(directory, /DIRECTORY) THEN DEFSYSV, '!cgPostScript_LastDir', directory
ENDELSE
self.filenameSet = filename
self.directorySet = directory
self.fullFilenameSet=self.filenameID->GetFileName()

   <span class="comments">; If this is WINDOWS, then forward slashes need to be converted to backward slashes.</span>
   
IF StrUpCase(!Version.OS_FAMILY) EQ 'WINDOWS' THEN BEGIN
   self.directorySet = StrJoin( StrSplit(self.directorySet, '/', /Regex, /Extract, /Preserve_Null), '\')
   self.fullFilenameSet = StrJoin( StrSplit(self.fullFilenameSet, '/', /Regex, /Extract, /Preserve_Null), '\')
ENDIF

   <span class="comments">; Set the status light if this is the APPLY button</span>

Widget_Control, event.id, Get_UValue=buttonInfo
IF N_Elements(buttonInfo) NE 0 THEN $
   IF buttonInfo.method EQ 'APPLY' THEN self->StatusLight, 1

   <span class="comments">; Save this configuration.</span>

self->SaveConfiguration

   <span class="comments">; Destroy the widget if this is a modal widget.</span>

IF N_Elements(buttonInfo) NE 0 THEN $
   IF buttonInfo.method EQ 'ACCEPT' AND Widget_Info(self.tlb, /Valid_ID) THEN BEGIN
   Widget_Control, self.tlb, /Destroy
   self.noblock = 0
ENDIF

END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::Cancel, event

<span class="comments">; If the cancel button was clicked, set the cancel flag to 1 and</span>
<span class="comments">; destroy the widget.</span>

self.cancel = 1
self.noblock = 0
Widget_Control, event.top, /Destroy
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::ClearStyles, event

<span class="comments">; This event handler method responds to the Clear button by setting</span>
<span class="comments">; turning all the font style buttons off..</span>

self->UpDateFontStyle, /Clear
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::Color, event

<span class="comments">; This event handler method responds to changes in the Color droplist.</span>


self.plotID->SetColor, event.index

<span class="comments">; Set sensitivity of cmyk button</span>

self.cmykID->Sensitive, event.index
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::CMYK, event

<span class="comments">; This event handler method responds to changes in the CMYK droplist.</span>

<span class="comments">; If event.index is 1, set the Language Level to 2, otherwise to 1.</span>
IF event.index EQ 1 $
    THEN self.langLevelID->SetSelection, 2 $
    ELSE self.langLevelID->SetSelection, 1

END <span class="comments">;--------------------------------------------------------------------------------</span>



FUNCTION FSC_PSCONFIG::Construct_Full_Filename

<span class="comments">; This method returns the fully-qualified filename. Checks to be</span>
<span class="comments">; sure the last character in the directory name is not a directory</span>
<span class="comments">; specifier.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN, ""
ENDIF

   <span class="comments">; Get the correct directory separator.</span>

CASE StrUpCase(!Version.OS_Family) OF
   'WINDOWS' : sep = '\'    <span class="comments">; PCs</span>
   'MACOS'   : sep = ':'    <span class="comments">; Macintoshes</span>
   'VMS'     : sep = ']'    <span class="comments">; VMS machines</span>
   ELSE      : sep = '/'    <span class="comments">; Unix machines</span>
ENDCASE

IF StrUpCase(!Version.OS_Family) NE "VMS" THEN BEGIN
   length = StrLen(self.directorySet)
   WHILE StrMid(self.directorySet, length-1, 1) EQ sep DO BEGIN
      self.directorySet = StrMid(self.directorySet, 0, length-1)
      length = StrLen(self.directorySet)
   ENDWHILE
ENDIF

RETURN, Filepath(Root_Dir=self.directorySet, self.filenameSet)
END <span class="comments">;-------------------------------------------------------------------------------</span>



FUNCTION FSC_PSCONFIG::DefaultList

<span class="comments">; This method defines the default settings values in the Defaults droplist.</span>
<span class="comments">; To add your own defaults, start by adding the new default name here. Then</span>
<span class="comments">; add your default setup to the SetDefault method below.</span>

defaultlist = [ 'None', $
                'System (Portrait)', $
                'System (Landscape)', $
                'Centered (Portrait)', $
                'Centered (Landscape)', $
                'Square (Portrait)', $
                'Square (Landscape)', $
                'Figure (Small)', $
                'Figure (Large)', $
                'Color (Portrait)', $
                'Color (Landscape)' ]

RETURN, defaultList
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::Defaults, event

<span class="comments">; This event handler method responds to changes in the Defaults droplist.</span>

self->SetDefault, *event.selection
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::Encapsulate, event

<span class="comments">; This method responds to a change in the Encapsulation droplist widget.</span>
IF event.index THEN BEGIN
    self.previewID->Sensitive, 1 
    self.landscapeSet = 0
    self.encapsulationSet = 1
    self->UpdateDisplay
    self.orientationID->Sensitive, 0
    
ENDIF ELSE BEGIN
    self.previewID->Sensitive, 0
    self.encapsulationSet = 0
    self->UpdateDisplay
    self.orientationID->Sensitive, 1
ENDELSE

END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::FontType, event

<span class="comments">; This event handler method responds to changes in the Font Type droplist.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

   <span class="comments">; Font styles, etc. can only be on if hardware or</span>
   <span class="comments">; true-type fonts are selected.</span>

CASE event.index OF

   0: BEGIN
   Widget_Control, self.fontnameID->GetID(), Sensitive=0
   Widget_Control, self.stylebaseID, Sensitive=0
   Widget_Control, self.clearbuttonID, Sensitive=0
   Widget_Control, self.fontSizeID->GetID(), Sensitive=0
   Widget_Control, self.truetypeID->GetID(), Sensitive=0
   Widget_Control, self.isolatinID->GetID(), Sensitive=0
   IF Obj_Valid(self.set_fontID) THEN Widget_Control, self.set_fontID->GetID(), Sensitive=0
   ENDCASE

   ELSE: BEGIN
   Widget_Control, self.fontnameID->GetID(), Sensitive=1
   Widget_Control, self.stylebaseID, Sensitive=1
   Widget_Control, self.clearbuttonID, Sensitive=1
   Widget_Control, self.fontSizeID->GetID(), Sensitive=1
   Widget_Control, self.truetypeID->GetID(), Sensitive=1
   Widget_Control, self.isolatinID->GetID(), Sensitive=1
   IF Obj_Valid(self.set_fontID) THEN Widget_Control, self.set_fontID->GetID(), Sensitive=1
   ENDCASE

ENDCASE

fontname = *event.selection
CASE StrUpCase(fontname) OF
   "TRUE-TYPE": BEGIN
      self.truetypeID->SetIndex, 1
      self.trueTypeSet = 1
      self.fontTypeSet = 1
   ENDCASE
   "HARDWARE" : BEGIN
      self.trueTypeSet = 0
      self.fontTypeSet = 0
      ENDCASE
   ELSE: BEGIN
      self.trueTypeSet = 0
      self.fontTypeSet = -1
      self.truetypeID->SetIndex, 0
   ENDCASE
ENDCASE

END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::MetricStyle, event

<span class="comments">; This event handler sets and unset the "Metric Style" button.</span>

IF event.select EQ 1 THEN BEGIN

   Widget_Control, event.top, Update=0
   self.metric = 1
   IF self.inchesSet EQ 1 THEN BEGIN
      sizes = self->GetSizes()
      self.xsizeSet = sizes[0] * 2.54
      self.ysizeSet = sizes[1] * 2.54
      self.xoffsetSet = sizes[2] * 2.54
      self.yoffsetSet = sizes[3] * 2.54
   ENDIF
   self.inchesSet = 0
   self.pageTypeSet = 'A4'
   self.pageType = 'A4'
   self.plotID->SetUnits, 'Centimeters'
   Widget_Control, event.top, Update=1

ENDIF ELSE BEGIN

   Widget_Control, event.top, Update=0
   self.metric = 0
   IF self.inchesSet EQ 0 THEN BEGIN
      sizes = self->GetSizes()
      self.xsizeSet = sizes[0] / 2.54
      self.ysizeSet = sizes[1] / 2.54
      self.xoffsetSet = sizes[2] / 2.54
      self.yoffsetSet = sizes[3] / 2.54
   self.inchesSet = 1
   self.pageType = 'LETTER'
   self.pageTypeSet = 'LETTER'
   self.plotID->SetUnits, 'Inches'
   Widget_Control, event.top, Update=1

   ENDIF

ENDELSE
self->UpdateDisplay
self.plotID->CenterPlot
END <span class="comments">;--------------------------------------------------------------------------------</span>



FUNCTION FSC_PSCONFIG::GetKeywords, FontType=fonttype

<span class="comments">; This method creates and returns a structure with the PostScript Device</span>
<span class="comments">; keywords as fields in the structure.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN, {Cancel:1}
ENDIF

  <span class="comments">; I am shielding the user from the strangeness of PostScript</span>
  <span class="comments">; Landscape mode, in which the X and Y offsets are rotated</span>
  <span class="comments">; 180 degrees. Thus, in the form, the offsets are calculated from</span>
  <span class="comments">; the lower-left corner in both Landscape and Portrait mode.</span>
  <span class="comments">; This means I have to monkey around to get the proper offsets</span>
  <span class="comments">; if the form is in Landscape mode.</span>

IF self.landscapeSet EQ 1 THEN BEGIN
    pageDims = self->PageDimensions()
       <span class="comments">; Switch x and y offsets</span>
    yoffset = pageDims[1] - self.xoffsetSet
    xoffset = self.yoffsetSet
ENDIF ELSE BEGIN
    xoffset = self.xoffsetSet
    yoffset = self.yoffsetSet
ENDELSE


filename = self -> Construct_Full_Filename()

   <span class="comments">; Create the basic structure.</span>

struct = { $
   bits_per_pixel: Fix(self.bitsSet), $
   cmyk: self.cmykSet, $
   color: self.colorSet, $
   encapsulated: self.encapsulationSet, $
   filename: filename, $
   font_size: Fix(self.fontSizeSet), $
   inches: self.inchesSet, $
   isolatin1: self.isolatinSet, $
   language_level: self.langLevelSet, $
   preview: self.previewSet, $
   tt_font: self.truetypeSet, $
   xoffset: xoffset, $
   xsize: self.xsizeSet, $
   yoffset: yoffset, $
   ysize: self.ysizeSet, $
   pagetype: StrUpCase(self.pageType), $
   fonttype: self.fonttypeSet}

   <span class="comments">; Addition of CMYK keyword implies LANGUAGE_LEVEL keyword set to 2.</span>
   
IF self.cmykSet THEN struct.language_level = 2
   
   <span class="comments">; Can add DECOMPOSED keyword if IDL 7.1 and higher.</span>
IF Float(!Version.Release) GE 7.1 THEN struct = Create_Struct(struct, 'decomposed', self.decomposedSet)

   <span class="comments">; Return the font type information to the user.</span>

fonttype = self.fonttypeSet

   <span class="comments">; Depending upon which widgets are set, we have to add</span>
   <span class="comments">; additional fields to the structure.</span>

IF self.landscapeSet THEN BEGIN
   struct = Create_Struct(struct, 'landscape', 1)
   struct = Create_Struct(struct, 'portrait', 0)
ENDIF ELSE BEGIN
   struct = Create_Struct(struct, 'portrait', 1)
   struct = Create_Struct(struct, 'landscape', 0)
ENDELSE
IF self.set_fontSet NE "" THEN struct = Create_Struct(struct, 'set_font', self.set_font)

   <span class="comments">; What about font keywords?</span>

IF self.avantgarde THEN struct = Create_Struct(struct, 'avantgarde', 1)
IF self.bookman THEN struct = Create_Struct(struct, 'bkman', 1)
IF self.courier THEN struct = Create_Struct(struct, 'courier', 1)
IF self.helvetica THEN struct = Create_Struct(struct, 'helvetica', 1)
IF self.palatino THEN struct = Create_Struct(struct, 'palatino', 1)
IF self.schoolbook THEN struct = Create_Struct(struct, 'schoolbook', 1)
IF self.symbol THEN struct = Create_Struct(struct, 'symbol', 1)
IF self.times THEN struct = Create_Struct(struct, 'times', 1)
IF self.zapfdingbats THEN struct = Create_Struct(struct, 'zapfdingbats', 1)
IF self.zapfchancery THEN struct = Create_Struct(struct, 'zapfchancery', 1)

   <span class="comments">; What about style keywords?</span>

IF self.fontStyleSet[0] THEN struct = Create_Struct(struct, 'bold', 1) ELSE struct = Create_Struct(struct, 'bold', 0)
IF self.fontStyleSet[1] THEN struct = Create_Struct(struct, 'book', 1) ELSE struct = Create_Struct(struct, 'book', 0)
IF self.fontStyleSet[2] THEN struct = Create_Struct(struct, 'demi', 1) ELSE struct = Create_Struct(struct, 'demi', 0)
IF self.fontStyleSet[3] THEN struct = Create_Struct(struct, 'italic', 1) ELSE struct = Create_Struct(struct, 'italic', 0)
IF self.fontStyleSet[4] THEN struct = Create_Struct(struct, 'light', 1) ELSE struct = Create_Struct(struct, 'light', 0)
IF self.fontStyleSet[5] THEN struct = Create_Struct(struct, 'medium', 1) ELSE struct = Create_Struct(struct, 'medium', 0)
IF self.fontStyleSet[6] THEN struct = Create_Struct(struct, 'narrow', 1) ELSE struct = Create_Struct(struct, 'narrow', 0)
IF self.fontStyleSet[7] THEN struct = Create_Struct(struct, 'oblique', 1) ELSE struct = Create_Struct(struct, 'oblique', 0)

<span class="comments">; If the user is doing encapsulated PostScript, then landscape mode must be off and</span>
<span class="comments">; offsets must be set to zero.</span>
<span class="comments">;IF struct.encapsulated THEN BEGIN</span>
<span class="comments">;</span>
<span class="comments">;    struct.portrait = 1</span>
<span class="comments">;    struct.landscape = 0</span>
<span class="comments">;    struct.xoffset = 0</span>
<span class="comments">;    struct.yoffset = 0</span>
<span class="comments">;</span>
<span class="comments">;ENDIF</span>

   <span class="comments">; Return the keyword stucture.</span>

RETURN, struct
END <span class="comments">;--------------------------------------------------------------------------------</span>




FUNCTION FSC_PSConfig::GetName

<span class="comments">; This method returns the "name" of the object.</span>

RETURN, self.name
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSConfig::GetProperty, Name=name

<span class="comments">; This GetProperty method is set up only to be able to obtain</span>
<span class="comments">; the name of the object. This makes the object compatible with</span>
<span class="comments">; Martin Shultz's container object. All other keywords are swallowed</span>
<span class="comments">; silently. Note that the GetName method can also be used.</span>

name = self.name
END <span class="comments">;--------------------------------------------------------------------------------</span>



FUNCTION FSC_PSCONFIG::GetSizes

RETURN, [self.xsizeID->Get_Value(), self.ysizeID->Get_Value(), $
   self.xoffsetID->Get_Value(), self.yoffsetID->Get_Value()]
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::GUI, Group_Leader=leader, NoBlock=noblock, Cancel=cancel, $
   FontInfo=fontinfo, Accept_Button_Name=acceptButtonName, FontType=fonttype

<span class="comments">; This method displays the graphical user interface without font information.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

   <span class="comments">; Can't run this program in a device that doesn't support windows.</span>

self.thisDevice = !D.Name
IF (!D.Flags AND 256) EQ 0 THEN BEGIN
   thisOS = StrUpCase(!Version.OS_Family)
   CASE thisOS OF
      'MACOS': Set_Plot, 'Mac'
      'WINDOWS': Set_Plot, 'Win'
      ELSE: Set_Plot, 'X'
   ENDCASE
ENDIF

   <span class="comments">; If the user wants font information, then call the GUIFont method.</span>

IF Keyword_Set(fontinfo) THEN BEGIN
   self->GUIFont, Group_Leader=leader, NoBlock=noblock, Cancel=cancel, $
      Accept_Button_Name=acceptButtonName, FontType=fonttype
   RETURN
ENDIF

IF N_Elements(acceptButtonName) EQ 0 THEN BEGIN
   IF Keyword_Set(noblock) THEN BEGIN
      acceptButtonName = 'Apply'
   ENDIF ELSE BEGIN
      acceptButtonName = 'Accept'
   ENDELSE
ENDIF

   <span class="comments">; Only one GUI at a time with the same name.</span>

IF XRegistered('fsc_psconfig_' + self.name) GT 0 THEN RETURN

   <span class="comments">;Set default values.</span>

self.fontInfo = 0
CW_FIELD_SIZE = 5
IF Keyword_Set(noblock) THEN BEGIN
   cancelButVal = 'Dismiss'
ENDIF ELSE BEGIN
   cancelButVal = 'Cancel'
ENDELSE

self.fontTypeSet = !P.Font
IF Keyword_Set(noblock) THEN self.cancel = 0 ELSE self.cancel = 1

   <span class="comments">; Modal TLB if possible.</span>

IF self.name NE "" THEN tlbTitle = self.name + ": Configure PostScript Device" ELSE $
   tlbTitle = "Configure PostScript Device"

IF N_Elements(leader) EQ 0 OR Keyword_Set(noblock) THEN BEGIN
   tlb = Widget_Base(Title=tlbTitle, Column=1, BASE_ALIGN_CENTER=1)
ENDIF ELSE BEGIN
   tlb = Widget_Base(Title=tlbTitle, Column=1, $
      Group_Leader=leader, /Modal, BASE_ALIGN_CENTER=1)
ENDELSE

self.tlb = tlb

   <span class="comments">; Widget sub-bases.</span>

   topBase = Widget_Base(tlb, Row=1, UValue=self.thisDevice, $
    Kill_Notify='FSC_PSConfig_Restore_Device', BASE_ALIGN_TOP=1)
    
      leftTopBase = Widget_Base(topBase, Column=1)
         bbbase = Widget_Base(leftTopBase)
         l = Widget_Label(bbbase, value=' Properties ', xoffset=5)
         lgeo    = widget_info(l, /geometry) 
         controlBase = Widget_Base(bbbase, Column=1, /Frame, YOffset=lgeo.ysize/2, YPAD=10, XPAD=10)
         l = Widget_Label(bbbase, value=' Properties ', xoffset=5)
         
      middleTopBase = Widget_Base(topBase, Column=1, BASE_ALIGN_LEFT=1)
   
   <span class="comments">; Create droplist widgets.</span>

values = ['Letter', 'A4', 'Legal', 'Ledger']
self.pageTypeID = FSC_Droplist(controlBase, Value=values, Title='Page Size:', $
   UValue={Method:'PageSize', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.pageTypeID->SetSelection, self.pageTypeSet
self.pagetype = self.pageTypeSet

values = ['Portrait', 'Landscape']
self.orientationID = FSC_Droplist(controlBase, Value=values, Title='Orientation:', $
   UValue={Method:'Orientation', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.orientationID->SetIndex, self.landscapeSet
IF self.encapsulationSet THEN self.orientationID -> Sensitive, 0

values = ['Centimeters', 'Inches']
self.unitsID = FSC_Droplist(controlBase, Value=values, Title='Units:', $
   UValue={Method:'Units', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.unitsID->SetIndex, self.inchesSet

values = ['Off', 'On']
self.encapsulationID = FSC_Droplist(controlBase, Value=values, Title='Encapsulation:', $
   UValue={Method:'ENCAPSULATE', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.encapsulationID->SetIndex, self.encapsulationSet

values = ['None', 'Bitmap Preview', 'TIFF Preview']
self.previewID = FSC_Droplist(controlBase, Value=values, Title='Preview Mode:', $
   UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.previewID->SetIndex, self.previewSet

values = ['Off', 'On']
self.colorID = FSC_Droplist(controlBase, Value=values, Title='Color Output:', $
   UValue={Method:'COLOR', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.colorID->SetIndex, self.colorSet

values = ['Off', 'On']
self.cmykID = FSC_Droplist(controlBase, Value=values, Title = 'CMYK Output:', $
    UValue={Method:'CMYK', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.cmykID->SetIndex, self.cmykSet
IF ~self.colorset THEN self.cmykID->Sensitive, 0

values = ['1','2']
self.langlevelID = FSC_Droplist(controlBase, Value=values, Title = 'Language Level:', $
    UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.langlevelID->SetSelection, self.langlevelSet


values = ['8', '4', '2']
self.bitsID = FSC_Droplist(controlBase, Value=values, Title='Bits Per Image Pixel:', $
   UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.bitsID->SetSelection, self.bitsSet

IF Float(!Version.Release) GE 7.1 THEN BEGIN
    values = ['Off', 'On']
    self.decomposedID = FSC_Droplist(controlBase, Value=values, Title = 'Color Decomposition:', $
        UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
    self.decomposedID->SetIndex, self.decomposedSet
    self.bitsID->SetSelection, 8
    self.colorID->SetIndex, 1
    self.colorSet = 1
ENDIF

values = self->DefaultList()
self.defaultsID = FSC_Droplist(controlBase, Value=values, Title='Setups:', $
   UValue={Method:'DEFAULTS', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.defaultsID->SetSelection, self.defaultsSet

euroBase = Widget_Base(controlBase, row=1, /NonExclusive)
euroSetUPID = Widget_Button(euroBase, Value='Metric Style', UValue={Method:'METRICSTYLE', Object:self})
IF self.metric THEN Widget_Control, euroSetUpID, /Set_Button
IF self.inchesSet THEN unit = 'INCHES' ELSE unit = 'CENTIMETERS'

windowDims = self->PageDimensions()
shortside = Min(windowDims, Max=longside)
IF self.landscapeSet THEN BEGIN
   windowsize = [self.xoffsetSet/longside, self.yoffsetSet/shortside, $
      self.xsizeSet/longside + self.xoffsetSet/longside, self.ysizeSet/shortside + self.yoffsetSet/shortside]
ENDIF ELSE BEGIN
   windowsize = [self.xoffsetSet/shortside, self.yoffsetSet/longside, $
      self.xsizeSet/shortside + self.xoffsetSet/shortside, self.ysizeSet/longside + self.yoffsetSet/longside]
ENDELSE

   <span class="comments">; Create directions widgets.</span>

directionBase = Widget_Base(middleTopBase, Column=1, SPACE=10)
bbbase = Widget_Base(directionBase)
l = Widget_Label(bbbase, value=' Directions ', xoffset=5)
lgeo    = widget_info(l, /geometry) 
labelBase = Widget_Base(bbbase, Column=1, /Frame, YOffset=lgeo.ysize/2, YPAD=10, XPAD=10, Base_Align_Center=1)
l = Widget_Label(bbbase, value=' Directions ', xoffset=5)
label = Widget_Label(labelBase, Value='Move or resize the PostScript "plot" on the', /Align_Left)
label = Widget_Label(labelBase, Value='page with left or right buttons. Click the middle', /Align_Left)
label = Widget_Label(labelBase, Value='button in the window to center plot on the page.', /Align_Left)

   <span class="comments">; Create size and offset windows.</span>
   
sizebase = Widget_Base(middleTopBase, Column=1, SPACE=10)
bbbase = Widget_Base(sizebase)
l = Widget_Label(bbbase, value=' Page Size ', xoffset=5)
lgeo    = widget_info(l, /geometry) 
sizeitBase = Widget_Base(bbbase, Column=2, /Frame, YOffset=lgeo.ysize/2, YPAD=10, XPAD=10)
l = Widget_Label(bbbase, value=' Page Size ', xoffset=5)
xsizeID = FSC_Field(sizeitBase, Title=' X Size: ', Value=self.xsizeSet, Object=xsizeObj, $
   /Float, XSize=CW_FIELD_SIZE, Decimal=2, /CR_Only, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'WINDOWSIZE', Object:self}, /Positive, /Label_Left)
self.xsizeID = xsizeObj
ysizeID = FSC_Field(sizeitBase, Title=' Y Size: ', Value=self.ysizeSet, Object=ysizeObj, $
   /Float, XSize=CW_FIELD_SIZE, Decimal=2, /CR_Only, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'WINDOWSIZE', Object:self}, /Positive, /Label_Left)
self.ysizeID = ysizeObj

xoffsetID = FSC_Field(sizeitBase, Title=' X Offset: ', Value=self.xoffsetSet, Object=xoffsetObj, $
   /Float, XSize=CW_FIELD_SIZE, Decimal=2, /CR_Only, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'WINDOWSIZE', Object:self}, /Positive, /Label_Left)
self.xoffsetID = xoffsetObj

yoffsetID = FSC_Field(sizeitBase, Title=' Y Offset: ', Value=self.yoffsetSet, Object=yoffsetObj, $
   /Float, XSize=CW_FIELD_SIZE, Decimal=2, /CR_Only, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'WINDOWSIZE', Object:self}, /Positive, /Label_Left)
self.yoffsetID = yoffsetObj

   <span class="comments">; Set up TABing between fields.</span>

self.xsizeID->SetTabNext, self.ysizeID->GetTextID()
self.ysizeID->SetTabNext, self.xoffsetID->GetTextID()
self.xoffsetID->SetTabNext, self.yoffsetID->GetTextID()
self.yoffsetID->SetTabNext, self.xsizeID->GetTextID()

   <span class="comments">; Create filename widgets.</span>

fileBase = Widget_base(middleTopBase, Row=1)
         bbbase = Widget_Base(fileBase)
         l = Widget_Label(bbbase, value=' Filename ', xoffset=5)
         lgeo    = widget_info(l, /geometry) 
         filenameBase = Widget_Base(bbbase, Column=1, /Frame, YOffset=lgeo.ysize/2, YPAD=5)
         l = Widget_Label(bbbase, value=' Filename ', xoffset=5)

dummy = FSC_FileSelect(filenameBase, Filename=self.filenameSet, $
   Directory=self.directorySet, XSIZE=30, ObjectRef=filenameID)
self.filenameID = filenameID

geo = Widget_Info(filenameBase, /GEOMETRY)
Widget_Control, labelbase, XSIZE=geo.scr_xsize
Widget_Control, sizeitbase, XSIZE=geo.scr_xsize


   <span class="comments">; Create the plot window.</span>
rightTopBase = Widget_Base(topBase, Column=1, Base_Align_Center=1)
IF StrUpCase(!VERSION.OS_FAMILY) EQ 'WINDOWS' THEN BEGIN
   bbbase = Widget_Base(rightTopBase)
   thisLabel = ' Interactive Plot Placement' 
   l = Widget_Label(bbbase, value=thisLabel, xoffset=5)
   lgeo    = widget_info(l, /geometry) 
   plotBase = Widget_Base(bbbase, Column=1, /Frame, YOffset=lgeo.ysize/2, YPAD=10, XPAD=10)
   l = Widget_Label(bbbase, value=thisLabel, xoffset=5)
   
self.plotID = FSC_PlotWindow(plotBase, Units=unit, PageSize=self.pagetypeSet, $
   Landscape=self.landscapeSet, WindowSize=windowsize, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'PLOTWINDOW', Object:self})

   <span class="comments">; Create bottom button widgets.</span>

    actionBase = Widget_Base(rightTopBase, Row=1)
    cancel = Widget_Button(actionBase, Value=cancelButVal, UValue={Method:'CANCEL', Object:self})
    self.revertID = Widget_Button(actionBase, Value='Revert', UValue={Method:'REVERT', Object:self}, Sensitive=0)
    helper = Widget_Button(actionBase, Value='Help', UValue={Method:'HELP', Object:self})
    self.acceptID = Widget_Button(actionBase, Value=acceptButtonName, UValue={Method:'ACCEPT', Object:self})

ENDIF ELSE BEGIN

    plotbase = Widget_Base(rightTopBase, /Frame, XPAD=15, YPAD=15, COLUMN=1)
    self.plotID = FSC_PlotWindow(plotbase, Units=unit, PageSize=self.pagetypeSet, $
       Landscape=self.landscapeSet, WindowSize=windowsize, Event_Pro='FSC_PSCONFIG_Events', $
       UValue={Method:'PLOTWINDOW', Object:self})

   <span class="comments">; Create bottom button widgets.</span>

    actionBase = Widget_Base(middleTopBase, Row=1)
    cancel = Widget_Button(actionBase, Value=cancelButVal, UValue={Method:'CANCEL', Object:self})
    self.revertID = Widget_Button(actionBase, Value='Revert', UValue={Method:'REVERT', Object:self}, Sensitive=0)
    helper = Widget_Button(actionBase, Value='Help', UValue={Method:'HELP', Object:self})
    self.acceptID = Widget_Button(actionBase, Value=acceptButtonName, UValue={Method:'ACCEPT', Object:self})
ENDELSE
 
   <span class="comments">; Size the widgets.</span>

t = Widget_Info(leftTopBase, /Geometry)
targetSize = t.scr_xsize
self.pageTypeID->Resize, ParentSize=targetsize
self.orientationID->Resize, targetsize
self.unitsID->Resize, targetsize
self.encapsulationID->Resize, targetsize
self.langLevelID->Resize, targetsize
self.previewID->Resize, targetsize
self.cmykID->Resize, targetsize
self.colorID->Resize, targetsize
self.bitsID->Resize, targetsize
IF Obj_Valid(self.decomposedID) THEN self.decomposedID->Resize, targetsize
self.defaultsID->Resize, targetsize

IF self.encapsulationID->GetIndex() THEN self.previewID->Sensitive, 1 ELSE self.previewID->Sensitive, 0
self.plotID->SetColor, self.colorSet

   <span class="comments">; Center and realize TLB.</span>

FSC_PSConfig_CenterTLB, tlb
Widget_Control, tlb, /Realize

self.noblock = Keyword_Set(noblock)

   <span class="comments">; Save the current configuration.</span>

self->SaveConfiguration

XManager, 'fsc_psconfig_' + self.name, tlb, Event_Handler='FSC_PSCONFIG_EVENTS', $
  No_Block=Keyword_Set(noblock)
IF Keyword_Set(noblock) THEN cancel = 0 ELSE cancel = self.cancel
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::GUIFont, Cancel=cancel, Group_Leader=leader, NoBlock=noblock, $
   NoFont=nofont, Accept_Button_Name=acceptButtonName, FontType=fonttype

<span class="comments">; This method displays the graphical user interface with font information</span>
<span class="comments">; in place.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

   <span class="comments">; Can't run this program in a device that doesn't support windows.</span>

self.thisDevice = !D.Name
IF (!D.Flags AND 256) EQ 0 THEN BEGIN
   thisOS = StrUpCase(!Version.OS_Family)
   CASE thisOS OF
      'MACOS': Set_Plot, 'Mac'
      'WINDOWS': Set_Plot, 'Win'
      ELSE: Set_Plot, 'X'
   ENDCASE
ENDIF

   <span class="comments">; If the NoFont keyword is set, call the non-font GUI method.</span>

IF Keyword_Set(nofont) THEN BEGIN
   self->Gui, Cancel=cancel, Group_Leader=leader, NoBlock=Keyword_Set(noblock), $
      Accept_Button_Name=acceptButtonName, FontType=fonttype
   RETURN
ENDIF

IF N_Elements(acceptButtonName) EQ 0 THEN BEGIN
   IF Keyword_Set(noblock) THEN BEGIN
      acceptButtonName = 'Apply'
   ENDIF ELSE BEGIN
      acceptButtonName = 'Accept'
   ENDELSE
ENDIF

   <span class="comments">; Only one GUI at a time with the same name.</span>

IF XRegistered('fsc_psconfig_' + self.name) GT 0 THEN RETURN

   <span class="comments">;Set default values.</span>

self.fontInfo = 1
CW_FIELD_SIZE = 5
IF Keyword_Set(noblock) THEN BEGIN
   cancelButVal = 'Dismiss'
ENDIF ELSE BEGIN
   cancelButVal = 'Cancel'
ENDELSE

IF N_Elements(fonttype) EQ 0 THEN fonttype = self.fontTypeSet
self.fontTypeSet = fonttype

IF self.fontTypeSet EQ 1 THEN self.trueTypeSet = 1
IF Keyword_Set(noblock) THEN self.cancel = 0 ELSE self.cancel = 1

IF self.name NE "" THEN tlbTitle = self.name + ": Configure PostScript Device" ELSE $
   tlbTitle = "Configure PostScript Device"

   <span class="comments">; Modal TLB if possible.</span>

IF N_Elements(leader) EQ 0 OR Keyword_Set(noblock) THEN BEGIN
   tlb = Widget_Base(Title=tlbTitle, Column=1, Base_Align_Center=1)
ENDIF ELSE BEGIN
   tlb = Widget_Base(Title=tlbTitle, Column=1, $
      Base_Align_Center=1, Group_Leader=leader, /Modal)
ENDELSE

self.tlb = tlb

   <span class="comments">; Sub-base hierarchy.</span>

   topBase = Widget_Base(tlb, Row=1, UValue=self.thisDevice, Kill_Notify='FSC_PSConfig_Restore_Device')
      leftTopBase = Widget_Base(topBase, Column=1)
         controlBase = Widget_Base(leftTopBase, Column=1, /Frame)
         euroBase = Widget_Base(leftTopBase, row=1, /NonExclusive)
      rightTopBase = Widget_Base(topBase, Column=1)
         sizebase = Widget_Base(rightTopBase, Row=1, /Frame)
         fontbase = Widget_Base(rightTopBase, Column=1, Base_Align_Left=1, Frame=1)
            firstRow = Widget_Base(fontbase, Row=1)
            secondRow = Widget_Base(fontbase, Row=1)
            thirdRow = Widget_Base(fontbase, Row=1)
            fourthRow = Widget_Base(fontbase, Row=1)
      middleTopBase = Widget_Base(topBase, Column=1, Base_Align_Center=1)
   actionBase = Widget_Base(tlb, Row=1, Base_Align_Center=1)

   <span class="comments">; Create droplist widgets.</span>

values = ['Letter', 'A4', 'Legal', 'Ledger']
self.pageTypeID = FSC_Droplist(controlBase, Value=values, Title='Page Size:', $
   UValue={Method:'PageSize', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.pageTypeID->SetSelection, self.pageTypeSet
self.pagetype = self.pageTypeSet

values = ['Portrait', 'Landscape']
self.orientationID = FSC_Droplist(controlBase, Value=values, Title='Orientation:', $
   UValue={Method:'Orientation', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.orientationID->SetIndex, self.landscapeSet

values = ['Centimeters', 'Inches']
self.unitsID = FSC_Droplist(controlBase, Value=values, Title='Units:', $
   UValue={Method:'Units', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.unitsID->SetIndex, self.inchesSet

values = ['Off', 'On']
self.encapsulationID = FSC_Droplist(controlBase, Value=values, Title='Encapsulation:', $
   UValue={Method:'ENCAPSULATE', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.encapsulationID->SetIndex, self.encapsulationSet

values = ['None','Bitmap Preview','TIFF Preview']
self.previewID = FSC_Droplist(controlBase, Value=values, Title='Preview Mode:', $
   UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.previewID->SetIndex, self.previewSet

values = ['Off', 'On']
self.colorID = FSC_Droplist(controlBase, Value=values, Title='Color Output:', $
   UValue={Method:'COLOR', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.colorID->SetIndex, self.colorSet

values = ['Off', 'On']
self.cmykID = FSC_Droplist(controlBase, Value=values, Title = 'CMYK Output', $
    UValue={Method:'CMYK', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.cmykID->SetIndex, self.cmykSet

values = ['1','2']
self.langlevelID = FSC_Droplist(controlBase, Value=values, Title = 'Language Level:', $
    UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.langlevelID->SetSelection, self.langlevelSet

values = ['8', '4', '2']
self.bitsID = FSC_Droplist(controlBase, Value=values, Title='Bits Per Image Pixel:', $
   UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.bitsID->SetSelection, self.bitsSet

IF Float(!Version.Release) GE 7.1 THEN BEGIN
    values = ['Off', 'On']
    self.decomposedID = FSC_Droplist(controlBase, Value=values, Title = 'Color Decomposition:', $
        UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
    self.decomposedID->SetIndex, self.decomposedSet
    self.bitsID->SetSelection, 8
    self.colorID->SetIndex, 1
    self.colorSet = 1
ENDIF

values = self->DefaultList()
self.defaultsID = FSC_Droplist(controlBase, Value=values, Title='Setups:', $
   UValue={Method:'DEFAULTS', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
self.defaultsID->SetSelection, self.defaultsSet

euroSetUpID = Widget_Button(euroBase, Value='Metric Style', UValue={Method:'METRICSTYLE', Object:self})
IF self.metric THEN Widget_Control, euroSetUpID, /Set_Button
IF self.inchesSet THEN unit = 'INCHES' ELSE unit = 'CENTIMETERS'

windowDims = self->PageDimensions()
shortside = Min(windowDims, Max=longside)
IF self.landscapeSet THEN BEGIN
   windowsize = [self.xoffsetSet/longside, self.yoffsetSet/shortside, $
      self.xsizeSet/longside + self.xoffsetSet/longside, self.ysizeSet/shortside + self.yoffsetSet/shortside]
ENDIF ELSE BEGIN
   windowsize = [self.xoffsetSet/shortside, self.yoffsetSet/longside, $
      self.xsizeSet/shortside + self.xoffsetSet/shortside, self.ysizeSet/longside + self.yoffsetSet/longside]
ENDELSE

   <span class="comments">; Create the plot window.</span>

self.plotID = FSC_PlotWindow(middleTopBase, Units=unit, PageSize=self.pagetypeSet, $
   Landscape=self.landscapeSet, WindowSize=windowsize, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'PLOTWINDOW', Object:self})

   <span class="comments">; Create size and offset windows.</span>

xsizeID = FSC_Field(sizebase, Title=' X Size: ', Value=self.xsizeSet, Object=xsizeObj, $
   /Float, XSize=CW_FIELD_SIZE, Decimal=2, /CR_Only, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'WINDOWSIZE', Object:self}, /Positive, /Label_Left)
self.xsizeID = xsizeObj
ysizeID = FSC_Field(sizebase, Title=' Y Size: ', Value=self.ysizeSet, Object=ysizeObj, $
   /Float, XSize=CW_FIELD_SIZE, Decimal=2, /CR_Only, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'WINDOWSIZE', Object:self}, /Positive, /Label_Left)
self.ysizeID = ysizeObj

xoffsetID = FSC_Field(sizebase, Title=' X Offset: ', Value=self.xoffsetSet, Object=xoffsetObj, $
   /Float, XSize=CW_FIELD_SIZE, Decimal=2, /CR_Only, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'WINDOWSIZE', Object:self}, /Positive, /Label_Left)
self.xoffsetID = xoffsetObj

yoffsetID = FSC_Field(sizebase, Title=' Y Offset: ', Value=self.yoffsetSet, Object=yoffsetObj, $
   /Float, XSize=CW_FIELD_SIZE, Decimal=2, /CR_Only, Event_Pro='FSC_PSCONFIG_Events', $
   UValue={Method:'WINDOWSIZE', Object:self}, /Positive, /Label_Left)
self.yoffsetID = yoffsetObj

   <span class="comments">; Set up TABing between fields.</span>

self.xsizeID->SetTabNext, self.ysizeID->GetTextID()
self.ysizeID->SetTabNext, self.xoffsetID->GetTextID()
self.xoffsetID->SetTabNext, self.yoffsetID->GetTextID()
self.yoffsetID->SetTabNext, self.xsizeID->GetTextID()

   <span class="comments">; Create the font widgets.</span>

values = ['Vector (Hershey)', 'Hardware', 'True-Type']
self.fontTypeID = FSC_Droplist(firstRow, Value=values, Title='Font Type: ', $
   UValue={Method:'FONTTYPE', Object:self}, Event_Pro='FSC_PSCONFIG_Events') <span class="comments">;, UName='Font Type')</span>
self.fontTypeID->SetIndex, (0 > (self.fonttypeSet + 1) &lt<span class="comments">; 2)</span>

self.fontnameID = FSC_Droplist(firstrow, Value=*self.fontnames, Title='Font: ', $
   UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events') <span class="comments">;, UName='Font Name')</span>
self.fontnameID->SetSelection, self.fontNameSet

values = ['Bold','Book', 'Demi', 'Italic', 'Light', 'Medium', 'Narrow', 'Oblique']
self.styleBaseID = Widget_Base(secondRow, Column=4, /Nonexclusive, /Frame)
FOR j=0,7 DO BEGIN
      self.fontStyleButtonID[j] = Widget_Button(self.styleBaseID, Value=values[j], $
         UValue={Method:'STYLEBUTTONS', Object:self}, Event_Pro='FSC_PSCONFIG_Events')
      Widget_Control, self.fontStylebuttonID[j], Set_Button=self.fontStyleSet[j]
ENDFOR
FOR j=0,7 DO IF self.fontStyleSet[j] THEN Widget_Control, self.fontStyleButtonID[j], Set_Button=1

clearBaseID = Widget_Base(secondRow)
self.clearButtonID = Widget_Button(clearBaseID, Value='Clear Font Styles', YOffset=15, XOffset=6, $
         UValue={Method:'CLEARSTYLES', Object:self}, Event_Pro='FSC_PSCONFIG_Events')

   <span class="comments">; More droplist widgets.</span>

values = Indgen(31) + 6
self.fontSizeID = FSC_Droplist(thirdrow, Value=StrTrim(values,2), Title='Font Size: ', $
   UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events') <span class="comments">;, UName='Font Size')</span>
self.fontSizeID->SetSelection, StrTrim(self.fontsizeSet,2)

self.truetypeID = FSC_Droplist(thirdrow, Value=['No', 'Yes'], Title='True-Type: ', $
   UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events') <span class="comments">;, UName='True-Type Fonts')</span>
self.truetypeID->SetIndex, self.truetypeSet

self.isolatinID = FSC_Droplist(thirdrow, Value=['Off', 'On'], Title='ISOlatin1: ', $
   UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events') <span class="comments">;, UName='Isolatin Encoding')</span>
self.isolatinID->SetIndex, self.isolatinSet

<span class="comments">;self.set_fontID = FSC_InputField(fourthRow, Value=self.set_fontSet, $</span>
<span class="comments">;   UValue={Method:'NULL', Object:self}, Event_Pro='FSC_PSCONFIG_Events', $</span>
<span class="comments">;   Title='Set_Font Name: ', XSize=35, /StringValue)</span>

   <span class="comments">; The directions widgets.</span>

labelBase = Widget_Base(middleTopBase, Column=1, Base_Align_Center=1)
label = Widget_Label(labelBase, Value='Directions')
label = Widget_Label(labelBase, Value='Move or resize the PostScript "plot" on the', /Align_Left)
label = Widget_Label(labelBase, Value='page with left or right buttons. Click the middle', /Align_Left)
label = Widget_Label(labelBase, Value='button in the window to center plot on the page.', /Align_Left)

   <span class="comments">; The file name widgets.</span>

dummy = FSC_FileSelect(rightTopBase, Filename=self.filenameSet, $
   Directory=self.directorySet, XSIZE=40, ObjectRef=filenameID)
self.filenameID = filenameID

   <span class="comments">; The bottom button widgets.</span>

cancel = Widget_Button(actionBase, Value=cancelButVal, UValue={Method:'CANCEL', Object:self})
self.revertID = Widget_Button(actionBase, Value='Revert', UValue={Method:'REVERT', Object:self}, Sensitive=0)
helper = Widget_Button(actionBase, Value='Help', UValue={Method:'HELP', Object:self})
self.acceptID = Widget_Button(actionBase, Value=acceptButtonName, UValue={Method:'ACCEPT', Object:self})

   <span class="comments">; Size the widgets for layout.</span>

t = Widget_Info(leftTopBase, /Geometry)
targetSize = t.scr_xsize
self.pageTypeID->Resize, ParentSize=targetsize
self.orientationID->Resize, targetsize
self.unitsID->Resize, targetsize
self.encapsulationID->Resize, targetsize
self.previewID->Resize, targetsize
self.cmykID->Resize, targetsize
IF Obj_Valid(self.decomposedID) THEN self.decomposedID->Resize, targetsize
self.langlevelID->Resize, targetsize
self.colorID->Resize, targetsize
self.bitsID->Resize, targetsize
self.defaultsID->Resize, targetsize

t = Widget_Info(fontbase, /Geometry)
targetsize = t.scr_xsize / 2
self.fontTypeID->Resize, targetsize
self.fontnameID[0]->Resize, targetsize

targetsize = t.scr_xsize / 3
self.truetypeID->Resize, targetsize
self.isoLatinID->Resize, targetsize
self.fontSizeID->Resize, targetsize

targetsize = t.scr_xsize
IF Obj_Valid(self.set_fontID) THEN self.set_fontID->Resize, targetsize

   <span class="comments">; Some widgets need to be turned off.</span>

IF self.encapsulationID->GetIndex() THEN self.previewID->Sensitive, 1 ELSE self.previewID->Sensitive, 0
self.plotID->SetColor, self.colorSet
IF self.fontTypeSet EQ -1 THEN BEGIN
   Widget_Control, self.fontnameID->GetID(), Sensitive=0
   Widget_Control, self.stylebaseID, Sensitive=0
   Widget_Control, self.clearbuttonID, Sensitive=0
   Widget_Control, self.fontSizeID->GetID(), Sensitive=0
   Widget_Control, self.truetypeID->GetID(), Sensitive=0
   Widget_Control, self.isolatinID->GetID(), Sensitive=0
   IF Obj_Valid(self.set_fontID) THEN Widget_Control, self.set_fontID->GetID(), Sensitive=0
ENDIF

   <span class="comments">; Center and realize the top-level base.</span>

FSC_PSConfig_CenterTLB, tlb
Widget_Control, tlb, /Realize

self.noblock = Keyword_Set(noblock)

   <span class="comments">; Save the current configuration.</span>

self->SaveConfiguration

XManager, 'fsc_psconfig_' + self.name, tlb, Event_Handler='FSC_PSCONFIG_EVENTS', $
  No_Block=Keyword_Set(noblock)
IF Keyword_Set(noblock) THEN cancel = 0 ELSE cancel = self.cancel
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::Help, event

<span class="comments">; This is the text that pops up in the HELP WINDOW when the</span>
<span class="comments">; Help button is selected. Feel free to change it to whatever</span>
<span class="comments">; you like. The "textsize" variable below the help text should</span>
<span class="comments">; be set to the number of lines of textual information.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

helptext = [ $
"                                                              ", $
"  The FSC_PSConfig object is a Open Source program written    ", $
"  by David Fanning of Fanning Software Consulting. Complete   ", $
"  program documenation is available on the FSC web page:      ", $
"                                                              ", $
"     http://www.idlcoyote.com/programs/docs/fsc_psconfig.html  ", $
"                                                              ", $
"  Other IDL programs, as well as many IDL programming tips    ", $
"  and techniques can be found on the Coyote's Guide to IDL    ", $
"  Programming web page. Please take a moment to look around.  ", $
"                                                              ", $
"     Fanning Software Consulting                              ", $
"     1645 Sheely Drive                                        ", $
"     Fort Collins, CO 80526                                   ", $
"     Phone: 970-221-0438   Fax: 970-221-4762                  ", $
"     E-Mail: david@idlcoyote.com                               ", $
"     IDL Book Orders: 1-888-461-0155                          ", $
"     Coyote's Guide: http://www.idlcoyote.com/                 ", $
"                                                              " ]
textsize = 19

   <span class="comments">; Only one help display at a time, please.</span>

IF XRegistered('fsc_psconfig_help') GT 0 THEN RETURN

   <span class="comments">; Creat the widgets for the HELP WINDOW.</span>

base = Widget_Base(Column=1, Group_Leader=self.acceptID)
textID = Widget_Text(base, Value=helptext, Scr_XSize=500, YSize=textsize)
IF NOT Widget_Info(self.tlb, /Modal) THEN button = Widget_Button(base, Value='Dismiss')
FSC_PSConfig_CenterTLB, base
Widget_Control, base, /Realize
XManager, 'fsc_psconfig_help', base, /Just_Reg
END <span class="comments">;--------------------------------------------------------------------------------</span>



FUNCTION FSC_PSCONFIG::PageDimensions

<span class="comments">; This method sets up the page size. If you add a new page size,</span>
<span class="comments">; you must add its dimensions (in inches) to the CASE statement below.</span>

<span class="comments">; Letter 8.5 x 11.</span>
<span class="comments">; Ledger 11 x 17.</span>
<span class="comments">; Legal 8.5 x 14.</span>
<span class="comments">; A4 8.27 x 11.7.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN, [0,0]
ENDIF

CASE StrUpCase(self.pagetype) OF
   'LETTER': BEGIN
         shortside = 8.5
         longside = 11.0
      ENDCASE
   'LEDGER': BEGIN
         shortside = 11.0
         longside = 17.0
      ENDCASE
   'LEGAL': BEGIN
         shortside = 8.5
         longside = 14.0
      ENDCASE
   'A4': BEGIN
         shortside = 8.27
         longside = 11.70
      ENDCASE
<span class="comments">;   ELSE: BEGIN</span>
<span class="comments">;         shortside = 8.5</span>
<span class="comments">;         longside = 11.0</span>
<span class="comments">;      ENDCASE</span>
ENDCASE

IF self.inchesSet EQ 0 THEN BEGIN
   shortside = shortside * 2.54
   longside = longside * 2.54
ENDIF

RETURN, [shortside, longside]
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::Orientation, event

<span class="comments">; This event handler method responds to changes in the Orientation droplist.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

pagetype = self.pageTypeID->GetSelection()
Widget_Control, event.top, Update=0
self.plotID->SetPageSize, pagetype, Landscape=event.index, TLB=self.tlb
self.plotID->GetWindowLocation, xsize, ysize, xoffset, yoffset
self->UpdateSizes, xsize, ysize, xoffset, yoffset
self.landscapeSet = event.index
Widget_Control, event.top, Update=1
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::PageSize, event

<span class="comments">; This event handler method responds to changes in the Page Size droplist.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

   <span class="comments">; Landscape is the default orientation for LEDGER output.</span>

IF StrUpCase(*event.selection) EQ "LEDGER" THEN BEGIN
   landscapeValue = 1
   self.orientationID->SetIndex, 1
ENDIF ELSE landscapeValue = self.orientationID->GetIndex()

   <span class="comments">; Change the page size. Get the window location and update the display.</span>

Widget_Control, event.top, Update=0
self.plotID->SetPageSize, *event.selection, Landscape=landscapeValue, TLB=self.tlb
self.plotID->GetWindowLocation, xsize, ysize, xoffset, yoffset
self->UpdateSizes, xsize, ysize, xoffset, yoffset
self.pagetype = *event.selection
Widget_Control, event.top, Update=1
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::PlotWindow, event

<span class="comments">; The plot window moved or changed size. Update the size and offset widgets.</span>

self->UpdateSizes, event.xsize, event.ysize, event.xoffset, event.yoffset
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::Revert, event

<span class="comments">; This method allows the user to revert to the previously</span>
<span class="comments">; saved configuration. All buttons, droplists, etc. are set</span>
<span class="comments">; to their previously saved values.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

   <span class="comments">; Reset the widget setting variables.</span>

self.bitsSet = self.bitsRevert
self.defaultsSet = self.defaultsRevert
self.directorySet = self.directoryRevert
self.encapsulationSet = self.encapsulationRevert
self.filenameSet = self.filenameRevert
self.fontsizeSet = self.fontsizeRevert
self.fontstyleSet = self.fontstyleRevert
self.fonttypeSet = self.fonttypeRevert
self.fontnameSet = self.fontnameRevert
self.inchesSet = self.inchesRevert
self.isolatinSet = self.isolatinRevert
self.landscapeSet = self.landscapeRevert
self.langlevelSet = self.langlevelRevert
self.pagetypeSet = self.pagetypeRevert
self.previewSet = self.previewRevert
self.set_fontSet = self.set_fontRevert
self.truetypeSet = self.truetypeRevert
self.decomposedSet = self.decomposedRevert
self.cmykSet = self.cmykRevert
self.colorSet = self.colorRevert
self.xoffsetSet = self.xoffsetRevert
self.xsizeSet = self.xsizeRevert
self.yoffsetSet = self.yoffsetRevert
self.ysizeSet = self.ysizeRevert

IF Obj_Valid(self.plotID) THEN BEGIN
   IF self.inchesSet THEN plotUnits = 'INCHES' ELSE plotUnits = 'CENTIMETERS'
   self.plotID->SetUnits, plotUnits
ENDIF

   <span class="comments">; Turn off updating while you update the plot window.</span>

Widget_Control, event.top, Update=0
self.plotID->SetPageSize, self.pagetypeSet, Landscape=self.landscapeSet, TLB=self.tlb
self.plotID->SetWindowLocation, self.xsizeSet, self.ysizeSet, self.xoffsetSet, self.yoffsetSet
self.plotID->SetColor, self.colorSet

   <span class="comments">; Make sure the Preview droplist is set correctly.</span>

IF self.encapsulationSet THEN self.previewID->Sensitive, 1 ELSE self.previewID->Sensitive, 0

   <span class="comments">; The statuslight should be set to SAFE.</span>

self->StatusLight, 1

   <span class="comments">; Update the display.</span>

self->UpdateDisplay
Widget_Control, event.top, Update=1
self.plotID->Refresh

END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::SaveConfiguration

<span class="comments">; This method saves the current configuration. Reversion</span>
<span class="comments">; variables are set so the REVERT button can be used to</span>
<span class="comments">; return to the previously saved configuration.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

self.bitsRevert = self.bitsSet
self.cmykRevert = self.cmykSet
self.colorRevert = self.colorSet
self.defaultsRevert = self.defaultsSet
self.directoryRevert = self.directorySet
self.encapsulationRevert = self.encapsulationSet
self.filenameRevert = self.filenameSet
self.fontnameRevert = self.fontnameSet
self.fontsizeRevert = self.fontsizeSet
self.fontstyleRevert = self.fontstyleSet
self.fonttypeRevert = self.fonttypeSet
self.inchesRevert = self.inchesSet
self.isolatinRevert = self.isolatinSet
self.landscapeRevert = self.landscapeSet
self.langlevelRevert = self.langlevelSet
self.pagetypeRevert = self.pagetypeSet
self.previewRevert = self.previewSet
self.truetypeRevert = self.truetypeSet
self.decomposedRevert = self.decomposedSet
self.set_fontRevert = self.set_fontSet
self.xoffsetRevert = self.xoffSetSet
self.yoffsetRevert = self.yoffSetSet
self.xsizeRevert = self.xsizeSet
self.ysizeRevert = self.ysizeSet

END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::SetDefault, defaultname

<span class="comments">; This method implements the default setups. To add your own default</span>
<span class="comments">; setups, add the new default name to the list in the DefaultList method</span>
<span class="comments">; above. Then add the default settings in the CASE statement below.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

   <span class="comments">; Set the page type and page units here, based on EUROPEAN setting.</span>

IF self.metric THEN BEGIN
   pagetype = 'A4'
   units = 0
ENDIF ELSE BEGIN
   pagetype = 'LETTER'
   units = 1
ENDELSE

   <span class="comments">; Get the file name.</span>

IF Obj_Valid(self.filenameID) THEN BEGIN
   self.filenameID->GetProperty, Filename=defaultFileName
   self.filenameID->GetProperty, Directory=directoryName
   index = FSC_PSConfig_RStrPos( defaultFileName, "." )
   IF index GE 0 THEN defaultFileName = StrMid(defaultFileName, 0, index)
ENDIF ELSE BEGIN
   IF self.filenameSet NE "" THEN BEGIN
      IF N_Elements(directoryName) EQ 0 THEN BEGIN
            defaultFileName = cgRootName(self.filenameSet, EXTENSION=ext, DIRECTORY=directoryName)
            IF directoryName EQ "" THEN CD, Current=directoryName 
       ENDIF ELSE BEGIN
            defaultFileName = "idl"
            CD, Current=directoryName
       ENDELSE
   ENDIF ELSE BEGIN
        defaultFileName = "idl"
        CD, Current=directoryName
   ENDELSE
ENDELSE

   <span class="comments">; Get the names of the defaults on the default list.</span>

defaultlist = self->DefaultList()

   <span class="comments">; If the defaultname variable is undefined, choose the first one</span>
   <span class="comments">; in the list.</span>

IF N_Elements(defaultname) EQ 0 THEN defaultname = defaultlist[0]
defaultname = String(defaultname)

   <span class="comments">; Define synonyms.</span>

IF StrUpCase(defaultname) EQ 'SYSTEM' THEN defaultname = 'System (Portrait)'
IF StrUpCase(defaultname) EQ 'PORTRAIT' THEN defaultname = 'Centered (Portrait)'
IF StrUpCase(defaultname) EQ 'LANDSCAPE' THEN defaultname = 'Centered (Landscape)'
IF StrUpCase(defaultname) EQ 'CENTER' THEN defaultname = 'Centered (Portrait)'
IF StrUpCase(defaultname) EQ 'CENTERED' THEN defaultname = 'Centered (Portrait)'
IF StrUpCase(defaultname) EQ 'FIGURE' THEN defaultname = 'Figure (Large)'
IF StrUpCase(defaultname) EQ 'ENCAPSULATED' THEN defaultname = 'Figure (Small)'
IF StrUpCase(defaultname) EQ 'ENCAPSULATE' THEN defaultname = 'Figure (Small)'
IF StrUpCase(defaultname) EQ 'COLOR' THEN defaultname = 'Color (Portrait)'
IF StrUpCase(defaultname) EQ 'NONE' THEN defaultname = 'None'


index = Where(StrUpCase(defaultlist) EQ StrUpCase(defaultname), count)
IF count EQ 0 THEN BEGIN
   ok = Dialog_Message(['Default set-up "' + defaultname + '" is', $
      'unknown. Using system defaults.'])
   defaultname = 'System (Portrait)'
ENDIF

thisDefault = defaultlist[index[0]]

   <span class="comments">; The default setups. Add your setups to this CASE statement if you are</span>
   <span class="comments">; adding a new default setup.</span>

CASE thisDefault OF

   'System (Portrait)': BEGIN
         self.bitsSet = '8'                          <span class="comments">; Sets the Bits-per-Pixels keyword.</span>
         self.colorSet = 0                           <span class="comments">; Sets the Color keyword.</span>
         self.directorySet = directoryName           <span class="comments">; Sets the directory name of the PostScript file.</span>
         self.encapsulationSet = 0                   <span class="comments">; Sets the Encapsulation keyword.</span>
         self.filenameSet = defaultFilename + ".ps"  <span class="comments">; Sets the filename of the PostScript file.</span>
         self.fonttypeSet = 2                        <span class="comments">; Sets the Font keyword.</span>
         self.fontsizeSet = 12                       <span class="comments">; Sets the Font_Size keyword.</span>
         self.fontStyleSet = Replicate(0, 8)         <span class="comments">; Sets the font style keywords in this order: Bold, Book, Demi, Italic, Light, Medium, Narrow, and Oblique.</span>
         self.fontnameSet = "Helvetica"              <span class="comments">; Sets the PostScript font name. All PostScript font names acceptable.</span>
         self.inchesSet = units                      <span class="comments">; Sets the Inches keyword.</span>
         self.landscapeSet = 0                       <span class="comments">; Sets the Landscape keyword.</span>
         self.langlevelSet = 1                       <span class="comments">; Set the Language Level keyword.</span>
         self.isolatinSet = 1                        <span class="comments">; Sets the Isolatin1 keyword.</span>
         self.pagetypeSet = pagetype                 <span class="comments">; Sets the page type. Possible values include "Letter", "A4", etc.</span>
         self.pagetype = pagetype                    <span class="comments">; Sets the page type. Possible values include "Letter", "A4", etc.</span>
         self.previewSet = 0                         <span class="comments">; Sets the Preview keyword.</span>
         self.truetypeSet = 0                        <span class="comments">; Sets the TT_Font keyword.</span>
         IF self.metric THEN self.xoffsetSet = 1.61 ELSE self.xoffsetSet = 0.75 <span class="comments">; Sets the XOffset keyword.</span>
         IF self.metric THEN self.yoffsetSet = 14.65 ELSE self.yoffsetSet = 5.0 <span class="comments">; Sets the YOffset keyword.</span>
         IF self.metric THEN self.xsizeSet = 17.80 ELSE self.xsizeSet = 7.0     <span class="comments">; Sets the XSize keyword.</span>
         IF self.metric THEN self.ysizeSet = 12.70 ELSE self.ysizeSet = 5.0     <span class="comments">; Sets the YSize keyword.</span>
         self.defaultsSet = 'System (Portrait)'
      ENDCASE

   'System (Landscape)': BEGIN
         self.bitsSet = '8'
         self.colorSet = 0
         self.directorySet = directoryName
         self.encapsulationSet = 0
         self.filenameSet = defaultFilename + ".ps"
         self.fonttypeSet = 2
         self.fontsizeSet = 12
         self.fontstyleSet = Replicate(0, 8)
         self.fontnameSet = "Helvetica"
         self.inchesSet = units
         self.landscapeSet = 1
         self.langlevelSet = 1                      
         self.isolatinSet = 1 
         self.pagetypeSet = pagetype
         self.pagetype = pagetype
         self.previewSet = 0
         self.truetypeSet = 0
         IF self.metric THEN self.xoffsetSet = 1.76 ELSE self.xoffsetSet = 0.75
         IF self.metric THEN self.yoffsetSet = 1.69 ELSE self.yoffsetSet = 0.75
         IF self.metric THEN self.xsizeSet = 26.25 ELSE self.xsizeSet = 9.5
         IF self.metric THEN self.ysizeSet = 17.63 ELSE self.ysizeSet = 7.0
         self.defaultsSet = 'System (Landscape)'
     ENDCASE

   'Centered (Portrait)': BEGIN
         self.bitsSet = '8'
         self.colorSet = 1
         self.directorySet = directoryName
         self.encapsulationSet = 0
         self.filenameSet = defaultFilename + ".ps"
         self.fonttypeSet = 2
         self.fontsizeSet = 12
         self.fontstyleSet = Replicate(0, 8)
         self.fontnameSet = "Helvetica"
         self.inchesSet = units
         self.landscapeSet = 0
         self.langlevelSet = 1                      
         self.isolatinSet = 1
         self.pagetypeSet = pagetype
         self.pagetype = pagetype
         self.previewSet = 0
         self.truetypeSet = 0
         IF self.metric THEN self.xoffsetSet = 3.51 ELSE self.xoffsetSet = 1.5
         IF self.metric THEN self.yoffsetSet = 3.68 ELSE self.yoffsetSet = 1.5
         IF self.metric THEN self.xsizeSet = 14.00 ELSE self.xsizeSet = 5.5
         IF self.metric THEN self.ysizeSet = 22.40 ELSE self.ysizeSet = 8.0
         self.defaultsSet = 'Centered (Portrait)'
      ENDCASE

   'Centered (Landscape)': BEGIN
         self.bitsSet = '8'
         self.colorSet = 1
         self.directorySet = directoryName
         self.encapsulationSet = 0
         self.filenameSet = defaultFilename + ".ps"
         self.fonttypeSet = 2
         self.fontsizeSet = 12
         self.fontstyleSet = Replicate(0, 8)
         self.fontnameSet = "Helvetica"
         self.inchesSet = units
         self.landscapeSet = 1
         self.langlevelSet = 1                      
         self.isolatinSet = 1
         self.pagetypeSet = pagetype
         self.pagetype = pagetype
         self.previewSet = 0
         self.truetypeSet = 0
         IF self.metric THEN self.xoffsetSet = 3.66 ELSE self.xoffsetSet = 1.5
         IF self.metric THEN self.yoffsetSet = 3.52 ELSE self.yoffsetSet = 1.5
         IF self.metric THEN self.xsizeSet = 22.43 ELSE self.xsizeSet = 8.0
         IF self.metric THEN self.ysizeSet = 13.97 ELSE self.ysizeSet = 5.5
         self.defaultsSet = 'Centered (Landscape)'
      ENDCASE

   'Square (Portrait)': BEGIN
         self.bitsSet = '8'
         self.colorSet = 1
         self.directorySet = directoryName
         self.encapsulationSet = 0
         self.filenameSet = defaultFilename + ".ps"
         self.fonttypeSet = 2
         self.fontsizeSet = 12
         self.fontstyleSet = Replicate(0, 8)
         self.fontnameSet = "Helvetica"
         self.inchesSet = units
         self.landscapeSet = 0
         self.langlevelSet = 1                      
         self.isolatinSet = 1
         self.pagetypeSet = pagetype
         self.pagetype = pagetype
         self.previewSet = 0
         self.truetypeSet = 0
         IF self.metric THEN self.xoffsetSet = 2.26 ELSE self.xoffsetSet = 1.0
         IF self.metric THEN self.yoffsetSet = 6.63 ELSE self.yoffsetSet = 2.25
         IF self.metric THEN self.xsizeSet = 16.50 ELSE self.xsizeSet = 6.5
         IF self.metric THEN self.ysizeSet = 16.50 ELSE self.ysizeSet = 6.5
         self.defaultsSet = 'Square (Portrait)'
      ENDCASE

   'Square (Landscape)': BEGIN
         self.bitsSet = '8'
         self.colorSet = 1
         self.directorySet = directoryName
         self.encapsulationSet = 0
         self.filenameSet = defaultFilename + ".ps"
         self.fonttypeSet = 2
         self.fontsizeSet = 12
         self.fontstyleSet = Replicate(0, 8)
         self.fontnameSet = "Helvetica"
         self.inchesSet = units
         self.landscapeSet = 1
         self.langlevelSet = 1                      
         self.isolatinSet = 1
         self.pagetypeSet = pagetype
         self.pagetype = pagetype
         self.previewSet = 0
         self.truetypeSet = 0
         IF self.metric THEN self.xoffsetSet = 6.63 ELSE self.xoffsetSet = 2.25
         IF self.metric THEN self.yoffsetSet = 2.26 ELSE self.yoffsetSet = 1.0
         IF self.metric THEN self.xsizeSet = 16.50 ELSE self.xsizeSet = 6.5
         IF self.metric THEN self.ysizeSet = 16.50 ELSE self.ysizeSet = 6.5
         self.defaultsSet = 'Square (Landscape)'
      ENDCASE

   'Figure (Small)': BEGIN
         self.bitsSet = '8'
         self.colorSet = 1
         self.directorySet = directoryName
         self.encapsulationSet = 1
         self.filenameSet = defaultFilename + ".eps"
         self.fonttypeSet = 2
         self.fontsizeSet = 12
         self.fontstyleSet = Replicate(0, 8)
         self.fontnameSet = "Helvetica"
         self.inchesSet = units
         self.landscapeSet = 0
         self.langlevelSet = 1                      
         self.isolatinSet = 1
         self.pagetypeSet = pagetype
         self.pagetype = pagetype
         self.previewSet = 2
         self.truetypeSet = 0
         IF self.metric THEN self.xoffsetSet = 6.06 ELSE self.xoffsetSet = 2.5
         IF self.metric THEN self.yoffsetSet = 11.71 ELSE self.yoffsetSet = 4.25
         IF self.metric THEN self.xsizeSet = 8.89 ELSE self.xsizeSet = 3.5
         IF self.metric THEN self.ysizeSet = 6.35 ELSE self.ysizeSet = 2.5
         self.defaultsSet = 'Figure (Small)'
      ENDCASE

   'Figure (Large)': BEGIN
         self.bitsSet = '8'
         self.colorSet = 1
         self.directorySet = directoryName
         self.encapsulationSet = 1
         self.filenameSet = defaultFilename + ".eps"
         self.fonttypeSet = 0
         self.fontsizeSet = 12
         self.fontstyleSet = Replicate(0, 8)
         self.fontnameSet = "Helvetica"
         self.inchesSet = units
         self.landscapeSet = 0
         self.isolatinSet = 1
         self.langlevelSet = 1                      
         self.pagetypeSet = pagetype
         self.pagetype = pagetype
         self.previewSet = 2
         self.truetypeSet = 0
         IF self.metric THEN self.xoffsetSet = 4.16 ELSE self.xoffsetSet = 1.75
         IF self.metric THEN self.yoffsetSet = 9.8 ELSE self.yoffsetSet = 3.5
         IF self.metric THEN self.xsizeSet = 12.70 ELSE self.xsizeSet = 5.0
         IF self.metric THEN self.ysizeSet = 10.16 ELSE self.ysizeSet = 4.0
         self.defaultsSet = 'Figure (Large)'
      ENDCASE

   'Color (Portrait)': BEGIN
         self.bitsSet = '8'
         self.colorSet = 1
         self.directorySet = directoryName
         self.encapsulationSet = 0
         self.filenameSet = defaultFilename + ".ps"
         self.fonttypeSet = 2
         self.fontsizeSet = 12
         self.fontstyleSet = Replicate(0, 8)
         self.fontnameSet = "Helvetica"
         self.inchesSet = units
         self.landscapeSet = 0
         self.langlevelSet = 1                      
         self.isolatinSet = 1
         self.pagetypeSet = pagetype
         self.pagetype = pagetype
         self.previewSet = 0
         self.truetypeSet = 0
         IF self.metric THEN self.xoffsetSet = 3.51 ELSE self.xoffsetSet = 1.5
         IF self.metric THEN self.yoffsetSet = 3.68 ELSE self.yoffsetSet = 1.5
         IF self.metric THEN self.xsizeSet = 14.00 ELSE self.xsizeSet = 5.5
         IF self.metric THEN self.ysizeSet = 22.40 ELSE self.ysizeSet = 8.0
         self.defaultsSet = 'Color (Portrait)'
      ENDCASE

   'Color (Landscape)': BEGIN
         self.bitsSet = '8'
         self.colorSet = 1
         self.directorySet = directoryName
         self.encapsulationSet = 0
         self.filenameSet = defaultFilename + ".ps"
         self.fonttypeSet = 2
         self.fontsizeSet = 12
         self.fontstyleSet = Replicate(0, 8)
         self.fontnameSet = "Helvetica"
         self.inchesSet = units
         self.landscapeSet = 1
         self.langlevelSet = 1                      
         self.isolatinSet = 1
         self.pagetypeSet = pagetype
         self.pagetype = pagetype
         self.previewSet = 0
         self.truetypeSet = 0
         IF self.metric THEN self.xoffsetSet = 3.66 ELSE self.xoffsetSet = 1.5
         IF self.metric THEN self.yoffsetSet = 3.52 ELSE self.yoffsetSet = 1.5
         IF self.metric THEN self.xsizeSet = 22.43 ELSE self.xsizeSet = 8.0
         IF self.metric THEN self.ysizeSet = 13.97 ELSE self.ysizeSet = 5.5
         self.defaultsSet = 'Color (Landscape)'
      ENDCASE

   ELSE: self.defaultsSet = 'None'
ENDCASE


IF Obj_Valid(self.plotID) THEN BEGIN
   IF self.inchesSet THEN plotUnits = 'INCHES' ELSE plotUnits = 'CENTIMETERS'
   self.plotID->SetUnits, plotUnits
ENDIF

   <span class="comments">; Set the full filename.</span>
self.fullFileNameSet = Filepath(ROOT_DIR=self.directorySet, self.filenameSet)

   <span class="comments">; If the font information is on the display, update it.</span>

IF self.fontInfo THEN BEGIN

   IF self.fontTypeSet EQ -1 THEN BEGIN
      Widget_Control, self.fontnameID->GetID(), Sensitive=0
      Widget_Control, self.stylebaseID, Sensitive=0
      Widget_Control, self.clearbuttonID, Sensitive=0
      Widget_Control, self.fontSizeID->GetID(), Sensitive=0
      Widget_Control, self.truetypeID->GetID(), Sensitive=0
      Widget_Control, self.isolatinID->GetID(), Sensitive=0
      IF Obj_Valid(self.set_fontID) THEN Widget_Control, self.set_fontID->GetID(), Sensitive=0
   ENDIF ELSE BEGIN
      Widget_Control, self.fontnameID->GetID(), Sensitive=1
      Widget_Control, self.stylebaseID, Sensitive=1
      Widget_Control, self.clearbuttonID, Sensitive=1
      Widget_Control, self.fontSizeID->GetID(), Sensitive=1
      Widget_Control, self.truetypeID->GetID(), Sensitive=1
      Widget_Control, self.isolatinID->GetID(), Sensitive=1
      IF Obj_Valid(self.set_fontID) THEN Widget_Control, self.set_fontID->GetID(), Sensitive=1

ENDELSE

ENDIF

   <span class="comments">; Update the display.</span>

self->UpDateDisplay

END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::StatusLight, safe

<span class="comments">; This method sets the status light (the background color of the</span>
<span class="comments">; page window). Safe equal 1 means the current configuration is saved.</span>
<span class="comments">; Safe equal 0 means the current configuration is not saved. The</span>
<span class="comments">; REVERT button is turned on or off to reflect the current SAFE state.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

safe = Keyword_Set(safe)

   <span class="comments">; Different colors based on depth of visual class.</span>

Device, Get_Visual_Depth=theDepth
IF safe THEN BEGIN
   IF theDepth GT 8 THEN windowColor = [60, 140, 140] ELSE windowColor = [80, 80, 80]
   Widget_Control, self.revertID, Sensitive=0
ENDIF ELSE BEGIN
   IF theDepth GT 8 THEN windowColor = [200, 133, 133] ELSE windowColor = [140, 140, 140]
      Widget_Control, self.revertID, Sensitive=1
ENDELSE

   <span class="comments">; Update the background window color. Done only in NOBLOCK conditions.</span>

IF self.noblock THEN self.plotID->SetWindowColor, windowColor
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::StyleButtons, event

<span class="comments">; This event handler method responds to changes in the font style buttons.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

index = Where(self.fontStyleButtonID EQ event.id)
index = index[0]
self.fontStyleSet[index] = event.select
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::Units, event

<span class="comments">; This event handler method responds to changes in the Units droplist.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

units = self.unitsID->GetSelection()
self.plotID->SetUnits, units
self.plotID->GetWindowLocation, xsize, ysize, xoffset, yoffset
self->UpdateSizes, xsize, ysize, xoffset, yoffset
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::UpdateDisplay

<span class="comments">; This method updates the GUI display with the current object settings.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

   <span class="comments">; Can only update if widget is valid and realized.</span>

IF Widget_Info(self.tlb, /Valid_ID) EQ 0 THEN RETURN
IF Widget_Info(self.tlb, /Realized) EQ 0 THEN RETURN

   <span class="comments">; Set the normal GUI widgets.</span>

IF Obj_Valid(self.decomposedID) THEN self.decomposedID->SetIndex, self.decomposedSet
self.bitsID->SetSelection, self.bitsSet
self.cmykID->SetIndex, self.cmykSet
self.colorID->SetIndex, self.colorSet
self.filenameID->SetProperty, Directory=self.directorySet, Filename=self.filenameSet
self.encapsulationID->SetIndex, self.encapsulationSet
self.unitsID->SetIndex, self.inchesSet
self.orientationID->SetIndex, self.landscapeSet
self.langlevelID->SetIndex, self.langlevelSet
self.pagetypeID->SetSelection, self.pagetypeSet
self.previewID->SetIndex, self.previewSet
self.xsizeID->Set_Value, self.xsizeSet
self.ysizeID->Set_Value, self.ysizeSet
self.xoffsetID->Set_Value, self.xoffsetSet
self.yoffsetID->Set_Value, self.yoffsetSet
self.defaultsID->SetSelection, self.defaultsSet

   <span class="comments">; If font information is on the display, set that too.</span>

IF self.fontInfo THEN BEGIN
   self.fontTypeID->SetIndex, (0 > (self.fonttypeSet + 1) &lt<span class="comments">; 2)</span>
   self.fontsizeID->SetSelection, StrTrim(self.fontsizeSet,2)
   self.isolatinID->SetIndex, self.isolatinSet
   self->UpDateFontStyle
   self.fontnameID->SetSelection, self.fontnameSet
   IF Obj_Valid(self.set_fontID) THEN self.set_fontID->Set_Value, self.set_fontSet
   self.truetypeID->SetIndex, self.truetypeSet
ENDIF

   <span class="comments">; Update the plot window and set the size and offset widgets.</span>

self.plotID->SetPageSize, self.pagetypeSet, Landscape=self.landscapeSet, TLB=self.tlb
self.plotID->SetWindowLocation, self.xsizeSet, self.ysizeSet, self.xoffsetSet, self.yoffsetSet
self.plotID->GetWindowLocation, xsize, ysize, xoffset, yoffset
self.xsizeID->Set_Value, xsize
self.ysizeID->Set_Value, ysize
self.xoffsetID->Set_Value, xoffset
self.yoffsetID->Set_Value, yoffset
self.plotID->SetColor, self.colorSet

IF self.encapsulationSet THEN self.previewID->Sensitive, 1 ELSE self.previewID->Sensitive, 0

END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::UpdateFontStyle, Clear = Clear

<span class="comments">; This method updates the font style box. If the CLEAR keyword</span>
<span class="comments">; is set, all the widgets are turned OFF.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

IF Keyword_Set(clear) THEN BEGIN
   FOR j=0,7 DO BEGIN
      Widget_Control, self.fontstyleButtonID[j], Set_Button=0
      self.fontStyleSet[j] = 0
   ENDFOR
ENDIF ELSE BEGIN
   FOR j=0,7 DO Widget_Control, self.fontstyleButtonID[j], Set_Button=self.fontStyleSet[j]
ENDELSE

END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::UpdateSizes, xsize, ysize, xoffset, yoffset

<span class="comments">; This method updates the size and offset widgets.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

self.xsizeID->Set_Value, xsize
self.ysizeID->Set_Value, ysize
self.xoffsetID->Set_Value, xoffset
self.yoffsetID->Set_Value, yoffset
END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::WindowSize, event

<span class="comments">; This is the event handler method that responds to events</span>
<span class="comments">; in the XSize, YSize, XOffset, and YOffset text widgets.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=self.debug)
   RETURN
ENDIF

   <span class="comments">; Get the values in the appropriate widgets.</span>

IF N_Elements(self.xsizeID->Get_Value()) EQ 0 THEN BEGIN
   IF self.inchesSet THEN xsize = 1.0 ELSE xsize = 2.54
ENDIF ELSE xsize = self.xsizeID->Get_Value()
IF N_Elements(self.ysizeID->Get_Value()) EQ 0 THEN BEGIN
   IF self.inchesSet THEN ysize = 1.0 ELSE ysize = 2.54
ENDIF ELSE ysize = self.ysizeID->Get_Value()
IF N_Elements(self.xoffsetID->Get_Value()) EQ 0 THEN xoffset = 0.0 $
   ELSE xoffset = self.xoffsetID->Get_Value()
IF N_Elements(self.yoffsetID->Get_Value()) EQ 0 THEN yoffset = 0.0 $
   ELSE yoffset = self.yoffsetID->Get_Value()

   <span class="comments">; Change the plot window to these sizes and offsets.</span>

self.plotID->SetWindowLocation, xsize, ysize, xoffset, yoffset

   <span class="comments">; The input values may be bogus. Get the "real" values from the</span>
   <span class="comments">; plot object and update the size and offset widgets.</span>

self.plotID->GetWindowLocation, xsize, ysize, xoffset, yoffset
self.xsizeID->Set_Value, xsize
self.ysizeID->Set_Value, ysize
self.xoffsetID->Set_Value, xoffset
self.yoffsetID->Set_Value, yoffset
END <span class="comments">;--------------------------------------------------------------------------------</span>




PRO FSC_PSCONFIG::SetProperty,        $ <span class="comments">; The SetProperty method of the object.</span>
   AvantGarde=avantgarde,             $ <span class="comments">; Set this keyword to select the AvantGarde font.</span>
   Bits_per_Pixel=bits_per_pixel,     $ <span class="comments">; The number of image bits saved for each image pixel: 2, 4, or 8.</span>
   Bold=bold,                         $ <span class="comments">; Set this keyword to select the Bold font style.</span>
   BookStyle=book,                    $ <span class="comments">; Set this keyword to select the Book font style.</span>
   Bkman=bookman,                     $ <span class="comments">; Set this keyword to select the Bookman font.</span>
   CMYK=cmyk,                         $ <span class="comments">; Set this keywprd to use CMYK colors instead of RGB.</span>
   Color=color,                       $ <span class="comments">; Set this keyword to select Color PostScript output.</span>
   Courier=courier,                   $ <span class="comments">; Set this keyword to select the Courier font.</span>
   DefaultSetup=defaultsetup,         $ <span class="comments">; Set this keyword to the "name" of a default style.</span>
   Demi=demi,                         $ <span class="comments">; Set this keyword to select the Demi font style.</span>
   Directory=directory,               $ <span class="comments">; Set thie keyword to the name of the starting directory. Current directory by default.</span>
   Encapsulated=encapsulated,         $ <span class="comments">; Set this keyword to select Encapsulated PostScript output.</span>
<span class="comments">;   European=european,                 $ ; Set this keyword to indicate "european" mode (i.e., A4 page and centimeter units).</span>
   Filename=filename,                 $ <span class="comments">; Set this keyword to the name of the file. Default: 'idl.ps'</span>
   FontSize=fontsize,                 $ <span class="comments">; Set this keyword to the font size. Between 6 and 36. Default is 12.</span>
   FontType=fonttype,                 $ <span class="comments">; Set this keyword to select the font type: -1 is Hershey, 0 is hardward, 1 is true-type.</span>
   Helvetica=helvetica,               $ <span class="comments">; Set this keyword to select the Helvetica font.</span>
   Inches=inches,                     $ <span class="comments">; Set this keyword to indicate sizes and offsets are in inches as opposed to centimeters.</span>
   Italic=italic,                     $ <span class="comments">; Set this keyword to select the Italic font style.</span>
   Isolatin=isolatin,                 $ <span class="comments">; Set this keyword to select ISOlatin1 encoding.</span>
   Landscape=landscape,               $ <span class="comments">; Set this keyword to select Landscape output.</span>
   LanguageLevel=langlevel,           $ <span class="comments">; Set this keyword to the Language Level of the PostScript interpreter.</span>
   Light=light,                       $ <span class="comments">; Set this keyword to select the Light font style.</span>
   Medium=medium,                     $ <span class="comments">; Set this keyword to select the Medium font style.</span>
   Metric=metric,                     $ <span class="comments">; Set this keyword to indicate "metric" mode (i.e., A4 page and centimeter units).</span>
   Name=name,                         $ <span class="comments">; This is the "name" of the object.</span>
   Narrow=narrow,                     $ <span class="comments">; Set this keyword to select the Narrow font style.</span>
   Oblique=oblique, $                 $ <span class="comments">; Set this keyword to select the Oblique font style.</span>
   PageType=pagetype,                 $ <span class="comments">; Set this keyword to the "type" of page: 'Letter', 'Legal', 'Ledger', or 'A4'.</span>
   Palatino=palatino,                 $ <span class="comments">; Set this keyword to select the Palatino font.</span>
   Preview=preview,                   $ <span class="comments">; Set this keyword to select Preview mode: 0, 1, or 2.</span>
   Schoolbook=schoolbook,             $ <span class="comments">; Set this keyword to select the Schoolbook font.</span>
   Set_Font=set_font,                 $ <span class="comments">; Set this keyword to the name of a font passed to PostScript with Set_Plot keyword.</span>
   Symbol=symbol,                     $ <span class="comments">; Set this keyword to select the Symbol font.</span>
   Times=times,                       $ <span class="comments">; Set this keyword to select the Times font.</span>
   TrueType=truetype,                 $ <span class="comments">; Set this keyword to select True-Type fonts.</span>
   UpDate=update, $                   $ <span class="comments">; Set this keyword to update the GUI if it is on the display.</span>
   XOffset=xoffset,                   $ <span class="comments">; Set this keyword to the XOffset. (Note: offset calculated from lower-left corner of page.)</span>
   XSize=xsize,                       $ <span class="comments">; Set this keyword to the X size of the PostScript "window".</span>
   YOffset=yoffset,                   $ <span class="comments">; Set this keyword to the YOffset. (Note: offset calculated from lower-left corner of page.)</span>
   YSize=ysize,                       $ <span class="comments">; Set this keyword to the Y size of the PostScript "window".</span>
   ZapfChancery=zapfchancery,         $ <span class="comments">; Set this keyword to select the ZapfChancery font.</span>
   ZapfDingbats=zapfdingbats            <span class="comments">; Set this keyword to select the ZapfDingbats font.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=Keyword_Set(self.debug))
   RETURN
ENDIF

   <span class="comments">; Check for undefined variables.</span>

IF N_Elements(bits_per_pixel) NE 0 THEN BEGIN
   IF bits_per_pixel EQ 2 OR bits_per_pixel EQ 4 OR bits_per_pixel EQ 8 THEN $
      self.bitsSet = StrTrim(bits_per_pixel,2) ELSE self.bitsSet = '8'
ENDIF
IF N_Elements(color) NE 0 THEN self.colorSet = color
IF N_Elements(directory) NE 0 THEN self.directorySet = directory
IF N_Elements(filename) NE 0 THEN self.filenameSet = filename
self.fullfilenameSet = self->Construct_Full_Filename()
IF N_Elements(fontsize) NE 0 THEN self.fontsizeSet = fontsize
IF N_Elements(fonttype) NE 0 THEN self.fonttypeSet = fonttype
IF N_Elements(encapsulated) NE 0 THEN self.encapsulationSet = encapsulated
IF Keyword_Set(inches) NE 0 THEN self.inchesSet = inches
IF N_Elements(landscape) NE 0 THEN self.landscape = landscape
IF N_Elements(langlevel) NE 0 THEN self.langlevel = langlevel
IF Keyword_Set(name) NE 0 THEN self.name = name
IF N_Elements(pagetype) NE 0 THEN BEGIN
   self.pagetypeSet = pagetype
   self.pagetype = pagetype
ENDIF
IF N_Elements(preview) NE 0 THEN self.previewSet = 0 > preview &lt<span class="comments">; 2</span>

IF N_Elements(set_font) NE 0 THEN self.set_fontSet = set_font
IF N_Elements(xsize) NE 0 THEN self.xsizeSet = xsize
IF N_Elements(ysize) NE 0 THEN self.ysizeSet = ysize

   <span class="comments">; Offsets are weird.</span>

dims = self->PageDimensions()
IF N_Elements(xoffset) NE 0 THEN IF self.landscape THEN self.xoffsetSet = dims[1] - yoffset ELSE self.xoffsetSet = xoffset
IF N_Elements(yoffset) NE 0 THEN IF self.landscape THEN self.yoffsetSet = xoffset ELSE self.yoffsetSet = yoffset


avantgarde = Keyword_Set(avantgarde)
bold = Keyword_Set(bold)
book = Keyword_Set(book)
bookman = Keyword_Set(bookman)
cmyk = Keyword_Set(cmyk)
courier = Keyword_Set(courier)
demi = Keyword_Set(demi)
encapsulated = Keyword_Set(encapsulated)
<span class="comments">;european = Keyword_Set(european)</span>
helvetica = Keyword_Set(helvetica)
isolatin = Keyword_Set(isolatin)
italic = Keyword_Set(italic)
landscape = Keyword_Set(landscape)
light = Keyword_Set(light)
medium = Keyword_Set(medium)
metric = Keyword_Set(metric)
narrow = Keyword_Set(narrow)
oblique = Keyword_Set(oblique)
palatino = Keyword_Set(palatino)
schoolbook = Keyword_Set(schoolbook)
symbol = Keyword_Set(symbol)
times = Keyword_Set(times)
truetype = Keyword_Set(truetype)
zapfchancery = Keyword_Set(zapfchancery)
zapfdingbats = Keyword_Set(zapfdingbats)

fontset = [avantgarde, bookman, courier, helvetica, palatino, schoolbook, symbol, times, zapfchancery, zapfdingbats]
index = Where(fontset EQ 1, count)
IF count EQ 0 THEN self.fontnameSet = 'Helvetica' ELSE self.fontnameSet = (*self.fontnames)[index[0]]
IF self.fontnameSet EQ 'AvantGarde' THEN self.avantgarde = 1 ELSE self.avantgarde = 0
IF self.fontnameSet EQ 'Bookman' THEN self.bookman = 1 ELSE self.bookman = 0
IF self.fontnameSet EQ 'Courier' THEN self.courier = 1 ELSE self.courier = 0
IF self.fontnameSet EQ 'Helvetica' THEN self.helvetica = 1 ELSE self.helvetica = 0
IF self.fontnameSet EQ 'Palatino' THEN self.palatino = 1 ELSE self.palatino = 0
IF self.fontnameSet EQ 'Schoolbook' THEN self.schoolbook = 1 ELSE self.schoolbook = 0
IF self.fontnameSet EQ 'Symbol' THEN self.symbol = 1 ELSE self.symbol = 0
IF self.fontnameSet EQ 'Times' THEN self.times = 1 ELSE self.times = 0
IF self.fontnameSet EQ 'ZapfChancery' THEN self.zapfchancery = 1 ELSE self.zapfchancery = 0
IF self.fontnameSet EQ 'ZapfDingbats' THEN self.zapfdingbats = 1 ELSE self.zapfdingbats = 0
self.fontstyleSet = [bold, book, demi, italic, light, medium, narrow, oblique]

   <span class="comments">; Populate the self object by saving the configuration.</span>

self->SaveConfiguration

   <span class="comments">; Update the display if required.</span>

IF Keyword_Set(update) THEN self->UpdateDisplay

END <span class="comments">;--------------------------------------------------------------------------------</span>



PRO FSC_PSCONFIG::CLEANUP
Ptr_Free, self.fontnames
END <span class="comments">;--------------------------------------------------------------------------------</span>



FUNCTION FSC_PSCONFIG::INIT,          $ <span class="comments">; The INIT method of the FSC_PSCONFIG object.</span>
   AvantGarde=avantgarde,             $ <span class="comments">; Set this keyword to select the AvantGarde font.</span>
   Bits_per_Pixel=bits_per_pixel,     $ <span class="comments">; The number of image bits saved for each image pixel: 2, 4, or 8.</span>
   Bold=bold,                         $ <span class="comments">; Set this keyword to select the Bold font style.</span>
   BookStyle=book,                    $ <span class="comments">; Set this keyword to select the Book font style.</span>
   Bkman=bookman,                     $ <span class="comments">; Set this keyword to select the Bookman font.</span>
   CMYK=cmyk,                         $ <span class="comments">; Set this keywprd to use CMYK colors instead of RGB.</span>
   Color=color,                       $ <span class="comments">; Set this keyword to select Color PostScript output.</span>
   Courier=courier,                   $ <span class="comments">; Set this keyword to select the Courier font.</span>
   Debug=debug,                       $ <span class="comments">; Set this keyword to get traceback information when errors are encountered.</span>
   Decomposed=decomposed, $           $ <span class="comments">; Set this keyword to select 24-bit color. IDL 7.1 and above only.</span>
   DefaultSetup=defaultsetup,         $ <span class="comments">; Set this keyword to the "name" of a default style.</span>
   Demi=demi,                         $ <span class="comments">; Set this keyword to select the Demi font style.</span>
   Directory=directory,               $ <span class="comments">; Set thie keyword to the name of the starting directory. Current directory by default.</span>
   Encapsulated=encapsulated,         $ <span class="comments">; Set this keyword to select Encapsulated PostScript output.</span>
<span class="comments">;   European=european,                 $ ; Set this keyword to indicate "european" mode (i.e., A4 page and centimeter units).</span>
   Filename=filename,                 $ <span class="comments">; Set this keyword to the name of the file. Default: 'idl.ps'</span>
   FontSize=fontsize,                 $ <span class="comments">; Set this keyword to the font size. Between 6 and 36. Default is 12.</span>
   FontType=fonttype,                 $ <span class="comments">; Set this keyword to select the font type: -1 is Hershey, 0 is hardward, 1 is true-type.</span>
   Helvetica=helvetica,               $ <span class="comments">; Set this keyword to select the Helvetica font.</span>
   Inches=inches,                     $ <span class="comments">; Set this keyword to indicate sizes and offsets are in inches as opposed to centimeters.</span>
   Italic=italic,                     $ <span class="comments">; Set this keyword to select the Italic font style.</span>
   Isolatin=isolatin,                 $ <span class="comments">; Set this keyword to select ISOlatin1 encoding.</span>
   Landscape=landscape,               $ <span class="comments">; Set this keyword to select Landscape output.</span>
   LanguageLevel=langlevel, $         $ <span class="comments">; Set this keyword to select the language level (1 or 2).</span>
   Light=light,                       $ <span class="comments">; Set this keyword to select the Light font style.</span>
   Medium=medium,                     $ <span class="comments">; Set this keyword to select the Medium font style.</span>
   Metric=metric,                     $ <span class="comments">; Set this keyword to indicate metric mode (i.e., A4 page and centimeter units).</span>
   Name=name,                         $ <span class="comments">; The "name" of the object. Objects with different names can have their</span>
                                        <span class="comments">; graphical user interfaces appear simultaneously on the display.</span>
   Narrow=narrow,                     $ <span class="comments">; Set this keyword to select the Narrow font style.</span>
   Oblique=oblique, $                 $ <span class="comments">; Set this keyword to select the Oblique font style.</span>
   PageType=pagetype,                 $ <span class="comments">; Set this keyword to the "type" of page: 'Letter', 'Legal', 'Ledger', or 'A4'.</span>
   Palatino=palatino,                 $ <span class="comments">; Set this keyword to select the Palatino font.</span>
   Preview=preview,                   $ <span class="comments">; Set this keyword to select Preview mode: 0, 1, or 2.</span>
   Schoolbook=schoolbook,             $ <span class="comments">; Set this keyword to select the Schoolbook font.</span>
   Set_Font=set_font,                 $ <span class="comments">; Set this keyword to the name of a font passed to PostScript with Set_Plot keyword.</span>
   Symbol=symbol,                     $ <span class="comments">; Set this keyword to select the Symbol font.</span>
   Times=times,                       $ <span class="comments">; Set this keyword to select the Times font.</span>
   TrueType=truetype,                 $ <span class="comments">; Set this keyword to select True-Type fonts.</span>
   XOffset=xoffset,                   $ <span class="comments">; Set this keyword to the XOffset. (Note: offset calculated from lower-left corner of page.)</span>
   XSize=xsize,                       $ <span class="comments">; Set this keyword to the X size of the PostScript "window".</span>
   YOffset=yoffset,                   $ <span class="comments">; Set this keyword to the YOffset. (Note: offset calculated from lower-left corner of page.)</span>
   YSize=ysize,                       $ <span class="comments">; Set this keyword to the Y size of the PostScript "window".</span>
   ZapfChancery=zapfchancery,         $ <span class="comments">; Set this keyword to select the ZapfChancery font.</span>
   ZapfDingbats=zapfdingbats            <span class="comments">; Set this keyword to select the ZapfDingbats font.</span>

   <span class="comments">; Error handling.</span>

Catch, theError
IF theError NE 0 THEN BEGIN
   Catch, /Cancel
   ok = FSC_PSConfig_Error_Message(Traceback=Keyword_Set(debug))
   RETURN, 1
ENDIF

self.debug = 1<span class="comments">; Keyword_Set(debug)</span>
decomposed = Keyword_Set(decomposed)
encapsulated = Keyword_Set(encapsulated) <span class="comments">; Must come before LANDSCAPE.</span>
landscape = Keyword_Set(landscape)
IF encapsulated THEN landscape = 0

   <span class="comments">; Set the available PostScript fonts.</span>

availableFonts = [                      $
        'AvantGarde',                   $
        'Bookman',                      $
        'Courier',                      $
        'Helvetica',                    $
        'Palatino',                     $
        'Schoolbook',                   $
        'Symbol',                       $
        'Times',                        $
        'ZapfChancery',                 $
        'ZapfDingbats']

self.fontnames = Ptr_New(availableFonts)

   <span class="comments">; Default font and font type.</span>

fontname = "Helvetica"
IF N_Elements(fonttype) EQ 0 THEN fonttype = 2
IF N_Elements(filename) NE 0 THEN self.filenameSet = filename

   <span class="comments">; Metric style</span>
self.metric = Keyword_Set(metric)

   <span class="comments">; Set default values if a default setup was not asked for.</span>

IF N_Elements(defaultsetup) EQ 0 THEN BEGIN

   self.defaultsSet = 'None'
   IF N_Elements(bits_per_pixel) EQ 0 THEN bits_per_pixel = 8
   IF N_Elements(bits_per_pixel) NE 0 THEN BEGIN
       IF bits_per_pixel EQ 2 OR bits_per_pixel EQ 4 OR bits_per_pixel EQ 8 THEN $
          self.bitsSet = StrTrim(bits_per_pixel,2) ELSE self.bitsSet = '8'
   ENDIF
   IF N_Elements(color) EQ 0 THEN color = 1 ELSE color = 0 > color &lt<span class="comments">; color</span>
   IF N_Elements(filename) EQ 0 THEN filename = "idl.ps"
   
   <span class="comments">; Is this a fully-qualified filename?</span>
   dirName = File_Dirname(filename)  
    
   <span class="comments">; Parse the filename and the directory name     </span>
   IF N_Elements(directory) EQ 0 THEN BEGIN
        <span class="comments">; If no directory is provide, go get the last directory saved if you can.</span>
        <span class="comments">; Otherwise, use the current directory.</span>
        IF dirName EQ "." THEN BEGIN
            DEFSYSV, '!cgPostScript_LastDir', EXISTS=exists
            IF exists THEN directory = !cgPostScript_LastDir ELSE CD, Current=directory
        ENDIF ELSE BEGIN
            basename = File_Basename(filename)
            filename = basename
            directory = dirName
        ENDELSE
   ENDIF ELSE BEGIN
        IF dirName NE "." THEN BEGIN
            basename = File_Basename(filename)
            filename = basename
        ENDIF 
   ENDELSE
   IF N_Elements(fontsize) EQ 0 THEN fontsize = 12
   IF Keyword_Set(inches) EQ 0 THEN IF Keyword_Set(metric) THEN inches = 0 ELSE inches = 1
   IF N_Elements(name) EQ 0 THEN name = ""
   IF N_Elements(pagetype) EQ 0 THEN IF Keyword_Set(metric) THEN pagetype = "A4" ELSE pagetype = "LETTER"
   IF N_Elements(preview) EQ 0 THEN preview = 0
   IF N_Elements(set_font) EQ 0 THEN set_font = ""
   IF N_Elements(xoffset) EQ 0 THEN BEGIN
        IF landscape THEN BEGIN
            IF inches THEN xoffset = 0.75 ELSE xoffset = 0.75 * 2.54
        ENDIF ELSE BEGIN
            IF inches THEN xoffset = 0.5 ELSE xoffset = 0.5 * 2.54
        ENDELSE
   ENDIF
   IF N_Elements(xsize) EQ 0 THEN BEGIN
        IF landscape THEN BEGIN
            IF inches THEN xsize = 9.5 ELSE xsize = 9.5 * 2.54
        ENDIF ELSE BEGIN
            IF inches THEN xsize = 7.5 ELSE xsize = 7.5 * 2.54
        ENDELSE
   ENDIF
   IF N_Elements(yoffset) EQ 0 THEN BEGIN
        IF landscape THEN BEGIN
            IF inches THEN IF inches THEN yoffset = 10.25 ELSE yoffset = 10.25 * 2.54
        ENDIF ELSE BEGIN
            IF inches THEN yoffset = 2.5 ELSE yoffset = 2.5 * 2.54
        ENDELSE
   ENDIF
   IF N_Elements(ysize) EQ 0 THEN BEGIN
        IF landscape THEN BEGIN
            IF inches THEN IF inches THEN ysize = 7.0 ELSE ysize = 7.0 * 2.54
        ENDIF ELSE BEGIN
            IF inches THEN ysize = 6.0 ELSE ysize = 6.0 * 2.54
        ENDELSE
   ENDIF
   IF N_Elements(langlevel) EQ 0 THEN langlevel = 1

   avantgarde = Keyword_Set(avantgarde)
   bold = Keyword_Set(bold)
   book = Keyword_Set(book)
   bookman = Keyword_Set(bookman)
   cmyk = Keyword_Set(cmyk)
   courier = Keyword_Set(courier)
   demi = Keyword_Set(demi)
   helvetica = Keyword_Set(helvetica)
   IF N_Elements(isolatin) EQ 0 THEN isolatin = 1 ELSE isolatin = Keyword_Set(isolatin)
   italic = Keyword_Set(italic)
   light = Keyword_Set(light)
   medium = Keyword_Set(medium)
   metric = Keyword_Set(metric)
   narrow = Keyword_Set(narrow)
   oblique = Keyword_Set(oblique)
   palatino = Keyword_Set(palatino)
   schoolbook = Keyword_Set(schoolbook)
   symbol = Keyword_Set(symbol)
   times = Keyword_Set(times)
   truetype = Keyword_Set(truetype)
   zapfchancery = Keyword_Set(zapfchancery)
   zapfdingbats = Keyword_Set(zapfdingbats)

   fontset = [avantgarde, bookman, courier, helvetica, palatino, schoolbook, symbol, times, zapfchancery, zapfdingbats]
   index = Where(fontset EQ 1, count)
   IF count EQ 0 THEN self.fontnameSet = 'Helvetica' ELSE self.fontnameSet = (*self.fontnames)[index[0]]
   IF self.fontnameSet EQ 'AvantGarde' THEN self.avantgarde = 1 ELSE self.avantgarde = 0
   IF self.fontnameSet EQ 'Bookman' THEN self.bookman = 1 ELSE self.bookman = 0
   IF self.fontnameSet EQ 'Courier' THEN self.courier = 1 ELSE self.courier = 0
   IF self.fontnameSet EQ 'Helvetica' THEN self.helvetica = 1 ELSE self.helvetica = 0
   IF self.fontnameSet EQ 'Palatino' THEN self.palatino = 1 ELSE self.palatino = 0
   IF self.fontnameSet EQ 'Schoolbook' THEN self.schoolbook = 1 ELSE self.schoolbook = 0
   IF self.fontnameSet EQ 'Symbol' THEN self.symbol = 1 ELSE self.symbol = 0
   IF self.fontnameSet EQ 'Times' THEN self.times = 1 ELSE self.times = 0
   IF self.fontnameSet EQ 'ZapfChancery' THEN self.zapfchancery = 1 ELSE self.zapfchancery = 0
   IF self.fontnameSet EQ 'ZapfDingbats' THEN self.zapfdingbats = 1 ELSE self.zapfdingbats = 0

   self.bitsSet = StrTrim(bits_per_pixel, 2)
   self.decomposedSet = decomposed
   self.cmykSet = cmyk
   self.colorSet = color
   self.directorySet = directory
   self.metric = metric
   self.encapsulationSet = encapsulated
   self.filenameSet = filename
   self.fonttypeSet = -1 > fonttype &lt<span class="comments">; 1</span>
   self.fontsizeSet = Strtrim( 6 > Fix(fontsize) &lt<span class="comments">; 36, 2)</span>
   self.fontstyleSet = [bold, book, demi, italic, light, medium, narrow, oblique]
   self.inchesSet = inches
   self.isolatinSet = isolatin
   self.landscapeSet = landscape
   self.langlevelSet = langlevel
   self.name = name
   self.pagetype = pagetype
   self.pagetypeSet = pagetype
   self.previewSet = preview
   self.truetypeSet = truetype
   self.set_fontSet = set_font

   <span class="comments">; Offsets are harder to set because I am trying to shield the</span>
   <span class="comments">; user from PostScript weirdness.</span>

   IF landscape THEN BEGIN
      dims = self->PageDimensions()
      self.xoffsetSet = dims[1] - yoffset
      self.xsizeSet = xsize
      self.yoffsetSet = xoffset
      self.ysizeSet = ysize
   ENDIF ELSE BEGIN
      self.xoffsetSet = xoffset
      self.xsizeSet = xsize
      self.yoffsetSet = yoffset
      self.ysizeSet = ysize
   ENDELSE

   <span class="comments">; Get the correct directory separator.</span>

    CASE StrUpCase(!Version.OS_Family) OF
       'WINDOWS' : sep = '\'    <span class="comments">; PCs</span>
       'MACOS'   : sep = ':'    <span class="comments">; Macintoshes</span>
       'VMS'     : sep = ']'    <span class="comments">; VMS machines</span>
       ELSE      : sep = '/'    <span class="comments">; Unix machines</span>
    ENDCASE
    
    index = FSC_PSCONFIG_RStrPos(directory, sep)
    IF index EQ - 1 THEN BEGIN
       self.fullFilenameSet = directory + sep + filename
    ENDIF ELSE BEGIN
       IF index EQ (StrLen(directory) - 1) THEN self.fullFilenameSet = directory + filename ELSE $
           self.fullFilenameSet = directory + sep + filename
    ENDELSE

ENDIF ELSE self->SetDefault, defaultsetup

   <span class="comments">; Save this configuration.</span>

self->SaveConfiguration

RETURN, 1
END <span class="comments">;--------------------------------------------------------------------------------</span>


PRO FSC_PSCONFIG__DEFINE

   struct = { FSC_PSCONFIG,            $

                  <span class="comments">; Font specifiers.</span>

              avantgarde: 0,           $
              bkman: 0,                $
              bookman: 0,              $
              courier: 0,              $
              helvetica: 0,            $
              palatino: 0,             $
              portrait: 0,             $
              schoolbook: 0,           $
              symbol: 0,               $
              times: 0,                $
              zapfchancery: 0,         $
              zapfdingbats: 0,         $

                  <span class="comments">; Widget identifiers.</span>

              clearbuttonID: 0L,            $ <span class="comments">; Clear Font Style settings button.</span>
              tlb: 0L,                      $ <span class="comments">; The top-level base of the GUI.</span>
              acceptID: 0L,                 $ <span class="comments">; The Accept or Apply button ID.</span>
              revertID: 0L,                 $ <span class="comments">; The Revert button ID.</span>
              pagetypeID: Obj_New(),        $ <span class="comments">; The pagetype droplist ID.</span>
              orientationID: Obj_New(),     $ <span class="comments">; The orientation droplist ID.</span>
              unitsID: Obj_New(),           $ <span class="comments">; The units droplist ID.</span>
              encapsulationID: Obj_New(),   $ <span class="comments">; The encapsulation droplist ID.</span>
              previewID: Obj_New(),         $ <span class="comments">; The preview droplist ID.</span>
              colorID: Obj_New(),           $ <span class="comments">; The color droplist ID.</span>
              cmykID: Obj_New(),            $ <span class="comments">; The cmyk droplist ID.</span>
              bitsID: Obj_New(),            $ <span class="comments">; The bits droplist ID.</span>
              decomposedID: Obj_New(),      $ <span class="comments">; The decomposed droplist ID.</span>
              defaultsID: Obj_New(),        $ <span class="comments">; The defaults droplist ID.</span>
              plotID: Obj_New(),            $ <span class="comments">; The plot window ID.</span>
              filenameID: Obj_New(),        $ <span class="comments">; The filename widget ID.</span>
              fontnameID: Obj_New(),        $ <span class="comments">; The font name droplist ID.</span>
              fontsizeID: Obj_New(),        $ <span class="comments">; The font size droplist ID.</span>
              fontstyleID: Obj_New(),       $ <span class="comments">; The font style droplist ID.</span>
              fontstyleButtonID: LonArr(8), $ <span class="comments">; The pagetype droplist ID.</span>
              fonttypeID: Obj_New(),        $ <span class="comments">; The font style button IDs.</span>
              isolatinID: Obj_New(),        $ <span class="comments">; The isolatin1 droplist ID.</span>
              langlevelID: Obj_New(), $     $ <span class="comments">; The language level droplist ID.</span>
              set_fontID: Obj_New(),        $ <span class="comments">; The set font text widget ID.</span>
              stylebaseID: 0L,              $ <span class="comments">; The style base widget ID.</span>
              truetypeID: Obj_New(),        $ <span class="comments">; The true-type droplist ID.</span>
              xsizeID: Obj_New(),           $ <span class="comments">; The xsize field ID.</span>
              ysizeID: Obj_New(),           $ <span class="comments">; The ysize field  ID.</span>
              xoffsetID: Obj_New(),         $ <span class="comments">; The xoffset field  ID.</span>
              yoffsetID: Obj_New(),         $ <span class="comments">; The yoffset field ID.</span>

                  <span class="comments">; Data values and flags.</span>

               debug: 0,             $ <span class="comments">; Set if debugging is turned on.</span>
               fontInfo: 0,          $ <span class="comments">; Set if the user wants font information on GUI.</span>
               fontnames: Ptr_New(), $ <span class="comments">; The allowed font names.</span>
<span class="comments">;               european: 0,          $ ; Set if European units and page size are in effect.</span>
               pagetype: "",         $ <span class="comments">; The current page size or type.</span>
               metric: 0,            $ <span class="comments">; Set if metric units and page size are in effect.</span>
               name: "",             $ <span class="comments">; The "name" of the object.</span>
               noblock: 0,           $ <span class="comments">; A flag that tells whether the GUI is in NOBLOCK state.</span>
               cancel: 0,            $ <span class="comments">; A flag that tells the status of the Cancel button.</span>
               thisDevice: "",       $ <span class="comments">; The entry graphics device. Will be restored.</span>

                  <span class="comments">; GUI property identifiers.</span>

               bitsSet: "",             $ <span class="comments">; Sets the bits_per_pixel value.</span>
               cmykSet:0,               $ <span class="comments">; Sets the CMYK on/off value.</span>
               colorSet: 0,             $ <span class="comments">; Sets the color on/off value.</span>
               decomposedSet: 0,        $ <span class="comments">; Set the decomposed value.</span>
               defaultsSet: "",         $ <span class="comments">; Sets the default setup value.</span>
               directorySet: "",        $ <span class="comments">; Sets the directory name value.</span>
               inchesSet: 0,            $ <span class="comments">; Sets the units value.</span>
               isolatinSet: 1,          $ <span class="comments">; Sets the isolatin1 value.</span>
               encapsulationSet: 0,     $ <span class="comments">; Sets the encapsulation value.</span>
               filenameSet: "",         $ <span class="comments">; Sets the file name value.</span>
               fullFilenameSet: "",     $ <span class="comments">; Sets the fully-qualified filename.</span>
               fontsizeSet: "",         $ <span class="comments">; Sets the font size value.</span>
               fontstyleSet: IntArr(8), $ <span class="comments">; Sets the font style values.</span>
               fontnameSet: "",         $ <span class="comments">; Sets the font name value.</span>
               fonttypeSet: 0,          $ <span class="comments">; Sets the font type value.</span>
               landscapeSet: 0,         $ <span class="comments">; Sets the orientation value.</span>
               langlevelSet: 0,         $ <span class="comments">; Set the language level value.</span>
               pagetypeSet: "",         $ <span class="comments">; Sets the page type or size value.</span>
               previewSet: 0,           $ <span class="comments">; Sets the preview value.</span>
               set_fontSet: "",         $ <span class="comments">; Sets the Set_Font font name value.</span>
               truetypeSet: 0,          $ <span class="comments">; Sets the true-type font value.</span>
               xoffsetSet: 0.0,         $ <span class="comments">; Sets the xoffset value.</span>
               xsizeSet: 0.0,           $ <span class="comments">; Sets the xsize value.</span>
               yoffsetSet: 0.0,         $ <span class="comments">; Sets the yoffset value.</span>
               ysizeSet: 0.0,           $ <span class="comments">; Sets the ysize value.</span>

                  <span class="comments">; GUI revert property identifiers. Mirrors of GUI property identifiers above.</span>

               bitsRevert: "", $
               cmykRevert:0, $
               colorRevert: 0, $
               decomposedRevert: 0, $
               defaultsRevert: "", $
               directoryRevert: "", $
               inchesRevert: 0, $
               isolatinRevert: 1, $
               encapsulationRevert: 0, $
               filenameRevert: "", $
               fontsizeRevert: "", $
               fontstyleRevert: IntArr(8), $
               fontnameRevert: "", $
               fonttypeRevert: 0, $
               landscapeRevert: 0, $
               langlevelRevert: 0, $
               pagetypeRevert: "", $
               previewRevert: 0, $
               set_fontRevert: "", $
               truetypeRevert: 0, $
               xoffsetRevert: 0.0, $
               xsizeRevert: 0.0, $
               yoffsetRevert: 0.0, $
               ysizeRevert: 0.0 $

}

END
</code>
    </div>
  </body>
</html>