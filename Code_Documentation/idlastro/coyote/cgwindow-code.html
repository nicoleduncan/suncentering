<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:19 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>cgwindow.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="cgwindow.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">; docformat = 'rst'</span>
<span class="comments">;</span>
<span class="comments">; NAME:</span>
<span class="comments">;   cgWindow</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;   Creates a resizeable graphics window for IDL traditional commands (Plot, Contour, </span>
<span class="comments">;   Surface, etc. or for Coyote Graphics routines, cgPlot, cgContour, cgSurf, etc.). </span>
<span class="comments">;   In addition, the window contents can be saved as PostScript files or as raster image </span>
<span class="comments">;   files. If ImageMagick is installed on your machine, the raster image files can be </span>
<span class="comments">;   created in very high quality from PostScript files.</span>
<span class="comments">;</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Copyright (c) 2011, by Fanning Software Consulting, Inc. All rights reserved.           ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  Redistribution and use in source and binary forms, with or without                      ;</span>
<span class="comments">;  modification, are permitted provided that the following conditions are met:             ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;      * Redistributions of source code must retain the above copyright                    ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer.                     ;</span>
<span class="comments">;      * Redistributions in binary form must reproduce the above copyright                 ;</span>
<span class="comments">;        notice, this list of conditions and the following disclaimer in the               ;</span>
<span class="comments">;        documentation and/or other materials provided with the distribution.              ;</span>
<span class="comments">;      * Neither the name of Fanning Software Consulting, Inc. nor the names of its        ;</span>
<span class="comments">;        contributors may be used to endorse or promote products derived from this         ;</span>
<span class="comments">;        software without specific prior written permission.                               ;</span>
<span class="comments">;                                                                                          ;</span>
<span class="comments">;  THIS SOFTWARE IS PROVIDED BY FANNING SOFTWARE CONSULTING, INC. ''AS IS'' AND ANY        ;</span>
<span class="comments">;  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES    ;</span>
<span class="comments">;  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT     ;</span>
<span class="comments">;  SHALL FANNING SOFTWARE CONSULTING, INC. BE LIABLE FOR ANY DIRECT, INDIRECT,             ;</span>
<span class="comments">;  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED    ;</span>
<span class="comments">;  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;         ;</span>
<span class="comments">;  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND             ;</span>
<span class="comments">;  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT              ;</span>
<span class="comments">;  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS           ;</span>
<span class="comments">;  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.                            ;</span>
<span class="comments">;******************************************************************************************;</span>
<span class="comments">;+</span>
<span class="comments">;  Creates a resizeable graphics window for IDL traditional commands (Plot, Contour, </span>
<span class="comments">;  Surface, etc. or for Coyote Graphics routines, `cgPlot`, `cgContour`, `cgSurf`, etc.). </span>
<span class="comments">;  In addition, the window contents can be saved as PostScript, PDF, or raster image </span>
<span class="comments">;  files. If ImageMagick is installed on your machine, the raster image files can be </span>
<span class="comments">;  created in very high quality from PostScript files.</span>
<span class="comments">;</span>
<span class="comments">;  The program is designed to work with any IDL traditional graphics routine</span>
<span class="comments">;  that is a procedure and includes no more than three positional parameters.</span>
<span class="comments">;  Any number of keywords can be used to specify properties of the graphical</span>
<span class="comments">;  output. Any number of graphics commands can be "added" the the cgWindow.</span>
<span class="comments">;  Simply use the `AddCmd` keyword to add commands.</span>
<span class="comments">;  </span>
<span class="comments">;  If your program does not load its own color tables, the color tables in</span>
<span class="comments">;  effect when cgWindow is first called are used to display the graphics</span>
<span class="comments">;  commands.</span>
<span class="comments">;    </span>
<span class="comments">;  To create PostScript output from within cgWindow, your graphics program</span>
<span class="comments">;  has to be written in such a way that it can work properly in the PostScript</span>
<span class="comments">;  device. This means there are no Window commands, WSet commands, and the like</span>
<span class="comments">;  that are not allowed in the PostScript device. Such commands are allowed in </span>
<span class="comments">;  programs, of course, if they are "protected". Usually such protection looks </span>
<span class="comments">;  like this::</span>
<span class="comments">;  </span>
<span class="comments">;     IF (!D.Flags AND 256) NE 0 THEN Window, ...</span>
<span class="comments">;     </span>
<span class="comments">;  The Coyote Graphics program `cgDisplay` is a good program for opening graphics </span>
<span class="comments">;  "windows", because such PostScript protection is built into the program. In a PostScript </span>
<span class="comments">;  device, cgDisplay produces a "window" with the same aspect ratio as the current</span>
<span class="comments">;  display graphics window, which is an aid in producing PostScript output that</span>
<span class="comments">;  looks like the same output in the display window.</span>
<span class="comments">;   </span>
<span class="comments">;  Much better looking raster files can be created from the cgWindow contents,</span>
<span class="comments">;  if the raster files are created by converting PostScript files to the raster </span>
<span class="comments">;  file. If the ImageMagick "convert" command can be found on your machine, you</span>
<span class="comments">;  will have the option to create raster files using this method. I *highly*</span>
<span class="comments">;  recommend doing so, as fonts and other plot annotation will be of much higher</span>
<span class="comments">;  quality using this method.</span>
<span class="comments">;   </span>
<span class="comments">;  cgWindow has been designed to work with other Coyote Graphics routines: `cgPlot`,</span>
<span class="comments">;  `cgContour`, `cgSurf`, and so on, although I expect it to work with any IDL</span>
<span class="comments">;  traditional graphics routine, if the routine is well written.</span>
<span class="comments">;        </span>
<span class="comments">; :Categories:</span>
<span class="comments">;    Graphics</span>
<span class="comments">;    </span>
<span class="comments">; :Author:</span>
<span class="comments">;    FANNING SOFTWARE CONSULTING::</span>
<span class="comments">;       David W. Fanning </span>
<span class="comments">;       1645 Sheely Drive</span>
<span class="comments">;       Fort Collins, CO 80526 USA</span>
<span class="comments">;       Phone: 970-221-0438</span>
<span class="comments">;       E-mail: david@idlcoyote.com</span>
<span class="comments">;       Coyote's Guide to IDL Programming: http://www.idlcoyote.com</span>
<span class="comments">;</span>
<span class="comments">; :Copyright:</span>
<span class="comments">;     Copyright (c) 2011, Fanning Software Consulting, Inc.</span>
<span class="comments">;-</span>


<span class="comments">;+</span>
<span class="comments">;   Creates a resizeable graphics window for IDL traditional commands (Plot, Contour, </span>
<span class="comments">;   Surface, etc. or for Coyote Graphics routines, cgPlot, cgContour, cgSurf, etc.). </span>
<span class="comments">;   In addition, the window contents can be saved as PostScript files or as raster image </span>
<span class="comments">;   files. If ImageMagick is installed on your machine, the raster image files can be </span>
<span class="comments">;   created in very high quality from PostScript files.</span>
<span class="comments">;</span>
<span class="comments">; :Params:</span>
<span class="comments">;    command: in, required, type=string</span>
<span class="comments">;       The graphics procedure command to be executed. This parameter</span>
<span class="comments">;       must be a string and the the command must be a procedure. Examples</span>
<span class="comments">;       are 'Surface', 'Contour', 'Plot', 'cgPlot', cgContour, etc.</span>
<span class="comments">;    p1: in, optional, type=any</span>
<span class="comments">;       The first positional parameter appropriate for the graphics command.</span>
<span class="comments">;    p2: in, optional, type=any</span>
<span class="comments">;       The second positional parameter appropriate for the graphics command.</span>
<span class="comments">;    p3: in, optional, type=any</span>
<span class="comments">;       The third positional parameter appropriate for the graphics command.</span>
<span class="comments">;    p4: in, optional, type=any</span>
<span class="comments">;       The fourth positional parameter appropriate for the graphics command.</span>
<span class="comments">;       </span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    addcmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to add an additional graphics command to an cgWindow.</span>
<span class="comments">;       The command is added to the last created cgWindow, unless the WinID</span>
<span class="comments">;       keyword is used to select another cgWindow. Adding a command causes</span>
<span class="comments">;       all the commands in the window to be immediately executed. If this is</span>
<span class="comments">;       not behavior you desire, use the LOADCMD keyword instead. If CMDINDEX</span>
<span class="comments">;       is used to select a command index, the new command is added before</span>
<span class="comments">;       the command currently occuping that index in the command list.</span>
<span class="comments">;    altps_Keywords: in, optional, type=string</span>
<span class="comments">;       A structure containing alternative keyword names (as tags) and values for</span>
<span class="comments">;       those keywords to be used when the current device is the PostScript device.</span>
<span class="comments">;       See http://www.idlcoyote.com/cg_tips/kwexpressions.php and the examples</span>
<span class="comments">;       below for details on how to use this keyword.</span>
<span class="comments">;    altps_Params: in, optional, type=IntArr(3)</span>
<span class="comments">;       A structure containing alternative parameter values to be used when </span>
<span class="comments">;       the current device is the PostScript device. Structure names are restricted</span>
<span class="comments">;       to the names "P1", "P2", "P3" and "P4" to correspond to the equivalent positional</span>
<span class="comments">;       parameter. See http://www.idlcoyote.com/cg_tips/kwexpressions.php and the </span>
<span class="comments">;       examples below for details on how to use this keyword.</span>
<span class="comments">;    cmddelay: in, optional, type=float</span>
<span class="comments">;       If this keyword is set to a value other than zero, there will be a </span>
<span class="comments">;       delay of this many seconds between command execution. This will permit</span>
<span class="comments">;       "movies" of command sequences to be displayed.</span>
<span class="comments">;    cmdindex: in, optional, type=integer</span>
<span class="comments">;       This keyword is used to select which command in an cgWindow to act on</span>
<span class="comments">;       when the AllCmd, DeleteCmd, LoadCmd and ReplaceCmd keywords are used. </span>
<span class="comments">;       See the descriptions of these keywords for details on what happens when </span>
<span class="comments">;       CmdIndex is missing.</span>
<span class="comments">;    deletecmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to delete a graphics command from an cgWindow.</span>
<span class="comments">;       If CmdIndex is undefined the last command entered into the window is</span>
<span class="comments">;       deleted. It is not possible to delete the last command in the window.</span>
<span class="comments">;       Use WinID to identify the cgWindow you are interested in. If WinID </span>
<span class="comments">;       is undefined, the last cgWindow created is used.</span>
<span class="comments">;    executecmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to immediate execute all the commands in an cgWindow.</span>
<span class="comments">;       Normally, this is used after commands have been loaded with LOADCMD.</span>
<span class="comments">;    group_leader: in, optional</span>
<span class="comments">;       The identifier of a widget to serve as a group leader for this program.</span>
<span class="comments">;       If the group leader is destroyed, this program is also destroyed. Used</span>
<span class="comments">;       when calling this program from another widget program.</span>
<span class="comments">;    listcmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       If this keyword is set, the commands currently in the cgWindow are</span>
<span class="comments">;       listed. Use WinID to identify the cgWindow you are interested in.</span>
<span class="comments">;       If WinID is undefined, the last cgWindow created is used.</span>
<span class="comments">;    loadcmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to add an additional graphics command to an cgWindow.</span>
<span class="comments">;       The command is added to the last created cgWindow, unless the WinID</span>
<span class="comments">;       keyword is used to select another cgWindow. Loaded commands are not</span>
<span class="comments">;       automatically executed. Set the EXECUTECMD keyword at the end of loading</span>
<span class="comments">;       to execute the loaded commands. If CMDINDEX is used to select a command </span>
<span class="comments">;       index, the new command is loaded before the command currently occuping </span>
<span class="comments">;       that index in the command list.</span>
<span class="comments">;    method: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword if the command is an object method call rather than a </span>
<span class="comments">;       procedure call. If this keyword is set, the first positional parameter, p1,</span>
<span class="comments">;       must be present and must be a valid object reference.</span>
<span class="comments">;    replacecmd: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to replace a graphics command from an cgWindow.</span>
<span class="comments">;       If CmdIndex is undefined, *all* commands in the window are replaced. Use </span>
<span class="comments">;       WinID to identify the cgWindow you are interested in. If WinID is </span>
<span class="comments">;       undefined, the last cgWindow created is used for the replacement.</span>
<span class="comments">;    waspect: in, optional, type=float, default=normal</span>
<span class="comments">;       Set this keyword to the aspect ratio you would like the window to have.</span>
<span class="comments">;       The aspect ratio is calculated as (ysize/xsize). Must be a float value.</span>
<span class="comments">;       If this keyword is set, the window will maintain this aspect ratio,</span>
<span class="comments">;       even when it is resized.</span>
<span class="comments">;    wbackground: in, optional, type=varies, default=!P.Background</span>
<span class="comments">;       The background color of the window. Specifying a background color </span>
<span class="comments">;       automatically sets the WErase keyword.</span>
<span class="comments">;    werase: in, optional, type=boolean, default=0</span>
<span class="comments">;       Set this keyword to cause the window to be erased before graphics commands </span>
<span class="comments">;       are drawn. This may need to be set, for example, to display images.</span>
<span class="comments">;    winid: in, optional, type=integer</span>
<span class="comments">;       Use this keyword to select the window cgWindow identifier (the number between</span>
<span class="comments">;       the parentheses in the title bar of cgWindow). The AddCmd, ReplaceCmd, ListCmd,</span>
<span class="comments">;       and DeleteCmd keywords will all apply to the commands in the last cgWindow</span>
<span class="comments">;       created unless this keyword is used to select another cgWindow to apply the </span>
<span class="comments">;       commands to.</span>
<span class="comments">;    wmulti: in, optional, type=intarr(5)</span>
<span class="comments">;        Set this keyword in exactly the same way you would set the !P.Multi keyword.</span>
<span class="comments">;        It will allow you to display multi-plots in the cgWindow graphics window.</span>
<span class="comments">;    wobject: out, optional, type=object</span>
<span class="comments">;       cgWindow creates a FSC_CmdWindow object. This object reference is returned</span>
<span class="comments">;       if this keyword is present.</span>
<span class="comments">;    woxmargin: in, optional, type=float</span>
<span class="comments">;       A two-element array indicating the left and right X outside margins for the</span>
<span class="comments">;       graphical display. Used only when doing multiple plots with `WMulti`.</span>
<span class="comments">;    woymargin: in, optional, type=float</span>
<span class="comments">;       A two-element array indicating the bottom and top Y outside margins for the</span>
<span class="comments">;       graphical display. Used only when doing multiple plots with `WMulti`.</span>
<span class="comments">;    wxpos: in, optional, type=integer, default=5</span>
<span class="comments">;       The x offset in device coordinates of the cgWindow from the upper-left corner of the display.</span>
<span class="comments">;    wypos: in, optional, type=integer, default=5</span>
<span class="comments">;       The y offset in device coordinates of the cgWindow from the upper-left corner of the display.</span>
<span class="comments">;    wxsize: in, optional, type=integer, default=640</span>
<span class="comments">;       The x size in device coordinates of the graphics window.</span>
<span class="comments">;    wysize: in, optional, type=integer, default=5</span>
<span class="comments">;       The y size in device coordinates of the the graphics window.</span>
<span class="comments">;    wtitle: in, optional, type=string, default='Resizeable Graphics Window'</span>
<span class="comments">;       The title of the graphics window. A window index number is appended to the</span>
<span class="comments">;       title so multiple cgWindow programs can be selected.</span>
<span class="comments">;          </span>
<span class="comments">; :Examples:</span>
<span class="comments">;    Test code::</span>
<span class="comments">;       data = cgDemoData(17)</span>
<span class="comments">;       cgWindow, 'cgPlot', data, COLOR='red'</span>
<span class="comments">;       cgWindow, 'cgPlot', data, PSYM=2, /Overplot, COLOR='dodger blue', /AddCmd</span>
<span class="comments">;       cgWIndow, 'cgPlot', cgDemoData(17), color='olive', linestyle = 2, /Overplot, /AddCmd</span>
<span class="comments">;       cgWindow, /ListCmd</span>
<span class="comments">;       cgWindow, 'cgPlot', data, COLOR='purple', /ReplaceCMD, CMDINDEX=0</span>
<span class="comments">;       </span>
<span class="comments">;    Additional examples can be found here::</span>
<span class="comments">;       </span>
<span class="comments">;        http://www.idlcoyote.com/graphics_tips/cgwindow.html</span>
<span class="comments">;          </span>
<span class="comments">;    Example using different keyword parameters for the display and PostScript output::</span>
<span class="comments">;    </span>
<span class="comments">;        IDL> cgPlot, cgDemoData(1), /WINDOW, $</span>
<span class="comments">;             THICK=1.0, XTITLE='Distance (' + Greek('mu') + 'm)', $</span>
<span class="comments">;             ALTPS_KEYWORDS={THICK:4.0, XTITLE:'Distance (' + Greek('mu', /PS) + 'm)'}</span>
<span class="comments">;           </span>
<span class="comments">;    Example using different positional parameters::</span>
<span class="comments">;    </span>
<span class="comments">;        IDL> cgText, 0.20, 0.85, /Normal, 'Line of Text', ALIGNMENT=0.0, $</span>
<span class="comments">;             ALTPS_KEYWORDS={ALIGNMENT:1.0}, ALTPS_PARAMS={P1:0.88}, /ADDCMD</span>
<span class="comments">;           </span>
<span class="comments">;    Additional examples can be found here::</span>
<span class="comments">;    </span>
<span class="comments">;        http://www.idlcoyote.com/cg_tips/kwexpressions.php</span>
<span class="comments">;           </span>
<span class="comments">; :History:</span>
<span class="comments">;     Change History::</span>
<span class="comments">;        Written, 17 January 2011. DWF.</span>
<span class="comments">;        Fixed a problem with the example code, and added EMPTY to end of Draw method</span>
<span class="comments">;           to force UNIX machines to empty the graphics buffer after CALL_PROCEDURE. 20 Jan 2011. DWF.</span>
<span class="comments">;        Improved documentation and error handling. 19 Jan 2011. DWF.</span>
<span class="comments">;        More improved error handling and messages. 26 Jan 2011. DWF.</span>
<span class="comments">;        Made changes to accommodate the new cgControl routine. 27 Jan 2011. DWF.</span>
<span class="comments">;        Added WXOMARGIN and WYOMARGIN keywords. 28 Jan 2011. DWF.</span>
<span class="comments">;        Numerous changes leading up to official release. 4 Feb 2011. DWF.</span>
<span class="comments">;        Added workaround for UNIX bug for draw widget creation. 5 Feb 2011. DWF.</span>
<span class="comments">;        Corrected a window aspect ratio problem with PostScript output by making the</span>
<span class="comments">;           window the current window before calling PS_Start. 17 Feb 2011. DWF.</span>
<span class="comments">;        Added machinery for programmatically generating raster files. 18 Feb 2011. Jeremy Bailin.</span>
<span class="comments">;        Problem with restoring visualizations fixed. 6 March 2011. DWF.</span>
<span class="comments">;        Fixed a problem with CALL_METHOD, which requires one positional parameter. 8 March 2011. DWF.</span>
<span class="comments">;        Added the ability to set and unset adjustable text size in the window. 24 April 2011. DWF.</span>
<span class="comments">;        Fixed a problem in the ReplaceCommand method that had input parameters reversed. 6 May 2011. DWF.</span>
<span class="comments">;        Added the ability to set the dimensions of the draw widget programmatically. 14 June 2011.</span>
<span class="comments">;        Added the keywords EvalKeywords and EvalParams to allow evaluation of command parameters and</span>
<span class="comments">;            keywords at run-time. See http://www.idlcoyote.com/cg_tips/kwexpressions.php for</span>
<span class="comments">;            additional details and explanations of how these keywords should be used. 2 Aug 2011.</span>
<span class="comments">;        Problem dereferencing a null pointer in DRAW method fixed. 3 Aug 2011. DWF.</span>
<span class="comments">;        Changes to handle inability to create raster files from PS encapsulated files in </span>
<span class="comments">;           landscape mode. 26 Aug 2011. DWF.</span>
<span class="comments">;        Added ability to set PostScript color mode. 30 Aug 2011. DWF.</span>
<span class="comments">;        The method I was using for evaluating keyword and argument parameters at run-time</span>
<span class="comments">;            was just WAY too complicated and difficult to use. I have eliminated this</span>
<span class="comments">;            method (along with the EvalKeywords and EvalParams) in favor of a method that</span>
<span class="comments">;            allows the user to supply alternative values to use in the PostScript device.</span>
<span class="comments">;            This uses keywords AltPS_Keywords and AltPS_Params to collect these alternative</span>
<span class="comments">;            arguments in structures that can be used at run-time to supply alternative values.</span>
<span class="comments">;            As before, this is explained in detail at http://www.idlcoyote.com/cg_tips/kwexpressions.php.</span>
<span class="comments">;            1 Sept 2011. DWF.</span>
<span class="comments">;         Missed a couple of places to set decomposition color mode. 7 Sept 2011. DWF.</span>
<span class="comments">;         Fixed a problem with improper filename when creating raster file vis</span>
<span class="comments">;             Imagemagick via cgControl. 10 Oct 2011. DWF.</span>
<span class="comments">;         Added WASPECT keyword to allow window aspect ratio to be set. 9 Nov 2011. DWF.   </span>
<span class="comments">;         Added PDF file to the Save As menu. Requires Ghostscript to be installed on some machines. 6 Dec 2011. DWF.</span>
<span class="comments">;         Added modifications to allow PDF files to be programmatically created from cgControl. 11 Dec 2011. DWF.</span>
<span class="comments">;         Added the ability to specify a fourth positional parameter. 6 Jan 2012. DWF.</span>
<span class="comments">;         Separated off the cgCmdWindow part of the code to make an object-widget draw widget. 19 Jan 2012. DWF.</span>
<span class="comments">;         Fixed a small type with the Outside Margin keywords that was preventing these from being used. 19 April 2012. DWF.</span>
<span class="comments">;         In decompling cgWindow from cgCmdWindow, I accidentally named the WASPECT keyword ASPECT. Restored</span>
<span class="comments">;             original name in this version. 13 July 2012. DWF.</span>
<span class="comments">;-</span>
PRO cgWindow, $
   command, $                       <span class="comments">; The graphics "command" to execute.</span>
   p1, p2, p3, p4, $                <span class="comments">; The four allowed positional parameters.</span>
   AddCmd=addcmd, $                 <span class="comments">; Set this keyword to add a command to the interface and immediate execute commands.</span>
   AltPS_Keywords=altps_Keywords, $ <span class="comments">; A structure of PostScript alternative keywords and values.</span>
   AltPS_Params=altps_Params, $     <span class="comments">; A structure of PostScript alternative parameters and values. Fields </span>
                                    <span class="comments">; should be "P1", "P2", "P3" or "P4".</span>
   CmdDelay=cmdDelay, $             <span class="comments">; Set this keyword to a value to "wait" before executing the next command.</span>
   CmdIndex=cmdIndex, $             <span class="comments">; Set this keyword to identify the index of the command to manipulate.</span>
   DeleteCmd=deletecmd, $           <span class="comments">; Set the keyword to delete a command.</span>
   ExecuteCmd=executecmd, $         <span class="comments">; Set this keyword to execute the commands in the window.</span>
   Group_Leader = group_leader, $   <span class="comments">; The group leader of the cgWindow program.</span>
   ListCmd=listCmd, $               <span class="comments">; Set this keyword to list the commands in the window.</span>
   LoadCmd=loadCmd, $               <span class="comments">; Set this keyword to load commands in the window, but not execute them.</span>
   Method=method, $                 <span class="comments">; If set, will use CALL_METHOD instead of CALL_PROCEDURE to execute command.</span>
   ReplaceCmd=replacecmd, $         <span class="comments">; Set this keyword to replace a command in the window.</span>
   WAspect = waspect, $             <span class="comments">; Set the window aspect ratio to this value.</span>
   WBackground = wbackground, $     <span class="comments">; The background color. Set to !P.Background by default.</span>
   WErase = weraseit, $             <span class="comments">; Set this keyword to erase the display before executing the command.</span>
   WinID=winid, $                   <span class="comments">; Set this keyword to select an cgWindow.</span>
   WMulti = wmulti, $               <span class="comments">; Set this in the same way !P.Multi is used.   </span>
   WObject=wobject, $               <span class="comments">; The FSC_CMDWindow object. A return value.</span>
   WOXMargin = woxmargin, $         <span class="comments">; Set the !X.OMargin. A two element array.</span>
   WOYMargin = woymargin, $         <span class="comments">; Set the !Y.OMargin. A two element array</span>
   WXPos = wxpos, $                 <span class="comments">; The X offset of the window on the display. The window is tiled if not set.</span>
   WXSize = wxsize, $               <span class="comments">; The X size of the cgWindow graphics window in pixels. By default: 640.</span>
   WYPos = wypos, $                 <span class="comments">; The Y offset of the window on the display. The window is tiled if not set.</span>
   WYSize = wysize, $               <span class="comments">; The Y size of the cgWindow graphics window in pixels. By default: 512.</span>
   WTitle = wtitle, $               <span class="comments">; The window title.</span>
    _Extra = extra                   <span class="comments">; Any extra keywords. Usually the "command" keywords.</span>

    Compile_Opt idl2
    
    Catch, theError
    IF theError NE 0 THEN BEGIN
        Catch, /CANCEL
        void = Error_Message(Traceback=0)
        RETURN
    ENDIF

    <span class="comments">; Did the user want to execute the commands in the window?</span>
    IF N_Elements(executeCmd) NE 0 THEN BEGIN
   
      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgWindow with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    thisWindowStruct.windowObj -> ExecuteCommands
                ENDIF ELSE BEGIN
                    Message, 'The cgWindow referred to does not exist.'
                ENDELSE
                RETURN
           ENDIF ELSE Message, 'A valid cgWindow does not exist to execute commands in.'
       ENDIF ELSE Message, 'A cgWindow object not exist to execute commands in.'
    ENDIF
    
    <span class="comments">; Did the user want to list the commands in a cgWindow?</span>
    IF N_Elements(listCmd) NE 0 THEN BEGIN
   
      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgWindow with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    thisWindowStruct.windowObj -> ListCommand
                ENDIF ELSE BEGIN
                    Message, 'The cgWindow referred to does not exist.'
                ENDELSE
                RETURN
           ENDIF ELSE Message, 'A valid cgWindow does not exist to list commands from.'
       ENDIF ELSE Message, 'A cgWindow object not exist to list commands from.'
    ENDIF
    
    <span class="comments">; Did the user want to delete a command in the window?</span>
    IF N_Elements(deleteCmd) NE 0 THEN BEGIN
   
      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgWindow with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    <span class="comments">; If the cmdIndex is undefined, the last entered command is deleted.</span>
                    thisWindowStruct.windowObj -> DeleteCommand, cmdIndex
                ENDIF ELSE BEGIN
                    Message, 'The cgWindow referred to does not exist.'
                ENDELSE
                RETURN
           ENDIF ELSE Message, 'The cgWindow object is not a valid window object.'
       ENDIF ELSE Message, 'A cgWindow object not exist to add a command to.'
   ENDIF

   <span class="comments">; Did the user want to replace a command or commands in the window?</span>
   IF Keyword_Set(replaceCmd) THEN BEGIN
      
      <span class="comments">; Must have a command to replace current command with.</span>
      IF N_Elements(command) EQ 0 THEN Message, 'No replacement command has been specified.'

      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgWindow with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    
                    <span class="comments">; Check command components.</span>
                    IF Size(command, /TNAME) NE 'STRING' THEN $
                        Message, 'The first positional argument must be a command string.'
                    IF N_Params() GT 5 THEN $
                        Message, 'The maximum number of positional command parameters allowed is four.'
                    newCommand = Obj_New('cgWindow_Command', COMMAND=command, $
                        P1=p1, P2=p2, P3=p3, P4=p4, KEYWORDS=extra, AltPS_Keywords=altps_Keywords, $
                        AltPS_Params=altps_Params, TYPE=Keyword_Set(method))
                        
                    <span class="comments">; If the cmdIndex is undefined, ALL current commands in the window are replaced.</span>
                    thisWindowStruct.windowObj -> ReplaceCommand, newCommand, cmdIndex, MULTI=wmulti
                    thisWindowStruct.windowObj -> ExecuteCommands
                ENDIF ELSE BEGIN
                    Message, 'The cgWindow referred to does not exist.'
                ENDELSE
                RETURN
           ENDIF ELSE Message, 'A valid cgWindow does not exist to replace commands with.'
       ENDIF ELSE Message, 'A cgWindow does not exist to replace commands with.'
    
    ENDIF 
   
   <span class="comments">; Did the user want to load commands without executing them?</span>
   IF Keyword_Set(loadCmd) THEN BEGIN

      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgWindow with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    newCommand = Obj_New('cgWindow_Command', COMMAND=command, $
                        P1=p1, P2=p2, P3=p3, P4=p4, KEYWORDS=extra, AltPS_Keywords=altps_Keywords, $
                        AltPS_Params=altps_Params, TYPE=Keyword_Set(method))
                    thisWindowStruct.windowObj -> AddCommand, newCommand, INDEX=cmdIndex
                ENDIF ELSE BEGIN
                    Message, 'The cgWindow referred to does not exist.'
                ENDELSE
                RETURN
           ENDIF ELSE Message, 'A valid cgWindow does not exist to add a command to.'
       ENDIF ELSE Message, 'A cgWindow does not exist to add a command to.'
    
    ENDIF 
   
   <span class="comments">; Did the user want to add a command to the window?</span>
   IF Keyword_Set(addCmd) THEN BEGIN

      <span class="comments">; Does the self object exist somewhere?</span>
      DefSysV, '!FSC_WINDOW_LIST', EXISTS=exists
      IF exists THEN BEGIN
           theList = !FSC_WINDOW_LIST
           IF Obj_Valid(theList) THEN BEGIN
                structs = theList -> Get_Item(/ALL, /DEREFERENCE)
                IF Size(structs, /TNAME) EQ 'POINTER' THEN RETURN
                IF N_Elements(winID) EQ 0 THEN BEGIN
                    winID = N_Elements(structs) - 1
                ENDIF ELSE BEGIN
                    index = Where(structs.wid[*] EQ winID, count)
                    IF count GT 0 THEN winID = index[0] ELSE BEGIN
                        Message, 'Cannot find an cgWindow with window index ' + StrTrim(winID, 2) + '.'
                    ENDELSE
                ENDELSE
                thisWindowStruct = structs[winID]
                IF Obj_Valid(thisWindowStruct.windowObj) THEN BEGIN
                    newCommand = Obj_New('cgWindow_Command', COMMAND=command, $
                        P1=p1, P2=p2, P3=p3, P4=p4, KEYWORDS=extra, AltPS_Keywords=altps_Keywords, $
                        AltPS_Params=altps_Params, TYPE=Keyword_Set(method))
                    thisWindowStruct.windowObj -> AddCommand, newCommand, INDEX=cmdIndex
                    thisWindowStruct.windowObj -> ExecuteCommands
                ENDIF ELSE BEGIN
                    Message, 'The cgWindow referred to does not exist.'
                ENDELSE
                RETURN
           ENDIF ELSE Message, 'A valid cgWindow does not exist to add a command to.'
       ENDIF ELSE Message, 'A cgWindow does not exist to add a command to.'
    
    ENDIF 
   
   <span class="comments">; Otherwise, make the command object.</span>
   wobject = Obj_New('cgCmdWindow', $
       Command=command, $               <span class="comments">; The graphics "command" to execute.</span>
       P1=p1, P2=p2, P3=p3, P4=p4, $    <span class="comments">; The four allowed positional parameters.</span>
       _Extra = extra, $                <span class="comments">; Any extra keywords. The "command" keywords.</span>
       CmdDelay = cmdDelay, $           <span class="comments">; The amount of time to "wait" between commands.</span>
       AltPS_Keywords=altps_Keywords, $ <span class="comments">; A structure of PostScript alternative keywords and values.</span>
       AltPS_Params=altps_Params, $     <span class="comments">; A structure of PostScript alternative parameters and values. Fields </span>
                                        <span class="comments">; should be "P1", "P2", "P3" or "P4".</span>
       Group_Leader = group_leader, $   <span class="comments">; The group leader of the cgWindow program.</span>
       Method=method, $                 <span class="comments">; If set, will use CALL_METHOD instead of CALL_PROCEDURE to execute command.</span>
       Background = wbackground, $      <span class="comments">; The background color. Not used unless set.</span>
       Multi = wmulti, $                <span class="comments">; Set this in the same way !P.Multi is used.</span>
       Erase = weraseit, $              <span class="comments">; Set this keyword to erase the display before executing the command.</span>
       OXMargin = woxMargin, $          <span class="comments">; The X outside margin.</span>
       OYMargin = woymargin, $          <span class="comments">; The Y outside margin.</span>
       WAspect = waspect, $             <span class="comments">; Set the window aspect ratio to this value.</span>
       WXSize = wxsize, $               <span class="comments">; The X size of the cgWindow graphics window in pixels. By default: 400.</span>
       WYSize = wysize, $               <span class="comments">; The Y size of the cgWindow graphics window in pixels. By default: 400.</span>
       WTitle = wtitle, $               <span class="comments">; The window title.</span>
       WXPos = wxpos, $                 <span class="comments">; The X offset of the window on the display. The window is centered if not set.</span>
       WYPos = wypos )                  <span class="comments">; The Y offset of the window on the display. The window is centered if not set.</span>
        
END
</code>
    </div>
  </body>
</html>