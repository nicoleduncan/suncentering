<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:59 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>rdpsf.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="rdpsf.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="rdpsf:source"></a>pro rdpsf,psf,hpsf,psfname
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       RDPSF</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Read the FITS file created by GETPSF in the DAOPHOT sequence </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       Combines the Gaussian with the residuals to create an output PSF array.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       RDPSF, PSF, HPSF, [ PSFname]</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS</span>
<span class="comments">;       PSFname - string giving the name of the FITS file containing the PSF</span>
<span class="comments">;               residuals</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS</span>
<span class="comments">;       psf - array containing the actual PSF</span>
<span class="comments">;       hpsf - header associated with psf</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES CALLED:</span>
<span class="comments">;       DAO_VALUE(), MAKE_2D, SXADDPAR, READFITS(), SXPAR()</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written W. Landsman              December, 1988</span>
<span class="comments">;       Checked for IDL Version 2, J. Isensee & J. Hill, December, 1990</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>
 On_error,2

 if N_params() LT 2 then begin
    print,'Syntax - RDPSF, psf, Hpsf, [ PSFname ]'
    print,'    PSF,HPSF - are the output PSF array and header'
    print,'    PSFNAME - the name of the file containing the PSF, input'
   return
 endif

 if N_params() EQ 2 then begin
    psfname = ''
    read,'Enter name of the FITS file containing the PSF residuals: ',psfname
 endif

 resid = readfits(psfname, hpsf)
 gauss = sxpar(hpsf,'GAUSS*')  <span class="comments">;Get Gaussian parameters (5)</span>
 psfrad = sxpar(hpsf,'PSFRAD') <span class="comments">;Get PSF radius</span>
 npsf = 2*psfrad+1             <span class="comments">;Width of output array containing PSF</span>
 psf = fltarr(npsf,npsf)       <span class="comments">;Create output array</span>
 dx = indgen(npsf) - psfrad    <span class="comments">;Vector gives X distance from center of array</span>
 dy = dx                       <span class="comments">;Ditto for dy</span>
 make_2d,dx,dy                 <span class="comments">;Now have X and Y values for each pixel in</span>
<span class="comments">;                              the output array   </span>

 psf = psf + dao_value(dx,dy,gauss,resid) <span class="comments">;Compute DAOPHOT value at each point</span>

 sxaddpar,hpsf,'NAXIS1',npsf   <span class="comments">;Update header to contain PSF size</span>
 sxaddpar,hpsf,'NAXIS2',npsf   <span class="comments">;rather than residual array size</span>

 return
 end
</code>
    </div>
  </body>
</html>