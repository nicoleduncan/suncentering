<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:39 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>getpsf.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="getpsf.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="getpsf-code.html" title="Chromocoded source">Source</a> <a href="getpsf.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">getpsf.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="getpsf">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="getpsf-code.html#getpsf:source" class="top">source</a> getpsf<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>getpsf<span class="argument">, <a href="#getpsf:p:image">image</a></span><span class="argument">, <a href="#getpsf:p:xc">xc</a></span><span class="argument">, <a href="#getpsf:p:yc">yc</a></span><span class="argument">, <a href="#getpsf:p:apmag">apmag</a></span><span class="argument">, <a href="#getpsf:p:sky">sky</a></span><span class="argument">, <a href="#getpsf:p:ronois">ronois</a></span><span class="argument">, <a href="#getpsf:p:phpadu">phpadu</a></span><span class="argument">, <a href="#getpsf:p:gauss">gauss</a></span><span class="argument">, <a href="#getpsf:p:psf">psf</a></span><span class="argument">, <a href="#getpsf:p:idpsf">idpsf</a></span><span class="argument">, <a href="#getpsf:p:psfrad">psfrad</a></span><span class="argument">, <a href="#getpsf:p:fitrad">fitrad</a></span><span class="argument">, <a href="#getpsf:p:psfname">psfname</a></span><span class="argument">, <a href="#getpsf:k:DEBUG">DEBUG</a>=<span class="var">DEBUG</span></span></code></p>

          
          <div class="small "><p> NAME:
	GETPSF
 PURPOSE:
	To generate a point-spread function (PSF) from observed stars.
 EXPLANATION:
	The PSF is represented as a 2-dimensional Gaussian
	(integrated over each pixel) and a lookup table of residuals.
	The lookup table and Gaussian parameters are output in a FITS
	image file.   The PSF FITS file created by GETPSF can be
	read with the procedure RDPSF.      Adapted from the 1986 STSDAS
	version of DAOPHOT
</p>

<p> CALLING SEQUENCE:
	GETPSF, image, xc, yc, apmag, sky, [ronois, phpadu, gauss, psf,
			idpsf, psfrad, fitrad, psfname, /DEBUG ]
</p>

<p> INPUTS:
	IMAGE  - input image array
	XC     - input vector of x coordinates (from FIND), these should be
		IDL (first pixel is (0,0)) convention.
	YC     - input vector of y coordinates (from FIND)
	APMAG  - vector of magnitudes (from APER), used for initial estimate
		of gaussian intensity.  If APMAG is multidimensional, (more
		than 1 aperture was used in APER) then the first aperture
		is used.
	SKY    - vector of sky values (from APER)
</p>

<p> OPTIONAL INPUTS:
	The user will be prompted for the following parameters if not supplied.
</p>

<p>	RONOIS - readout noise per pixel, (in electrons, or equivalent photons)
	PHPADU - photons per analog digital unit, used to scale the data
		numbers in IMAGE into photon units
	IDPSF  - subscripts of the list of stars created by
		APER which will be used to define the PSF.   Stars whose
		centroid does not fall within PSFRAD of the edge of the frame,
		or for which a Gaussian fit requires more than 25 iterations,
		will be ignored when creating the final PSF.
	PSFRAD - the scalar radius, in pixels, of the circular area within
		which the PSF will be defined.   This should be slightly larger
		than the radius of the brightest star that one will be
		interested in.
	FITRAD - the scalar radius, in pixels of the circular area used in the
		least-square star fits.  Stetson suggest that FITRAD should
		approximately equal to the FWHM, slightly less for crowded
		fields.  (FITRAD must be smaller than PSFRAD.)
	PSFNAME- Name of the FITS file that will contain the table of residuals,
		and the best-fit Gaussian parameters.    This file is
		subsequently required for use by NSTAR.
</p>

<p> OPTIONAL OUTPUTS:
	GAUSS  - 5 element vector giving parameters of gaussian fit to the
		first PSF star
		GAUSS(0) - height of the gaussian (above sky)
		GAUSS(1) - the offset (in pixels) of the best fitting gaussian
			and the original X centroid
		GAUSS(2) - similiar offset from the Y centroid
		GAUSS(3) - Gaussian sigma in X
		GAUSS(4) - Gaussian sigma in Y
	PSF    - 2-d array of PSF residuals after a Gaussian fit.
</p>

<p> PROCEDURE:
	GETPSF fits a Gaussian profile to the core of the first PSF star
	and generates a look-up table of the residuals of the
	actual image data from the Gaussian fit.  If desired, it will then
	fit this PSF to another star (using PKFIT) to determine its precise
	centroid, scale the same Gaussian to the new star's core, and add the
	differences between the actual data and the scaled Gaussian to the
	table of residuals.   (In other words, the Gaussian fit is performed
       only on the first star.)
</p>

<p> OPTIONAL KEYWORD INPUT:
	DEBUG - if this keyword is set and non-zero, then the result of each
		fitting iteration will be displayed.
</p>

<p> PROCEDURES CALLED
	DAOERF, MAKE_2D, MKHDR, RINTER(), PKFIT, STRNUMBER(), STRN(), WRITEFITS
</p>

<p> REVISON HISTORY:
	Adapted from the 1986 version of DAOPHOT in STSDAS
	IDL Version 2  W Landsman           November 1988
	Use DEBUG keyword instead of !DEBUG  W. Landsman       May 1996
	Converted to IDL V5.0   W. Landsman   September 1997
</p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="getpsf:p:image">image <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:xc">xc <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:yc">yc <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:apmag">apmag <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:sky">sky <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:ronois">ronois <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:phpadu">phpadu <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:gauss">gauss <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:psf">psf <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:idpsf">idpsf <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:psfrad">psfrad <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:fitrad">fitrad <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="getpsf:p:psfname">psfname <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="getpsf:k:DEBUG">DEBUG <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:50 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>405</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:57:39 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>