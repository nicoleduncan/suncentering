<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:25 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>dbcompare.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="dbcompare.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="dbcompare:source"></a>pro dbcompare,list1,list2, items, TEXTOUT=textout, DIFF = diff
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;     DBCOMPARE</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;     Display two entries in an IDL database side by side in a column format</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:     </span>
<span class="comments">;     dbcompare, list1, list2, [items, TEXTOUT= , /DIFF]  </span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;     list1 - Integer scalar giving first entry number to be compared.</span>
<span class="comments">;     list2 - Integer scalar giving second entry number to be compared.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT-OUTPUT:</span>
<span class="comments">;     items - items to be compared, if not supplied then all items will be</span>
<span class="comments">;          compared.    The items can be specified in any of the following ways:</span>
<span class="comments">;</span>
<span class="comments">;             form 1  scalar string giving item(s) as list of names</span>
<span class="comments">;                     separated by commas</span>
<span class="comments">;             form 2  string array giving list of item names</span>
<span class="comments">;             form 3  string of form '$filename' giving name</span>
<span class="comments">;                     of text file containing items (one item per line)                      line)</span>
<span class="comments">;             form 4  integer scalar giving single item number or</span>
<span class="comments">;                     integer vector list of item numbers</span>
<span class="comments">;             form 5  Null string specifying interactive selection.   This</span>
<span class="comments">;                     is the default if 'items' is not supplied</span>
<span class="comments">;             form 6  '*'     select all items (= default)</span>
<span class="comments">;</span>
<span class="comments">;            If items was undefined or a null string on input, then</span>
<span class="comments">;            on output it will contain the items interactively selected.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS:</span>
<span class="comments">;     /DIFF - If this keyword is set and non-zero, then only the items </span>
<span class="comments">;             in the database that differ will be printed</span>
<span class="comments">;</span>
<span class="comments">;     TEXTOUT -  Scalar Integer (1-7) Used to determine output device.   See</span>
<span class="comments">;               TEXTOPEN for more info.</span>
<span class="comments">;</span>
<span class="comments">; SYSTEM VARIABLES:</span>
<span class="comments">;     Output device controlled by non-standard system variable !TEXTOUT, if </span>
<span class="comments">;     TEXTOUT keyword is not used.    </span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;     Display entries 3624 and 3625 in column form showing only the items</span>
<span class="comments">;     that differ.</span>
<span class="comments">;               IDL> dbcompare,3624,3625,/diff</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;     DB_INFO(), DB_ITEM, DB_ITEM_INFO(), DBRD, DBXVAL()</span>
<span class="comments">;     TEXTOPEN, TEXTCLOSE</span>
<span class="comments">; HISTORY:</span>
<span class="comments">;     Written,  W. Landsman            July 1996</span>
<span class="comments">;     Fix documentation, add Syntax display    W. Landsman   November 1998   </span>
<span class="comments">;     Replace DATATYPE() with size(/TNAME)   W. Landsman    November 2001</span>
<span class="comments">;     Assume since V5.5, remove VMS call  W. Landsman       September 2006</span>
<span class="comments">;     Fix problem with multiple values when /DIFF set W. Landsman April 2007</span>
<span class="comments">;-</span>
<span class="comments">;</span>
 On_error,2                                <span class="comments">;Return to caller</span>
 compile_opt idl2
 if N_params() LT 2 then begin
       print,'Syntax - DBCOMPARE, list1, list2, [items, TEXTOUT= ,/DIFF]'  
       return
 endif
 
<span class="comments">; Make list a vector</span>

 dbname = db_info( 'NAME', 0 )

 nentry = db_info( 'ENTRIES', 0)
 if list1[0] GT nentry then message, dbname + $
     ' LIST1 entry number must be between 1 and ' + strtrim( nentry, 2 )

 if list2[0] GT nentry then message, dbname + $
     ' LIST2 entry number must be between 1 and ' + strtrim( nentry, 2 )


<span class="comments">; Determine items to print</span>

 if N_elements(items) EQ 0 then items = '*'
 db_item,items, it, ivalnum, dtype, sbyte, numvals, nbytes
 nvalues = db_item_info( 'NVALUES', it )        <span class="comments">;number of values in item</span>
 nitems = N_elements( it )                      <span class="comments">;number of items requested</span>
 qnames = db_item_info( 'NAME', it )
 qtitle = db_info( 'TITLE', 0 )                 <span class="comments">;data base title</span>

<span class="comments">; Open output text file</span>

 if not keyword_set(TEXTOUT) then textout = !textout  <span class="comments">;use default output dev.</span>

 textopen, dbname, TEXTOUT = textout
 if size(TEXTOUT,/TNAME) EQ 'STRING' then text_out = 5 else $
        text_out = textout &lt<span class="comments">;!TEXTUNIT</span>

<span class="comments">; Create table listing of each item specified. -------------------------</span>

      dbrd, list1, entry1                         <span class="comments">; read an entry.</span>
      dbrd, list2, entry2                         <span class="comments">; read an entry.</span>
      printf, !TEXTUNIT, ' '                        <span class="comments">; print  blank line.</span>

<span class="comments">; display name and value for each entry </span>

      for k = 0, nitems-1  do begin
         <span class="comments">;</span>
         <span class="comments">; only print entries of reasonable size... &lt; 5 values in item.</span>
         <span class="comments">;</span>
         if nvalues[k] LT 5 then begin
                value1 = dbxval(entry1,dtype[k],nvalues[k],sbyte[k],nbytes[k])
                value2 = dbxval(entry2,dtype[k],nvalues[k],sbyte[k],nbytes[k])
                if dtype[k] EQ 1 then begin
                        value1 = fix(value1)
                        value2 = fix(value2)
                endif
                value1 = strtrim(value1,2)
                value2 = strtrim(value2,2)
                if keyword_set(diff) then $
		       doprint = total(value1 NE value2) GT 0  $
                                      else doprint = 1
                if doprint then printf,!textunit,it[k],') ',qnames[k],  $
                        f = '(i,a,a,a,t55,a)',  value1,value2
         endif                                          <span class="comments">;display name,value</span>
       endfor   <span class="comments">; k</span>


 printf,!textunit,' '                         <span class="comments">;Added 11/90</span>
 
 textclose, TEXTOUT = textout                   <span class="comments">;close text file</span>

 return
 end
</code>
    </div>
  </body>
</html>