<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:07 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>table_calc.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="table_calc.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="table_calc:source"></a>pro table_calc,table,expression,table_out
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	TABLE_CALC </span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Adds a new table column from a expression using existing columns</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	table_calc, table, expression, table_out</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;	table - input SDAS table table</span>
<span class="comments">;	expression - expression for new or updated column values.</span>
<span class="comments">;		Any legal IDL expression is valid where existing</span>
<span class="comments">;		column names can be used as variables.  User functions</span>
<span class="comments">;		within the expression are allowed if the function</span>
<span class="comments">;		is in an IDL library or previously compiled.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT:</span>
<span class="comments">;	table_out - output table name.  If not supplied, the</span>
<span class="comments">;		input name is used.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;	a new SDAS table file is created.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLES:</span>
<span class="comments">;</span>
<span class="comments">;	 create a column WAVELENGTH in table TAB which is the average</span>
<span class="comments">;	of the WLOW and WHIGH columns of table TAB.</span>
<span class="comments">;</span>
<span class="comments">;		table_calc,'tab','WAVELENGTH=(WLOW+WHIGH)/2.0'</span>
<span class="comments">;</span>
<span class="comments">;	add a column SINX which is the sin of column X to table JUNK.</span>
<span class="comments">;</span>
<span class="comments">;		table_calc,'junk','SINX=sin(X)'</span>
<span class="comments">;</span>
<span class="comments">;	add 10.0 to an existing column in table MYTAB.</span>
<span class="comments">;</span>
<span class="comments">;		table_calc,'mytab','flux=flux+10.0'</span>
<span class="comments">;</span>
<span class="comments">; HISTORY</span>
<span class="comments">;	version 1  D. Lindler November, 1989</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;-</span>
<span class="comments">;----------------------------------------------------------------------</span>
<span class="comments">;</span>
<span class="comments">; set output file name</span>
<span class="comments">;</span>
	if n_params(0) lt 3 then table_out=table
<span class="comments">;</span>
<span class="comments">; read input table</span>
<span class="comments">;</span>
	tab_read,table,tcb,tab,h
<span class="comments">;</span>
<span class="comments">; get name of the output column</span>
<span class="comments">;</span>
	st = expression
	outcol = gettok(st,'=')
	if strtrim(st) eq '' then begin
		print,'TABLE_CALC--invalid expression supplied'
		retall
	endif
	st=strupcase(st)
<span class="comments">;</span>
<span class="comments">; get names of the input columns and read if needed into a variable</span>
<span class="comments">; with a name equal to the column name.</span>
<span class="comments">;</span>
	tab_size,tcb,nrows,ncols
	for i=0,ncols-1 do begin
	    tab_col,tcb,i+1,offset,width,dtype,name
	    name = strtrim(name)
	    if strpos(st,strupcase(name)) ge 0 then begin
		istat = execute(name+"=tab_val(tcb,tab,'"+name+"')")
		if istat le 0 then return
	    endif
	endfor
<span class="comments">;</span>
<span class="comments">; execute the expression with the result going into varible x</span>
<span class="comments">;</span>
	istat = execute('x='+st)
	if istat le 0 then begin
		print,'TABLE_CALC - error processing the expression'
		retall
	endif
<span class="comments">;</span>
<span class="comments">; add column to the table</span>
<span class="comments">;</span>
	tab_put,outcol,x,tcb,tab
<span class="comments">;</span>
<span class="comments">; write the new table</span>
<span class="comments">;</span>
	sxaddhist,' TABLE_CALC:  '+outcol+' = '+st,h
	tab_write,table_out,tcb,tab,h
	return
	end
</code>
    </div>
  </body>
</html>