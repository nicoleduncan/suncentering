<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:32 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>getwrd.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="getwrd.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;-------------------------------------------------------------</span>
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       GETWRD</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Return the n'th word from a text string.</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       wrd = getwrd(txt, n, [m])</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       txt = text string to extract from.         in</span>
<span class="comments">;         The first element is used if txt is an array.</span>
<span class="comments">;       n = word number to get (first = 0 = def).  in</span>
<span class="comments">;       m = optional last word number to get.      in</span>
<span class="comments">; KEYWORD PARAMETERS:</span>
<span class="comments">;       Keywords:</span>
<span class="comments">;         LOCATION = l.  Return word n string location.</span>
<span class="comments">;         DELIMITER = d. Set word delimiter (def = space & tab).</span>
<span class="comments">;         /LAST means n is offset from last word.  So n=0 gives</span>
<span class="comments">;           last word, n=-1 gives next to last, ...</span>
<span class="comments">;           If n=-2 and m=0 then last 3 words are returned.</span>
<span class="comments">;         /NOTRIM suppresses whitespace trimming on ends.</span>
<span class="comments">;         NWORDS=n.  Returns number of words in string.</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       wrd = returned word or words.              out</span>
<span class="comments">; COMMON BLOCKS:</span>
<span class="comments">;       getwrd_com</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       Note: If a NULL string is given (txt="") then the last string</span>
<span class="comments">;             given is used.  This saves finding the words again.</span>
<span class="comments">;             If m > n wrd will be a string of words from word n to</span>
<span class="comments">;             word m.  If no m is given wrd will be a single word.</span>
<span class="comments">;             n&lt;0 returns text starting at word abs(n) to string end</span>
<span class="comments">;             If n is out of range then a null string is returned.</span>
<span class="comments">;             See also nwrds.</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;       Ray Sterner,  6 Jan, 1985.</span>
<span class="comments">;       R. Sterner, Fall 1989 --- converted to SUN.</span>
<span class="comments">;       R. Sterner, Jan 1990 --- added delimiter.</span>
<span class="comments">;       R. Sterner, 18 Mar, 1990 --- added /LAST.</span>
<span class="comments">;       R. Sterner, 31 Jan, 1991 --- added /NOTRIM.</span>
<span class="comments">;       R. Sterner, 20 May, 1991 --- Added common and NULL string.</span>
<span class="comments">;       R. Sterner, 13 Dec, 1992 --- Made tabs equivalent to spaces.</span>
<span class="comments">;       R. Sterner,  4 Jan, 1993 --- Added NWORDS keyword.</span>
<span class="comments">;       R. Sterner, 2001 Jan 15 --- Fixed to use first element if not a scalar.</span>
<span class="comments">;       Johns Hopkins University Applied Physics Laboratory.</span>
<span class="comments">;</span>
<span class="comments">; Copyright (C) 1985, Johns Hopkins University/Applied Physics Laboratory</span>
<span class="comments">; This software may be used, copied, or redistributed as long as it is not</span>
<span class="comments">; sold and this copyright notice is reproduced on each copy made.  This</span>
<span class="comments">; routine is provided as is without any express or implied warranties</span>
<span class="comments">; whatsoever.  Other limitations apply as described in the file disclaimer.txt.</span>
<span class="comments">;-</span>
<span class="comments">;-------------------------------------------------------------</span>
 
 
	FUNCTION GETWRD, TXTSTR, NTH, MTH, help=hlp, location=ll,$
	   delimiter=delim, notrim=notrim, last=last, nwords=nwords
 
	common getwrd_com, txtstr0, nwds, loc, len
 
	if (n_params(0) lt 1) or keyword_set(hlp) then begin
	  print," Return the n'th word from a text string."
	  print,' wrd = getwrd(txt, n, [m])'
	  print,'   txt = text string to extract from.         in'
	  print,'     The first element is used if txt is an array.'
	  print,'   n = word number to get (first = 0 = def).  in'
	  print,'   m = optional last word number to get.      in'
	  print,'   wrd = returned word or words.              out'
	  print,' Keywords:'
	  print,'   LOCATION = l.  Return word n string location.'
	  print,'   DELIMITER = d. Set word delimiter (def = space & tab).'
	  print,'   /LAST means n is offset from last word.  So n=0 gives'
	  print,'     last word, n=-1 gives next to last, ...'
	  print,'     If n=-2 and m=0 then last 3 words are returned.'
	  print,'   /NOTRIM suppresses whitespace trimming on ends.'
	  print,'   NWORDS=n.  Returns number of words in string.'
	  print,'Note: If a NULL string is given (txt="") then the last string'
	  print,'      given is used.  This saves finding the words again.'
	  print,'      If m > n wrd will be a string of words from word n to'
	  print,'      word m.  If no m is given wrd will be a single word.'
	  print,'      n&lt;0 returns text starting at word abs(n) to string end'
	  print,'      If n is out of range then a null string is returned.'
	  print,'      See also nwrds.'
	  return, -1
	endif
 
	if n_params(0) lt 2 then nth = 0		<span class="comments">; Def is first word.</span>
	IF N_PARAMS(0) LT 3 THEN MTH = NTH		<span class="comments">; Def is one word.</span>
 
	if strlen(txtstr[0]) gt 0 then begin
	  ddel = ' '					<span class="comments">; Def del is a space.</span>
	  if n_elements(delim) ne 0 then ddel = delim	<span class="comments">; Use given delimiter.</span>
	  TST = (byte(ddel))(0)				<span class="comments">; Del to byte value.</span>
	  tb = byte(txtstr[0])				<span class="comments">; String to bytes.</span>
	  if ddel eq ' ' then begin		        <span class="comments">; Check for tabs?</span>
	    w = where(tb eq 9B, cnt)			<span class="comments">; Yes.</span>
	    if cnt gt 0 then tb[w] = 32B		<span class="comments">; Convert any to space.</span>
	  endif
	  X = tb NE TST					<span class="comments">; Non-delchar (=words).</span>
	  X = [0,X,0]					<span class="comments">; 0s at ends.</span>
 
	  Y = (X-SHIFT(X,1)) EQ 1			<span class="comments">; Diff=1: word start.</span>
	  Z = WHERE(SHIFT(Y,-1) EQ 1)			<span class="comments">; Word start locations.</span>
	  Y2 = (X-SHIFT(X,-1)) EQ 1			<span class="comments">; Diff=1: word end.</span>
	  Z2 = WHERE(SHIFT(Y2,1) EQ 1)			<span class="comments">; Word end locations.</span>
 
	  txtstr0 = txtstr[0]				<span class="comments">; Move string to common.</span>
	  NWDS = long(TOTAL(Y))				<span class="comments">; Number of words.</span>
	  LOC = Z					<span class="comments">; Word start locations.</span>
	  LEN = Z2 - Z - 1				<span class="comments">; Word lengths.</span>
	endif else begin
	  if n_elements(nwds) eq 0 then begin		<span class="comments">; Check if first call.</span>
	    print,' Error in getwrd: must give a '+$
	      'non-NULL string on the first call.'
	    return, -1					<span class="comments">; -1 = error flag.</span>
	  endif
	endelse
 
	nwords = nwds					<span class="comments">; Set nwords</span>
 
	if keyword_set(last) then begin			<span class="comments">; Offset from last.</span>
	  lst = nwds - 1
	  in = lst + nth				<span class="comments">; Nth word.</span>
	  im = lst + mth				<span class="comments">; Mth word.</span>
	  if (in lt 0) and (im lt 0) then return, ''	<span class="comments">; Out of range.</span>
	  in = in > 0					<span class="comments">; Smaller of in and im</span>
	  im = im > 0					<span class="comments">;  to zero.</span>
	  if (in gt lst) and (im gt lst) then return,'' <span class="comments">; Out of range.</span>
	  in = in &lt<span class="comments">; lst					; Larger of in and im</span>
	  im = im &lt<span class="comments">; lst					;  to be last.</span>
	  ll = loc[in]					<span class="comments">; Nth word start.</span>
	  return, strtrim(strmid(txtstr0,ll,loc[im]-loc[in]+len[im]), 2) 
	endif
 
	N = ABS(NTH)					<span class="comments">; Allow nth&lt;0.</span>
	IF N GT NWDS-1 THEN RETURN,''			<span class="comments">; out of range, null.</span>
	ll = loc[n]					<span class="comments">; N'th word position.</span>
	IF NTH LT 0 THEN GOTO, NEG			<span class="comments">; Handle nth&lt;0.</span>
	IF MTH GT NWDS-1 THEN MTH = NWDS-1		<span class="comments">; Words to end.</span>
 
	if keyword_set(notrim) then begin
	  RETURN, STRMID(TXTSTR0,ll,LOC[MTH]-LOC[NTH]+LEN[MTH])
	endif else begin
	  RETURN, strtrim(STRMID(TXTSTR0,ll,LOC[MTH]-LOC[NTH]+LEN[MTH]), 2)
 	endelse
 
NEG:	if keyword_set(notrim) then begin
	  RETURN, STRMID(TXTSTR0,ll,9999)
	endif else begin
	  RETURN, strtrim(STRMID(TXTSTR0,ll,9999), 2)
	endelse
 
	END
</code>
    </div>
  </body>
</html>