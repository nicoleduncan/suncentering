<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:43 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>imlist.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="imlist.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="imlist:source"></a>pro imlist, image, xc, yc, DX=dx, DY = DY, WIDTH=width, TEXTOUT = textout, $
                           DESCRIP = descr,OFFSET = offset
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;      IMLIST        </span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;      Display pixel values on an image surrounding a specified X,Y center.</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;      IMLIST is similar to TVLIST but the center pixel is supplied directly by</span>
<span class="comments">;      the user, rather than being read off of the image display</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;      IMLIST, Image, Xc, Yc, [ TEXTOUT = , DX = , DY = ,WIDTH = ,DESCRIP = ]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;      Image - Two-dimensional array containing the image </span>
<span class="comments">;      Xc  -   X pixel value at which to center the display, integer scalar </span>
<span class="comments">;      Yc -    Y pixel value at which to center the display, integer scalar </span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS KEYWORDS:</span>
<span class="comments">;      TEXTOUT - Scalar number (1-7) or string which determines output device.</span>
<span class="comments">;               (see TEXTOPEN) The following dev/file is opened for output.</span>
<span class="comments">;</span>
<span class="comments">;               textout=1       TERMINAL using /more option</span>
<span class="comments">;               textout=2       TERMINAL without /more option</span>
<span class="comments">;               textout=3       &lt;program>.prt</span>
<span class="comments">;               textout=4       laser.tmp</span>
<span class="comments">;               textout=5       user must open file</span>
<span class="comments">;               textout=7       same as 3 but text is appended to &lt;program>.prt</span>
<span class="comments">;                               if file already exists</span>
<span class="comments">;               textout = filename (default extension of .prt)</span>
<span class="comments">;</span>
<span class="comments">;       DX     -Integer scalar giving the number of pixels inthe  X direction </span>
<span class="comments">;               to be displayed.  If omitted then DX = 18 for byte images, and </span>
<span class="comments">;               DX = 14 for integer images.  IMLIST will display REAL data </span>
<span class="comments">;               with more significant figures if more room is available to </span>
<span class="comments">;               print.  </span>
<span class="comments">;</span>
<span class="comments">;       DY    - Same as DX, but in Y direction.  If omitted, then DY = DX </span>
<span class="comments">;       WIDTH - Integer scalar giving the character width of the output device.</span>
<span class="comments">;               Default is 80 characters.</span>
<span class="comments">;       DESCRIP =  Scalar string which will be written as a description over</span>
<span class="comments">;               the output pixel values.   If DESCRIP is not supplied, and the</span>
<span class="comments">;               output device specified by TEXTOUT is not a terminal, then the</span>
<span class="comments">;               user will be prompted for a description.</span>
<span class="comments">;       OFFSET - 2 element numeric vector giving an offset to apply to the </span>
<span class="comments">;               display of the X,Y coordinates of the image (e.g. if the </span>
<span class="comments">;               supplied image array is a subarray of a larger image).</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       None.</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;       Corresponding region of image is then displayed at</span>
<span class="comments">;       the terminal.   If necessary, IMLIST will divide all pixel values</span>
<span class="comments">;       in a REAL*4 image by a (displayed) factor of 10 to make a pretty format.</span>
<span class="comments">;</span>
<span class="comments">; SYSTEM VARIABLES:</span>
<span class="comments">;       If the keyword TEXTOUT is not supplied, then the non-standard system</span>
<span class="comments">;       variable !TEXTOUT will be read.    (The procedure ASTROLIB can be</span>
<span class="comments">;       used to add the non-standard system variables.)</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;       IMLIST may not be able to correctly format all pixel values if the</span>
<span class="comments">;       dynamic range of the values near the center pixel is very large</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Display the pixel values of an image array IM in the vicinity of 254,111</span>
<span class="comments">;</span>
<span class="comments">;       IDL> imlist, IM, 254, 111</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES USED</span>
<span class="comments">;       TEXTOPEN, F_FORMAT(), TEXTCLOSE</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written,    W. Landsman             June, 1991</span>
<span class="comments">;       Added DESCRIP keyword    W. Landsman      December, 1991</span>
<span class="comments">;       Treat LONG image as integer when possible, call TEXTOPEN with /STDOUT</span>
<span class="comments">;       keyword, W. Landsman   April, 1996</span>
<span class="comments">;       Use SYSTIME() instead of !STIME  August 1997</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Recognize new integer types, added OFFSET keyword  W. Landsman Jan. 2000</span>
<span class="comments">;       Replace DATATYPE() with size(/TNAME)  W. Landsman Nov. 2001</span>
<span class="comments">;       Handle NAN values in output display W. Landsman June 2004</span>
<span class="comments">;       Use V6.0 notation  W. Landsman April 2011</span>
<span class="comments">;-</span>
 On_error,2                                   <span class="comments">;Return to caller</span>
 compile_opt idl2

 if N_params() LT 3 then begin
    print,'Syntax - IMLIST, Image, Xc, Yc, [TEXTOUT= ,DX=, DY=, WIDTH= ,DESC= ]'
    print,'        Image - Any IDL numeric 2-d array'
    print,'        Xc, Yc - X,Y of center pixel of region to display'
    return
 endif


 if ~keyword_set( TEXTOUT )  then textout = !TEXTOUT      <span class="comments">;Use default</span>
 if N_elements( OFFSET) NE 2 then offset = [0,0]

 if size( TEXTOUT,/TNAME ) NE 'STRING' then begin
        textout = textout > 2                  <span class="comments">;Don't use /MORE</span>
        hardcopy =  (textout GE 3) && (textout NE 5) 
 endif else hardcopy = 1

 defsysv,'!TEXTUNIT',exist=i
 if i EQ 0 then astrolib
 textopen, 'IMLIST', TEXTOUT = textout, /STDOUT            <span class="comments">;Open output device</span>

 sz = size(image)
 if (sz[0] LT 2) or (sz[sz[0]+2] NE sz[1]*sz[2]) then $
                message,'Image array (first parameter) not 2-dimensional'

 type = sz[ sz[0] + 1 ]      <span class="comments">;Byte or Integer or Float image?</span>

 if hardcopy then begin   <span class="comments">;Direct output to a disk file</span>
        printf,!TEXTUNIT,'IMLIST: ' + strmid(systime(),4,20)
        if ~keyword_set( DESCR ) then begin
           descr = ''
           read,'Enter a brief description to be written to disk: ',descr
        endif
        printf,!TEXTUNIT,descr
        printf,!TEXTUNIT,' '
 endif                 

 xdim = sz[1] - 1 
 ydim = sz[2] - 1 

<span class="comments">; Make sure supplied center pixel is actually within image</span>

 if (xc LT 0) || (xc GT xdim) then $
        message,'ERROR - X pixel center must be between 0 and '+strtrim(xdim,2)
 if (yc LT 0) || (yc GT ydim) then $
        message,'ERROR - Y pixel center must be between 0 and '+strtrim(ydim,2)

 xim = round(xc)
 yim = round(yc)
 if ~keyword_set( WIDTH ) then width = 80

 case type of
 1: fmtsz = 4
 2: fmtsz = 6
12: fmtsz = 6
else: fmtsz = 5
endcase

 if ~keyword_set(DX) then dx = fix((width - 5)/fmtsz)
 if ~keyword_set(DY) then dy = dx

<span class="comments">; Don't try to print outside the image</span>
  xmax = (xim + dx/2) &lt<span class="comments">; xdim</span>
  xmin = (xim - dx/2) > 0 
  ymax = (yim + dy/2) &lt<span class="comments">; ydim</span>
  ymin = (yim - dy/2) > 0 

 dx = xmax - xmin + 1 & dy = ymax - ymin + 1
 if fmtsz EQ 5 then  fmtsz = ( width-4 ) / dx
 sfmt = strtrim( fmtsz,2 )
 cdx = string(dx,'(i2)')
 flt_to_int = 0               <span class="comments">;Convert floating point to integer?</span>


<span class="comments">; For Integer and Byte datatypes we already know the best output format</span>
<span class="comments">; For other datatypes the function F_FORMAT is used to get the best format</span>
<span class="comments">; If all values of a LONG image can be expressed with 5 characters </span>
<span class="comments">; (-9999 &lt; IM &lt; 99999) then treat as an integer image.</span>
REDO:
 case 1 of                                    <span class="comments">;Get proper print format</span>

   type EQ 1:  fmt = '(i4,' + cdx + 'i' + sfmt + ')'           <span class="comments">;byte</span>

   (type EQ 2):   fmt = '(i4,' + cdx + 'i' + sfmt + ')'        <span class="comments">;Integer</span>
   (type EQ 12):  fmt = '(i4,1x,' + cdx + 'i' + sfmt + ')'     <span class="comments">;Unsigned Integer</span>

   (type EQ 4) || (type EQ 3) || (type EQ 5) || (type GE 13):  begin      <span class="comments">;Long, Real or Double</span>

      temp = image[ xmin:xmax,ymin:ymax ]
      minval = min( temp, MAX = maxval, /nan)
      if (type EQ 3) || (type GE 13) then  begin

                if (maxval LT 999.) && (minval GT -99.) then begin
                type = 1 & sfmt = '4'
                 goto, REDO
                endif
                if (maxval LT 9999.) && (minval GT -999.) then begin
                type = 12 & sfmt = '5'
                goto, REDO
                endif
                if (maxval LT 99999.) && (minval GT -9999.) then begin
                type = 2  & sfmt = '6'
                goto, REDO
                endif
      endif

      realfmt = F_FORMAT( minval, maxval, factor, fmtsz )
      if strmid(realfmt,0,1) EQ 'I' then flt_to_int = 1
      fmt = '(i4,1x,' + cdx + realfmt + ')'
      if factor NE 1 then $                                   
       printf,!TEXTUNIT,form='(/,A,E7.1,/)',' IMLIST: Scale Factor ',factor

      end

    else: message,'ERROR - Unrecognized data type'
 endcase 

<span class="comments">; Compute and print x-indices above array</span>

 index = indgen(dx) + xmin + offset[0]

 if type NE 1 then $
     printf,!TEXTUNIT,form='(A,'+ cdx + 'i' + sfmt + ')',' col ',index  $
 else printf,!TEXTUNIT,form='(A,'+ cdx + 'i' + sfmt + ')',' col',index

 printf,!TEXTUNIT,'$(A)',' row'
 for i = ymax,ymin,-1 do begin  <span class="comments">;list pixel values</span>

        row = image[i*sz[1]+xmin:i*sz[1]+xmax]      <span class="comments">;from supplied image array</span>
        if type EQ 1 then row = fix(row)
        if (type EQ 4) || (type EQ 3) || (type EQ 5) || (type GE 13) then $
                   row = row/factor
        if flt_to_int then row = round( row )
        printf, !TEXTUNIT, FORM = fmt, i + offset[1], row

 endfor
 
 textclose, TEXTOUT=textout
 
 return
 end
</code>
    </div>
  </body>
</html>