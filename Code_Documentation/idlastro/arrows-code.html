<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:19 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>arrows.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="arrows.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="arrows:source"></a>pro arrows,h,xcen,ycen,thick=thick,charsize=charsize,arrowlen=arrowlen, $
             color=color,NotVertex=NotVertex,Normal = normal,Data=data,font=font
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;      ARROWS</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;      To display "weathervane" directional arrows on an astronomical image </span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;      Overlays a graphic showing orientation of North and East.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;      ARROWS,h, [ xcen, ycen, ARROWLEN= , CHARSIZE=  COLOR= , /DATA</span>
<span class="comments">;                              FONT=, /NORMAL, /NOTVERTEX, THICK=  ]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       h - FITS header array, must include astrometry</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUTS:</span>
<span class="comments">;       xcen,ycen - numeric scalars, specifying the center position of</span>
<span class="comments">;		arrows.   Position in device units unless the /NORMALIZED </span>
<span class="comments">;		keyword is specified.   If not supplied, then ARROWS</span>
<span class="comments">;		will prompt for xcen and ycen</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL KEYWORD INPUTS:</span>
<span class="comments">;       arrowlen  - length of arrows in terms of normal Y size of vector-drawn</span>
<span class="comments">;                     character,  default  = 3.5, floating point scalar</span>
<span class="comments">;       charsize  - character size, default = 2.0, floating point scalar</span>
<span class="comments">;       color     -  color name or number for the arrows and NE letters.  See</span>
<span class="comments">;                 cgCOLOR() for a list of color names.                    </span>
<span class="comments">;       Data - if this keyword is set and nonzero, the input center (xcen,</span>
<span class="comments">;                 ycen) is understood to be in data coordinates</span>
<span class="comments">;       font - IDL vector font number (1-20) to use to display NE letters.</span>
<span class="comments">;                 For example, set font=13 to use complex italic font.</span>
<span class="comments">;       NotVertex - Normally (historically) the specified xcen,ycen indicated</span>
<span class="comments">;                   the position of the vertex of the figure.  If this</span>
<span class="comments">;                   keyword is set, the xcen,ycen coordinates refer to a sort</span>
<span class="comments">;                   of 'center of mass' of the figure.  This allows the</span>
<span class="comments">;                   figure to always appear with the area irregardless of</span>
<span class="comments">;                   the rotation angle.</span>
<span class="comments">;       Normal - if this keyword is set and nonzero, the input center </span>
<span class="comments">;                (xcen,ycen) is taken to be in normalized coordinates.   The</span>
<span class="comments">;                default is device coordinates.</span>
<span class="comments">;       thick     - line thickness, default = 2.0, floating point scalar</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       none</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Draw a weathervane at (400,100) on the currently active window, </span>
<span class="comments">;       showing the orientation of the image associated with a FITS header, hdr</span>
<span class="comments">;</span>
<span class="comments">;       IDL> arrows, hdr, 400, 100</span>
<span class="comments">;</span>
<span class="comments">; METHOD:</span>
<span class="comments">;       Uses EXTAST to EXTract ASTrometry from the FITS header.   The </span>
<span class="comments">;       directions of North and East are computed and the procedure</span>
<span class="comments">;       ONE_ARROW called to create the "weathervane".</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       GETROT - Computes rotation from the FITS header</span>
<span class="comments">;       ONE_ARROW - Draw a labeled arrow	</span>
<span class="comments">;       ZPARCHECK</span>
<span class="comments">; REVISON HISTORY:</span>
<span class="comments">;       written by B. Boothman 2/5/86 </span>
<span class="comments">;       Recoded with new procedures ONE_ARROW, ONE_RAY.  R.S.Hill,HSTX,5/20/92</span>
<span class="comments">;       Added separate determination for N and E arrow to properly display</span>
<span class="comments">;         arrows irregardless of handedness or other peculiarities and added</span>
<span class="comments">;         /NotVertex keyword to improve positioning of figure. E.Deutsch 1/10/93</span>
<span class="comments">;       Added /DATA and /NORMAL keywords W. Landsman      July 1993</span>
<span class="comments">;       Recognize GSSS header    W. Landsman       June 1993</span>
<span class="comments">;       Added /FONT keyword W. Landsman           April 1995</span>
<span class="comments">;       Modified to work correctly for COLOR=0  J.Wm.Parker, HITC   1995 May 25</span>
<span class="comments">;       Work correctly for negative CDELT values   W. Landsman   Feb. 1996</span>
<span class="comments">;       Use GETROT to compute rotation   W. Landsman    June 2003</span>
<span class="comments">;       Restored /NotVertex keyword which was not working after June 2003 change</span>
<span class="comments">;                  W. Landsman  January 2004</span>
<span class="comments">;-</span>

  On_error,2                            <span class="comments">;Return to caller</span>

  if (N_params() LT 1) then begin 
    print,'Syntax - ' + $
             'ARROWS, hdr, [ xcen, ycen, ARROWLEN= , CHARSIZE=  COLOR= , /DATA'
    print,'                        FONT=, /NORMAL, /NotVertex, THICK=  ]'
    print,'         hdr - FITS header with astrometry'
    return
  endif else zparcheck,'ARROWS',h,1,7,1,'FITS header array'

  if ( N_params() LT 3 ) then $
    read,'Enter x, y values for center of arrows: ',xcen,ycen

  setdefaultvalue, thick, 2.0
  setdefaultvalue, charsize, 2.0
  setdefaultvalue, arrowlen, 3.5
  setdefaultvalue, NotVertex, 0

<span class="comments">;  Derive Position Angles for North and East separately</span>

  getrot,h,npa, cdelt,/SILENT
  sgn = 1 - 2*(cdelt[0]*cdelt[1] GT 0) 
  epa = npa + sgn*90   

<span class="comments">;  Make arrows reasonable size depending on device</span>

  arrowlen_dev = arrowlen*!D.y_ch_size
  arrowsize = [arrowlen_dev, arrowlen_dev/3.5, 35.0]  <span class="comments">; See one_arrow.pro</span>

  if keyword_set( NORMAL) then begin
	newcen = convert_coord( xcen, ycen, /NORMAL, /TO_DEVICE)
        xcent = newcen[0]
        ycent = newcen[1]
  endif else if keyword_set( DATA) then begin
	newcen = convert_coord( xcen, ycen, /DATA, /TO_DEVICE)
        xcent = newcen[0]
        ycent = newcen[1]
  endif else begin
         xcent=xcen & ycent=ycen
  endelse 

<span class="comments">;  Adjust Center to 'Center of Mass' if NotVertex set</span>
 if NotVertex then begin
    rot = npa/!RADEG
    dRAdX = cdelt[0]*cos(rot)
    dRAdY = cdelt[1]*sin(rot)
    dDECdX = cdelt[0]*sin(rot) 
    dDECdY = cdelt[1]*cos(rot)
    RAnorm = sqrt( dRAdX^2 + dRAdY^2 )
    DECnorm = sqrt(dDECdX^2 + dDECdY^2 )
    xcent = xcen - (dRAdX+dDECdX)/2/RAnorm*arrowsize[0]
    ycent = ycen - (dRAdY+dDECdY)/2/DECnorm*arrowsize[0]
    endif

<span class="comments">;  Draw arrows</span>
  one_arrow, xcent, ycent,  90+NPA, 'N', font= font, $
    charsize=charsize, thick=thick, color=color, arrowsize=arrowsize
  one_arrow, xcent, ycent, 90+EPA, 'E', font = font, $
    charsize=charsize, thick=thick, color=color, arrowsize=arrowsize

  return
  end
</code>
    </div>
  </body>
</html>