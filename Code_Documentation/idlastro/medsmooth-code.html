<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:47 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>medsmooth.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="medsmooth.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">FUNCTION MEDSMOOTH,ARRAY,WINDOW
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       MEDSMOOTH</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Median smoothing of a vector, including points near its ends.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       SMOOTHED = MEDSMOOTH( VECTOR, WINDOW_WIDTH )</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       VECTOR  = The (1-d numeric) vector to be smoothed</span>
<span class="comments">;       WINDOW = Odd integer giving the full width of the window over which </span>
<span class="comments">;               the median is determined for each point.     (If WINDOW is</span>
<span class="comments">;               specified as an even number, then the effect is the same as</span>
<span class="comments">;               using WINDOW+1)   </span>
<span class="comments">;</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       Function returns the smoothed vector</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURE:</span>
<span class="comments">;       Each point is replaced by the median of the nearest WINDOW of points.</span>
<span class="comments">;       The width of the window shrinks towards the ends of the vector, so that</span>
<span class="comments">;       only the first and last points are not filtered. These points are </span>
<span class="comments">;       replaced by forecasting from smoothed interior points.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Create a vector with isolated high points near its ends</span>
<span class="comments">;       IDL> a = randomn(seed,40) & a[1] = 10  & a[38] = 10</span>
<span class="comments">;       Now do median smoothing with a 7 point window </span>
<span class="comments">;       IDL> b = medsmooth(a,7)</span>
<span class="comments">;       Note that, unlike MEDIAN(), that MEDSMOOTH will remove the isolated</span>
<span class="comments">;       high points near the ends.</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written, H. Freudenreich, STX, 12/89</span>
<span class="comments">;       H.Freudenreich, 8/90: took care of end-points by shrinking window.</span>
<span class="comments">;       Speed up using vector median when possible  W. Landsman February 2002</span>
<span class="comments">;-</span>

 LEND = N_ELEMENTS(ARRAY)-1
 IF (LEND+1) LT WINDOW THEN BEGIN
   message,/CON, $
         'ERROR - Size of smoothing window must be smaller than array size'
   RETURN,ARRAY
 ENDIF

 OFFSET = FIX(WINDOW/2)

 smoothed = median(array, window )

<span class="comments">; Fix the ends:</span>
 NUMLOOP = (WINDOW-1)/2 - 1
 IF NUMLOOP GT 0 THEN BEGIN
   FOR J=1,NUMLOOP DO BEGIN 

     LEN = 2*J+1
     SMOOTHED[J] = MEDIAN(ARRAY[0:LEN-1])
     SMOOTHED[LEND-J] =  MEDIAN(ARRAY[LEND-LEN+1:LEND]) 

   ENDFOR
ENDIF

<span class="comments">; Now replace the very last and first points:</span>
 Y0 = 3.*ARRAY[0]-2.*ARRAY[1]         <span class="comments">; Predicted value of point -1</span>
 SMOOTHED[0] = MEDIAN([Y0,ARRAY[0],ARRAY[1]])
 Y0 = 3.*ARRAY[LEND]-2.*ARRAY[LEND-1] <span class="comments">; Predicted value of point LEND+1</span>
 SMOOTHED[LEND] = MEDIAN([Y0,ARRAY[LEND],ARRAY[LEND-1]])
               
 RETURN,SMOOTHED
 END
</code>
    </div>
  </body>
</html>