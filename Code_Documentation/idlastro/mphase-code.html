<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:48 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>mphase.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="mphase.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="mphase:source"></a>pro mphase,jd, k
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       MPHASE</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Return the illuminated fraction of the Moon at given Julian date(s) </span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       MPHASE, jd, k</span>
<span class="comments">; INPUT:</span>
<span class="comments">;       JD - Julian date, scalar or vector, double precision recommended</span>
<span class="comments">; OUTPUT:</span>
<span class="comments">;       k - illuminated fraction of Moon's disk (0.0 &lt; k &lt; 1.0), same number</span>
<span class="comments">;           of elements as jd.   k = 0 indicates a new moon, while k = 1 for</span>
<span class="comments">;           a full moon.</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Plot the illuminated fraction of the moon for every day in July </span>
<span class="comments">;       1996 at 0 TD (~Greenwich noon).</span>
<span class="comments">;</span>
<span class="comments">;       IDL> jdcnv, 1996, 7, 1, 0, jd         ;Get Julian date of July 1</span>
<span class="comments">;       IDL> mphase, jd+dindgen(31), k        ;Moon phase for all 31 days</span>
<span class="comments">;       IDL> plot, indgen(31),k               ;Plot phase vs. July day number</span>
<span class="comments">;</span>
<span class="comments">; METHOD:</span>
<span class="comments">;       Algorithm from Chapter 46 of "Astronomical Algorithms" by Jean Meeus</span>
<span class="comments">;       (Willmann-Bell, Richmond) 1991.   SUNPOS and MOONPOS are used to get</span>
<span class="comments">;       positions of the Sun and the Moon (and the Moon distance).   The</span>
<span class="comments">;       selenocentric elongation of the Earth from the Sun (phase angle)</span>
<span class="comments">;       is then computed, and used to determine the illuminated fraction.</span>
<span class="comments">; PROCEDURES CALLED:</span>
<span class="comments">;       MOONPOS, SUNPOS</span>
<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;       Written W. Landsman     Hughes STX           June 1996</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Use /RADIAN keywords to MOONPOS, SUNPOS internally  W. Landsman Aug 2000</span>
<span class="comments">;-</span>
 On_error,2

 if N_params() LT 2 then begin
        print,'Syntax - MPHASE, jd, k'
        return
 endif
 diss = 1.49598e8         <span class="comments">;Earth-Sun distance (1 AU)</span>

 moonpos, jd, ram, decm, dism, /RADIAN
 sunpos, jd, ras, decs, /RADIAN

<span class="comments">; phi - geocentric elongation of the Moon from the Sun</span>
<span class="comments">; inc - selenocentric (Moon centered) elongation of the Earth from the Sun</span>

 phi = acos( sin(decs)*sin(decm) + cos(decs)*cos(decm)*cos(ras-ram) )
 inc = atan( diss * sin(phi), dism - diss*cos(phi) )
 k = (1 + cos(inc))/2.

 return
 end
</code>
    </div>
  </body>
</html>