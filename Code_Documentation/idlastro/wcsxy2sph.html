<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:12 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>wcsxy2sph.pro (Documentation for ./)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="wcsxy2sph.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for ./</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="wcsxy2sph-code.html" title="Chromocoded source">Source</a> <a href="wcsxy2sph.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          User documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">idlastro/</h2>
      <h1 class="basename">wcsxy2sph.pro<span class="file-attributes"></span></h1>
      

      
      <span class="file_attribute small">includes main-level program</span>
      
      <br/>

      
      <div id="file_comments">
        <div class="small "><p> NAME:
      WCSXY2SPH
</p>

<p> PURPOSE:
      Convert x and y (map) coordinates to spherical coordinates
 EXPLANATION:
      To convert x and y (map) coordinates to spherical (longitude and
      latitude or sky) coordinates.    This procedure is the inverse of
      WCSSPH2XY.
</p>

<p>     This is a lower level procedure -- given a FITS header, the user will
     usually use XYAD which will then call WCSXY2SPH with the appropriate
     parameters.
 CATEGORY:
      Mapping and Auxilary FITS Routine
</p>

<p> CALLING SEQUENCE:
</p>

<p>      wcsxy2sph, x, y, longitude, latitude, [map_type], [ CTYPE = ,$
             FACE = ,PV2 = ,CRVAL =, CRXY =, LONGPOLE=, LATPOLE=]
</p>

<p> INPUT PARAMETERS:
</p>

<p>       x - x coordinate of data, scalar or vector, in degrees, NOTE: x
               increases to the left, not the right
       y - y coordinate of data, same number of elements as x, in degrees
       map_type - optional positional parameter, scalar corresponding to a
               particular map projection.  This is not a FITS standard, it is
               simply put in to allow function similar to that of less general
               map projection procedures (eg AITOFF).  The following list gives
               the map projection types and their respective numbers.
</p>

<p>  FITS  Number  Name                       Comments
  code   code
  ----  ------  -----------------------    -----------------------------------
   DEF     0    Default = Cartesian
   AZP     1    Zenithal perspective       pv2_1 required
   TAN     2    Gnomic                     AZP w/ pv2_1 = 0
   SIN     3    Orthographic               pv2_1, pv2_2 optional
   STG     4    Stereographic              AZP w/ pv2_1 = 1
   ARC     5    Zenithal Equidistant
   ZPN     6    Zenithal polynomial        PV2_0, PV2_1....PV2_20 possible
   ZEA     7    Zenithal equal area
   AIR     8    Airy                       pv2_1 required
   CYP     9    Cylindrical perspective    pv2_1 and pv2_2 required
   CAR    10    Cartesian
   MER    11    Mercator
   CEA    12    Cylindrical equal area     pv2_1 required
   COP    13    Conical perspective        pv2_1 and pv2_2 required
   COD    14    Conical equidistant        pv2_1 and pv2_2 required
   COE    15    Conical equal area         pv2_1 and pv2_2 required
   COO    16    Conical orthomorphic       pv2_1 and pv2_2 required
   BON    17    Bonne's equal area         pv2_1 required
   PCO    18    Polyconic
   SFL    19    Sanson-Flamsteed
   PAR    20    Parabolic
   AIT    21    Hammer-Aitoff
   MOL    22    Mollweide
   CSC    23    Cobe Quadrilateralized     inverse converges poorly
                Spherical Cube
   QCS    24    Quadrilateralized
                Spherical Cube
   TSC    25    Tangential Spherical Cube
   SZP    26    Slant Zenithal perspective  PV2_1,PV2_2, PV2_3 optional
   HPX    27    HealPix
   HCT    28    HealCart (Cartesian approximation of Healpix)
</p>

<p> OPTIONAL KEYWORD PARAMETERS:
</p>

<p>       CTYPE - One, two, or three element vector containing 8 character
               strings corresponding to the CTYPE1, CTYPE2, and CTYPE3
               FITS keywords:
</p>

<p>               CTYPE[0] - first four characters specify standard system
               ('RA--','GLON' or 'ELON' for right ascension, galactic
               longitude or ecliptic longitude respectively), second four
               letters specify the type of map projection (eg '-AIT' for
               Aitoff projection)
               CTYPE[1] - first four characters specify standard system
               ('DEC-','GLAT' or 'ELAT' for declination, galactic latitude
               or ecliptic latitude respectively; these must match
               the appropriate system of ctype1), second four letters of
               ctype2 must match second four letters of ctype1.
               CTYPE[2] - if present must be the 8 character string,'CUBEFACE',
                only used for spherical cube projections to identify an axis
               as containing the face on which each x and y pair of
               coordinates lie.
       FACE - a input variable used for spherical cube projections to
               designate the face of the cube on which the x and y
               coordinates lie.   Must contain the same number of elements
               as X and Y.
       CRVAL - 2 element vector containing standard system coordinates (the
               longitude and latitude) of the reference point
       CRXY - 2 element vector giving the x and y coordinates of the
               reference point, if this is not set the offset of the x
               coordinate is assumed to be 0.
       LATPOLE -  native latitude of the standard system's North Pole
       LONGPOLE - native longitude of standard system's North Pole, default
               is 180 degrees, numeric scalar
       PV2  - Vector of projection parameter associated with latitude axis
             PV2 will have up to 21 elements for the ZPN projection, up to 3
             for the SIN projection and no more than 2 for any other
             projection.   The first element corresponds to PV2_1, the
             second to PV2_2, etc.
</p>

<p> OUTPUT PARAMETERS:
</p>

<p>       longitude - longitude of data, same number of elements as x, in degrees
       latitude - latitude of data, same number of elements as x, in degrees
</p>

<p>       Longitude and latitude will be set to NaN, wherever elements of X,Y
       have no corresponding longitude, latitude values.
 NOTES:
       The conventions followed here are described in more detail in the paper
      "Representations of Celestial Coordinates in FITS" by Calabretta &
       Greisen (2002, A&A, 395, 1077, also see
       http://fits.gsfc.nasa.gov/fits_wcs.html).   The general scheme
       outlined in that article is to convert x and y coordinates into a
       "native" longitude and latitude and then rotate the system into one of
       three generally recognized systems (celestial, galactic or ecliptic).
</p>

<p>       This procedure necessitates two basic sections.  The first converts
       x and y coordinates to "native" coordinates while the second converts
       "native" to "standard" coordinates.  The first section contains the
       guts of the code in which all of the map projection is done.  The
       second step is performed by WCS_ROTATE and only involves rotation of
       coordinate systems.  WCSXY2SPH can be called in a form similar to
       AITOFF, EQPOLE, or QDCB by calling wcsxy2sph with a fifth parameter
       specifying the map projection by number and by not using any of the
       keywords related to the map projection type (eg ctype1 and ctyp2).
</p>

<p> PROCEDURE:
       The first task of the procedure is to do general error-checking to
       make sure the procedure was called correctly and none of the
       parameters or keywords conflict.  This is particularly important
       because the procedure can be called in two ways (either using
       FITS-type keywords or using a number corresponding a map projection
       type).  All variables are converted into double precision values.
</p>

<p>       The second task of the procedure is to take x and y coordinates and
       convert them into "native" latitude and longitude coordinates.
       Map-specific error-checking is done at this time.  All of the
       equations were obtained from "Representations of Celestial
       Coordinates in FITS" and cases needing special attention are handled
       appropriately (see the comments with individual map projections for
       more information on special cases).     WCS_ROTATE is then called to
       convert the "native" coordinates to "standard" coordinates by rotating
       the coordinate system.  This rotation is governed by the keywords
       CRVAL, and LONGPOLE.  The transformation is a straightforward
       application of euler angles.  Finally, longitude values are converted
       into the range from 0 to 360 degrees.
</p>

<p> COMMON BLOCKS:
       none
 PROCEDURES CALLED:
       WCS_ROTATE
</p>

<p> AUTHOR:
</p>

<p>       Rick Balsano
</p>

<p> MODIFICATIONS/REVISION LEVEL:
</p>

<p> 1.1    8/31/93
 1.2    9/12/93   W. Landsman Vectorized CRXY, CRVAL, CTYPE
 1.3    29/12/93  I. Freedman Eliminated LU decomposition
 1.4    22/09/94  W. Landsman If scalar input, then scalar output
 1.5    02/03/05  W. Landsman Change variable name BETA for V4.0 compatibility
 1.6    06/07/05  W. Landsman Change loop index from integer to long
 1.7    02/18/99  W. Landsman Fixed implementation of ARC algorithm
 1.8    June 2003 W. Landsman Update conic projections, add LATPOLE keyword
 1.81   Sep 2003 W. Landsman Avoid divide by zero
 1.82   Sep 2003 W. Landsman CTYPE keywords need not be 8 characters
 1.83   Sep 2003 W. Landsman Preserve input array sizes
 1.9    Jan 2004 W. Landsman don't modify scalars, fix PARabolic code
 2.0    Feb 2004 W. Landsman Fix AIR and AZP projections
 2.1    Feb 2004 W. Landsman Fix tangent projection for matrix input
 3.0    May 2004  W. Landsman Support extended SIN (=NCP), slant zenithal
                  (SZP), and zenithal polynomial (ZPN) projections, use
                   PV2 keyword vector instead of PROJP1, PROJP2
 3.1    May 2004 W. Landsman/J. Ballet Handle NaN values, flag invalid output
                   for AITOFF projection
 3.1.1  Dec 2005 W. Landsman/W. Thompson Fixed problem with Airy projection
                   centered on 90 degree latitude
 3.1.2  May 2006 W. Landsman/Y.Sato Fix problem selecting the correct root
                    for the ZPN projection
 3.2    Aug 2007  W. Landsman Correct treatment of PVi_j parameters
 3.3    Oct 2007  Sergey Koposov Support HEALPIX projection
 3.4    May 2012  Benjamin Alan Weaver, Add nonstandard HEALCART
                        projection, Allow map_index to be &gt; 25
</p>

</div>
      </div>
      

      

      

      

      

      


      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="wcsxy2sph">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="wcsxy2sph-code.html#wcsxy2sph:source" class="top">source</a> wcsxy2sph<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>wcsxy2sph<span class="argument">, <a href="#wcsxy2sph:p:x">x</a></span><span class="argument">, <a href="#wcsxy2sph:p:y">y</a></span><span class="argument">, <a href="#wcsxy2sph:p:longitude">longitude</a></span><span class="argument">, <a href="#wcsxy2sph:p:latitude">latitude</a></span><span class="argument">, <a href="#wcsxy2sph:p:map_type">map_type</a></span><span class="argument">, <a href="#wcsxy2sph:k:ctype">ctype</a>=<span class="var">ctype</span></span><span class="argument">, <a href="#wcsxy2sph:k:face">face</a>=<span class="var">face</span></span><span class="argument">, <a href="#wcsxy2sph:k:pv2">pv2</a>=<span class="var">pv2</span></span><span class="argument">, <a href="#wcsxy2sph:k:crval">crval</a>=<span class="var">crval</span></span><span class="argument">, <a href="#wcsxy2sph:k:crxy">crxy</a>=<span class="var">crxy</span></span><span class="argument">, <a href="#wcsxy2sph:k:longpole">longpole</a>=<span class="var">longpole</span></span><span class="argument">, <a href="#wcsxy2sph:k:Latpole">Latpole</a>=<span class="var">Latpole</span></span></code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="wcsxy2sph:p:x">x <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:p:y">y <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:p:longitude">longitude <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:p:latitude">latitude <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:p:map_type">map_type <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="wcsxy2sph:k:ctype">ctype <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:k:face">face <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:k:pv2">pv2 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:k:crval">crval <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:k:crxy">crxy <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:k:longpole">longpole <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="wcsxy2sph:k:Latpole">Latpole <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Oct 23 10:15:49 2012</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>1,318</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.5.1 on Mon Sep 30 16:58:12 2013</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>