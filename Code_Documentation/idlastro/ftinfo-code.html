<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:33 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>ftinfo.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="ftinfo.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="ftinfo:source"></a>pro ftinfo, h, ft_str, Count = tfields
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       FTINFO</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Return an informational structure from a FITS ASCII table header.</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       ftinfo,h,ft_str, [Count = ]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       h - FITS ASCII table header, string array</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       ft_str - IDL structure with extracted info from the FITS ASCII table</span>
<span class="comments">;                header.   Tags include</span>
<span class="comments">;        .tbcol - starting column position in bytes</span>
<span class="comments">;        .width - width of the field in bytes</span>
<span class="comments">;        .idltype - idltype of field.</span>
<span class="comments">;                       7 - string, 4- real*4, 3-integer, 5-real*8</span>
<span class="comments">;        .tunit - string unit numbers</span>
<span class="comments">;        .tscal - scale factor</span>
<span class="comments">;        .tzero - zero point for field</span>
<span class="comments">;        .tnull - null value for the field</span>
<span class="comments">;        .tform - format for the field</span>
<span class="comments">;        .ttype - field name</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL OUTPUT KEYWORD:</span>
<span class="comments">;       Count - Integer scalar giving number of fields in the table</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;       GETTOK(), SXPAR()</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       This procedure underwent a major revision in May 2000, and **THE</span>
<span class="comments">;       NEW CALLING SEQUENCE IS INCOMPATIBLE WITH THE OLD ONE **</span>
<span class="comments">; HISTORY:</span>
<span class="comments">;       D. Lindler  July, 1987</span>
<span class="comments">;       Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;       Major rewrite, return structure   W. Landsman   April 2000</span>
<span class="comments">;-</span>
<span class="comments">;----------------------------------------------------------------------------</span>
<span class="comments">; On_error,2</span>
<span class="comments">;</span>
  if N_params() LT 2 then begin
      print,'Syntax - FTINFO, header, ft_str'
      return
  endif

<span class="comments">; get number of fields</span>

 tfields = sxpar( h, 'TFIELDS' , Count = N_TFields)
 if N_TFields EQ 0 then $
        message,'Invalid FITS header. keyword TFIELDS is missing'

 if tfields EQ 0 then return
 tbcol = intarr(tfields)
 tform = replicate(' ',tfields)

<span class="comments">; get info for specified field</span>

 ttype = sxpar(h,'ttype*',Count=N_ttype)                    <span class="comments">;field name</span>
 if N_ttype EQ 0 then ttype = strarr(tfields)

 tbcol[0] = sxpar(h,'tbcol*', Count = N_tbcol)       <span class="comments">;starting column position</span>
 if N_tbcol NE tfields then message,/CON, $
 'Warning - Invalid FITS table header -- TBCOL not present for all fields'
<span class="comments">;</span>
 tform[0] = strtrim(sxpar(h,'tform*', Count = N_tform),2)   <span class="comments">; column format</span>
 if N_tform NE tfields then message,/CON, $
   'Warning - Invalid FITS table header -- TFORM  not present for all fields'
 <span class="comments">;                                               ; physical units</span>
 tunit = strarr(Tfields)
 temp = sxpar(h, 'TUNIT*', Count = N_tunit)
 if N_tunit GT 0 then tunit[0] = temp

 tscal = fltarr(Tfields)
 temp = sxpar(h, 'TSCAL*', Count = N_tscal)      <span class="comments">; data scale factor</span>
 if N_tscal GT 0 then tscal[0] = temp

 tzero = fltarr(tfields)
 temp = sxpar(h,'TZERO*', Count = N_tzero)       <span class="comments">; zero point for field</span>
 if N_tzero GT 0 then tzero[0] = temp

 tnull = strarr(Tfields)
 temp = sxpar(h,'TNULL*', Count = N_tnull)       <span class="comments">;null data value</span>
 if N_tnull GT 0 then tnull[0] = temp
<span class="comments">;</span>
<span class="comments">; determine idl data type from format</span>
<span class="comments">;</span>
 type = strmid(tform,0,1)
 idltype = intarr(tfields)
 for i=0,tfields-1 do begin
 case strupcase(type[i]) of
        'A' : idltype[i] = 7
        'I' : idltype[i] = 3
        'E' : idltype[i] = 4
        'F' : idltype[i] = 4
        'D' : idltype[i] = 5
        else: message,'Invalid format specification for keyword ' + $
                        'TFORM' + strtrim(i+1,2)
 endcase
 endfor
<span class="comments">;</span>
<span class="comments">; get field width in characters</span>
<span class="comments">;</span>
 decpos = strpos(tform,'.')
 decimal = decpos GT 0
 len = strlen(tform)
 width = intarr(tfields)
 for i=0, tfields-1 do begin
     if decimal[i] then width[i] = fix(strmid(tform[i],1,decpos[i]-1)) else $
                     width[i] = fix(strmid(tform[i],1,len[i]-1))
 endfor
 ft_str = {TBCOL:tbcol,WIDTH:width,IDLTYPE:idltype,TUNIT:tunit, TSCAL:tscal, $
           TZERO:tzero, TNULL:tnull, TFORM:tform, TTYPE:ttype}

 return
 end
</code>
    </div>
  </body>
</html>