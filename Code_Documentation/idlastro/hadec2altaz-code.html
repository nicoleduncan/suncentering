<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:40 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>hadec2altaz.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="hadec2altaz.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">PRO hadec2altaz, ha, dec, lat, alt, az, WS=WS

<span class="comments">;+</span>
<span class="comments">;  NAME:</span>
<span class="comments">;     HADEC2ALTAZ</span>
<span class="comments">;  PURPOSE:</span>
<span class="comments">;      Converts Hour Angle and Declination to Horizon (alt-az) coordinates.</span>
<span class="comments">;  EXPLANATION:</span>
<span class="comments">;      Can deal with NCP/SCP singularity.    Intended mainly to be used by</span>
<span class="comments">;      program EQ2HOR</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;      HADEC2ALTAZ, ha, dec, lat ,alt ,az [ /WS ]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS</span>
<span class="comments">;     ha -  the local apparent hour angle, in DEGREES, scalar or vector</span>
<span class="comments">;     dec -  the local apparent declination, in DEGREES, scalar or vector</span>
<span class="comments">;     lat -  the local latitude, in DEGREES, scalar or vector</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS</span>
<span class="comments">;     alt - the local apparent altitude, in DEGREES.</span>
<span class="comments">;     az  - the local apparent azimuth, in DEGREES, all results in double</span>
<span class="comments">;           precision</span>
<span class="comments">; OPTIONAL KEYWORD INPUT:</span>
<span class="comments">;      /WS - Set this keyword for the output azimuth to be measured West from </span>
<span class="comments">;            South.    The default is to measure azimuth East from North.</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;     What were the apparent altitude and azimuth of the sun when it transited </span>
<span class="comments">;     the local meridian at Pine Bluff Observatory (Lat=+43.07833 degrees) on </span>
<span class="comments">;     April 21, 2002?   An object transits the local meridian at 0 hour angle.</span>
<span class="comments">;     Assume this will happen at roughly 1 PM local time (18:00 UTC).</span>
<span class="comments">;</span>
<span class="comments">;     IDL> jdcnv, 2002, 4, 21, 18., jd  ; get rough Julian date to determine </span>
<span class="comments">;                                       ;Sun ra, dec.</span>
<span class="comments">;     IDL> sunpos, jd, ra, dec</span>
<span class="comments">;     IDL> hadec2altaz, 0., dec, 43.078333, alt, az</span>
<span class="comments">;</span>
<span class="comments">;       ===> Altitude alt = 58.90</span>
<span class="comments">;            Azimuth  az = 180.0</span>

<span class="comments">; REVISION HISTORY:</span>
<span class="comments">;      Written  Chris O'Dell Univ. of Wisconsin-Madison May 2002</span>
<span class="comments">;-</span>

if N_params() LT 4 then begin
     print,'Syntax - HADEC2ALTAZ, ha, dec, lat ,alt ,az [ /WS ]'
     return
endif

d2r = !dpi/180.

sh = sin(ha*d2r) & ch = cos(ha*d2r)
sd = sin(dec*d2r) & cd = cos(dec*d2r)
sl = sin(lat*d2r) & cl = cos(lat*d2r)

x = - ch * cd * sl + sd * cl
y = - sh * cd
z = ch * cd * cl + sd * sl
r = sqrt(x^2 + y^2)
<span class="comments">; now get Alt, Az</span>

az = atan(y,x) /d2r
alt = atan(z,r) / d2r

<span class="comments">; correct for negative AZ</span>
w = where(az LT 0)
if w[0] ne -1 then az[w] = az[w] + 360.

<span class="comments">; convert AZ to West from South, if desired</span>
if keyword_set(WS) then az = (az + 180.) mod 360.


END
</code>
    </div>
  </body>
</html>