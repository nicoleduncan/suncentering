<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:57:31 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>fitsrgb_to_tiff.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="fitsrgb_to_tiff.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"> PRO FITSRGB_to_TIFF, path, rgb_files, tiff_name, BY_PIXEL=by_pixel, $
                      PREVIEW=preview, RED=r_mix, GREEN=g_mix, BLUE=b_mix
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;       FITSRGB_to_TIFF</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;       Combine separate red, green, and blue FITS images into TIFF format</span>
<span class="comments">; EXPLANATION:</span>
<span class="comments">;       The output TIFF (class R) file can have colors interleaved either</span>
<span class="comments">;       by pixel or image.  The colour mix is also adjustable.</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;       FITSRGB_to_TIFF, path, rgb_files, tiff_name [,/BY_PIXEL, /PREVIEW,</span>
<span class="comments">;                         RED= , GREEN =, BLUE =]</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;       path = file system directory path to the RGB files required.</span>
<span class="comments">;       rgb_files = string array with three components - the red FITS file</span>
<span class="comments">;                   filename, the blue FITS file filename and the green FITS</span>
<span class="comments">;                   file filename</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;       tiff_name = string containing name of tiff file to be produced</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL OUTPUT:</span>
<span class="comments">;       Header = String array containing the header from the FITS file.</span>
<span class="comments">;</span>
<span class="comments">; OPTIONAL INPUT KEYWORDS:</span>
<span class="comments">;       BY_PIXEL = This causes TIFF file RGB to be interleaved by pixel</span>
<span class="comments">;                  rather than the default of by image.</span>
<span class="comments">;       PREVIEW  = Allows a 24 bit image to be displayed on the screen</span>
<span class="comments">;                  to check the colour mix.</span>
<span class="comments">;       RED = Real number containing the fractional mix of red</span>
<span class="comments">;       GREEN = Real number containing the fractional mix of green</span>
<span class="comments">;       BLUE = Real number containing the fractional mix of blue</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;       Read three FITS files, 'red.fits', 'blue.fits' and 'green.fits' from</span>
<span class="comments">;       the directory '/data/images/space' and output a TIFF file named</span>
<span class="comments">;       'colour.tiff'</span>
<span class="comments">;</span>
<span class="comments">;               IDL> FITSRGB_to_TIFF, '/data/images/space', ['red.fits', $</span>
<span class="comments">;                    'blue.fits', 'green.fits'], 'colour.tiff'</span>
<span class="comments">;</span>
<span class="comments">;       Read three FITS files, 'red.fits', 'blue.fits' and 'green.fits' from</span>
<span class="comments">;       the current directory and output a TIFF file named '/images/out.tiff'</span>
<span class="comments">;       In this case, the red image is twice as strong as the green and the</span>
<span class="comments">;       blue is a third more intense.  A preview on screen is also wanted.</span>
<span class="comments">;</span>
<span class="comments">;               IDL> FITSRGB_to_TIFF, '.', ['red.fits', $</span>
<span class="comments">;                    'blue.fits', 'green.fits'], '/images/out.tiff', $</span>
<span class="comments">;                    /PREVIEW, RED=0.5, GREEN=1.0, BLUE=0.666</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; RESTRICTIONS:</span>
<span class="comments">;       (1) Limited to the ability of the routine READFITS</span>
<span class="comments">;</span>
<span class="comments">; NOTES:</span>
<span class="comments">;       None</span>
<span class="comments">;</span>
<span class="comments">; PROCEDURES USED:</span>
<span class="comments">;     Functions:   READFITS, CONCAT_DIR</span>
<span class="comments">;     Procedures:  WRITE_TIFF</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;     16th January 1995 - Written by Carl Shaw, Queen's University Belfast</span>
<span class="comments">;	27 Jan 1995 - W. Landsman, Add CONCAT_DIR for VMS, Windows compatibility</span>
<span class="comments">;	Converted to IDL V5.0   W. Landsman   September 1997</span>
<span class="comments">;    Use WRITE_TIFF instead of obsolete TIFF_WRITE  W. Landsman  December 1998</span>
<span class="comments">;    Cosmetic changes  W. Landsman    February 2000</span>
<span class="comments">;-</span>
<span class="comments">;</span>
<span class="comments">;  Make sure user has supplied valid parameters</span>
<span class="comments">;</span>
 IF N_PARAMS() LT 3 THEN BEGIN
      print, 'Syntax -  FITSRGB_to_TIFF, path, rgb_files, tiff_name'
      print,'                     [/BY_PIXEL,/PREVIEW, RED=, GREEN=, BLUE= ]'
      return
 ENDIF
<span class="comments">;</span>
 IF N_ELEMENTS(rgb_files) LT 3 THEN $
  MESSAGE, 'Three filenames for the colour components have not been supplied'
<span class="comments">;</span>
  by_pixel =  KEYWORD_SET(BY_PIXEL)
<span class="comments">;</span>
 IF ~KEYWORD_SET(r_mix) THEN r_mix = 1.0
 IF ~KEYWORD_SET(g_mix) THEN g_mix = 1.0
 IF ~KEYWORD_SET(b_mix) THEN b_mix = 1.0
<span class="comments">;</span>
<span class="comments">;  Now load the colour components</span>
<span class="comments">;</span>
 fname = CONCAT_DIR( path, rgb_files )
 red = READFITS( fname[0], /SILENT)
 green = READFITS( fname[1], /SILENT)
 blue = READFITS( fname[2], /SILENT)
<span class="comments">;</span>
<span class="comments">;  Data now needs to be scaled to the same byte range (0-255) and also</span>
<span class="comments">;  scaled according to the RGB mix values supplied by the user</span>
<span class="comments">;</span>
 red = red[*,*] * r_mix
 green = green[*,*] * g_mix
 blue = blue[*,*] * b_mix          <span class="comments">;scale intensity by supplied mix</span>
<span class="comments">;</span>
 maxlim = MAX(red) > MAX(green) > MAX(blue)   <span class="comments">;max intensity</span>
 minlim = MIN(red) &lt<span class="comments">; MIN(green) &lt; MIN(blue)   ;min intensity</span>
 red = BYTSCL(red, MIN=minlim, MAX=maxlim)
 green = BYTSCL(green, MIN=minlim, MAX=maxlim)
 blue = BYTSCL(blue, MIN=minlim, MAX=maxlim)  <span class="comments">;scale colours to same byte range</span>
<span class="comments">;</span>
<span class="comments">;  Preview image on window system if required</span>
<span class="comments">;</span>
 IF keyword_set(PREVIEW) THEN BEGIN
  window, 0, colors=256
  wset, 0
  tv, color_quan(red, green, blue, r, g, b, colors=255)
  tvlct, r, g, b
 ENDIF
<span class="comments">;</span>
<span class="comments">; Now write out result as a tiff file</span>
<span class="comments">;</span>
 IF by_pixel THEN BEGIN
  <span class="comments">;</span>
  <span class="comments">;  Interleave by pixel</span>
  <span class="comments">;</span>
  extent = SIZE(red)
  xsize = extent[1]
  ysize = extent[2]                       <span class="comments">;get image size</span>
  interarr = FLTARR(3, xsize, ysize, /NOZERO)      <span class="comments">;make interleaved array</span>
  interarr[0, *, *] = red
  interarr[1, *, *] = green
  interarr[2, *, *] = blue
  <span class="comments">;</span>
  WRITE_TIFF, tiff_name, interarr
  <span class="comments">;</span>
 ENDIF ELSE BEGIN
  <span class="comments">;</span>
  <span class="comments">;  Interleave by image</span>
  <span class="comments">;</span>
  WRITE_TIFF, tiff_name, RED=red, BLUE=blue, GREEN=green, PLANARCONFIG=2
  <span class="comments">;</span>
 ENDELSE
<span class="comments">;</span>
 END
</code>
    </div>
  </body>
</html>