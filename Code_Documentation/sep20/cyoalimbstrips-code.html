<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.5.1 on Mon Sep 30 16:58:34 2013 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>cyoalimbstrips.pro (Documentation for ./)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="cyoalimbstrips.pro (Documentation for ./)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source">FUNCTION cyoalimbstrips, inputstruct, inputimage, fixfid
<span class="comments">;+</span>
<span class="comments">;   :Description:</span>
<span class="comments">;       Makes limb strips from whole strips</span>
<span class="comments">;</span>
<span class="comments">;   :Params:</span>
<span class="comments">;       inputstruct: in, required, type=structure</span>
<span class="comments">;           Structure containing all the solar information</span>
<span class="comments">;</span>
<span class="comments">;       inputimage: in, required, type=byte(ndims,2)</span>
<span class="comments">;           The raw input image</span>
<span class="comments">;</span>
<span class="comments">;       fixfid : in, required, type=structure</span>
<span class="comments">;           Strucutre comtaining the fiducial positions to be used for chord checking.</span>
<span class="comments">;</span>
<span class="comments">;   :Keywords:</span>
<span class="comments">;</span>
<span class="comments">;   Fun trivia, the name is an acronym for "Choose Your Own Adventure", meaning this program scales to whatever limb width you want.</span>
<span class="comments">;-</span>

a = makestrips(inputstruct,inputimage,fixfid)
<span class="comments">; How many pixels above/below the threhsold we count</span>
limbwidth = BYTE( !param.ministrip_length)/2

for jj = 0,N_ELEMENTS(inputstruct)-1 do begin
    for i = 0, !param.nstrips - 1 do begin
        <span class="comments">; Where our full-length chord is greater than the threshold</span>
        col_where = WHERE((a[jj].ystrips)[i].ARRAY gt a[jj].thresh)
        row_where = WHERE((a[jj].xstrips)[i].ARRAY gt a[jj].thresh)

        <span class="comments">; startpoints is the cut down strip with length = ministrip_length and contains</span>
        <span class="comments">; the indices from row_where[0] +/- limbwidth</span>
        <span class="comments">; stop</span>
        a[jj].limbxstrips[i].startpoints    = (a[jj].xstrips[i].array)[row_where[0] - limbwidth:row_where[0] + limbwidth - 1]  
        <span class="comments">; begindex is the index of the strip where it begins. </span>
        a[jj].limbxstrips[i].startindex       = FIX(row_where[0] - limbwidth)

        <span class="comments">; tarr = (a[jj].xstrips[i].array)</span>
        <span class="comments">; limb = replicate(!values.f_nan,241)</span>

        <span class="comments">; limb[row_where[0]-limbwidth:row_where[0]+1] = (a[jj].xstrips[i].array)[row_where[0] - limbwidth:row_where[0]+1]</span>

        <span class="comments">; limb[row_where[-1]-limbwidth+1:row_where[-1]+2] = (a[jj].xstrips[i].array)[row_where[-1] - limbwidth+1:row_where[-1] + 2]</span>
        <span class="comments">; ps_start,filename='redlimbs.eps',/encap,/color</span>
        <span class="comments">; plot,tarr,/ys,title='Chord profile over entire sun'</span>
        <span class="comments">; hline,a[jj].thresh</span>
        <span class="comments">; loadct,2</span>
        <span class="comments">; oplot,limb,thick=6,psym=-4,color=100</span>
        <span class="comments">; ps_end</span>
        <span class="comments">; stop</span>
        a[jj].limbxstrips[i].endpoints      = (a[jj].xstrips[i].array)[row_where[N_ELEMENTS(row_where)-1] - limbwidth+ 1:row_where[N_ELEMENTS(row_where)-1] + limbwidth]   
        a[jj].limbxstrips[i].endindex       = FIX(row_where[N_ELEMENTS(row_where)-1] - limbwidth)
        a[jj].limbystrips[i].startpoints    = (a[jj].ystrips[i].array)[col_where[0] - limbwidth:col_where[0] + limbwidth - 1]   
        a[jj].limbystrips[i].startindex       = FIX(col_where[0] - limbwidth)
        a[jj].limbystrips[i].endpoints      = (a[jj].ystrips[i].array)[col_where[N_ELEMENTS(col_where)-1] - limbwidth + 1:col_where[N_ELEMENTS(col_where)-1] + limbwidth]   
        a[jj].limbystrips[i].endindex       = FIX(col_where[N_ELEMENTS(col_where)-1] - limbwidth)
        <span class="comments">; stop</span>
        a[jj].limbxstrips[i].startloc       = row_where[0] - limbwidth
        a[jj].limbxstrips[i].endloc         = row_where[N_ELEMENTS(row_where)-1] - limbwidth+ 1
        a[jj].limbystrips[i].startloc       = col_where[0] - limbwidth
        a[jj].limbystrips[i].endloc         = col_where[N_ELEMENTS(col_where)-1] - limbwidth + 1
    endfor
endfor

RETURN,a
end
</code>
    </div>
  </body>
</html>